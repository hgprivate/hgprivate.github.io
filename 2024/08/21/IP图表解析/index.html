<!doctypehtml><html lang=zh-CN><meta charset=UTF-8><meta content=width=device-width name=viewport><meta media="(prefers-color-scheme: light)" content=#222 name=theme-color><meta media="(prefers-color-scheme: dark)" content=#222 name=theme-color><meta content="Hexo 7.3.0" name=generator><link href=/images/apple-touch-icon-next.png rel=apple-touch-icon sizes=180x180><link href=/images/favicon-32x32-next.png rel=icon sizes=32x32 type=image/png><link href=/images/favicon-16x16-next.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><link href=/css/main.css rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css integrity=sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA= rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css integrity=sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE= rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"hshz21.gitee.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src=/js/config.js></script><meta content="IP基本认识IP作用IP 在 TCP/IP 参考模型中处于第三层，即⽹络层。⽹络层主要作⽤：实现主机之间的通信，也叫点对点（end to end）通信。  IP与MAC关系MAC可以实现两个直连设备间的通信；IP可以实现两个无直连⽹络间的通信。 举个⽣活的栗⼦，⼩林要去⼀个很远的地⽅旅⾏，制定了⼀个⾏程表，其间需先后乘坐⻜机、地铁、公 交⻋才能抵达⽬的地，为此⼩林需要买⻜机票，地铁票等。" name=description><meta content=article property=og:type><meta content=计算机系列-IP图表分析 property=og:title><meta content=https://hshz21.gitee.io/2024/08/21/IP%E5%9B%BE%E8%A1%A8%E8%A7%A3%E6%9E%90/index.html property=og:url><meta content=豪哥博客 property=og:site_name><meta content="IP基本认识IP作用IP 在 TCP/IP 参考模型中处于第三层，即⽹络层。⽹络层主要作⽤：实现主机之间的通信，也叫点对点（end to end）通信。  IP与MAC关系MAC可以实现两个直连设备间的通信；IP可以实现两个无直连⽹络间的通信。 举个⽣活的栗⼦，⼩林要去⼀个很远的地⽅旅⾏，制定了⼀个⾏程表，其间需先后乘坐⻜机、地铁、公 交⻋才能抵达⽬的地，为此⼩林需要买⻜机票，地铁票等。" property=og:description><meta content=zh_CN property=og:locale><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415201526742.png?token=AIGEF3IBSDVTZBJISBUOCC3EZZQHC property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415202504342.png?token=AIGEF3IBSRHYSGRCHUUDKGTEZZQIU property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415203544505.png?token=AIGEF3NLJYYBD5VDNBBQTHTEZZQKW property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415204302389.png?token=AIGEF3MRG4SAOL4EIUZ7TALEZZQMK property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415204603352.png?token=AIGEF3LROQ3FWAKUIANXEN3EZZQN2 property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415205817207.png?token=AIGEF3KWRVXXTJFBF2M32T3EZZQPC property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415211145547.png?token=AIGEF3MW3M2R7E7OPP4GDDLEZZQRA property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415211234778.png?token=AIGEF3LH7MQRN5FCSP6MA5TEZZQSO property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415211525393.png?token=AIGEF3OOIFHUZG5TUUCS7C3EZZQT6 property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415211605113.png?token=AIGEF3OF4XRSSKC4YOE264TEZZQVG property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415211738776.png?token=AIGEF3OS6ZLP5TWZTLUPFGTEZZQW6 property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415211918539.png?token=AIGEF3IMMEMW2YLE2D7BTKTEZZQYI property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415211943850.png?token=AIGEF3NSSLF5SWJLFMRDNCDEZZQZO property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415212003104.png?token=AIGEF3L3DMCNVCSMHFSNBULEZZQ2Y property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415212019344.png?token=AIGEF3LMLOBOWT7Z44SCGFLEZZQ4U property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415212042823.png?token=AIGEF3OGGMZ55NXLKN4PIOLEZZQ56 property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415212322287.png?token=AIGEF3LLTM5WE655PPH2TBDEZZQ7E property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415212554129.png?token=AIGEF3INVAPZ7KYF2BGKFUDEZZRAM property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415212845042.png?token=AIGEF3JRGQDXS5ZBBAVNZHDEZZRCI property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415213617493.png?token=AIGEF3PKCDQC4T4KGH7OOV3EZZRDQ property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415213924099.png?token=AIGEF3NGU6KHIWBVZYN3B4TEZZREW property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415213947044.png?token=AIGEF3NLTJC54KGPO75DZITEZZRF2 property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415214100341.png?token=AIGEF3IO2DLR7L53D6QTLSLEZZRHO property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415214210802.png?token=AIGEF3NZH6JIPHBJQBXNYZLEZZRI6 property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415214300627.png?token=AIGEF3JL3ZQSBAJ4BXGH7F3EZZRKE property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415214715046.png?token=AIGEF3PW6RHL2TMR6FN4UQDEZZRLC property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415214931845.png?token=AIGEF3NVX3DKRC64RYSAHELEZZRMM property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20230805101102458.png?token=AIGEF3JXOV3NUCG7MPNDC33EZZRNY property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415215304596.png?token=AIGEF3PFAKEMEZ6GJ2PNKLTEZZRPE property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415220738058.png?token=AIGEF3M4XEWKNO7CH3ICLN3EZZRQC property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415220931123.png?token=AIGEF3K22S7HJNVL27DCCADEZZRRC property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415221031683.png?token=AIGEF3IKC3ZSXCNDBMPTHTDEZZRSG property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415221514890.png?token=AIGEF3PYUGAL34ICWISTU5LEZZRTM property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415221644966.png?token=AIGEF3J4SSES4SWPSTY7A6LEZZRUQ property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415221723705.png?token=AIGEF3MF22JJES33IHDA7EDEZZRVS property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415221848921.png?token=AIGEF3J4AISZEC7SBUT4H5LEZZRWY property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415222033735.png?token=AIGEF3JE5ZCEGB2HNLAWDI3EZZRXY property=og:image><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415222133007.png?token=AIGEF3LA2MJ4DXOOQZ7TRL3EZZRYU property=og:image><meta content=2024-08-21T13:39:13.781Z property=article:published_time><meta content=2023-10-06T14:13:51.408Z property=article:modified_time><meta content=豪哥 property=article:author><meta content=网络协议 property=article:tag><meta content=IP property=article:tag><meta content=summary name=twitter:card><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415201526742.png?token=AIGEF3IBSDVTZBJISBUOCC3EZZQHC name=twitter:image><link href=https://hshz21.gitee.io/2024/08/21/IP%E5%9B%BE%E8%A1%A8%E8%A7%A3%E6%9E%90/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://hshz21.gitee.io/2024/08/21/IP%E5%9B%BE%E8%A1%A8%E8%A7%A3%E6%9E%90/","path":"2024/08/21/IP图表解析/","title":"计算机系列-IP图表分析"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>计算机系列-IP图表分析 | 豪哥博客</title><noscript><link href=/css/noscript.css rel=stylesheet></noscript><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label=切换导航栏 class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <p class=site-title>豪哥博客</p> <i class=logo-line></i> </a><p class=site-subtitle itemprop=description>豪哥博客</div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=搜索 role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>分类</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>搜索 </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=搜索... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-1"><a class=nav-link href=#IP%E5%9F%BA%E6%9C%AC%E8%AE%A4%E8%AF%86><span class=nav-number>1.</span> <span class=nav-text>IP基本认识</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#IP%E4%BD%9C%E7%94%A8><span class=nav-number>1.1.</span> <span class=nav-text>IP作用</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#IP%E4%B8%8EMAC%E5%85%B3%E7%B3%BB><span class=nav-number>1.2.</span> <span class=nav-text>IP与MAC关系</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link href=#IP%E5%9C%B0%E5%9D%80%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86><span class=nav-number>2.</span> <span class=nav-text>IP地址基础知识</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#IP%E5%9C%B0%E5%9D%80%E5%AE%9A%E4%B9%89><span class=nav-number>2.1.</span> <span class=nav-text>IP地址定义</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#IP%E5%9C%B0%E5%9D%80%E5%88%86%E7%B1%BB><span class=nav-number>2.2.</span> <span class=nav-text>IP地址分类</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#IP%E5%9C%B0%E5%9D%80%E7%B1%BB%E5%9E%8B><span class=nav-number>2.2.1.</span> <span class=nav-text>IP地址类型</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#A%E3%80%81B%E3%80%81C%E7%B1%BB%E5%9E%8B%E5%9C%B0%E5%9D%80><span class=nav-number>2.2.2.</span> <span class=nav-text>A、B、C类型地址</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#D%E3%80%81E%E7%B1%BB%E5%9E%8B%E5%9C%B0%E5%9D%80><span class=nav-number>2.2.3.</span> <span class=nav-text>D、E类型地址</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%B9%BF%E6%92%AD%E5%9C%B0%E5%9D%80><span class=nav-number>2.2.4.</span> <span class=nav-text>广播地址</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#IP%E5%9C%B0%E5%9D%80%E5%88%86%E7%B1%BB%E4%BC%98%E5%8A%A3><span class=nav-number>2.2.5.</span> <span class=nav-text>IP地址分类优劣</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%82%B9><span class=nav-number>2.2.5.1.</span> <span class=nav-text>优点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BC%BA%E7%82%B9><span class=nav-number>2.2.5.2.</span> <span class=nav-text>缺点</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#CIDR%EF%BC%88%E6%97%A0%E5%88%86%E7%B1%BBIP%E5%9C%B0%E5%9D%80%EF%BC%89><span class=nav-number>2.3.</span> <span class=nav-text>CIDR（无分类IP地址）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#CIDR%E7%AE%80%E4%BB%8B><span class=nav-number>2.3.1.</span> <span class=nav-text>CIDR简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%BD%91%E7%BB%9C%E5%8F%B7%E5%92%8C%E4%B8%BB%E6%9C%BA%E5%8F%B7%E5%88%92%E5%88%86><span class=nav-number>2.3.2.</span> <span class=nav-text>网络号和主机号划分</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%AD%90%E7%BD%91%E5%88%92%E5%88%86><span class=nav-number>2.3.3.</span> <span class=nav-text>子网划分</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E4%B8%BA%E5%AD%90%E7%BD%91%E5%88%92%E5%88%86><span class=nav-number>2.3.3.1.</span> <span class=nav-text>何为子网划分</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AD%90%E7%BD%91%E5%88%92%E5%88%86%E5%8E%9F%E7%90%86><span class=nav-number>2.3.3.2.</span> <span class=nav-text>子网划分原理</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%85%AC%E6%9C%89IP%E5%9C%B0%E5%9D%80%E4%B8%8E%E7%A7%81%E6%9C%89IP%E5%9C%B0%E5%9D%80><span class=nav-number>2.4.</span> <span class=nav-text>公有IP地址与私有IP地址</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%85%AC%E7%A7%81IP%E5%9C%B0%E5%9D%80%E7%AE%80%E4%BB%8B><span class=nav-number>2.4.1.</span> <span class=nav-text>公私IP地址简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%85%AC%E7%A7%81IP%E5%9C%B0%E5%9D%80%E7%AE%A1%E7%90%86%E6%9C%BA%E6%9E%84><span class=nav-number>2.4.2.</span> <span class=nav-text>公私IP地址管理机构</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#IP%E5%9C%B0%E5%9D%80%E4%B8%8E%E8%B7%AF%E7%94%B1%E6%8E%A7%E5%88%B6><span class=nav-number>2.5.</span> <span class=nav-text>IP地址与路由控制</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%8E%AF%E5%9B%9E%E5%9C%B0%E5%9D%80><span class=nav-number>2.5.1.</span> <span class=nav-text>环回地址</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#IP%E5%88%86%E7%89%87%E4%B8%8E%E9%87%8D%E7%BB%84><span class=nav-number>2.6.</span> <span class=nav-text>IP分片与重组</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#IPV6%E5%9F%BA%E6%9C%AC%E8%AE%A4%E8%AF%86><span class=nav-number>2.7.</span> <span class=nav-text>IPV6基本认识</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#IPV6%E7%AE%80%E4%BB%8B><span class=nav-number>2.7.1.</span> <span class=nav-text>IPV6简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#IPV6%E4%BA%AE%E7%82%B9><span class=nav-number>2.7.2.</span> <span class=nav-text>IPV6亮点</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#IPV6%E5%9C%B0%E5%9D%80%E8%A1%A8%E7%A4%BA%E6%B3%95><span class=nav-number>2.7.3.</span> <span class=nav-text>IPV6地址表示法</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#IPV6%E5%9C%B0%E5%9D%80%E7%BB%93%E6%9E%84><span class=nav-number>2.7.4.</span> <span class=nav-text>IPV6地址结构</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#IPV6%E5%8D%95%E6%92%AD%E5%9C%B0%E5%9D%80%E7%B1%BB%E5%9E%8B><span class=nav-number>2.7.5.</span> <span class=nav-text>IPV6单播地址类型</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#IPV4%E9%A6%96%E9%83%A8%E4%B8%8EIPV6%E9%A6%96%E9%83%A8><span class=nav-number>2.8.</span> <span class=nav-text>IPV4首部与IPV6首部</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link href=#IP%E5%8D%8F%E8%AE%AE%E7%9B%B8%E5%85%B3%E6%8A%80%E6%9C%AF><span class=nav-number>3.</span> <span class=nav-text>IP协议相关技术</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#DNS%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90><span class=nav-number>3.1.</span> <span class=nav-text>DNS域名解析</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90%E6%B5%81%E7%A8%8B><span class=nav-number>3.1.1.</span> <span class=nav-text>域名解析流程</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#ARP%E4%B8%8ERARP%E5%8D%8F%E8%AE%AE%EF%BC%88%E7%BD%91%E7%BB%9C%E6%8E%A5%E5%8F%A3%E5%B1%82%EF%BC%89><span class=nav-number>3.2.</span> <span class=nav-text>ARP与RARP协议（网络接口层）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#ARP%E5%8D%8F%E8%AE%AE><span class=nav-number>3.2.1.</span> <span class=nav-text>ARP协议</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#RARP%E5%8D%8F%E8%AE%AE><span class=nav-number>3.2.2.</span> <span class=nav-text>RARP协议</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#DHCP%E5%8A%A8%E6%80%81%E8%8E%B7%E5%8F%96IP%E5%9C%B0%E5%9D%80><span class=nav-number>3.3.</span> <span class=nav-text>DHCP动态获取IP地址</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#NAT%EF%BC%88%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2%EF%BC%89><span class=nav-number>3.4.</span> <span class=nav-text>NAT（网络地址转换）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#NAT%E4%BD%9C%E7%94%A8><span class=nav-number>3.4.1.</span> <span class=nav-text>NAT作用</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#NAT%E7%BC%BA%E9%99%B7><span class=nav-number>3.4.2.</span> <span class=nav-text>NAT缺陷</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E7%BC%BA%E9%99%B7><span class=nav-number>3.4.3.</span> <span class=nav-text>如何解决缺陷</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#ICMP%EF%BC%88%E4%BA%92%E8%81%94%E7%BD%91%E6%8E%A7%E5%88%B6%E6%8A%A5%E6%96%87%E5%8D%8F%E8%AE%AE-%E7%BD%91%E7%BB%9C%E5%B1%82%EF%BC%89><span class=nav-number>3.5.</span> <span class=nav-text>ICMP（互联网控制报文协议 / 网络层）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#ICMP%E7%AE%80%E4%BB%8B><span class=nav-number>3.5.1.</span> <span class=nav-text>ICMP简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#ICMP%E5%8A%9F%E8%83%BD><span class=nav-number>3.5.2.</span> <span class=nav-text>ICMP功能</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#ICMP%E7%B1%BB%E5%9E%8B><span class=nav-number>3.5.3.</span> <span class=nav-text>ICMP类型</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#IGMP%EF%BC%88%E5%9B%A0%E7%89%B9%E7%BD%91%E7%BB%84%E7%AE%A1%E7%90%86%E5%8D%8F%E8%AE%AE-%E7%BD%91%E7%BB%9C%E5%B1%82%EF%BC%89><span class=nav-number>3.6.</span> <span class=nav-text>IGMP（因特网组管理协议 / 网络层）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#IGMP%E7%AE%80%E4%BB%8B><span class=nav-number>3.6.1.</span> <span class=nav-text>IGMP简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#IGMP%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6><span class=nav-number>3.6.2.</span> <span class=nav-text>IGMP工作机制</span></a></ol></ol></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><img alt=豪哥 class=site-author-image itemprop=image src=/static/imgs/avatar.png><p class=site-author-name itemprop=name>豪哥<div class=site-description itemprop=description>豪哥博客</div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>116</span> <span class=site-state-item-name>日志</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>35</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/> <span class=site-state-item-count>128</span> <span class=site-state-item-name>标签</span></a></div></nav></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article lang=zh-CN><link href=https://hshz21.gitee.io/2024/08/21/IP%E5%9B%BE%E8%A1%A8%E8%A7%A3%E6%9E%90/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/static/imgs/avatar.png itemprop=image> <meta content=豪哥 itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=豪哥博客 itemprop=name> <meta content=豪哥博客 itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="计算机系列-IP图表分析 | 豪哥博客" itemprop=name> <meta itemprop=description> </span><header class=post-header><h1 itemprop="name headline" class=post-title>计算机系列-IP图表分析</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2024-08-21 21:39:13" datetime=2024-08-21T21:39:13+08:00>2024-08-21</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-10-06 22:13:51" datetime=2023-10-06T22:13:51+08:00 itemprop=dateModified>2023-10-06</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/ itemprop=url rel=index><span itemprop=name>计算机</span></a> </span> </span></div></div></header><div class=post-body itemprop=articleBody><h1 id=IP基本认识><a class=headerlink href=#IP基本认识 title=IP基本认识></a>IP基本认识</h1><h2 id=IP作用><a class=headerlink href=#IP作用 title=IP作用></a>IP作用</h2><p><strong>IP 在 TCP/IP 参考模型中处于第三层，即⽹络层。⽹络层主要作⽤：实现主机之间的通信，也叫点对点（end to end）通信</strong>。<p><img alt=image-20210415201526742 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415201526742.png?token=AIGEF3IBSDVTZBJISBUOCC3EZZQHC><h2 id=IP与MAC关系><a class=headerlink href=#IP与MAC关系 title=IP与MAC关系></a>IP与MAC关系</h2><p><strong>MAC可以实现两个直连设备间的通信；IP可以实现两个无直连⽹络间的通信</strong>。<p>举个⽣活的栗⼦，⼩林要去⼀个很远的地⽅旅⾏，制定了⼀个⾏程表，其间需先后乘坐⻜机、地铁、公 交⻋才能抵达⽬的地，为此⼩林需要买⻜机票，地铁票等。⻜机票和地铁票都是去往特定的地点的，每张票只能够在某⼀限定区间内移动。<p><img alt=image-20210415202504342 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415202504342.png?token=AIGEF3IBSRHYSGRCHUUDKGTEZZQIU><p>同时要注意，如果⼩林只有⾏程表⽽没有⻋票，就⽆法搭乘交通⼯具到达⽬的地。相反，如果除了⻋票⽽没有⾏程表，恐怕也很难到达⽬的地。因为⼩林不知道该坐什么⻋，也不知道该在哪⾥换乘。<p>针对以上描述，可总结如下：<ul><li>此处的「区间内移动」就如同数据链路层。<li>区间内的出发点好⽐源 MAC 地址，⽬标地点好⽐⽬的 MAC 地址。<li>整个旅游⾏程表就相当于⽹络层。<li>⾏程的开始好⽐源 IP，⾏程的终点好⽐⽬的 IP 地址。<li>计算机⽹络中同时需要「数据链路层」和「⽹络层」两个分层才能实现与最终⽬标地址的通信。<li>在⽹络数据包传输中，源IP地址和⽬标IP地址不会变化，只有源 MAC 地址和⽬标 MAC ⼀直在变化。</ul><h1 id=IP地址基础知识><a class=headerlink href=#IP地址基础知识 title=IP地址基础知识></a>IP地址基础知识</h1><h2 id=IP地址定义><a class=headerlink href=#IP地址定义 title=IP地址定义></a>IP地址定义</h2><p>TCP/IP ⽹络通信时，为了保证正常通信，每个设备都需要配置正确的 IP 地址，否则⽆法实现正常通信。<p><strong>IP 地址（IPv4 地址）由 32 位正整数表示，IP 在计算机中是以⼆进制⽅式处理</strong>。 为了⽅便记忆采⽤了点分⼗进制的标记⽅式，也就是将 32 位 IP 地址以每 8 位为1组，共分为 4 组，每组以点隔开，再将每组转换成⼗进制。<p><img alt=image-20210415203544505 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415203544505.png?token=AIGEF3NLJYYBD5VDNBBQTHTEZZQKW><p>那么，IP 地址最⼤值为<code>2^32 = 4294967296</code>，也就是说最大允许43亿台计算机连接到网络。<p>实际上， IP 地址并非根据主机台数来配置，⽽是根据⽹卡来配置。<strong>IP 地址是由⽹络标识和主机标识两个部分组成</strong>，能够连接到⽹络的计算机个数很少。<blockquote><p>电脑配了 IP， ⼿机、IPad 等电⼦设备都配了 IP， 照理来说肯定会超过 43 亿啦，那是怎么能够⽀持这么多 IP 的呢？因为会根据⼀种可以更换 IP 地址的技术 NAT ，使得可连接计算机数超过 43 亿台。</blockquote><h2 id=IP地址分类><a class=headerlink href=#IP地址分类 title=IP地址分类></a>IP地址分类</h2><h3 id=IP地址类型><a class=headerlink href=#IP地址类型 title=IP地址类型></a>IP地址类型</h3><p><strong>IP 地址分为 5 种类型：A类、B类、C类、D类、E类</strong>。<p><img alt=image-20210415204302389 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415204302389.png?token=AIGEF3MRG4SAOL4EIUZ7TALEZZQMK><p>上图中⻩⾊部分为分类号，⽤以区分 IP 地址类别。<h3 id=A、B、C类型地址><a class=headerlink href=#A、B、C类型地址 title=A、B、C类型地址></a>A、B、C类型地址</h3><p><strong>A、B、C 类IP地址主要分两个部分：⽹络号和主机号</strong>。<p>A、B、C 分类地址的范围、最⼤主机个数如下：<p><img alt=image-20210415204603352 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415204603352.png?token=AIGEF3LROQ3FWAKUIANXEN3EZZQN2><p>最⼤主机数，就是看主机号的位数，如 C 类地址的主机号占 8 位，那么 C 类地址的最⼤主机个数为<code>2^8 - 2 = 254个</code><p>为什么要减 2 呢？ 因为IP 地址中有两 IP是特殊的，分别是主机号全为 1 和 全为 0 地址。<ul><li><strong>主机号全为1指的是某个⽹络下的所有主机，⽤于⼴播</strong>。<li><strong>主机号全为 0 指的是某个⽹络</strong>。</ul><h3 id=D、E类型地址><a class=headerlink href=#D、E类型地址 title=D、E类型地址></a>D、E类型地址</h3><p><strong>D 类和 E 类地址没有主机号，所以不可⽤于主机 IP，D 类常被⽤于多播，E 类是预留分类， 暂未使⽤</strong>。<p><img alt=image-20210415205817207 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415205817207.png?token=AIGEF3KWRVXXTJFBF2M32T3EZZQPC><p><strong>多播地址的作用是将包发送给特定组内的所有主机</strong>。<p>多播使⽤ D 类地址，其前四位是 1110 的就表示是多播地址，⽽剩下的 28 位是多播的组编号。<p>从 224.0.0.0 ~ 239.255.255.255 都是多播的可⽤范围，其划分为以下三类：<ul><li>224.0.0.0 ~ 224.0.0.255 为预留的组播地址，只能在局域⽹中，路由器是不会进⾏转发的。<li>224.0.1.0 ~ 238.255.255.255 为⽤户可⽤的组播地址，可以⽤于 Internet 上。<li>239.0.0.0 ~ 239.255.255.255 为本地管理组播地址，可供内部⽹使⽤，仅在特定的本地范围有效。</ul><h3 id=广播地址><a class=headerlink href=#广播地址 title=广播地址></a>广播地址</h3><p><strong>⼴播地址⽤于在同⼀个链路中相互连接的主机之间发送数据包</strong>。<p>当主机号全为 1 时，就表示该⽹络的⼴播地址。<p>⼴播地址可以分为本地⼴播和直接⼴播两种：<ul><li><strong>本⽹络内进行⼴播称为本地⼴播</strong></ul><p>例如⽹络地址为 192.168.0.0/24 的情况下，⼴播地址是 192.168.0.255 。因为这个⼴播地址的 IP 包会被路由器屏蔽，所以不会到达 192.168.0.0/24 以外的 其他链路上。<ul><li><strong>不同⽹络之间进行⼴播称为直接⼴播</strong></ul><p>例如⽹络地址为 192.168.0.0/24 的主机向 192.168.1.255/24 的⽬标地址发送 IP 包。收到这个包的路由器，将数据转发给 192.168.1.0/24，从⽽使得所有 192.168.1.1~192.168.1.254 的主机都能收到这个包（由于直接⼴播有⼀定的安全问题，多数情况 下会在路由器上设置为不转发。） 。<h3 id=IP地址分类优劣><a class=headerlink href=#IP地址分类优劣 title=IP地址分类优劣></a>IP地址分类优劣</h3><h4 id=优点><a class=headerlink href=#优点 title=优点></a>优点</h4><p>简单明了、选路（基于⽹络地址）简单，通过判断首位是0还是1就能 快速找出 ⽹络地址和主机地址。<p>其余分类判断⽅式参考如下：<p>第一位为：<ul><li>0：A类地址<li>1：第二位为：<ul><li>0：B类地址<li>1：第三位为：<ul><li>0：C类地址<li>1：第四位：<ul><li>0：D类地址<li>1：E类地址</ul></ul></ul></ul><h4 id=缺点><a class=headerlink href=#缺点 title=缺点></a>缺点</h4><ol><li>同一网络下没有地址层次。<li>A、B、C类不能很好与现实网络匹配。</ol><p>以上两个缺点都可以通过使用CIDR无分类地址来解决。<h2 id=CIDR（无分类IP地址）><a class=headerlink href=#CIDR（无分类IP地址） title=CIDR（无分类IP地址）></a>CIDR（无分类IP地址）</h2><h3 id=CIDR简介><a class=headerlink href=#CIDR简介 title=CIDR简介></a>CIDR简介</h3><p><strong>因IP分类存在许多缺点，所以提出⽆分类地址⽅案，即CIDR</strong>。<p><strong>CIDR不再分类地址，32 ⽐特的 IP 被划分为两部分：前⾯是⽹络号，后⾯是主机号</strong>。<h3 id=网络号和主机号划分><a class=headerlink href=#网络号和主机号划分 title=网络号和主机号划分></a>网络号和主机号划分</h3><p><strong>无分类地址格式为：a.b.c.d/x ，其中 /x 表示前 x 位属于⽹络号， x 的范围是 0 ~ 32 ，这使得 IP 地址更加灵活</strong>。<p>⽐如 10.100.122.2/24，就是无分类地址，/24 表示前 24 位是⽹络号，剩余的 8 位是主机号。<p><img alt=image-20210415211145547 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415211145547.png?token=AIGEF3MW3M2R7E7OPP4GDDLEZZQRA><p><strong>另⼀种划分⽹络号与主机号的方式是⼦⽹掩码，掩码就是掩盖掉主机号，剩下的是⽹络号</strong>。<p><strong>⼦⽹掩码和IP地址进行与运算可得到⽹络号</strong>。<p><img alt=image-20210415211234778 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415211234778.png?token=AIGEF3LH7MQRN5FCSP6MA5TEZZQSO><p><strong>为何划分网络号和主机号</strong><p>因为 两台计算机想通讯就得先判断是否处于同⼀个⼴播域内，即⽹络地址是否相同。如果⽹络地址相同，表明接受⽅在本⽹络上且可以把数据包直接发送到⽬标主机。<p>路由器寻址就是采用该方式来找到对应⽹络号，进⽽把数据包转发给对应⽹络。<p><img alt=image-20210415211525393 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415211525393.png?token=AIGEF3OOIFHUZG5TUUCS7C3EZZQT6><h3 id=子网划分><a class=headerlink href=#子网划分 title=子网划分></a>子网划分</h3><h4 id=何为子网划分><a class=headerlink href=#何为子网划分 title=何为子网划分></a>何为子网划分</h4><p><strong>⼦⽹掩码可以划分出⽹络号和主机号，还可划分⼦⽹</strong>。<p>⼦⽹划分实际上是将主机地址分为两个部分：⼦⽹⽹络地址 和 ⼦⽹主机地址。形式如下：<p><img alt=image-20210415211605113 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415211605113.png?token=AIGEF3OF4XRSSKC4YOE264TEZZQVG><ul><li>未做⼦⽹划分的 ip 地址：⽹络地址＋主机地址。<li>做⼦⽹划分后的 ip 地址：⽹络地址＋（⼦⽹⽹络地址＋⼦⽹主机地址）。</ul><h4 id=子网划分原理><a class=headerlink href=#子网划分原理 title=子网划分原理></a>子网划分原理</h4><p>假设对 C 类地址进⾏⼦⽹划分，⽹络地址 192.168.1.0，使⽤⼦⽹掩码 255.255.255.192 对其进⾏⼦⽹划分。<p>C 类地址中前 24 位是⽹络号，最后 8 位是主机号，根据⼦⽹掩码可知从 8 位主机号中借⽤ 2 位作为⼦⽹号。<p><img alt=image-20210415211738776 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415211738776.png?token=AIGEF3OS6ZLP5TWZTLUPFGTEZZQW6><p>由于⼦⽹⽹络地址被划分成 2 位，那么⼦⽹地址就有 4 个，分别是 00、01、10、11，具体划分如下图：<p><strong>子网0</strong><p><img alt=image-20210415211918539 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415211918539.png?token=AIGEF3IMMEMW2YLE2D7BTKTEZZQYI><p><strong>子网1</strong><p><img alt=image-20210415211943850 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415211943850.png?token=AIGEF3NSSLF5SWJLFMRDNCDEZZQZO><p><strong>子网2</strong><p><img alt=image-20210415212003104 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415212003104.png?token=AIGEF3L3DMCNVCSMHFSNBULEZZQ2Y><p><strong>子网3</strong><p><img alt=image-20210415212019344 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415212019344.png?token=AIGEF3LMLOBOWT7Z44SCGFLEZZQ4U><p>划分后的 4 个⼦⽹如下表格：<p><img alt=image-20210415212042823 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415212042823.png?token=AIGEF3OGGMZ55NXLKN4PIOLEZZQ56><h2 id=公有IP地址与私有IP地址><a class=headerlink href=#公有IP地址与私有IP地址 title=公有IP地址与私有IP地址></a>公有IP地址与私有IP地址</h2><h3 id=公私IP地址简介><a class=headerlink href=#公私IP地址简介 title=公私IP地址简介></a>公私IP地址简介</h3><p><strong>A、B、C 类地址中可分为公有 IP 地址和私有 IP 地址</strong>。<p><img alt=image-20210415212322287 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415212322287.png?token=AIGEF3LLTM5WE655PPH2TBDEZZQ7E><p>每个⼩区都有⾃⼰的楼编号和⻔牌号，你⼩区家可以叫 1 栋 101 号，我⼩区家也可以叫 1 栋 101，没有任何问题。但⼀旦出了⼩区，就需要带上中⼭路 666 号（公⽹ IP 地址），是国家统⼀分配 的，不能两个⼩区都叫中⼭路 666。<p>所以，公有 IP 地址是有个组织统⼀分配的，假设你要开⼀个博客⽹站，那么你就需要去申请购买⼀个 公有 IP，这样全世界的⼈才能访问。并且公有 IP 地址基本上要在整个互联⽹范围内保持唯⼀。<h3 id=公私IP地址管理机构><a class=headerlink href=#公私IP地址管理机构 title=公私IP地址管理机构></a>公私IP地址管理机构</h3><p><strong>私有 IP 地址通常由内部IT⼈员管理，公有IP由ICANN组织管理，中文叫互联⽹名称与数字地址分配机构</strong>。<p>IANA 是 ICANN中的⼀个机构，它负责分配互联⽹ IP 地址，是按州的⽅式层层分配。<p><img alt=image-20210415212554129 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415212554129.png?token=AIGEF3INVAPZ7KYF2BGKFUDEZZRAM><ul><li>ARIN 北美地区<li>LACNIC 拉丁美洲和⼀些加勒⽐群岛<li>RIPE NCC 欧洲、中东和中亚<li>AfriNIC ⾮洲地区<li>APNIC 亚太地区</ul><p><strong>国内IP由CNNIC机构管理，它是国内唯⼀指定的全局IP地址管理组织</strong>。<h2 id=IP地址与路由控制><a class=headerlink href=#IP地址与路由控制 title=IP地址与路由控制></a>IP地址与路由控制</h2><p><strong>IP地址的⽹络地址部分⽤于进⾏路由控制</strong>。<p>路由控制表中记录着⽹络地址与下⼀步应该发送⾄路由器的地址。在主机和路由器上都会有各⾃的路由器控制表。<p>发送 IP 包时 要先 确定 IP 包⾸部中的⽬标地址，再从路由控制表中找到与该地址具有相同⽹络地址的记录，根据该记录将 IP 包转发给相应的下⼀个路由器。如果路由控制表中存在多条相同⽹络地址 的记录，就选择相同位数最多的⽹络地址，也就是最⻓匹配。<p><img alt=image-20210415212845042 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415212845042.png?token=AIGEF3JRGQDXS5ZBBAVNZHDEZZRCI><ol><li>主机 A 要发送⼀个 IP 包，其源地址是 10.1.1.30 和⽬标地址是 10.1.2.10 ，由于没有在主机 A 的路由表找到与⽬标地址 10.1.2.10 的⽹络地址，于是包被转发到默认路由（路由器 1 ）。<li>路由器 1 收到 IP 包后，也在路由器 1 的路由表匹配与⽬标地址相同的⽹络地址记录，发现匹配 到了，于是就把 IP 数据包转发到了 10.1.0.2 这台路由器 2。<li>路由器 2 收到后，同样对⽐⾃身的路由表，发现匹配到了，于是把 IP 包从路由器 2 的 10.1.2.1 这个接⼝出去，最终经过交换机把 IP 数据包转发到了⽬标主机。</ol><h3 id=环回地址><a class=headerlink href=#环回地址 title=环回地址></a>环回地址</h3><p>环回地址 是在同⼀台计算机上的程序之间进⾏⽹络通信时所使⽤的默认地址。<p>计算机使⽤ 127.0.0.1 作为环回地址，与之相同的是主机名 localhost 。使⽤这个 IP 或主机名时，数据包不会流向⽹络。<h2 id=IP分片与重组><a class=headerlink href=#IP分片与重组 title=IP分片与重组></a>IP分片与重组</h2><p>每种数据链路的最⼤传输单元 MTU 都不相同，如 FDDI 数据链路 MTU 为 4352、以太⽹ MTU 为 1500 字节等。<p>每种数据链路的 MTU 之所以不同，是因为不同类型的数据链路 其 使⽤⽬的不同，故可承载的 MTU 也就不同。<p><strong>最常⻅的数据链路是以太⽹，它的 MTU 是 1500 字节</strong>。<p>当 IP 数据包⼤⼩⼤于 MTU 时， IP 数据包会被分⽚，分⽚后的 IP 数据包在被重组时，只能由⽬标主机进⾏，路由器不会进⾏重组。<p>假设发送⽅发送⼀个 4000 字节的⼤数据报，若要传输在以太⽹链路，则需要把数据报分⽚成 3 个⼩数 据报进⾏传输，再交由接收⽅重组成⼤数据报。<p><img alt=image-20210415213617493 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415213617493.png?token=AIGEF3PKCDQC4T4KGH7OOV3EZZRDQ><p>分⽚传输中，⼀旦某个分⽚丢失，会导致整个 IP 数据包作废，所以 TCP 引⼊了 MSS 也就是在 TCP 层进⾏分⽚而不在 IP 层分⽚，那么对于 UDP 我们尽量不要发送⼀个⼤于 MTU 的数据报⽂。<h2 id=IPV6基本认识><a class=headerlink href=#IPV6基本认识 title=IPV6基本认识></a>IPV6基本认识</h2><h3 id=IPV6简介><a class=headerlink href=#IPV6简介 title=IPV6简介></a>IPV6简介</h3><p>IPv4 地址是 32 位，⼤约有 43 亿个地址，但早在 2011 年 IPv4 地址就已经被分配完了。<p><strong>IPv6 地址是 128 位，可分配地址数量非常多，且还有更好的安全性和扩展性</strong>。<p>因IPv4 和 IPv6 不兼容，且IPV6要求电脑、手机要适配，也需要网络运营商的支持，所以ipv6普及较慢。<h3 id=IPV6亮点><a class=headerlink href=#IPV6亮点 title=IPV6亮点></a>IPV6亮点</h3><p>IPv6 除了地址多，还有很多其它亮点：<ol><li>IPv6可⾃动配置，即使<strong>没有DHCP服务器也可实现IP地址⾃动分配</strong>。<li>IPv6 包头包⾸部⻓度固定为40 字节，去掉了包头校验，简化了⾸部结构，减轻了路由器负荷，⼤⼤提⾼了传输性能。<li>IPv6 有<strong>防⽌线路窃听</strong>等功能，提升了安全性。</ol><h3 id=IPV6地址表示法><a class=headerlink href=#IPV6地址表示法 title=IPV6地址表示法></a>IPV6地址表示法</h3><p>IPv4 地址⻓度共 32 位，每 8 位作为⼀组，并⽤点分⼗进制的表示⽅式。<p><strong>IPv6 ⻓度 128 位，每 16 位为⼀组，每组⽤冒号隔开</strong>。<p><img alt=image-20210415213924099 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415213924099.png?token=AIGEF3NGU6KHIWBVZYN3B4TEZZREW><p>如果出现连续的0时还可以将这些 0 省略，并⽤两个冒号 「::」隔开。但是，⼀个 IP 地址中只允许出现⼀次两个连续的冒号。<p><img alt=image-20210415213947044 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415213947044.png?token=AIGEF3NLTJC54KGPO75DZITEZZRF2><h3 id=IPV6地址结构><a class=headerlink href=#IPV6地址结构 title=IPV6地址结构></a>IPV6地址结构</h3><p><strong>IPv6 类似 IPv4，同样采取IP地址前⼏位来标识 IP 地址的种类</strong>。<p>IPv6 地址主要有以下类型地址：<ul><li>单播地址，⽤于⼀对⼀的通信。<li>组播地址，⽤于⼀对多的通信。<li>任播地址，⽤于通信最近的节点，最近的节点是由路由协议决定。<li>没有⼴播地址。</ul><p><img alt=image-20210415214100341 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415214100341.png?token=AIGEF3IO2DLR7L53D6QTLSLEZZRHO><h3 id=IPV6单播地址类型><a class=headerlink href=#IPV6单播地址类型 title=IPV6单播地址类型></a>IPV6单播地址类型</h3><p>IPv6 地址主要分三类单播地址，每类地址有效范围都不同：<ul><li>同⼀链路单播通信，不经过路由器，可以使⽤链路本地单播地址，IPv4 没有此类型。<li>在内⽹⾥单播通信，可以使⽤唯⼀本地地址，相当于 IPv4 的私有 IP。<li>在互联⽹通信，可以使⽤全局单播地址，相当于 IPv4 的公有 IP。</ul><p><img alt=image-20210415214210802 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415214210802.png?token=AIGEF3NZH6JIPHBJQBXNYZLEZZRI6><h2 id=IPV4首部与IPV6首部><a class=headerlink href=#IPV4首部与IPV6首部 title=IPV4首部与IPV6首部></a>IPV4首部与IPV6首部</h2><p>IPv4 与 IPv6 ⾸部差异如下：<p><img alt=image-20210415214300627 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415214300627.png?token=AIGEF3JL3ZQSBAJ4BXGH7F3EZZRKE><p>IPv6 与 IPv4相比，其⾸部改进如下：<ol><li><strong>取消了⾸部校验和字段</strong>。因为在数据链路层和传输层都会校验，因此 IPv6 直接取消了 IP 的校验。<li><strong>取消了分⽚/重新组装相关字段</strong>。分⽚与重组是耗时的过程，IPv6不允许在中间路由器进⾏分⽚与重组，这种操作只能在源与⽬标主机，这将⼤⼤提⾼路由器转发速度。<li><strong>取消选项字段</strong>。选项字段不再是标准 IP ⾸部的⼀部分，但它并没有消失，⽽是可能出现在 IPv6 ⾸部中的「下⼀个⾸部」指出的位置上。删除该选项字段使的 IPv6 的⾸部成为固定⻓度的 40 字 节。</ol><h1 id=IP协议相关技术><a class=headerlink href=#IP协议相关技术 title=IP协议相关技术></a>IP协议相关技术</h1><h2 id=DNS域名解析><a class=headerlink href=#DNS域名解析 title=DNS域名解析></a>DNS域名解析</h2><p>我们访问网站时，其网址通常是域名，而并非是IP地址，因为域名更便于理解和接受。<p>实现这⼀技术的就是 DNS 域名解析， DNS可将域名⽹址⾃动转换为 IP地址。<p>DNS 中的域名都是⽤点来分隔，⽐如<code>www.server.com</code> ，这⾥的点代表了不同层次之间的界限。<p><strong>域名中，越靠右的位置表示其层级越⾼，所以域名的层级关系类似⼀个树状结构</strong>：<ul><li>根 DNS 服务器<li>顶级域 DNS 服务器（com）<li>权威 DNS 服务器（server.com）</ul><p><img alt=image-20210415214715046 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415214715046.png?token=AIGEF3PW6RHL2TMR6FN4UQDEZZRLC><p>根域 DNS 服务器信息保存在互联⽹中的所有 DNS 服务器中。这样⼀来，任何 DNS 服务器就都可以找到并访问根域 DNS 服务器。<p>因此，客户端只要能够找到任意⼀台 DNS 服务器，就可以通过它找到根域 DNS 服务器，然后再⼀路顺藤摸⽠找到位于下层的某台⽬标 DNS 服务器。<h3 id=域名解析流程><a class=headerlink href=#域名解析流程 title=域名解析流程></a>域名解析流程</h3><p>浏览器会先查自己的缓存，再查系统缓存，还没有就检查本机域名解析⽂件hosts ，如果还没有就会通过 DNS 服务器来查询。<p>DNS服务器查询过程如下：<ol><li>客户端⾸先会发出⼀个 DNS 请求，问 <a href=http://www.server.com/ rel=noopener target=_blank>www.server.com</a> 的 IP 是啥，并发给本地 DNS 服务器（也就是客户端的 TCP/IP 设置中填写的 DNS 服务器地址）。<li>本地域名服务器收到客户端的请求后，如果缓存⾥的表格能找到 <a href=http://www.server.com,则它直接返回/ rel=noopener target=_blank>www.server.com，则它直接返回</a> IP 地址。如果没有，本地 DNS 会去问它的根域名服务器：“⽼⼤， 能告诉我 <a href=http://www.server.com/ rel=noopener target=_blank>www.server.com</a> 的 IP 地址吗？” 根域名服务器是最⾼层次的，它不直接⽤于域名解析，但能指明⼀条道路。<li>根 DNS 收到来⾃本地 DNS 的请求后，发现后置是 .com，说：“<a href=http://www.server.com/ rel=noopener target=_blank>www.server.com</a> 这个域名归 .com 区域管理”，我给你 .com 顶级域名服务器地址，你去问它吧。”<li>本地 DNS 收到顶级域名服务器的地址后，发起请求问“⽼⼆， 你能告诉我 <a href=http://www.server.com/ rel=noopener target=_blank>www.server.com</a> 的 IP 地址吗？”<li>顶级域名服务器说：“我给你负责 <a href=http://www.server.com/ rel=noopener target=_blank>www.server.com</a> 区域的权威 DNS 服务器的地址，你去问它应该 能问到”。<li>本地 DNS 于是转向问权威 DNS 服务器：“⽼三，<a href=http://www.server.com对应的IP是啥呀？”>www.server.com对应的IP是啥呀？”</a> server.com 的权威 DNS 服务器，它是域名解析结果的原出处。为啥叫权威呢？就是我的域名我做主。<li>权威 DNS 服务器查询后将对应的 IP 地址 X.X.X.X 告诉本地 DNS。<li>本地 DNS 再将 IP 地址返回客户端，客户端和⽬标建⽴连接。</ol><p>⾄此，我们完成了 DNS 解析过程。现在总结⼀下，整个过程我画成了⼀个图。<p><img alt=image-20210415214931845 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415214931845.png?token=AIGEF3NVX3DKRC64RYSAHELEZZRMM><h2 id=ARP与RARP协议（网络接口层）><a class=headerlink href=#ARP与RARP协议（网络接口层） title=ARP与RARP协议（网络接口层）></a>ARP与RARP协议（网络接口层）</h2><h3 id=ARP协议><a class=headerlink href=#ARP协议 title=ARP协议></a>ARP协议</h3><p>在传输⼀个 IP 数据报时，确定了源 IP 地址和⽬标 IP 地址后，就会通过主机「路由表」确定 IP 数据包下⼀跳。然⽽，⽹络层的下⼀层是数据链路层，所以我们还要知道「下⼀跳」的 MAC 地址。<p><strong>通过主机路由表可找到下⼀跳 IP 地址，根据 IP地址 和 ARP 协议，可得知下⼀跳 MAC 地址</strong>。<p>ARP 如何知道对⽅MAC地址呢？<p><strong>ARP借助ARP请求与ARP响应两种类型的包来确定MAC地址</strong>。<p><img alt=image-20230805101102458 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20230805101102458.png?token=AIGEF3JXOV3NUCG7MPNDC33EZZRNY><ul><li><strong>主机会通过⼴播发送 ARP 请求，这个包中包含了想要知道 MAC 地址的主机 IP 地址</strong>。<li>当同个链路中的所有设备收到 ARP 请求时，会去拆开 ARP 请求包⾥的内容，如果 ARP 请求包中的⽬标 IP 地址与⾃⼰的 IP 地址⼀致，那么这个设备就将⾃⼰的 MAC 地址塞⼊ ARP 响应包返回给主机。</ul><p><strong>操作系统通常会把第⼀次通过 ARP 获取的 MAC 地址缓存起来，以便下次直接从缓存中拿</strong>。<p><font color=red>注意：MAC 地址缓存有时间限制，超过限定时间将清除已缓存内容。</font><h3 id=RARP协议><a class=headerlink href=#RARP协议 title=RARP协议></a>RARP协议</h3><p><strong>ARP 协议是已知 IP 地址求 MAC 地址， RARP 则是已知 MAC 地址求 IP 地址</strong>。例如 将打印机服务器等⼩型嵌⼊式设备接⼊到⽹络时就经常会⽤得到。<p>通常需要架设⼀台 RARP 服务器，在这个服务器上注册设备的 MAC 地址及其 IP 地址。然后再将这个设备接⼊到⽹络，接着：<ul><li>该设备会发送⼀条「我的 MAC 地址是XXXX，请告诉我，我的IP地址应该是什么」的请求信息。<li>RARP 服务器接到这个消息后返回「MAC地址为 XXXX 的设备，IP地址为 XXXX」的信息给这个设备。</ul><p>最后，设备会从 RARP 服务器所收到的应答信息中找到IP地址并进行设置。<p><img alt=image-20210415215304596 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415215304596.png?token=AIGEF3PFAKEMEZ6GJ2PNKLTEZZRPE><h2 id=DHCP动态获取IP地址><a class=headerlink href=#DHCP动态获取IP地址 title=DHCP动态获取IP地址></a>DHCP动态获取IP地址</h2><p>我们的电脑通常都是通过 DHCP 动态获取 IP 地址，⼤⼤省去了配 IP 信息繁琐的过程。<p>接下来，我们来看看电脑是如何通过 4 个步骤获取到 IP。<p><font color=red>注意：DHCP 客户端进程监听的是 68 端⼝号，DHCP 服务端进程监听的是 67 端⼝号。</font><p>4 个步骤如下：<ol><li>客户端⾸先发起 DHCP 发现报⽂（DHCP DISCOVER） 的 IP 数据报，由于客户端没有 IP 地址， 也不知道 DHCP 服务器的地址，所以使⽤的是 UDP ⼴播通信，其使⽤的⼴播⽬的地址是 255.255.255.255（端⼝ 67） 并且使⽤ 0.0.0.0（端⼝ 68） 作为源 IP 地址。DHCP 客户端将该 IP 数据报传递给链路层，然后链路层将帧⼴播到⽹络中的所有设备。<li>DHCP 服务器收到 DHCP 发现报⽂时，⽤ DHCP 提供报⽂（DHCP OFFER） 向客户端做出响应。该报⽂仍然使⽤ IP ⼴播地址 255.255.255.255，该报⽂信息携带服务器提供可租约的 IP 地址、⼦⽹掩码、默认⽹关、DNS 服务器以及 IP 地址租⽤期。<li>客户端收到⼀个或多个服务器的 DHCP 提供报⽂后，从中选择⼀个服务器，并向选中的服务器发送 DHCP 请求报⽂（DHCP REQUEST进⾏响应，回显配置的参数。<li>最后，服务端⽤ DHCP ACK 报⽂对 DHCP 请求报⽂进⾏响应，应答所要求的参数。</ol><p>⼀旦客户端收到 DHCP ACK 后，交互便完成了，并且客户端能够在租⽤期内使⽤ DHCP 服务器分配的 IP 地址。<p>如果租约的 DHCP IP 地址快过期了，客户端会向服务器发送 DHCP 请求报⽂：<ul><li>服务器如果同意继续租⽤，则⽤ DHCP ACK 报⽂进⾏应答，客户端就会延⻓租期。<li>服务器如果不同意继续租⽤，则⽤ DHCP NACK 报⽂，客户端就要停⽌使⽤租约的 IP 地址。</ul><p>可以发现，<strong>DHCP 交互中，全程都是使⽤ UDP ⼴播通信</strong>。<p>如果 DHCP 服务器和客户端不是在同⼀个局域⽹内，路由器⼜不会转发⼴播包，那不是每个⽹络都要配⼀个 DHCP 服务器？ 为解决该问题，出现了<strong>DHCP 中继代理</strong>。 有了 DHCP 中继代理以后，对不同⽹段的 IP 地址分配可以由⼀个 DHCP 服务器统⼀进⾏管理。<p><img alt=image-20210415220738058 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415220738058.png?token=AIGEF3M4XEWKNO7CH3ICLN3EZZRQC><ul><li>DHCP 客户端会向 DHCP 中继代理发送 DHCP 请求包，⽽ DHCP 中继代理在收到这个⼴播包以后，再以单播的形式发给 DHCP 服务器。<li>服务器端收到该包以后再向 DHCP 中继代理返回应答，并由 DHCP 中继代理将此包⼴播给 DHCP 客户端 。</ul><p>因此，DHCP 服务器即使不在同⼀个链路上也可以实现统⼀分配和管理IP地址。<h2 id=NAT（网络地址转换）><a class=headerlink href=#NAT（网络地址转换） title=NAT（网络地址转换）></a>NAT（网络地址转换）</h2><h3 id=NAT作用><a class=headerlink href=#NAT作用 title=NAT作用></a>NAT作用</h3><p>IPv4 地址紧缺，故提出了 ⽹络地址转换方案 NAT，作用就是： <strong>将私有IP地址转换成公有IP地址</strong>。<p><img alt=image-20210415220931123 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415220931123.png?token=AIGEF3K22S7HJNVL27DCCADEZZRRC><p>思考：若这样，那不是 N 个私有 IP 地址，就需要 N 个公有 IP 地址？这怎么就缓解 IPv4 地址耗尽问题？<p>确实是， 普通 NAT转换没什么意义。<strong>由于绝⼤多数⽹络应⽤都使⽤传输层协议 TCP 或 UDP 来传输数据。 因此可以把 IP 地址 + 端⼝号⼀起进⾏转换，这种转换技术叫 ⽹络地址与端⼝转换 NAPT</strong>。<p>很抽象？来，看下⾯的图解就能瞬间明⽩了。<p><img alt=image-20210415221031683 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415221031683.png?token=AIGEF3IKC3ZSXCNDBMPTHTDEZZRSG><p>图中有两个客户端 192.168.1.10 和 192.168.1.11 同时与服务器 183.232.231.172 进⾏通信，且两个客户端本地端⼝都是 1025。此时，两个私有 IP 地址将转换为公有地址 120.229.175.121，但是以不同的端⼝号作为区分。<p>于是，⽣成⼀个 NAPT 路由器转换表，就可以正确转换 地址与端⼝组合，令客户端 A、B 能同时与服务器之间进⾏通信。<p>这种转换表在 NAT 路由器上⾃动⽣成。例如，建⽴ TCP 连接⾸次握⼿时的 SYN 包 ⼀经发出，就会⽣成这个表。⽽后⼜随着收到关闭连接时发出 FIN 包的确认应答而从表中删除。<h3 id=NAT缺陷><a class=headerlink href=#NAT缺陷 title=NAT缺陷></a>NAT缺陷</h3><p>因为 NAT/NAPT 依赖⾃⼰的转换表，因此会有以下问题：<ol><li>外部⽆法主动与 NAT 内部服务器建⽴连接，因为 NAPT 转换表没有转换记录。<li>转换表的⽣成与转换操作都会产⽣性能开销。<li>通信过程中，如果 NAT 路由器重启了，所有TCP 连接都将被重置。</ol><h3 id=如何解决缺陷><a class=headerlink href=#如何解决缺陷 title=如何解决缺陷></a>如何解决缺陷</h3><ol><li><p>改用IPV6：IPv6 可⽤范围⾮常⼤，每台设备都可配置⼀个公有 IP 地址，但 IPv6 普及还需要时间。</p><li><p>NAT穿透技术</p> <p><font color=orange>NAT 穿透技术能够让⽹络应⽤程序主动发现⾃⼰位于 NAT 设备之后，并会主动获得 NAT 设备的公有 IP，并为⾃⼰建⽴端⼝映射条⽬，注意这些都由 NAT设备后的应⽤程序⾃动完成。</font></p></ol><p>也就是说，在 NAT 穿透技术中，NAT设备后的应⽤程序处于主动地位，它已经明确地知道 NAT 设备要修改它外发的数据包，于是它主动配合 NAT 设备的操作，主动地建⽴好映射，这样就减少了NAT设备的工作。<p>说⼈话，就是客户端主动从 NAT 设备获取公网 IP 地址，然后⾃⼰建⽴端⼝映射条⽬，然后⽤这个条⽬ 对外通信，就不需要 NAT 设备来进⾏转换了。<h2 id=ICMP（互联网控制报文协议-网络层）><a title="ICMP（互联网控制报文协议 / 网络层）" class=headerlink href=#ICMP（互联网控制报文协议-网络层）></a>ICMP（互联网控制报文协议 / 网络层）</h2><h3 id=ICMP简介><a class=headerlink href=#ICMP简介 title=ICMP简介></a>ICMP简介</h3><p><strong>ICMP全称是Internet Control Message Protocol，也叫互联⽹控制报⽂协议</strong>。<p>⾥⾯有个关键词 —— 控制，如何控制呢？<p>⽹络包 在 复杂⽹络传输中 会遇到各种问题。 当遇到问题时 需要 传出消息 并 报告异常问题，这样可以 调整传输策略 来控制 整个局⾯。<h3 id=ICMP功能><a class=headerlink href=#ICMP功能 title=ICMP功能></a>ICMP功能</h3><p><strong>ICMP 主要功能包括：确认IP包是否成功送达⽬标地址、报告发送过程中IP包被废弃的原因和改善⽹络设置等</strong>。<p>在 IP 通信中如果某个 IP 包因为某种原因未能达到⽬标地址，那么这个具体的原因将由 ICMP 负责通知。<p><img alt=image-20210415221514890 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415221514890.png?token=AIGEF3PYUGAL34ICWISTU5LEZZRTM><p>如上图，主机 A发送数据包 给 主机B，但因为某些原因 导致 路由器 2 不能找到主机B，此时路由器 2 通过 IP 向主机 A 发送⼀个 ICMP ⽬标不可达数据包。<p><strong>ICMP通知消息会使⽤ IP 进⾏发送</strong>。<p>因此，从路由器 2 返回的 ICMP 包会按照往常的路由控制先经过路由器 1 再转发给主机 A 。收到该 ICMP 包的主机 A 则分解 ICMP 的⾸部和数据域以后得知具体发⽣问题的原因。<h3 id=ICMP类型><a class=headerlink href=#ICMP类型 title=ICMP类型></a>ICMP类型</h3><p>ICMP ⼤致可以分为两⼤类：<ul><li><strong>⽤于诊断的查询消息，也就是「查询报⽂类型」</strong>。<li><strong>通知出错原因的错误消息，也就是「差错报⽂类型」</strong>。</ul><p><img alt=image-20210415221644966 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415221644966.png?token=AIGEF3J4SSES4SWPSTY7A6LEZZRUQ><h2 id=IGMP（因特网组管理协议-网络层）><a title="IGMP（因特网组管理协议 / 网络层）" class=headerlink href=#IGMP（因特网组管理协议-网络层）></a>IGMP（因特网组管理协议 / 网络层）</h2><h3 id=IGMP简介><a class=headerlink href=#IGMP简介 title=IGMP简介></a>IGMP简介</h3><p>ICMP 与 IGMP ⼀点关系都没有，就好比 周杰 与 周杰伦 的区别。<p><strong>组播地址说的是只有在⼀组的主机才能收到数据包，那么如何确定是否在⼀个组呢？这需要 IGMP协议 来协助</strong>。<p><img alt=image-20210415221723705 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415221723705.png?token=AIGEF3MF22JJES33IHDA7EDEZZRVS><p><strong>IGMP 是因特⽹组管理协议，⼯作在主机（组播成员）和最后⼀跳路由之间</strong>，如上图中蓝⾊部分。<ul><li>IGMP 报⽂向路由器申请加⼊和退出组播组，默认情况下路由器不会转发组播包到连接中的主机，除⾮主机通过 IGMP 加⼊到组播组，主机申请加⼊到组播组时，路由器就会记录 IGMP 路由器表，路由器后续就会转发组播包到对应的主机了。<li>IGMP 报⽂采⽤ IP 封装，IP 头部的协议号为 2，⽽且 TTL 字段值通常为 1，因为 IGMP 是⼯作在主机与连接的路由器之间。</ul><h3 id=IGMP工作机制><a class=headerlink href=#IGMP工作机制 title=IGMP工作机制></a>IGMP工作机制</h3><p><strong>IGMP 分为三个版本，分别是：IGMPv1、IGMPv2、IGMPv3</strong>。<p>以 IGMPv2 为例，说说 常规查询与响应 和 离开组播组 这两个⼯作机制。<p><strong>常规查询与响应⼯作机制</strong><p><img alt=image-20210415221848921 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415221848921.png?token=AIGEF3J4AISZEC7SBUT4H5LEZZRWY><ol><li>路由器会周期性发送⽬的地址为 224.0.0.1 （表示同⼀⽹段内所有主机和路由器） IGMP 常规查询报⽂。<li>主机1 和 主机 3 收到这个查询，随后会启动「报告延迟计时器」，计时器的时间是随机的，通常是 0~10 秒，计时器超时后主机就会发送 IGMP 成员关系报告报⽂（源 IP 地址为⾃⼰主机的 IP 地 址，⽬的 IP 地址为组播地址）。如果在定时器超时之前，收到同⼀个组内的其他主机发送的成员关系报告报⽂，则⾃⼰不再发送，这样可以减少⽹络中多余的 IGMP 报⽂数量。<li>路由器收到主机的成员关系报⽂后，就会在 IGMP 路由表中加⼊该组播组，后续⽹络中⼀旦该组播 地址的数据到达路由器，它会把数据包转发出去。</ol><p><strong>离开组播组⼯作机制</strong><p><strong>离开组播组的情况一，⽹段中仍有该组播组</strong>：<p><img alt=image-20210415222033735 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415222033735.png?token=AIGEF3JE5ZCEGB2HNLAWDI3EZZRXY><ol><li>主机 1 要离开组 224.1.1.1，发送 IGMPv2 离组报⽂，报⽂的⽬的地址是 224.0.0.2（表示发向⽹段内的所有路由器）。<li>路由器 收到该报⽂后，以 1 秒为间隔连续发送 IGMP 特定组查询报⽂（共计发送 2 个），以便确认该⽹络是否还有 224.1.1.1 组的其他成员。<li>主机 3 仍然是组 224.1.1.1 的成员，因此它⽴即响应这个特定组查询。路由器知道该⽹络中仍然存在该组播组的成员，于是继续向该⽹络转发 224.1.1.1 的组播数据包。</ol><p><strong>离开组播组的情况⼆，⽹段中没有该组播组</strong>：<p><img alt=image-20210415222133007 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20210415222133007.png?token=AIGEF3LA2MJ4DXOOQZ7TRL3EZZRYU><ol><li>主机 1 要离开组播组 224.1.1.1，发送 IGMP 离组报⽂。<li>路由器收到该报⽂后，以 1 秒为间隔连续发送 IGMP 特定组查询报⽂（共计发送 2 个）。此时在该⽹段内，组 224.1.1.1 已经没有其他成员了，因此没有主机响应这个查询。<li>⼀定时间后，路由器认为该⽹段中已经没有 224.1.1.1 组播组成员了，将不会再向这个⽹段转发该组播地址的数据包。</ol></div><footer class=post-footer><div class=post-tags><a href=/tags/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/ rel=tag># 网络协议</a><a href=/tags/IP/ rel=tag># IP</a></div><div class=post-nav><div class=post-nav-item><a href=/2024/08/21/IO%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/ rel=prev title=计算机系列-IO> <i class="fa fa-angle-left"></i> 计算机系列-IO </a></div><div class=post-nav-item><a href=/2024/08/21/JVM%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/ rel=next title=Java系列-JVM> Java系列-JVM <i class="fa fa-angle-right"></i> </a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>© <span itemprop=copyrightYear>2024</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>豪哥</span></div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label=返回顶部 class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script crossorigin=anonymous integrity=sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY= src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js></script><script src=/js/comments.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/sidebar.js></script><script src=/js/next-boot.js></script><script crossorigin=anonymous integrity=sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc= src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js></script><script src=/js/third-party/search/local-search.js></script>