<!doctypehtml><html lang=zh-CN><meta charset=UTF-8><meta content=width=device-width name=viewport><meta media="(prefers-color-scheme: light)" content=#222 name=theme-color><meta media="(prefers-color-scheme: dark)" content=#222 name=theme-color><meta content="Hexo 7.3.0" name=generator><link href=/images/apple-touch-icon-next.png rel=apple-touch-icon sizes=180x180><link href=/images/favicon-32x32-next.png rel=icon sizes=32x32 type=image/png><link href=/images/favicon-16x16-next.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><link href=/css/main.css rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css integrity=sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA= rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css integrity=sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE= rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"hshz21.gitee.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src=/js/config.js></script><meta content="MyBatis简介啥是MyBatisMybatis 是一个半自动 ORM（对象关系映射）框架。内部封装了 JDBC，只需自定义SQL，而无需做加载驱动、创建连接、创建 statement 等繁杂工作。 MyBatis可通过 xml文件 或 注解 将待执行 statement 配置起来，并通过 java对象 和 statement中SQL的动态参数进行映射生成待执行 SQL，最后执行SQL将结果映射" name=description><meta content=article property=og:type><meta content=MyBatis系列-MyBatis基础应用（二） property=og:title><meta content=https://hshz21.gitee.io/2024/08/21/MyBatis%E5%9F%BA%E7%A1%80%E5%BA%94%E7%94%A82/index.html property=og:url><meta content=豪哥博客 property=og:site_name><meta content="MyBatis简介啥是MyBatisMybatis 是一个半自动 ORM（对象关系映射）框架。内部封装了 JDBC，只需自定义SQL，而无需做加载驱动、创建连接、创建 statement 等繁杂工作。 MyBatis可通过 xml文件 或 注解 将待执行 statement 配置起来，并通过 java对象 和 statement中SQL的动态参数进行映射生成待执行 SQL，最后执行SQL将结果映射" property=og:description><meta content=zh_CN property=og:locale><meta content=2024-08-21T13:39:14.002Z property=article:published_time><meta content=2023-10-03T13:11:32.814Z property=article:modified_time><meta content=豪哥 property=article:author><meta content=MyBatis property=article:tag><meta content=MyBatis基础 property=article:tag><meta content=summary name=twitter:card><link href=https://hshz21.gitee.io/2024/08/21/MyBatis%E5%9F%BA%E7%A1%80%E5%BA%94%E7%94%A82/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://hshz21.gitee.io/2024/08/21/MyBatis%E5%9F%BA%E7%A1%80%E5%BA%94%E7%94%A82/","path":"2024/08/21/MyBatis基础应用2/","title":"MyBatis系列-MyBatis基础应用（二）"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>MyBatis系列-MyBatis基础应用（二） | 豪哥博客</title><noscript><link href=/css/noscript.css rel=stylesheet></noscript><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label=切换导航栏 class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <p class=site-title>豪哥博客</p> <i class=logo-line></i> </a><p class=site-subtitle itemprop=description>豪哥博客</div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=搜索 role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>分类</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>搜索 </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=搜索... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-1"><a class=nav-link href=#MyBatis%E7%AE%80%E4%BB%8B><span class=nav-number>1.</span> <span class=nav-text>MyBatis简介</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%95%A5%E6%98%AFMyBatis><span class=nav-number>1.1.</span> <span class=nav-text>啥是MyBatis</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E4%B8%BA%E5%95%A5MyBatis%E6%98%AF%E5%8D%8A%E8%87%AA%E5%8A%A8ORM><span class=nav-number>1.2.</span> <span class=nav-text>为啥MyBatis是半自动ORM</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#MyBatis%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF><span class=nav-number>1.3.</span> <span class=nav-text>MyBatis使用场景</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#MyBatis%E4%B8%8EHibernate%E5%8C%BA%E5%88%AB><span class=nav-number>1.4.</span> <span class=nav-text>MyBatis与Hibernate区别</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#MyBatis%E4%BC%98%E7%BC%BA%E7%82%B9><span class=nav-number>1.5.</span> <span class=nav-text>MyBatis优缺点</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E4%BC%98%E7%82%B9><span class=nav-number>1.5.1.</span> <span class=nav-text>优点</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%BC%BA%E7%82%B9><span class=nav-number>1.5.2.</span> <span class=nav-text>缺点</span></a></ol></ol><li class="nav-item nav-level-1"><a class=nav-link href=#%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5><span class=nav-number>2.</span> <span class=nav-text>增删改查</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%B1%9E%E6%80%A7%E5%90%8D%E5%92%8C%E5%AD%97%E6%AE%B5%E5%90%8D%E4%B8%8D%E5%90%8C><span class=nav-number>2.1.</span> <span class=nav-text>属性名和字段名不同</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%AE%9A%E4%B9%89%E5%88%AB%E5%90%8D><span class=nav-number>2.1.1.</span> <span class=nav-text>定义别名</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%98%A0%E5%B0%84><span class=nav-number>2.1.2.</span> <span class=nav-text>映射</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C><span class=nav-number>2.2.</span> <span class=nav-text>查询操作</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#MyBatis%E5%88%86%E9%A1%B5><span class=nav-number>2.2.1.</span> <span class=nav-text>MyBatis分页</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%A6%82%E4%BD%95%E5%88%86%E9%A1%B5><span class=nav-number>2.2.1.1.</span> <span class=nav-text>如何分页</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%88%86%E9%A1%B5%E6%8F%92%E4%BB%B6%E5%8E%9F%E7%90%86><span class=nav-number>2.2.1.2.</span> <span class=nav-text>分页插件原理</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E8%8E%B7%E5%8F%96%E8%87%AA%E5%A2%9E%E9%95%BF%E9%94%AE%E5%80%BC><span class=nav-number>2.2.1.3.</span> <span class=nav-text>获取自增长键值</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2><span class=nav-number>2.2.2.</span> <span class=nav-text>模糊查询</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%8F%92%E5%85%A5%E6%93%8D%E4%BD%9C><span class=nav-number>2.3.</span> <span class=nav-text>插入操作</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%89%B9%E9%87%8F%E6%8F%92%E5%85%A5><span class=nav-number>2.3.1.</span> <span class=nav-text>批量插入</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%B0%81%E8%A3%85%E7%BB%93%E6%9E%9C><span class=nav-number>2.4.</span> <span class=nav-text>封装结果</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E6%A0%87%E7%AD%BE><span class=nav-number>2.4.1.</span> <span class=nav-text>使用标签</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%88%AB%E5%90%8D><span class=nav-number>2.4.2.</span> <span class=nav-text>使用别名</span></a></ol></ol><li class="nav-item nav-level-1"><a class=nav-link href=#Mapper%E6%8E%A5%E5%8F%A3><span class=nav-number>3.</span> <span class=nav-text>Mapper接口</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#Mapper%E6%8E%A5%E5%8F%A3%E5%8E%9F%E7%90%86><span class=nav-number>3.1.</span> <span class=nav-text>Mapper接口原理</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Mapper%E6%8E%A5%E5%8F%A3%E6%96%B9%E6%B3%95%E5%8F%AF%E4%BB%A5%E9%87%8D%E8%BD%BD%E5%90%97%EF%BC%9F><span class=nav-number>3.2.</span> <span class=nav-text>Mapper接口方法可以重载吗？</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Mapper%E4%B8%AD%E5%A6%82%E4%BD%95%E4%BC%A0%E9%80%92%E5%A4%9A%E5%8F%82%E6%95%B0><span class=nav-number>3.3.</span> <span class=nav-text>Mapper中如何传递多参数</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E6%95%B0%E5%AD%97%E4%B8%8B%E6%A0%87><span class=nav-number>3.3.1.</span> <span class=nav-text>使用数字下标</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E6%B3%A8%E8%A7%A3-Param%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89><span class=nav-number>3.3.2.</span> <span class=nav-text>使用注解@Param（推荐）</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E4%BD%BF%E7%94%A8Map><span class=nav-number>3.3.3.</span> <span class=nav-text>使用Map</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Mapper%E6%8E%A5%E5%8F%A3%E7%BB%91%E5%AE%9A><span class=nav-number>3.4.</span> <span class=nav-text>Mapper接口绑定</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%AE%80%E4%BB%8B><span class=nav-number>3.4.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%BB%91%E5%AE%9A%E6%96%B9%E5%BC%8F><span class=nav-number>3.4.2.</span> <span class=nav-text>绑定方式</span></a></ol></ol><li class="nav-item nav-level-1"><a class=nav-link href=#Mapper-XML%E6%96%87%E4%BB%B6><span class=nav-number>4.</span> <span class=nav-text>Mapper XML文件</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#XML-%E9%9D%9E%E5%B8%B8%E8%A7%81%E6%A0%87%E7%AD%BE><span class=nav-number>4.1.</span> <span class=nav-text>XML 非常见标签</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E4%B8%8D%E5%90%8CXML%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84ID%E8%83%BD%E5%90%A6%E9%87%8D%E5%A4%8D><span class=nav-number>4.2.</span> <span class=nav-text>不同XML文件中的ID能否重复</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2><span class=nav-number>4.3.</span> <span class=nav-text>关联查询</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#MyBatis%E5%8A%A8%E6%80%81SQL><span class=nav-number>4.4.</span> <span class=nav-text>MyBatis动态SQL</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E4%BD%9C%E7%94%A8><span class=nav-number>4.4.1.</span> <span class=nav-text>作用</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%8E%9F%E7%90%86><span class=nav-number>4.4.2.</span> <span class=nav-text>原理</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%88%86%E7%B1%BB><span class=nav-number>4.4.3.</span> <span class=nav-text>分类</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%92%8C-%E7%9A%84%E5%8C%BA%E5%88%AB><span class=nav-number>4.5.</span> <span class=nav-text>#{} 和 ${} 的区别</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link href=#%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD><span class=nav-number>5.</span> <span class=nav-text>延迟加载</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%BC%80%E5%90%AF%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD><span class=nav-number>5.1.</span> <span class=nav-text>开启延迟加载</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD%E5%8E%9F%E7%90%86><span class=nav-number>5.2.</span> <span class=nav-text>延迟加载原理</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#ResultMap%E5%92%8CResultType%E5%8C%BA%E5%88%AB><span class=nav-number>5.3.</span> <span class=nav-text>ResultMap和ResultType区别</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link href=#%E7%BC%93%E5%AD%98><span class=nav-number>6.</span> <span class=nav-text>缓存</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#%E4%B8%80%E7%BA%A7%E7%BC%93%E5%AD%98><span class=nav-number>6.1.</span> <span class=nav-text>一级缓存</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-1><span class=nav-number>6.1.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%BC%93%E5%AD%98%E5%A4%B1%E6%95%88><span class=nav-number>6.1.2.</span> <span class=nav-text>缓存失效</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98><span class=nav-number>6.2.</span> <span class=nav-text>二级缓存</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-2><span class=nav-number>6.2.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%BC%80%E5%90%AF%E6%9D%A1%E4%BB%B6><span class=nav-number>6.2.2.</span> <span class=nav-text>开启条件</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%BC%93%E5%AD%98%E5%A4%B1%E6%95%88-1><span class=nav-number>6.2.3.</span> <span class=nav-text>缓存失效</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0><span class=nav-number>6.2.4.</span> <span class=nav-text>配置参数</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%9F%A5%E8%AF%A2%E7%BC%93%E5%AD%98%E9%A1%BA%E5%BA%8F><span class=nav-number>6.3.</span> <span class=nav-text>查询缓存顺序</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E4%BD%BF%E7%94%A8EhCache%E7%BC%93%E5%AD%98><span class=nav-number>6.4.</span> <span class=nav-text>使用EhCache缓存</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link href=#%E6%8F%92%E4%BB%B6><span class=nav-number>7.</span> <span class=nav-text>插件</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%8F%92%E4%BB%B6%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86><span class=nav-number>7.1.</span> <span class=nav-text>插件运行原理</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%A6%82%E4%BD%95%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8F%92%E4%BB%B6><span class=nav-number>7.2.</span> <span class=nav-text>如何自定义插件</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%88%86%E9%A1%B5%E6%8F%92%E4%BB%B6><span class=nav-number>7.3.</span> <span class=nav-text>分页插件</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link href=#%E6%80%BB%E7%BB%93><span class=nav-number>8.</span> <span class=nav-text>总结</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%AE%9E%E4%BD%93%E7%B1%BB%E5%AF%B9%E6%AF%94><span class=nav-number>8.1.</span> <span class=nav-text>实体类对比</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#POJO><span class=nav-number>8.1.1.</span> <span class=nav-text>POJO</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Java-Bean><span class=nav-number>8.1.2.</span> <span class=nav-text>Java Bean</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Entity><span class=nav-number>8.1.3.</span> <span class=nav-text>Entity</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#DTO><span class=nav-number>8.1.4.</span> <span class=nav-text>DTO</span></a></ol></ol></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><img alt=豪哥 class=site-author-image itemprop=image src=/static/imgs/avatar.png><p class=site-author-name itemprop=name>豪哥<div class=site-description itemprop=description>豪哥博客</div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>109</span> <span class=site-state-item-name>日志</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>33</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/> <span class=site-state-item-count>126</span> <span class=site-state-item-name>标签</span></a></div></nav></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article lang=zh-CN><link href=https://hshz21.gitee.io/2024/08/21/MyBatis%E5%9F%BA%E7%A1%80%E5%BA%94%E7%94%A82/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/static/imgs/avatar.png itemprop=image> <meta content=豪哥 itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=豪哥博客 itemprop=name> <meta content=豪哥博客 itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="MyBatis系列-MyBatis基础应用（二） | 豪哥博客" itemprop=name> <meta itemprop=description> </span><header class=post-header><h1 itemprop="name headline" class=post-title>MyBatis系列-MyBatis基础应用（二）</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2024-08-21 21:39:14" datetime=2024-08-21T21:39:14+08:00>2024-08-21</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-10-03 21:11:32" datetime=2023-10-03T21:11:32+08:00 itemprop=dateModified>2023-10-03</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/MyBatis/ itemprop=url rel=index><span itemprop=name>MyBatis</span></a> </span> </span></div></div></header><div class=post-body itemprop=articleBody><h1 id=MyBatis简介><a class=headerlink href=#MyBatis简介 title=MyBatis简介></a>MyBatis简介</h1><h2 id=啥是MyBatis><a class=headerlink href=#啥是MyBatis title=啥是MyBatis></a>啥是MyBatis</h2><p><strong>Mybatis 是一个半自动 ORM（对象关系映射）框架</strong>。内部封装了 JDBC，只需自定义SQL，而无需做加载驱动、创建连接、创建 statement 等繁杂工作。<p><strong>MyBatis可通过 xml文件 或 注解 将待执行 statement 配置起来，并通过 java对象 和 statement中SQL的动态参数进行映射生成待执行 SQL，最后执行SQL将结果映射为 Java 对象后返回</strong>。<h2 id=为啥MyBatis是半自动ORM><a class=headerlink href=#为啥MyBatis是半自动ORM title=为啥MyBatis是半自动ORM></a>为啥MyBatis是半自动ORM</h2><p><strong>Mybatis持久化要手动编写SQL来实现，所以称之为半自动 ORM 映射工具。</strong><h2 id=MyBatis使用场景><a class=headerlink href=#MyBatis使用场景 title=MyBatis使用场景></a>MyBatis使用场景</h2><ol><li>MyBatis 专注于 SQL 本身，是一个足够灵活的持久层框架。<li>对性能要求很高，或需求变化大的项目。</ol><h2 id=MyBatis与Hibernate区别><a class=headerlink href=#MyBatis与Hibernate区别 title=MyBatis与Hibernate区别></a>MyBatis与Hibernate区别</h2><ol><li>MyBatis是一个半自动ORM 框架，Hibernate是一个全自动ORM框架。<li>MyBatis灵活度高，适用于 对关系数据模型要求不高的场景，但数据库无关性差；Hibernate反之。</ol><h2 id=MyBatis优缺点><a class=headerlink href=#MyBatis优缺点 title=MyBatis优缺点></a>MyBatis优缺点</h2><h3 id=优点><a class=headerlink href=#优点 title=优点></a>优点</h3><ol><li>降低与代码的耦合，手动编写SQL，灵活度高；<li>与 JDBC 相比，代码量较少；<li>兼容多种数据库（MyBatis 基于 JDBC 实现，故 JDBC 支持的 MyBatis 都支持）；<li>可与 Spring 完美集成；<li>提供映射标签，支持对象与数据库的 ORM 字段关系映射；</ol><h3 id=缺点><a class=headerlink href=#缺点 title=缺点></a>缺点</h3><ol><li>SQL编写工作量稍大；<li>SQL本身依赖于数据库，数据库移植性差；</ol><h1 id=增删改查><a class=headerlink href=#增删改查 title=增删改查></a>增删改查</h1><h2 id=属性名和字段名不同><a class=headerlink href=#属性名和字段名不同 title=属性名和字段名不同></a>属性名和字段名不同</h2><h3 id=定义别名><a class=headerlink href=#定义别名 title=定义别名></a>定义别名</h3><p>通过在 SQL 中定义字段别名：<figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre><td class=code><pre><span class=line><span class=tag><<span class=name>select</span> <span class=attr>id</span>=<span class=string>”selectorder”</span> <span class=attr>parametertype</span>=<span class=string>”int”</span> <span class=attr>resultetype</span>=<span class=string>”me.gacl.domain.order”</span>></span></span><br><span class=line>    select order_id id, order_no orderno, order_price price </span><br><span class=line>    from orders </span><br><span class=line>    where order_id=#{id};</span><br><span class=line><span class=tag>&LT/<span class=name>select</span>></span></span><br></pre></table></figure><h3 id=映射><a class=headerlink href=#映射 title=映射></a>映射</h3><p>通过映射字段名和实体类属性名来达到一致：<figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br></pre><td class=code><pre><span class=line><span class=tag><<span class=name>resultMap</span> <span class=attr>type</span>=<span class=string>”me.gacl.domain.order”</span> <span class=attr>id</span>=<span class=string>”orderresultmap”</span>></span></span><br><span class=line>    &LT!–用 id 属性来映射主键字段–></span><br><span class=line>    <span class=tag><<span class=name>id</span> <span class=attr>property</span>=<span class=string>”id”</span> <span class=attr>column</span>=<span class=string>”order_id”</span>></span></span><br><span class=line>    &LT!–用 result 属性来映射非主键字段，property 为实体类属性名，column</span><br><span class=line>            为数据表中的属性–></span><br><span class=line>    <span class=tag><<span class=name>result</span> <span class=attr>property</span> = <span class=string>“orderno”</span> <span class=attr>column</span> =<span class=string>”order_no”/</span>></span></span><br><span class=line>    <span class=tag><<span class=name>result</span> <span class=attr>property</span>=<span class=string>”price”</span> <span class=attr>column</span>=<span class=string>”order_price”</span> /></span></span><br><span class=line><span class=tag>&LT/<span class=name>reslutMap</span>></span></span><br><span class=line>    </span><br><span class=line><span class=tag><<span class=name>select</span> <span class=attr>id</span>=<span class=string>"getOrder"</span> <span class=attr>parameterType</span>=<span class=string>"int"</span>  <span class=attr>resultMap</span>=<span class=string>"orderresultmap"</span>></span></span><br><span class=line>    select * from orders where order_id = #{id}</span><br><span class=line><span class=tag>&LT/<span class=name>select</span>></span></span><br></pre></table></figure><h2 id=查询操作><a class=headerlink href=#查询操作 title=查询操作></a>查询操作</h2><h3 id=MyBatis分页><a class=headerlink href=#MyBatis分页 title=MyBatis分页></a>MyBatis分页</h3><h4 id=如何分页><a class=headerlink href=#如何分页 title=如何分页></a>如何分页</h4><p><strong>Mybatis通过 RowBounds 对象进行分页，通过操作 ResultSet 结果集实现内存分页，而非物理分页</strong>。<p>注意：可编写分页SQL完成物理分页功能，也可使用分页插件来完成物理分页。<h4 id=分页插件原理><a class=headerlink href=#分页插件原理 title=分页插件原理></a>分页插件原理</h4><p>基本原理是 <strong>通过Mybatis插件接口实现自定义插件，插件会拦截待执行SQL，并重写SQL来实现分页</strong>。<h4 id=获取自增长键值><a class=headerlink href=#获取自增长键值 title=获取自增长键值></a>获取自增长键值</h4><p><strong>insert 方法总是返回一个 int 值，该值表示插入行数</strong>。<p>如果采用自增长策略，自动生成的键值在 insert 方法执行完后会被设置到传入的参数对象中。<figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line><span class=tag><<span class=name>insert</span> <span class=attr>id</span>=<span class=string>”insertname”</span> <span class=attr>usegeneratedkeys</span>=<span class=string>”true”</span> <span class=attr>keyproperty</span>=<span class=string>”id”</span>></span></span><br><span class=line>    insert into users (name) values (#{name})</span><br><span class=line><span class=tag>&LT/<span class=name>insert</span>></span></span><br></pre></table></figure><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre><td class=code><pre><span class=line><span class=type>User</span> <span class=variable>u</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">User</span>();</span><br><span class=line>u.setname(“fred”);</span><br><span class=line><span class=type>int</span> <span class=variable>rows</span> <span class=operator>=</span> mapper.insertname(name);</span><br><span class=line>system.out.println(“插入行数 = ” + rows);</span><br><span class=line>system.out.println(“自增长值 = ” + u.getid());</span><br></pre></table></figure><h3 id=模糊查询><a class=headerlink href=#模糊查询 title=模糊查询></a>模糊查询</h3><ul><li><p>双引号 + #{} + %（推荐）</p> <figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line><span class=keyword>select</span> <span class=operator>*</span> <span class=keyword>from</span> foo <span class=keyword>where</span> bar <span class=keyword>like</span> "%"#{<span class=keyword>value</span>}"%";</span><br></pre></table></figure><li><p>单引号 + ${} + %</p> <figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line><span class=keyword>select</span> <span class=operator>*</span> <span class=keyword>from</span> foo <span class=keyword>where</span> bar <span class=keyword>like</span> <span class=string>'%${value}%'</span>;</span><br></pre></table></figure><li><p>通过concat函数拼接</p> <figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line><span class=keyword>select</span> <span class=operator>*</span> <span class=keyword>from</span> foo <span class=keyword>where</span> bar <span class=keyword>like</span> concat(<span class=string>'%'</span>, #{name}, "%");</span><br></pre></table></figure><li><p>通过StringBuilder拼接%和参数值，xml中直接使用#{}</p> <figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line><span class=type>String</span> <span class=variable>searchText</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">StringBuilder</span>(<span class=string>"%"</span>).append(text).append(<span class=string>"%"</span>).toString();</span><br></pre></table></figure> <figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line><span class=keyword>select</span> <span class=operator>*</span> <span class=keyword>from</span> foo <span class=keyword>where</span> bar <span class=keyword>like</span> #{<span class=keyword>value</span>}</span><br></pre></table></figure></ul><p><font color=red>注意：在SQL语句中拼接通配符会引起SQL注入，不推荐该种方式。</font><h2 id=插入操作><a class=headerlink href=#插入操作 title=插入操作></a>插入操作</h2><h3 id=批量插入><a class=headerlink href=#批量插入 title=批量插入></a>批量插入</h3><p>首先创建一个简单的 insert 语句：<figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line><span class=tag><<span class=name>insert</span> <span class=attr>id</span>=<span class=string>”insertname”</span>></span></span><br><span class=line>    insert into names(name) values(#{value})</span><br><span class=line><span class=tag>&LT/<span class=name>insert</span>></span></span><br></pre></table></figure><p>然后在 Java 代码中执行批处理插入：<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre><td class=code><pre><span class=line><span class=comment>// 注意 executortype.batch</span></span><br><span class=line><span class=type>nameMapper</span> <span class=variable>mapper</span> <span class=operator>=</span> sqlsession.getmapper(nameMapper.class);</span><br><span class=line><span class=keyword>for</span> (string name: names) {</span><br><span class=line>    mapper.insert(name);</span><br><span class=line>}</span><br></pre></table></figure><h2 id=封装结果><a class=headerlink href=#封装结果 title=封装结果></a>封装结果</h2><h3 id=使用标签><a class=headerlink href=#使用标签 title=使用标签></a>使用标签</h3><p>逐一定义数据库列名和对象属性名之间的映射关系。<h3 id=使用别名><a class=headerlink href=#使用别名 title=使用别名></a>使用别名</h3><p>使用 SQL列的别名功能，将列的别名书写为对象属性名。<blockquote><p>有了 列名 与 属性名 的映射，<em><strong>MyBatis 通过反射创建对象，然后初始化对象属性，无映射关系的属性无法完成初始化</strong></em>。</blockquote><h1 id=Mapper接口><a class=headerlink href=#Mapper接口 title=Mapper接口></a>Mapper接口</h1><h2 id=Mapper接口原理><a class=headerlink href=#Mapper接口原理 title=Mapper接口原理></a>Mapper接口原理</h2><p>namespace 是 接口全限名；MapperStatement id 是 接口方法名；传递给 sql 的参数是 接口方法参数。<p>把 接口全限名+方法名 作为 key可定位一个MapperStatement。Mybatis 中的<code>&LTselect></code>、<code>&LTinsert></code>、<code>&LTupdate></code>、<code>&LTdelete></code>标签都会被解析成一个<code>MapperStatement</code>对象。<p><strong>MyBatis 使用JDK动态代理为 Mapper接口生成代理对象，代理对象会拦截对接口方法的调用，转而执行 MapperStatement 中的SQL，最后将 SQL 执行结果返回</strong>。<h2 id=Mapper接口方法可以重载吗？><a class=headerlink href=#Mapper接口方法可以重载吗？ title=Mapper接口方法可以重载吗？></a>Mapper接口方法可以重载吗？</h2><p>不能重载，因为底层使用<em><strong>全限名+方法名</strong></em>的保存和寻找策略。<h2 id=Mapper中如何传递多参数><a class=headerlink href=#Mapper中如何传递多参数 title=Mapper中如何传递多参数></a>Mapper中如何传递多参数</h2><h3 id=使用数字下标><a class=headerlink href=#使用数字下标 title=使用数字下标></a>使用数字下标</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class="title function_">UserselectUser</span><span class=params>(String name, String area)</span>;</span><br><span class=line><span class=comment>// 对应xml来说，#{0}代表接收的第一个参数name，#{1}代表接收第二个参数area，以此类推。</span></span><br></pre></table></figure><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre><td class=code><pre><span class=line><span class=tag><<span class=name>select</span> <span class=attr>id</span>=<span class=string>"selectUser"</span><span class=attr>resultMap</span>=<span class=string>"BaseResultMap"</span>></span></span><br><span class=line>    select * fromuser_user_t</span><br><span class=line>    whereuser_name = #{0}</span><br><span class=line>    anduser_area=#{1}</span><br><span class=line><span class=tag>&LT/<span class=name>select</span>></span></span><br></pre></table></figure><h3 id=使用注解-Param（推荐）><a class=headerlink href=#使用注解-Param（推荐） title=使用注解@Param（推荐）></a>使用注解@Param（推荐）</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">usermapper</span> {</span><br><span class=line>    user <span class="title function_">selectuser</span><span class=params>(<span class=meta>@param(“username”)</span> string username, <span class=meta>@param(“hashedpassword”)</span> string hashedpassword)</span>;</span><br><span class=line>}</span><br></pre></table></figure><p>在XML中这样使用：<figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line><span class=tag><<span class=name>select</span> <span class=attr>id</span>=<span class=string>”selectuser”</span> <span class=attr>resulttype</span>=<span class=string>”user”</span>></span></span><br><span class=line>    select id, username, hashedpassword</span><br><span class=line>    from some_table</span><br><span class=line>    where username = #{username}</span><br><span class=line>    and hashedpassword = #{hashedpassword}</span><br><span class=line><span class=tag>&LT/<span class=name>select</span>></span></span><br></pre></table></figure><h3 id=使用Map><a class=headerlink href=#使用Map title=使用Map></a>使用Map</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line><span class=comment>// 映射文件的命名空间.SQL 片段的 ID，就可以调用对应的映射文件中的 SQL</span></span><br><span class=line><span class=comment>// 由于我们的参数超过了两个，而方法中只有一个 Object 参数收集，因此我们使用 Map 集合来装载我们的参数</span></span><br><span class=line>Map < String, Object > map = <span class=keyword>new</span> <span class="title class_">HashMap</span>();</span><br><span class=line>map.put(<span class=string>"start"</span>, start);</span><br><span class=line>map.put(<span class=string>"end"</span>, end);</span><br><span class=line><span class=keyword>return</span> sqlSession.selectList(<span class=string>"StudentID.pagination"</span>, map);</span><br></pre></table></figure><h2 id=Mapper接口绑定><a class=headerlink href=#Mapper接口绑定 title=Mapper接口绑定></a>Mapper接口绑定</h2><h3 id=简介><a class=headerlink href=#简介 title=简介></a>简介</h3><p>接口绑定定义：<strong>Dao接口中的方法 与 mapper xml中的 SQL 进行绑定。</strong>调用接口方法就可实现执行SQL的功能。<h3 id=绑定方式><a class=headerlink href=#绑定方式 title=绑定方式></a>绑定方式</h3><p>接口绑定有两种实现方式：<ol><li><strong>注解绑定</strong>：在接口的方法上添加注解<code>@Select、@Update</code>等，然后在注解中直接编写SQL来绑定；<li><strong>Mapper xml绑定</strong>：xml 映射文件中的 namespace 属性值必须为接口的全路径名。</ol><blockquote><p>建议：SQL较简单时用注解绑定，较复杂时用 xml 绑定。xml 绑定方式使用较多。</blockquote><h1 id=Mapper-XML文件><a title="Mapper XML文件" class=headerlink href=#Mapper-XML文件></a>Mapper XML文件</h1><h2 id=XML-非常见标签><a title="XML 非常见标签" class=headerlink href=#XML-非常见标签></a>XML 非常见标签</h2><p><code>&LTresultMap></code>、<code>&LTparameterMap></code>、<code>&LTsql></code>、<code>&LTinclude></code>、<code>&LTselectKey></code>，加上动态 sql 的 9 个标签。<h2 id=不同XML文件中的ID能否重复><a class=headerlink href=#不同XML文件中的ID能否重复 title=不同XML文件中的ID能否重复></a>不同XML文件中的ID能否重复</h2><p>如果配置了namespace，那么 id 可以重复；如果没有配置 namespace，那么 id 不能重复；<blockquote><p>注意： namespace+id 会当作 Map 的 key 来使用，如果没有 namespace，id重复会造成数据覆盖。</blockquote><h2 id=关联查询><a class=headerlink href=#关联查询 title=关联查询></a>关联查询</h2><p>有 联合查询 和 嵌套查询 两种方式。<ul><li><strong>联合查询</strong>：几个表联合查询，只查询一次，通过在resultMap 里面添加 association 节点即可实现；<li><strong>嵌套查询</strong>：先查一个表，然后根据该表返回结果所对应的外键 id，再去另外一个表中查询。其同样通过 association 配置，但另外一个表的查询通过 select 属性配置。</ul><p>代码实现<figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br></pre><td class=code><pre><span class=line><span class=tag><<span class=name>mapper</span> <span class=attr>namespace</span>=<span class=string>"com.lcb.mapping.userMapper"</span>></span></span><br><span class=line>    <span class=comment>&LT!--association 一对一关联查询 --></span></span><br><span class=line>    <span class=tag><<span class=name>resultMap</span> <span class=attr>type</span>=<span class=string>"com.lcb.user.Classes"</span> <span class=attr>id</span>=<span class=string>"ClassesResultMap"</span>></span></span><br><span class=line>        <span class=tag><<span class=name>id</span> <span class=attr>property</span>=<span class=string>"id"</span> <span class=attr>column</span>=<span class=string>"c_id"</span>/></span></span><br><span class=line>        <span class=tag><<span class=name>result</span> <span class=attr>property</span>=<span class=string>"name"</span> <span class=attr>column</span>=<span class=string>"c_name"</span>/></span></span><br><span class=line>        <span class=tag><<span class=name>association</span> <span class=attr>property</span>=<span class=string>"teacher"</span> <span class=attr>javaType</span>=<span class=string>"com.lcb.user.Teacher"</span>></span></span><br><span class=line>            <span class=tag><<span class=name>id</span> <span class=attr>property</span>=<span class=string>"id"</span> <span class=attr>column</span>=<span class=string>"t_id"</span>/></span></span><br><span class=line>            <span class=tag><<span class=name>result</span> <span class=attr>property</span>=<span class=string>"name"</span> <span class=attr>column</span>=<span class=string>"t_name"</span>/></span></span><br><span class=line>        <span class=tag>&LT/<span class=name>association</span>></span></span><br><span class=line>    <span class=tag>&LT/<span class=name>resultMap</span>></span></span><br><span class=line>    <span class=tag><<span class=name>select</span> <span class=attr>id</span>=<span class=string>"getClass"</span> <span class=attr>parameterType</span>=<span class=string>"int"</span> <span class=attr>resultMap</span>=<span class=string>"ClassesResultMap"</span>></span></span><br><span class=line>        select * </span><br><span class=line>        from class c, teacher t</span><br><span class=line>        where c.teacher_id=t.t_id and c.c_id=#{id}</span><br><span class=line>    <span class=tag>&LT/<span class=name>select</span>></span></span><br><span class=line>    </span><br><span class=line>    <span class=comment>&LT!--collection 一对多关联查询 --></span></span><br><span class=line>    <span class=tag><<span class=name>resultMap</span> <span class=attr>type</span>=<span class=string>"com.lcb.user.Classes"</span> <span class=attr>id</span>=<span class=string>"ClassesResultMap2"</span>></span></span><br><span class=line>        <span class=tag><<span class=name>id</span> <span class=attr>property</span>=<span class=string>"id"</span> <span class=attr>column</span>=<span class=string>"c_id"</span>/></span></span><br><span class=line>        <span class=tag><<span class=name>result</span> <span class=attr>property</span>=<span class=string>"name"</span> <span class=attr>column</span>=<span class=string>"c_name"</span>/></span></span><br><span class=line>        <span class=tag><<span class=name>association</span> <span class=attr>property</span>=<span class=string>"teacher"</span> <span class=attr>javaType</span>=<span class=string>"com.lcb.user.Teacher"</span>></span></span><br><span class=line>            <span class=tag><<span class=name>id</span> <span class=attr>property</span>=<span class=string>"id"</span> <span class=attr>column</span>=<span class=string>"t_id"</span>/></span></span><br><span class=line>            <span class=tag><<span class=name>result</span> <span class=attr>property</span>=<span class=string>"name"</span> <span class=attr>column</span>=<span class=string>"t_name"</span>/></span></span><br><span class=line>        <span class=tag>&LT/<span class=name>association</span>></span></span><br><span class=line>        <span class=tag><<span class=name>collection</span> <span class=attr>property</span>=<span class=string>"student"</span> <span class=attr>ofType</span>=<span class=string>"com.lcb.user.Student"</span>></span></span><br><span class=line>            <span class=tag><<span class=name>id</span> <span class=attr>property</span>=<span class=string>"id"</span> <span class=attr>column</span>=<span class=string>"s_id"</span>/></span></span><br><span class=line>            <span class=tag><<span class=name>result</span> <span class=attr>property</span>=<span class=string>"name"</span> <span class=attr>column</span>=<span class=string>"s_name"</span>/></span></span><br><span class=line>        <span class=tag>&LT/<span class=name>collection</span>></span></span><br><span class=line>    <span class=tag>&LT/<span class=name>resultMap</span>></span></span><br><span class=line>    <span class=tag><<span class=name>select</span> <span class=attr>id</span>=<span class=string>"getClass2"</span> <span class=attr>parameterType</span>=<span class=string>"int"</span> <span class=attr>resultMap</span>=<span class=string>"ClassesResultMap2"</span>></span></span><br><span class=line>        select * from class c,teacher t,student s where c.teacher_id=t.t_id</span><br><span class=line>        and c.c_id=s.class_id and c.c_id=#{id}</span><br><span class=line>    <span class=tag>&LT/<span class=name>select</span>></span></span><br><span class=line><span class=tag>&LT/<span class=name>mapper</span>></span></span><br></pre></table></figure><h2 id=MyBatis动态SQL><a class=headerlink href=#MyBatis动态SQL title=MyBatis动态SQL></a>MyBatis动态SQL</h2><h3 id=作用><a class=headerlink href=#作用 title=作用></a>作用</h3><p>在 Xml 映射文件内以标签形式编写动态SQL，可以满足不同业务逻辑的需要。<h3 id=原理><a class=headerlink href=#原理 title=原理></a>原理</h3><p>原理：<strong>根据 表达式值 完成 逻辑判断 和 动态拼接SQL</strong>。<h3 id=分类><a class=headerlink href=#分类 title=分类></a>分类</h3><p>常见动态标签有：<em><strong>if、trim、where、set、foreach、when、choose、bind、otherwise；</strong></em><h2 id=和-的区别><a title="#{} 和 ${} 的区别" class=headerlink href=#和-的区别></a>#{} 和 ${} 的区别</h2><ol><li><code>#{}</code>是预编译处理，<code>${}</code>是字符串替换。<li><code>#{}</code>在处理时会替换为?号，调用 PreparedStatement 的 set 方法来赋值；<code>${}</code>在处理时会直接替换成变量的值。<li><code>#{}</code>可有效防止 SQL 注入，提高系统安全性，推荐使用。</ol><h1 id=延迟加载><a class=headerlink href=#延迟加载 title=延迟加载></a>延迟加载</h1><h2 id=开启延迟加载><a class=headerlink href=#开启延迟加载 title=开启延迟加载></a>开启延迟加载</h2><p><strong>Mybatis 仅支持 association 关联对象和 collection 关联集合对象的延迟加载</strong>。<blockquote><p>association 指一对一，collection 指一对多查询。</blockquote><p>在 Mybatis 配置文件中，通过如下配置来开启/关闭延迟加载：<figure class="highlight properties"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line><span class=attr>lazyLoadingEnabled</span>=<span class=string>true|false</span></span><br></pre></table></figure><h2 id=延迟加载原理><a class=headerlink href=#延迟加载原理 title=延迟加载原理></a>延迟加载原理</h2><p>原理：<strong>使用 CGLIB 创建目标对象的代理对象，调用目标方法时先进入拦截器方法执行相关操作</strong>。<p>比如：调用 a.getB().getName()，拦截器 invoke()方法发现 a.getB()是null 值，那么就会单独发送事先保存好的查询关联 B 对象的 sql，把 B 查询出来，然后调用 a.setB(b)，于是 a对象 的 b属性 就有值了，接着完成 a.getB().getName()方法的调用。这就是延迟加载基本原理。<blockquote><p>其它 持久层框架 延迟加载原理 与MyBatis一样。</blockquote><h2 id=ResultMap和ResultType区别><a class=headerlink href=#ResultMap和ResultType区别 title=ResultMap和ResultType区别></a>ResultMap和ResultType区别</h2><ol><li>resultMap 可实现延迟加载，而 resultType 无法实现；<li>查询无特殊要求时选择 resultType，否则选择 resultMap；<li>使用 resultType 时通过 pojo 对象来实现结果集映射；<li>使用 resultMap 时，利用 association 和 collection 可实现一对多、多对多的结果映射；</ol><h1 id=缓存><a class=headerlink href=#缓存 title=缓存></a>缓存</h1><h2 id=一级缓存><a class=headerlink href=#一级缓存 title=一级缓存></a>一级缓存</h2><h3 id=简介-1><a class=headerlink href=#简介-1 title=简介></a>简介</h3><p><strong>一级缓存是基于PerpetualCache的HashMap本地缓存，作用域为 Session，默认打开</strong>。<h3 id=缓存失效><a class=headerlink href=#缓存失效 title=缓存失效></a>缓存失效</h3><p>一级缓存失效的四种情况：<ol><li>不同的SqlSession对应不同的一级缓存。<li>同一个SqlSession，但查询条件不同。<li>同一个SqlSession两次查询期间执行了其它增删改操作。<li>同一个SqlSeesion两次查询期间手动清空了缓存。（调用了clearCahche()方法）</ol><h2 id=二级缓存><a class=headerlink href=#二级缓存 title=二级缓存></a>二级缓存</h2><h3 id=简介-2><a class=headerlink href=#简介-2 title=简介></a>简介</h3><p><strong>二级缓存是基于PerpetualCache的HashMap本地缓存，作用域为Mapper(Namespace)，可自定义存储源</strong>。<h3 id=开启条件><a class=headerlink href=#开启条件 title=开启条件></a>开启条件</h3><p>二级缓存开启条件：<ol><li>在核心配置文件中，设置全局属性<code>cacheEnabled</code>为<code>true</code>（默认为true，无需设置）。<li>映射文件中设置标签<code>&LTcache/></code>。<li>二级缓存必须在SqlSession关闭或提交后有效。<li>查询结果转换的实体类必须实现序列化接口。</ol><p><font color=red>注意：要实现二级缓存效果，需要执行完查询操作后关闭SqlSession，因为 关闭操作会触发 缓存保存，再查询会走二级缓存。</font><h3 id=缓存失效-1><a class=headerlink href=#缓存失效-1 title=缓存失效></a>缓存失效</h3><p>二级缓存失效的情况：两次查询期间执行了任意的增删改操作。<blockquote><p><font color=red>注意事项：在执行完 增删改 操作后，会对一级缓存和二级缓存进行清理。</font></blockquote><h3 id=配置参数><a class=headerlink href=#配置参数 title=配置参数></a>配置参数</h3><p>二级缓存相关配置参数如下：<ul><li><p><strong>eviction属性</strong>：缓存回收策略。</p> <ul><li>LRU（默认）：最近最少使用，默认配置。<li>FIFO：先进先出。<li>SOFT：软引用。<li>WEAK：弱引用。</ul><li><p><strong>flushInterval属性</strong>：刷新间隔，单位毫秒。默认没有配置该参数，缓存仅在调用语句时刷新。</p><li><p><strong>size属性</strong>：引用数量，正整数。表示缓存最多可以存储对象的数量，太大会导致内存溢出。</p><li><p><strong>readOnly属性</strong>：只读，可选值有true/false，默认值为false。值为true表示只读缓存。值为false表示读写缓存。</p></ul><h2 id=查询缓存顺序><a class=headerlink href=#查询缓存顺序 title=查询缓存顺序></a>查询缓存顺序</h2><ol><li>先查二级缓存，因为二级缓存可能已经执行了查询操作。<li>如果二级缓存没有，再查找一级缓存。<li>如果一级缓存也没有，则查询数据库。<li>SqlSession关闭后，一级缓存中的数据会写入二级缓存中。</ol><h2 id=使用EhCache缓存><a class=headerlink href=#使用EhCache缓存 title=使用EhCache缓存></a>使用EhCache缓存</h2><p>1）添加依赖<figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre><td class=code><pre><span class=line><span class=tag><<span class=name>dependency</span>></span></span><br><span class=line>    <span class=tag><<span class=name>groupId</span>></span>org.mybatis.caches<span class=tag>&LT/<span class=name>groupId</span>></span></span><br><span class=line>    <span class=tag><<span class=name>artifactId</span>></span>mybatis-ehcache<span class=tag>&LT/<span class=name>artifactId</span>></span></span><br><span class=line>    <span class=tag><<span class=name>version</span>></span>1.2.2<span class=tag>&LT/<span class=name>version</span>></span></span><br><span class=line><span class=tag>&LT/<span class=name>dependency</span>></span></span><br></pre></table></figure><p>2）添加ehcache.xml文件<figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br></pre><td class=code><pre><span class=line><span class=meta>&LT?xml version=<span class=string>"1.0"</span> encoding=<span class=string>"UTF-8"</span>?></span></span><br><span class=line><span class=tag><<span class=name>ehcache</span> <span class=attr>xmlns:xsi</span>=<span class=string>"http://www.w3.org/2001/XMLSchema-instance"</span> <span class=attr>xsi:noNamespaceSchemaLocation</span>=<span class=string>"http://ehcache.org/ehcache.xsd"</span></span></span><br><span class=line><span class=tag>                    <span class=attr>updateCheck</span>=<span class=string>"false"</span>></span></span><br><span class=line></span><br><span class=line>    <span class=tag><<span class=name>diskStore</span> <span class=attr>path</span>=<span class=string>"D:\tmp\ssm"</span>/></span></span><br><span class=line>    <span class=tag><<span class=name>defaultCache</span></span></span><br><span class=line><span class=tag>        <span class=attr>eternal</span>=<span class=string>"false"</span></span></span><br><span class=line><span class=tag>        <span class=attr>maxElementsInMemory</span>=<span class=string>"10000"</span></span></span><br><span class=line><span class=tag>        <span class=attr>overflowToDisk</span>=<span class=string>"false"</span></span></span><br><span class=line><span class=tag>        <span class=attr>diskPersistent</span>=<span class=string>"false"</span></span></span><br><span class=line><span class=tag>        <span class=attr>timeToIdleSeconds</span>=<span class=string>"1800"</span></span></span><br><span class=line><span class=tag>        <span class=attr>timeToLiveSeconds</span>=<span class=string>"259200"</span></span></span><br><span class=line><span class=tag>        <span class=attr>memoryStoreEvictionPolicy</span>=<span class=string>"LRU"</span>/></span></span><br><span class=line>    <span class=tag><<span class=name>cache</span></span></span><br><span class=line><span class=tag>        <span class=attr>name</span>=<span class=string>"test_mybatis2l"</span></span></span><br><span class=line><span class=tag>        <span class=attr>eternal</span>=<span class=string>"false"</span></span></span><br><span class=line><span class=tag>        <span class=attr>maxElementsInMemory</span>=<span class=string>"5000"</span></span></span><br><span class=line><span class=tag>        <span class=attr>overflowToDisk</span>=<span class=string>"false"</span></span></span><br><span class=line><span class=tag>        <span class=attr>diskPersistent</span>=<span class=string>"false"</span></span></span><br><span class=line><span class=tag>        <span class=attr>timeToIdleSeconds</span>=<span class=string>"1800"</span></span></span><br><span class=line><span class=tag>        <span class=attr>timeToLiveSeconds</span>=<span class=string>"1800"</span></span></span><br><span class=line><span class=tag>        <span class=attr>memoryStoreEvictionPolicy</span>=<span class=string>"LRU"</span>/></span></span><br><span class=line><span class=tag>&LT/<span class=name>ehcache</span>></span></span><br></pre></table></figure><p>3）修改mapper映射文件<figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line><span class=tag><<span class=name>cache</span> <span class=attr>type</span>=<span class=string>"org.mybatis.caches.ehcache.EhcacheCache"</span>/></span></span><br></pre></table></figure><h1 id=插件><a class=headerlink href=#插件 title=插件></a>插件</h1><h2 id=插件运行原理><a class=headerlink href=#插件运行原理 title=插件运行原理></a>插件运行原理</h2><p><strong>Mybatis 仅可以编写针对 ParameterHandler、ResultSetHandler、StatementHandler、Executor 等4种接口类型的插件</strong>。Mybatis <strong>使用JDK 动态代理来实现接口方法拦截增强</strong>。每当执行这 4 种接口对象方法时，就会进入拦截方法（ InvocationHandler 的 invoke()方法）。<h2 id=如何自定义插件><a class=headerlink href=#如何自定义插件 title=如何自定义插件></a>如何自定义插件</h2><p>实现 Mybatis 的 Interceptor 接口重写 intercept()方法，给插件编写注解，指定要拦截哪一个接口的哪些方法。<blockquote><p><font color=red>注意：一定要在配置文件中配置你编写的插件。</font></blockquote><h2 id=分页插件><a class=headerlink href=#分页插件 title=分页插件></a>分页插件</h2><p>1）引入依赖<figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line><span class=comment>&LT!--mybatis分页插件--></span></span><br><span class=line><span class=tag><<span class=name>dependency</span>></span></span><br><span class=line>    <span class=tag><<span class=name>groupId</span>></span>com.github.pagehelper<span class=tag>&LT/<span class=name>groupId</span>></span></span><br><span class=line>    <span class=tag><<span class=name>artifactId</span>></span>pagehelper<span class=tag>&LT/<span class=name>artifactId</span>></span></span><br><span class=line>    <span class=tag><<span class=name>version</span>></span>5.2.0<span class=tag>&LT/<span class=name>version</span>></span></span><br><span class=line><span class=tag>&LT/<span class=name>dependency</span>></span></span><br></pre></table></figure><p>2）配置分页插件<figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line><span class=comment>&LT!--分页插件--></span></span><br><span class=line><span class=tag><<span class=name>plugin</span> <span class=attr>interceptor</span>=<span class=string>"com.github.pagehelper.PageInterceptor"</span>></span><span class=tag>&LT/<span class=name>plugin</span>></span></span><br></pre></table></figure><p>3）使用示例<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">testGetUserPage</span><span class=params>()</span>{</span><br><span class=line>    <span class=keyword>try</span>(<span class=type>SqlSession</span> <span class=variable>sqlSession</span> <span class=operator>=</span> MyBatisUtil.getSqlSession()) {</span><br><span class=line>        <span class=type>UserMapper</span> <span class=variable>userMapper</span> <span class=operator>=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class=line>        <span class=comment>// 开启分页</span></span><br><span class=line>        Page&LTObject> page = PageHelper.startPage(<span class=number>2</span>, <span class=number>3</span>);</span><br><span class=line>        List&LTUser> userList = userMapper.getAll();</span><br><span class=line>        PageInfo&LTUser> userPageInfo = <span class=keyword>new</span> <span class="title class_">PageInfo</span><>(userList);</span><br><span class=line>        userList.forEach(System.out::println);</span><br><span class=line>        System.out.println(<span class=string>"page: "</span> + page);</span><br><span class=line>        System.out.println(<span class=string>"pageInfo: "</span> + userPageInfo);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h1 id=总结><a class=headerlink href=#总结 title=总结></a>总结</h1><h2 id=实体类对比><a class=headerlink href=#实体类对比 title=实体类对比></a>实体类对比</h2><h3 id=POJO><a class=headerlink href=#POJO title=POJO></a>POJO</h3><p>按照Martin Fowler的解释，<strong>POJO指的是“Plain Old Java Object”的首字母，字面翻译为纯洁老式Java对象，一般称为简单Java对象</strong>。<p>POJO是指那些 <strong>没有继承任何类、没有实现任何接口，没有业务方法，更没有被其它框架侵入的Java对象</strong>。<h3 id=Java-Bean><a title="Java Bean" class=headerlink href=#Java-Bean></a>Java Bean</h3><p>JavaBean是JAVA实现的<em><strong>可重用组件</strong></em>。必须符合如下约定：<ol><li>这个类<strong>必须有一个公共缺省构造函数</strong>。<li>这个<strong>类的属性使用getter和setter来访问</strong>，其他方法遵从标准命名规范。<li>这个<strong>类可以被序列化</strong>。</ol><blockquote><p>注意：<ol><li><em><strong>缺省构造函数 又叫 默认构造函数</strong></em>，也就是声明对象时会被编译器调用的一个构造函数。<li>若声明的类中没有声明构造函数，编译器会自动调用一个缺省构造函数，该函数相当于一个不接受任何参数，不进行任何操作的构造函数。而当类中已经有声明的构造函数时，编译器就不会调用缺省构造函数。</ol></blockquote><blockquote><p>PoJo比较JavaBean：<ul><li>pojo用于数据的临时传递，它仅用于装数据，而不具有业务逻辑处理能力。<li>JavaBean的数据获取虽然与pojo一样，但是Java Bean中可以存在其它方法逻辑。</ul></blockquote><h3 id=Entity><a class=headerlink href=#Entity title=Entity></a>Entity</h3><p><em><strong>实体bean一般用于ORM对象关系映射，一个实体映射一张表，一般无业务逻辑代码</strong></em>。<blockquote><p>操作EntityBean就等于操作了数据库，是面向对象编程的一种体现。</blockquote><p><strong>Entity使用场景</strong>：广泛应用于领域驱动设计，用于表示业务模型与数据库表的映射。<h3 id=DTO><a class=headerlink href=#DTO title=DTO></a>DTO</h3><p><strong>DTO是数据传输对象（Data Transfer Object）的简称，用于在不同层或服务之间传输数据，用于解耦不同层之间的数据传输。</strong><p>DTO特点如下：<ul><li>轻量级的数据对象，<strong>仅包含所需的数据字段，不包含业务逻辑或复杂的方法</strong>。<li>可以在不同的系统或服务之间进行序列化和传输。<li>可以通过映射与实体对象进行相互转换。</ul><p>DTO的使用场景：通常在分层架构或微服务架构中使用，用于在不同的层或服务之间传输数据。可以减少层之间的耦合度，提供一种简单的方式来定义传输数据。</div><footer class=post-footer><div class=post-tags><a href=/tags/MyBatis/ rel=tag># MyBatis</a><a href=/tags/MyBatis%E5%9F%BA%E7%A1%80/ rel=tag># MyBatis基础</a></div><div class=post-nav><div class=post-nav-item><a href=/2024/08/21/Mybatis%E5%9F%BA%E7%A1%80%E5%BA%94%E7%94%A8/ rel=prev title=MyBatis系列-MyBatis基础应用> <i class="fa fa-angle-left"></i> MyBatis系列-MyBatis基础应用 </a></div><div class=post-nav-item><a href=/2024/08/21/MySQL%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/ rel=next title=MySQL系列-MySQL环境搭建> MySQL系列-MySQL环境搭建 <i class="fa fa-angle-right"></i> </a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>© <span itemprop=copyrightYear>2024</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>豪哥</span></div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label=返回顶部 class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script crossorigin=anonymous integrity=sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY= src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js></script><script src=/js/comments.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/sidebar.js></script><script src=/js/next-boot.js></script><script crossorigin=anonymous integrity=sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc= src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js></script><script src=/js/third-party/search/local-search.js></script>