<!doctypehtml><html lang=zh-CN><meta charset=UTF-8><meta content=width=device-width name=viewport><meta media="(prefers-color-scheme: light)" content=#222 name=theme-color><meta media="(prefers-color-scheme: dark)" content=#222 name=theme-color><meta content="Hexo 7.3.0" name=generator><link href=/images/apple-touch-icon-next.png rel=apple-touch-icon sizes=180x180><link href=/images/favicon-32x32-next.png rel=icon sizes=32x32 type=image/png><link href=/images/favicon-16x16-next.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><link href=/css/main.css rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css integrity=sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA= rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css integrity=sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE= rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"hgprivate.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src=/js/config.js></script><meta content="0、前言0.1、软件设计基本原则 高内聚，低耦合； 面向抽象编程； 多用组合少用继承； 遵循开闭原则；  0.2、设计模式引入设计模式是计算机软件领域较抽象的东西，设计模式的作用：使 软件系统 变得 更加稳定、更易扩展、更易维护。 0.3、设计模式简介设计模式不分语言，共23种，分3种类型：创建型、行为型、结构型。 1、设计模式1.1、创建型（5种）1.1.1、Singleton（单例模式）简介保" name=description><meta content=article property=og:type><meta content=Java系列-设计模式 property=og:title><meta content=https://hgprivate.github.io/2024/08/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/index.html property=og:url><meta content=豪哥博客 property=og:site_name><meta content="0、前言0.1、软件设计基本原则 高内聚，低耦合； 面向抽象编程； 多用组合少用继承； 遵循开闭原则；  0.2、设计模式引入设计模式是计算机软件领域较抽象的东西，设计模式的作用：使 软件系统 变得 更加稳定、更易扩展、更易维护。 0.3、设计模式简介设计模式不分语言，共23种，分3种类型：创建型、行为型、结构型。 1、设计模式1.1、创建型（5种）1.1.1、Singleton（单例模式）简介保" property=og:description><meta content=zh_CN property=og:locale><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/06/image-20210420203056818.png?token=AIGEF3L6P4ZSWPM3RWVOD3LEZZZVE property=og:image><meta content=2024-08-21T13:39:14.974Z property=article:published_time><meta content=2023-10-05T08:13:04.630Z property=article:modified_time><meta content=豪哥 property=article:author><meta content=设计模式 property=article:tag><meta content=summary name=twitter:card><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/06/image-20210420203056818.png?token=AIGEF3L6P4ZSWPM3RWVOD3LEZZZVE name=twitter:image><link href=https://hgprivate.github.io/2024/08/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://hgprivate.github.io/2024/08/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/","path":"2024/08/21/设计模式知识点总结/","title":"Java系列-设计模式"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>Java系列-设计模式 | 豪哥博客</title><noscript><link href=/css/noscript.css rel=stylesheet></noscript><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label=切换导航栏 class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <p class=site-title>豪哥博客</p> <i class=logo-line></i> </a><p class=site-subtitle itemprop=description>豪哥博客</div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=搜索 role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>分类</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>搜索 </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=搜索... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-1"><a class=nav-link href=#0%E3%80%81%E5%89%8D%E8%A8%80><span class=nav-number>1.</span> <span class=nav-text>0、前言</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#0-1%E3%80%81%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1%E5%9F%BA%E6%9C%AC%E5%8E%9F%E5%88%99><span class=nav-number>1.1.</span> <span class=nav-text>0.1、软件设计基本原则</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#0-2%E3%80%81%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%BC%95%E5%85%A5><span class=nav-number>1.2.</span> <span class=nav-text>0.2、设计模式引入</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#0-3%E3%80%81%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AE%80%E4%BB%8B><span class=nav-number>1.3.</span> <span class=nav-text>0.3、设计模式简介</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link href=#1%E3%80%81%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F><span class=nav-number>2.</span> <span class=nav-text>1、设计模式</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#1-1%E3%80%81%E5%88%9B%E5%BB%BA%E5%9E%8B%EF%BC%885%E7%A7%8D%EF%BC%89><span class=nav-number>2.1.</span> <span class=nav-text>1.1、创建型（5种）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#1-1-1%E3%80%81Singleton%EF%BC%88%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.1.1.</span> <span class=nav-text>1.1.1、Singleton（单例模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B><span class=nav-number>2.1.1.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9E%E7%8E%B0><span class=nav-number>2.1.1.2.</span> <span class=nav-text>实现</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8><span class=nav-number>2.1.1.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9><span class=nav-number>2.1.1.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B><span class=nav-number>2.1.1.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF><span class=nav-number>2.1.1.6.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9><span class=nav-number>2.1.1.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B><span class=nav-number>2.1.1.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-1-2%E3%80%81AbstractFactory%EF%BC%88%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%EF%BC%89><span class=nav-number>2.1.2.</span> <span class=nav-text>1.1.2、AbstractFactory（抽象工厂）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89><span class=nav-number>2.1.2.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-1><span class=nav-number>2.1.2.2.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-1><span class=nav-number>2.1.2.3.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF><span class=nav-number>2.1.2.4.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-1><span class=nav-number>2.1.2.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-1><span class=nav-number>2.1.2.6.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#QA><span class=nav-number>2.1.2.7.</span> <span class=nav-text>QA</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-1><span class=nav-number>2.1.2.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-1-3%E3%80%81FactoryMethod%EF%BC%88%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%EF%BC%89><span class=nav-number>2.1.3.</span> <span class=nav-text>1.1.3、FactoryMethod（工厂方法）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-1><span class=nav-number>2.1.3.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-2><span class=nav-number>2.1.3.2.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-2><span class=nav-number>2.1.3.3.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-1><span class=nav-number>2.1.3.4.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-2><span class=nav-number>2.1.3.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%BA%90%E7%A0%81%E5%BA%94%E7%94%A8><span class=nav-number>2.1.3.6.</span> <span class=nav-text>源码应用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-2><span class=nav-number>2.1.3.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-2><span class=nav-number>2.1.3.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-1-4%E3%80%81Builder%EF%BC%88%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.1.4.</span> <span class=nav-text>1.1.4、Builder（建造者模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-2><span class=nav-number>2.1.4.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-3><span class=nav-number>2.1.4.2.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-3><span class=nav-number>2.1.4.3.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-2><span class=nav-number>2.1.4.4.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-3><span class=nav-number>2.1.4.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%BA%90%E7%A0%81%E5%BA%94%E7%94%A8-1><span class=nav-number>2.1.4.6.</span> <span class=nav-text>源码应用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-3><span class=nav-number>2.1.4.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-3><span class=nav-number>2.1.4.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-1-5%E3%80%81Prototype%EF%BC%88%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.1.5.</span> <span class=nav-text>1.1.5、Prototype（原型模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-3><span class=nav-number>2.1.5.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-4><span class=nav-number>2.1.5.2.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-4><span class=nav-number>2.1.5.3.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-3><span class=nav-number>2.1.5.4.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-4><span class=nav-number>2.1.5.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%BA%90%E7%A0%81%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8><span class=nav-number>2.1.5.6.</span> <span class=nav-text>源码中的应用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-4><span class=nav-number>2.1.5.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-4><span class=nav-number>2.1.5.8.</span> <span class=nav-text>代码实例</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#1-2%E3%80%81%E8%A1%8C%E4%B8%BA%E5%9E%8B%EF%BC%8811%E7%A7%8D%EF%BC%89><span class=nav-number>2.2.</span> <span class=nav-text>1.2、行为型（11种）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-1%E3%80%81Iterator%EF%BC%88%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.1.</span> <span class=nav-text>1.2.1、Iterator（迭代器模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-4><span class=nav-number>2.2.1.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-5><span class=nav-number>2.2.1.2.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9E%E7%8E%B0-1><span class=nav-number>2.2.1.3.</span> <span class=nav-text>实现</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-5><span class=nav-number>2.2.1.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-4><span class=nav-number>2.2.1.5.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-5><span class=nav-number>2.2.1.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-5><span class=nav-number>2.2.1.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-5><span class=nav-number>2.2.1.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-2%E3%80%81Observer%EF%BC%88%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.2.</span> <span class=nav-text>1.2.2、Observer（观察者模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-5><span class=nav-number>2.2.2.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-6><span class=nav-number>2.2.2.2.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-6><span class=nav-number>2.2.2.3.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-5><span class=nav-number>2.2.2.4.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-6><span class=nav-number>2.2.2.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%BA%90%E7%A0%81%E5%BA%94%E7%94%A8-2><span class=nav-number>2.2.2.6.</span> <span class=nav-text>源码应用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-6><span class=nav-number>2.2.2.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-6><span class=nav-number>2.2.2.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-3%E3%80%81TemplateMethod%EF%BC%88%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%EF%BC%89><span class=nav-number>2.2.3.</span> <span class=nav-text>1.2.3、TemplateMethod（模板方法）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-6><span class=nav-number>2.2.3.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-7><span class=nav-number>2.2.3.2.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-7><span class=nav-number>2.2.3.3.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-6><span class=nav-number>2.2.3.4.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-7><span class=nav-number>2.2.3.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-7><span class=nav-number>2.2.3.6.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-7><span class=nav-number>2.2.3.7.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-4%E3%80%81Strategy%EF%BC%88%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.4.</span> <span class=nav-text>1.2.4、Strategy（策略模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-7><span class=nav-number>2.2.4.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-8><span class=nav-number>2.2.4.2.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-8><span class=nav-number>2.2.4.3.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-7><span class=nav-number>2.2.4.4.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-8><span class=nav-number>2.2.4.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-8><span class=nav-number>2.2.4.6.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-8><span class=nav-number>2.2.4.7.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-5%E3%80%81ChainOfResponsibility%EF%BC%88%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.5.</span> <span class=nav-text>1.2.5、ChainOfResponsibility（职责链模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-8><span class=nav-number>2.2.5.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-9><span class=nav-number>2.2.5.2.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-9><span class=nav-number>2.2.5.3.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-8><span class=nav-number>2.2.5.4.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-9><span class=nav-number>2.2.5.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%BA%90%E7%A0%81%E5%BA%94%E7%94%A8-3><span class=nav-number>2.2.5.6.</span> <span class=nav-text>源码应用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-9><span class=nav-number>2.2.5.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-9><span class=nav-number>2.2.5.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-6%E3%80%81Mediator%EF%BC%88%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.6.</span> <span class=nav-text>1.2.6、Mediator（中介者模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-9><span class=nav-number>2.2.6.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-10><span class=nav-number>2.2.6.2.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-10><span class=nav-number>2.2.6.3.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-9><span class=nav-number>2.2.6.4.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-10><span class=nav-number>2.2.6.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-10><span class=nav-number>2.2.6.6.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-10><span class=nav-number>2.2.6.7.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-7%E3%80%81Interpreter%EF%BC%88%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.7.</span> <span class=nav-text>1.2.7、Interpreter（解释器模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-10><span class=nav-number>2.2.7.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-11><span class=nav-number>2.2.7.2.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-11><span class=nav-number>2.2.7.3.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-10><span class=nav-number>2.2.7.4.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-11><span class=nav-number>2.2.7.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-11><span class=nav-number>2.2.7.6.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-11><span class=nav-number>2.2.7.7.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-8%E3%80%81Command%EF%BC%88%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.8.</span> <span class=nav-text>1.2.8、Command（命令模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-11><span class=nav-number>2.2.8.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-12><span class=nav-number>2.2.8.2.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-12><span class=nav-number>2.2.8.3.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-11><span class=nav-number>2.2.8.4.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-12><span class=nav-number>2.2.8.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-12><span class=nav-number>2.2.8.6.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-12><span class=nav-number>2.2.8.7.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-9%E3%80%81State%EF%BC%88%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.9.</span> <span class=nav-text>1.2.9、State（状态模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-12><span class=nav-number>2.2.9.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-13><span class=nav-number>2.2.9.2.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-13><span class=nav-number>2.2.9.3.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-12><span class=nav-number>2.2.9.4.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-13><span class=nav-number>2.2.9.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-13><span class=nav-number>2.2.9.6.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-13><span class=nav-number>2.2.9.7.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-10%E3%80%81Visitor%EF%BC%88%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.10.</span> <span class=nav-text>1.2.10、Visitor（访问者模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-13><span class=nav-number>2.2.10.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-14><span class=nav-number>2.2.10.2.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-14><span class=nav-number>2.2.10.3.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-13><span class=nav-number>2.2.10.4.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-14><span class=nav-number>2.2.10.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-14><span class=nav-number>2.2.10.6.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-14><span class=nav-number>2.2.10.7.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-11%E3%80%81Memento%EF%BC%88%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.11.</span> <span class=nav-text>1.2.11、Memento（备忘录模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-14><span class=nav-number>2.2.11.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-15><span class=nav-number>2.2.11.2.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-15><span class=nav-number>2.2.11.3.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-14><span class=nav-number>2.2.11.4.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-15><span class=nav-number>2.2.11.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-15><span class=nav-number>2.2.11.6.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-15><span class=nav-number>2.2.11.7.</span> <span class=nav-text>代码实例</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#1-3%E3%80%81%E7%BB%93%E6%9E%84%E5%9E%8B%EF%BC%887%E7%A7%8D%EF%BC%89><span class=nav-number>2.3.</span> <span class=nav-text>1.3、结构型（7种）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#1-3-1%E3%80%81Composite%EF%BC%88%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.3.1.</span> <span class=nav-text>1.3.1、Composite（组合模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-15><span class=nav-number>2.3.1.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-16><span class=nav-number>2.3.1.2.</span> <span class=nav-text>何时使用</span></a><ol class=nav-child><li class="nav-item nav-level-5"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-16><span class=nav-number>2.3.1.2.1.</span> <span class=nav-text>优缺点</span></a></ol><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-15><span class=nav-number>2.3.1.3.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-16><span class=nav-number>2.3.1.4.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-16><span class=nav-number>2.3.1.5.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-16><span class=nav-number>2.3.1.6.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-3-2%E3%80%81Facade%EF%BC%88%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.3.2.</span> <span class=nav-text>1.3.2、Facade（外观模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-16><span class=nav-number>2.3.2.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-17><span class=nav-number>2.3.2.2.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-17><span class=nav-number>2.3.2.3.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-16><span class=nav-number>2.3.2.4.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-17><span class=nav-number>2.3.2.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-17><span class=nav-number>2.3.2.6.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-17><span class=nav-number>2.3.2.7.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-3-3%E3%80%81Proxy%EF%BC%88%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.3.3.</span> <span class=nav-text>1.3.3、Proxy（代理模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-17><span class=nav-number>2.3.3.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9E%E7%8E%B0-2><span class=nav-number>2.3.3.2.</span> <span class=nav-text>实现</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-18><span class=nav-number>2.3.3.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-18><span class=nav-number>2.3.3.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-17><span class=nav-number>2.3.3.5.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-18><span class=nav-number>2.3.3.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-18><span class=nav-number>2.3.3.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-18><span class=nav-number>2.3.3.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-3-4%E3%80%81Adpter%EF%BC%88%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.3.4.</span> <span class=nav-text>1.3.4、Adpter（适配器模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-18><span class=nav-number>2.3.4.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9E%E7%8E%B0-3><span class=nav-number>2.3.4.2.</span> <span class=nav-text>实现</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-19><span class=nav-number>2.3.4.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-19><span class=nav-number>2.3.4.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-18><span class=nav-number>2.3.4.5.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-19><span class=nav-number>2.3.4.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%BA%90%E7%A0%81%E5%BA%94%E7%94%A8-4><span class=nav-number>2.3.4.7.</span> <span class=nav-text>源码应用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-19><span class=nav-number>2.3.4.8.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-19><span class=nav-number>2.3.4.9.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-3-5%E3%80%81Decorator%EF%BC%88%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.3.5.</span> <span class=nav-text>1.3.5、Decorator（装饰模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-19><span class=nav-number>2.3.5.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-20><span class=nav-number>2.3.5.2.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-20><span class=nav-number>2.3.5.3.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-19><span class=nav-number>2.3.5.4.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-20><span class=nav-number>2.3.5.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%BA%90%E7%A0%81%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8-1><span class=nav-number>2.3.5.6.</span> <span class=nav-text>源码中的应用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-20><span class=nav-number>2.3.5.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-20><span class=nav-number>2.3.5.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-3-6%E3%80%81Bridge%EF%BC%88%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.3.6.</span> <span class=nav-text>1.3.6、Bridge（桥接模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-20><span class=nav-number>2.3.6.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-21><span class=nav-number>2.3.6.2.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-21><span class=nav-number>2.3.6.3.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-20><span class=nav-number>2.3.6.4.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-21><span class=nav-number>2.3.6.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-21><span class=nav-number>2.3.6.6.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-21><span class=nav-number>2.3.6.7.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-3-7%E3%80%81Flyweight%EF%BC%88%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.3.7.</span> <span class=nav-text>1.3.7、Flyweight（享元模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-21><span class=nav-number>2.3.7.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-22><span class=nav-number>2.3.7.2.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-22><span class=nav-number>2.3.7.3.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-21><span class=nav-number>2.3.7.4.</span> <span class=nav-text>应用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-22><span class=nav-number>2.3.7.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%BA%90%E7%A0%81%E5%BA%94%E7%94%A8-5><span class=nav-number>2.3.7.6.</span> <span class=nav-text>源码应用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-22><span class=nav-number>2.3.7.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-22><span class=nav-number>2.3.7.8.</span> <span class=nav-text>代码实例</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#1-4%E3%80%81%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB><span class=nav-number>2.4.</span> <span class=nav-text>1.4、设计模式间的关系</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link href=#2%E3%80%81%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%8E%9F%E5%88%99><span class=nav-number>3.</span> <span class=nav-text>2、设计模式原则</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#2-1%E3%80%81%E5%BC%80%E9%97%AD%E5%8E%9F%E5%88%99%EF%BC%88OCP%EF%BC%89><span class=nav-number>3.1.</span> <span class=nav-text>2.1、开闭原则（OCP）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#2-1-1%E3%80%81%E7%AE%80%E4%BB%8B><span class=nav-number>3.1.1.</span> <span class=nav-text>2.1.1、简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#2-1-2%E3%80%81%E5%88%86%E7%B1%BB><span class=nav-number>3.1.2.</span> <span class=nav-text>2.1.2、分类</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#2-2%E3%80%81%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E5%8E%9F%E5%88%99%EF%BC%88SRP%EF%BC%89><span class=nav-number>3.2.</span> <span class=nav-text>2.2、单一职责原则（SRP）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#2-2-1%E3%80%81%E7%AE%80%E4%BB%8B><span class=nav-number>3.2.1.</span> <span class=nav-text>2.2.1、简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#2-2-2%E3%80%81%E9%97%AE%E9%A2%98%E7%94%B1%E6%9D%A5><span class=nav-number>3.2.2.</span> <span class=nav-text>2.2.2、问题由来</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#2-2-3%E3%80%81%E4%BA%A7%E7%94%9F%E5%8E%9F%E5%9B%A0><span class=nav-number>3.2.3.</span> <span class=nav-text>2.2.3、产生原因</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#2-2-4%E3%80%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95><span class=nav-number>3.2.4.</span> <span class=nav-text>2.2.4、解决方法</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#2-3%E3%80%81%E4%BE%9D%E8%B5%96%E5%80%92%E7%BD%AE%E5%8E%9F%E5%88%99%EF%BC%88DIP%EF%BC%89><span class=nav-number>3.3.</span> <span class=nav-text>2.3、依赖倒置原则（DIP）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#2-3-1%E3%80%81%E7%AE%80%E4%BB%8B><span class=nav-number>3.3.1.</span> <span class=nav-text>2.3.1、简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#2-3-2%E3%80%81%E6%84%8F%E5%9B%BE><span class=nav-number>3.3.2.</span> <span class=nav-text>2.3.2、意图</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#2-3-3%E3%80%81%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9><span class=nav-number>3.3.3.</span> <span class=nav-text>2.3.3、注意事项</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#2-4%E3%80%81%E6%8E%A5%E5%8F%A3%E9%9A%94%E7%A6%BB%E5%8E%9F%E5%88%99%EF%BC%88ISP%EF%BC%89><span class=nav-number>3.4.</span> <span class=nav-text>2.4、接口隔离原则（ISP）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#2-4-1%E3%80%81%E7%AE%80%E4%BB%8B><span class=nav-number>3.4.1.</span> <span class=nav-text>2.4.1、简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#2-4-2%E3%80%81%E4%BC%98%E7%82%B9><span class=nav-number>3.4.2.</span> <span class=nav-text>2.4.2、优点</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#2-5%E3%80%81%E9%87%8C%E6%B0%8F%E6%9B%BF%E6%8D%A2%E5%8E%9F%E5%88%99%EF%BC%88LSP%EF%BC%89><span class=nav-number>3.5.</span> <span class=nav-text>2.5、里氏替换原则（LSP）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#2-5-1%E3%80%81%E7%AE%80%E4%BB%8B><span class=nav-number>3.5.1.</span> <span class=nav-text>2.5.1、简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#2-5-2%E3%80%81%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9><span class=nav-number>3.5.2.</span> <span class=nav-text>2.5.2、注意事项</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#2-6%E3%80%81%E8%BF%AA%E7%B1%B3%E7%89%B9%E5%8E%9F%E5%88%99%EF%BC%88LOD%EF%BC%89><span class=nav-number>3.6.</span> <span class=nav-text>2.6、迪米特原则（LOD）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#2-6-1%E3%80%81%E7%AE%80%E4%BB%8B><span class=nav-number>3.6.1.</span> <span class=nav-text>2.6.1、简介</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#2-7%E3%80%81%E5%90%88%E6%88%90%E5%A4%8D%E7%94%A8%E5%8E%9F%E5%88%99%EF%BC%88CRP%EF%BC%89><span class=nav-number>3.7.</span> <span class=nav-text>2.7、合成复用原则（CRP）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#2-7-1%E3%80%81%E7%AE%80%E4%BB%8B><span class=nav-number>3.7.1.</span> <span class=nav-text>2.7.1、简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#2-7-2%E3%80%81%E4%BC%98%E7%82%B9><span class=nav-number>3.7.2.</span> <span class=nav-text>2.7.2、优点</span></a></ol></ol></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><img alt=豪哥 class=site-author-image itemprop=image src=/static/imgs/avatar.png><p class=site-author-name itemprop=name>豪哥<div class=site-description itemprop=description>豪哥博客</div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>117</span> <span class=site-state-item-name>日志</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>36</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/> <span class=site-state-item-count>129</span> <span class=site-state-item-name>标签</span></a></div></nav></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article lang=zh-CN><link href=https://hgprivate.github.io/2024/08/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/static/imgs/avatar.png itemprop=image> <meta content=豪哥 itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=豪哥博客 itemprop=name> <meta content=豪哥博客 itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="Java系列-设计模式 | 豪哥博客" itemprop=name> <meta itemprop=description> </span><header class=post-header><h1 itemprop="name headline" class=post-title>Java系列-设计模式</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2024-08-21 21:39:14" datetime=2024-08-21T21:39:14+08:00>2024-08-21</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-10-05 16:13:04" datetime=2023-10-05T16:13:04+08:00 itemprop=dateModified>2023-10-05</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/ itemprop=url rel=index><span itemprop=name>设计模式</span></a> </span> </span></div></div></header><div class=post-body itemprop=articleBody><h1 id=0、前言><a class=headerlink href=#0、前言 title=0、前言></a>0、前言</h1><h2 id=0-1、软件设计基本原则><a class=headerlink href=#0-1、软件设计基本原则 title=0.1、软件设计基本原则></a>0.1、软件设计基本原则</h2><ol><li>高内聚，低耦合；<li>面向抽象编程；<li>多用组合少用继承；<li>遵循开闭原则；</ol><h2 id=0-2、设计模式引入><a class=headerlink href=#0-2、设计模式引入 title=0.2、设计模式引入></a>0.2、设计模式引入</h2><p>设计模式是计算机软件领域较抽象的东西，设计模式的作用：使 软件系统 变得 更加稳定、更易扩展、更易维护。<h2 id=0-3、设计模式简介><a class=headerlink href=#0-3、设计模式简介 title=0.3、设计模式简介></a>0.3、设计模式简介</h2><p><strong>设计模式不分语言，共23种，分3种类型：创建型、行为型、结构型</strong>。<h1 id=1、设计模式><a class=headerlink href=#1、设计模式 title=1、设计模式></a>1、设计模式</h1><h2 id=1-1、创建型（5种）><a class=headerlink href=#1-1、创建型（5种） title=1.1、创建型（5种）></a>1.1、创建型（5种）</h2><h3 id=1-1-1、Singleton（单例模式）><a class=headerlink href=#1-1-1、Singleton（单例模式） title=1.1.1、Singleton（单例模式）></a>1.1.1、Singleton（单例模式）</h3><h4 id=简介><a class=headerlink href=#简介 title=简介></a>简介</h4><p><strong>保证一个类仅有一个实例，并提供一个访问它的全局访问点。常见单例模式实现有：饿汉式、懒汉式、枚举式等</strong>。<h4 id=实现><a class=headerlink href=#实现 title=实现></a>实现</h4><ol><li>构造方法设为私有，禁止它人创建对象。</ol><h4 id=何时使用><a class=headerlink href=#何时使用 title=何时使用></a>何时使用</h4><p>当您想控制实例数目，节省系统资源的时候。<h4 id=优缺点><a class=headerlink href=#优缺点 title=优缺点></a>优缺点</h4><ul><li><p>优点：</p> <ol><li>在内存里只有一个实例，减少了内存的开销，尤其是频繁的创建和销毁实例（比如管理学院首页页面缓存）。<li>避免对资源的多重占用（比如写文件操作）。</ol><li><p>缺点：</p> <p>没有接口，不能继承，与单一职责原则冲突，一个类应该只关心内部逻辑，而不关心外面怎么样来实例化。</p></ul><h4 id=应用实例><a class=headerlink href=#应用实例 title=应用实例></a>应用实例</h4><ol><li>一个班级只有一个班主任。<li>Windows 是多进程多线程的，在操作一个文件的时候，就不可避免地出现多个进程或线程同时操作一个文件的现象，所以所有文件的处理必须通过唯一的实例来进行。<li>一些设备管理器常常设计为单例模式，比如一个电脑有两台打印机，在输出的时候就要处理不能两台打印机打印同一个文件。</ol><h4 id=使用场景><a class=headerlink href=#使用场景 title=使用场景></a>使用场景</h4><ol><li>要求生产唯一序列号。<li>WEB 中的计数器，不用每次刷新都在数据库里加一次，用单例先缓存起来。<li>创建一个对象消耗资源过多时可通过单例降低多次创建带来的消耗，比如 I/O 与数据库的连接等。</ol><h4 id=注意事项><a class=headerlink href=#注意事项 title=注意事项></a>注意事项</h4><ol><li><font color=red>注意序列化对单例的破坏；</font><li><font color=red>注意反射对单例的破坏；</font></ol><h4 id=代码实例><a class=headerlink href=#代码实例 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br></pre><td class=code><pre><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 实例一：基于双重校验锁方式实现单例</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * - 优点：懒加载，效率较好。</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * - 缺点：反序列化会对单例造成破坏</span></span><br><span class=line><span class=comment> *   应对方案：要想防止序列化对单例的破坏，只要添加readResolve方法就可避免。</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Singleton</span> <span class=keyword>implements</span> <span class="title class_">Serializable</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>volatile</span> <span class=keyword>static</span> Singleton singleton;</span><br><span class=line>    <span class=keyword>private</span> <span class="title function_">Singleton</span> <span class=params>()</span>{}</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> Singleton <span class="title function_">getSingleton</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>if</span> (singleton == <span class=literal>null</span>) {</span><br><span class=line>            <span class=keyword>synchronized</span> (Singleton.class) {</span><br><span class=line>                <span class=keyword>if</span> (singleton == <span class=literal>null</span>) {</span><br><span class=line>                    singleton = <span class=keyword>new</span> <span class="title class_">Singleton</span>();</span><br><span class=line>                }</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> singleton;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>private</span> Object <span class="title function_">readResolve</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> singleton;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 实例二：基于 CAS 实现单例</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * - 优点：</span></span><br><span class=line><span class=comment> *   - 不需要使用传统的锁机制来保证线程安全；</span></span><br><span class=line><span class=comment> *   - 相对于锁它没有线程切换和阻塞的额外消耗,可以支持较大的并行度；</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * - 缺点：</span></span><br><span class=line><span class=comment> *   - 如果等待一直执行不成功(一直在死循环中)，会对CPU造成较大的执行开销；</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">SingletonByCAS</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>static</span> <span class=keyword>final</span> AtomicReference&LTSingletonByCAS> INSTANCE = <span class=keyword>new</span> <span class="title class_">AtomicReference</span>&LTSingletonByCAS>();</span><br><span class=line>    <span class=keyword>private</span> <span class="title function_">SingletonByCAS</span><span class=params>()</span>{}</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> SingletonByCAS <span class="title function_">getInstance</span><span class=params>()</span>{</span><br><span class=line>        <span class=keyword>for</span> (;;){</span><br><span class=line>            <span class=type>SingletonByCAS</span> <span class=variable>single</span> <span class=operator>=</span> INSTANCE.get();</span><br><span class=line>            <span class=keyword>if</span> (<span class=literal>null</span> != single){</span><br><span class=line>                <span class=keyword>return</span> single;</span><br><span class=line>            }</span><br><span class=line>            single = <span class=keyword>new</span> <span class="title class_">SingletonByCAS</span>();</span><br><span class=line>            <span class=keyword>if</span> (INSTANCE.compareAndSet(<span class=literal>null</span>, single)){</span><br><span class=line>                <span class=keyword>return</span> single;</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 实例三：基于 枚举 实现单例</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>enum</span> <span class="title class_">SingletonByEnum</span> {</span><br><span class=line>    INSTANCE;</span><br><span class=line>    <span class=comment>// 其它方法</span></span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 实例四：基于双重校验锁方式实现单例（优化版）</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * - 优点：懒加载，利用局部变量提高效率；</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * - 缺点：反序列化会对单例造成破坏</span></span><br><span class=line><span class=comment> *   应对方案：要想防止序列化对单例的破坏，只要添加readResolve方法就可避免。</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">SingletonByLocalVariable</span> <span class=keyword>implements</span> <span class="title class_">Serializable</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>volatile</span> <span class=keyword>static</span> SingletonByLocalVariable singleton;</span><br><span class=line>    <span class=keyword>private</span> <span class="title function_">SingletonByLocalVariable</span><span class=params>()</span>{}</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> SingletonByLocalVariable <span class="title function_">getSingleton</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>SingletonByLocalVariable</span> <span class=variable>tmp</span> <span class=operator>=</span> singleton;</span><br><span class=line>        <span class=keyword>if</span> (tmp == <span class=literal>null</span>) {</span><br><span class=line>            <span class=keyword>synchronized</span> (SingletonByLocalVariable.class) {</span><br><span class=line>                tmp = singleton;</span><br><span class=line>                <span class=keyword>if</span> (tmp == <span class=literal>null</span>) {</span><br><span class=line>                    tmp = <span class=keyword>new</span> <span class="title class_">SingletonByLocalVariable</span>();</span><br><span class=line>                    singleton = tmp;</span><br><span class=line>                }</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> singleton;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>private</span> Object <span class="title function_">readResolve</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> singleton;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 实例五：基于静态内部类实现单例</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * - 原理：利用了classloder的机制来保证初始化instance时只有一个线程。</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * - 优点：这是一种懒加载，就是说Singleton类被装载了，instance不一定被初始化。</span></span><br><span class=line><span class=comment> *        因为SingletonHolder类没有被主动使用，只有显式调用getInstance方法时，</span></span><br><span class=line><span class=comment> *        才会装载SingletonHolder类，从而实例化instance。</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">SingletonByStaticInnerClass</span> {</span><br><span class=line>    <span class=comment>// 私有构造，禁止通过new创建对象。</span></span><br><span class=line>    <span class=keyword>private</span> <span class="title function_">SingletonByStaticInnerClass</span><span class=params>()</span>{</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>static</span> <span class=keyword>class</span> <span class="title class_">SingletonHholder</span>{</span><br><span class=line>        <span class=keyword>private</span> <span class=keyword>static</span> <span class=keyword>final</span> <span class=type>SingletonByStaticInnerClass</span> <span class=variable>INSTANCE</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">SingletonByStaticInnerClass</span>();</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>final</span> SingletonByStaticInnerClass <span class="title function_">getInstance</span><span class=params>()</span>{</span><br><span class=line>        <span class=keyword>return</span> SingletonHholder.INSTANCE;</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-1-2、AbstractFactory（抽象工厂）><a class=headerlink href=#1-1-2、AbstractFactory（抽象工厂） title=1.1.2、AbstractFactory（抽象工厂）></a>1.1.2、AbstractFactory（抽象工厂）</h3><h4 id=定义><a class=headerlink href=#定义 title=定义></a>定义</h4><p><strong>任何可以生成对象的方法或类，都可以称之为工厂。单例也是一个工厂</strong>。主要解决接口选择问题。<h4 id=何时使用-1><a class=headerlink href=#何时使用-1 title=何时使用></a>何时使用</h4><p>系统产品有多于一个的产品族，而系统只消费其中某一族的产品。<h4 id=优缺点-1><a class=headerlink href=#优缺点-1 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>可以实现从工厂得到的产品彼此兼容。<li>可以避免具体产品和客户端代码之间的紧密耦合。<li>符合单一职责原则。<li>符合开闭原则。</ol><li>缺点<ol><li>产品族扩展非常困难，要增加一个系列的某一产品，既要在抽象的 Creator 里加代码，又要在具体实现中加代码。</ol></ul><h4 id=应用场景><a class=headerlink href=#应用场景 title=应用场景></a>应用场景</h4><ol><li>QQ 换皮肤，一整套一起换。<li>生成不同操作系统对应的程序。</ol><h4 id=应用实例-1><a class=headerlink href=#应用实例-1 title=应用实例></a>应用实例</h4><p>为了参加一些聚会，肯定有两套或多套衣服吧，比如说有商务装（成套，一系列具体产品）、时尚装（成套，一系列具体产品），对于一个家庭来说，可能有商务女装、商务男装、时尚女装、时尚男装，这些都是成套的，即一系列具体产品。<p>假设一种情况，在您的家中，某一个衣柜（具体工厂）只能存放某一种衣服（成套，一系列具体产品），每次拿这种成套衣服时自然要从这个衣柜中取出。用 OO 的思想去理解，所有的衣柜（具体工厂）都是衣柜类的（抽象工厂）某一个，而每一件成套的衣服又包括具体的上衣（某一具体产品），裤子（某一具体产品），这些具体的上衣其实也都是上衣（抽象产品），具体的裤子也都是裤子（另一个抽象产品）。<h4 id=注意事项-1><a class=headerlink href=#注意事项-1 title=注意事项></a>注意事项</h4><p>产品族难扩展，产品等级易扩展。<h4 id=QA><a class=headerlink href=#QA title=QA></a>QA</h4><ol><li><p>为何还需要工厂?</p> <ol><li>灵活控制生产过程。<li>权限、修饰、日志等。</ol></ol><h4 id=代码实例-1><a class=headerlink href=#代码实例-1 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br></pre><td class=code><pre><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 抽象工厂模式</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * 抽象工厂模式以一种倾斜的方式支持增加新的产品，它为新产品族的增加提供</span></span><br><span class=line><span class=comment> * 方便，但不能为新的产品等级结构的增加提供这样的方便。</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * 三种工厂模式之间的关系：</span></span><br><span class=line><span class=comment> *      当抽象工厂模式中每一个具体工厂类只创建一个产品对象，也就是只存</span></span><br><span class=line><span class=comment> *      在一个产品等级结构时，抽象工厂模式退化成工厂方法模式；</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> *      抽象工厂模式与工厂方法模式最大的区别在于，工厂方法模式针对的是</span></span><br><span class=line><span class=comment> *      一个产品等级结构，而抽象工厂模式则需要面对多个产品等级结构。</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> *      当工厂方法模式中抽象工厂与具体工厂合并，提供一个统一的工厂来创</span></span><br><span class=line><span class=comment> *      建产品对象，并将创建对象的工厂方法设计为静态方法时，工厂方法模</span></span><br><span class=line><span class=comment> *      式退化成简单工厂模式。</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * 总结：</span></span><br><span class=line><span class=comment> *      抽象工厂模式是所有工厂模式中最为抽象和最具一般性的一种形态。</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> *      抽象工厂模式的主要优点是隔离了具体类的生成，使得客户并不需要知</span></span><br><span class=line><span class=comment> *      道什么被创建，而且每次可以通过具体工厂类创建一个产品族中的多个</span></span><br><span class=line><span class=comment> *      对象，增加或者替换产品族比较方便，增加新的具体工厂和产品族很方</span></span><br><span class=line><span class=comment> *      便；主要缺点在于增加新的产品等级结构很复杂，需要修改抽象工厂和</span></span><br><span class=line><span class=comment> *      所有具体工厂类，对“开闭原则”的支持呈现倾斜性。</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">App</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>CarFactory</span> <span class=variable>sportCarFactory</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">SportCarFactory</span>();</span><br><span class=line>        <span class=type>TeslaCar</span> <span class=variable>teslaCar</span> <span class=operator>=</span> sportCarFactory.getTeslaCar();</span><br><span class=line>        <span class=type>BenzCar</span> <span class=variable>benzCar</span> <span class=operator>=</span> sportCarFactory.getBenzCar();</span><br><span class=line>        teslaCar.charge();</span><br><span class=line>        benzCar.gasUp();</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-1-3、FactoryMethod（工厂方法）><a class=headerlink href=#1-1-3、FactoryMethod（工厂方法） title=1.1.3、FactoryMethod（工厂方法）></a>1.1.3、FactoryMethod（工厂方法）</h3><h4 id=简介-1><a class=headerlink href=#简介-1 title=简介></a>简介</h4><p><strong>定义一个用于创建对象的接口，让子类决定实例化哪一个类。Factory Method使得一个类的实例化延迟到了子类</strong>。<h4 id=何时使用-2><a class=headerlink href=#何时使用-2 title=何时使用></a>何时使用</h4><p>明确地计划不同条件下创建不同实例。<h4 id=优缺点-2><a class=headerlink href=#优缺点-2 title=优缺点></a>优缺点</h4><ul><li><p>优点</p> <ol><li>将具体产品和创建者解耦。<li>符合单一职责原则。<li>符合开闭原则。</ol><li><p>缺点</p> <p>每次增加一个产品时，都需要增加一个具体类和对象实现工厂，使得系统中类的个数成倍增加，在一定程度上增加了系统的复杂度，同时也增加了系统具体类的依赖。</p></ul><h4 id=应用场景-1><a class=headerlink href=#应用场景-1 title=应用场景></a>应用场景</h4><ol><li>日志记录器：记录可能记录到本地硬盘、系统事件、远程服务器等，用户可以选择记录日志到什么地方。<li>数据库访问，当用户不知道最后系统采用哪一类数据库，以及数据库可能有变化时。<li>设计一个连接服务器的框架，需要三个协议，”POP3”、”IMAP”、”HTTP”，可以把这三个作为产品类，共同实现一个接口。</ol><h4 id=应用实例-2><a class=headerlink href=#应用实例-2 title=应用实例></a>应用实例</h4><ol><li>您需要一辆汽车，可以直接从工厂里面提货，而不用去管这辆汽车是如何生产出来的。<li>Hibernate 换数据库只需换驱动就可以。</ol><h4 id=源码应用><a class=headerlink href=#源码应用 title=源码应用></a>源码应用</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line>Calendar.getInstance();</span><br><span class=line>java.text.NumberFormat.getInstance();</span><br><span class=line>java.util.ResourceBundle.getBundle();</span><br><span class=line></span><br><span class=line>java.net.URLStreamHandlerFactory</span><br><span class=line>java.xml.bind.JAXBContext.createMarshaller</span><br></pre></table></figure><h4 id=注意事项-2><a class=headerlink href=#注意事项-2 title=注意事项></a>注意事项</h4><p><font color=red>在任何需要生成复杂对象的地方，都可以使用工厂方法模式。有一点需要注意：复杂对象适合使用工厂模式，而简单对象不适合。</font><h4 id=代码实例-2><a class=headerlink href=#代码实例-2 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br></pre><td class=code><pre><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 计算器 - 工厂方法模式</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * 工厂方法模式优点：</span></span><br><span class=line><span class=comment> *    1、使用工厂来创建对象，隐藏了具体产品类将被实例化的细节。</span></span><br><span class=line><span class=comment> *    2、能够使工厂可以自主确定创建何种产品对象，而如何创建这个对象的细节则完全</span></span><br><span class=line><span class=comment> *       封装在具体工厂内部。</span></span><br><span class=line><span class=comment> *    3、每种对象对应单独一个工厂，其目的主要为了解耦。</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * 工厂方法模式缺点：</span></span><br><span class=line><span class=comment> *    1、在添加新产品时，需要编写新的具体产品类，而且还要提供与之对应的具体工厂</span></span><br><span class=line><span class=comment> *       类，系统中类的个数将成对增加，这增加了系统的复杂度。</span></span><br><span class=line><span class=comment> *    2、考虑到系统的可扩展性，需要引入抽象层，在客户端代码中均使用抽象层进行定义，</span></span><br><span class=line><span class=comment> *       增加了系统的抽象性和理解难度。且在实现时可能需要用到DOM、反射等技术，</span></span><br><span class=line><span class=comment> *       增加了系统的实现难度。</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">FactoryMethodApp</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>IFactory</span> <span class=variable>factory</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">AddFactory</span>();</span><br><span class=line>        <span class=type>Operation</span> <span class=variable>operationAdd</span> <span class=operator>=</span> factory.createOperation();</span><br><span class=line>        operationAdd.setVal1(<span class=number>15.2</span>);</span><br><span class=line>        operationAdd.setVal2(<span class=number>19.3</span>);</span><br><span class=line>        System.out.println(operationAdd.getResult());</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 计算器 - 简单工厂模式</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * 简单工厂模式优点:</span></span><br><span class=line><span class=comment> *    1、一个调用者想创建一个对象，只要知道其名称就行了。</span></span><br><span class=line><span class=comment> *    2、屏蔽产品的具体实现，调用者只关心产品的接口。</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * 简单工厂模式缺点：</span></span><br><span class=line><span class=comment> *    1、增加新算法时，需要编写一个新类并继承Operation。</span></span><br><span class=line><span class=comment> *    2、同时需要修改OperationFactory类的代码，这违反了“开闭原则”。</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">SimpleFactoryApp</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>Operation</span> <span class=variable>operationAdd</span> <span class=operator>=</span> OperationFactory.create(<span class=string>"+"</span>);</span><br><span class=line>        operationAdd.setVal1(<span class=number>10</span>);</span><br><span class=line>        operationAdd.setVal2(<span class=number>5</span>);</span><br><span class=line>        System.out.println(operationAdd.getResult());</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-1-4、Builder（建造者模式）><a class=headerlink href=#1-1-4、Builder（建造者模式） title=1.1.4、Builder（建造者模式）></a>1.1.4、Builder（建造者模式）</h3><h4 id=简介-2><a class=headerlink href=#简介-2 title=简介></a>简介</h4><p><strong>将一个复杂对象的创建与它的表示分离，使得同样的构建过程可以创建不同的表示</strong>。<h4 id=何时使用-3><a class=headerlink href=#何时使用-3 title=何时使用></a>何时使用</h4><p>一些基本部件不会变，而其组合经常变化的时候。<h4 id=优缺点-3><a class=headerlink href=#优缺点-3 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>建造者独立，易扩展。<li>便于控制细节风险。</ol><li>缺点<ol><li>产品必须有共同点，范围有限制。<li>内部变化复杂，有很多建造类。</ol></ul><h4 id=应用场景-2><a class=headerlink href=#应用场景-2 title=应用场景></a>应用场景</h4><ol><li>需要生成的对象具有复杂的内部结构。<li>需要生成的对象内部属性本身相互依赖。<li>与不可变对象配合使用。</ol><h4 id=应用实例-3><a class=headerlink href=#应用实例-3 title=应用实例></a>应用实例</h4><ol><li>去肯德基，汉堡、可乐、薯条、炸鸡翅等是不变的，而其组合是经常变化的，生成出所谓的 “套餐”。<li>JAVA 中的 StringBuilder。</ol><h4 id=源码应用-1><a class=headerlink href=#源码应用-1 title=源码应用></a>源码应用</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>org.springframework.web.service.mvc.method.RequestMappingInfo</span><br><span class=line>org.springframework.benas.factory.support.BeanDefinitionBuilder</span><br></pre></table></figure><h4 id=注意事项-3><a class=headerlink href=#注意事项-3 title=注意事项></a>注意事项</h4><p><font color=red>与工厂模式的区别：建造者模式更加关注零件装配的顺序。</font><h4 id=代码实例-3><a class=headerlink href=#代码实例-3 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Role</span> {</span><br><span class=line>    <span class=keyword>private</span> String head; <span class=comment>//头部</span></span><br><span class=line>    <span class=keyword>private</span> String face; <span class=comment>//脸部（脸部依赖于头部）</span></span><br><span class=line>    <span class=keyword>private</span> String body; <span class=comment>//身体</span></span><br><span class=line>    <span class=keyword>private</span> Double hp;   <span class=comment>//生命值</span></span><br><span class=line>    <span class=keyword>private</span> Double sp;   <span class=comment>//能量值</span></span><br><span class=line>    <span class=keyword>private</span> Double mp;   <span class=comment>//魔法值</span></span><br><span class=line>    </span><br><span class=line>    <span class=comment>// get/set/toString methods ...</span></span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>class</span> <span class="title class_">Builder</span> {</span><br><span class=line>    <span class=keyword>protected</span> <span class=type>Role</span> <span class=variable>role</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Role</span>();</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>void</span> <span class="title function_">buildHead</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>void</span> <span class="title function_">buildFace</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>void</span> <span class="title function_">buildBody</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>void</span> <span class="title function_">buildHp</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>void</span> <span class="title function_">buildSp</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>void</span> <span class="title function_">buildMp</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>public</span> Role <span class="title function_">getResult</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> role;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">CommonRoleBuilder</span> <span class=keyword>extends</span> <span class="title class_">Builder</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=type>Role</span> <span class=variable>role</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Role</span>();</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">buildHead</span><span class=params>()</span> {</span><br><span class=line>        role.setHead(<span class=string>"common head"</span>);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">buildFace</span><span class=params>()</span> {</span><br><span class=line>        role.setFace(<span class=string>"common face"</span>);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">buildBody</span><span class=params>()</span> {</span><br><span class=line>        role.setBody(<span class=string>"common body"</span>);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">buildHp</span><span class=params>()</span> {</span><br><span class=line>        role.setHp(<span class=number>100d</span>);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">buildSp</span><span class=params>()</span> {</span><br><span class=line>        role.setSp(<span class=number>100d</span>);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">buildMp</span><span class=params>()</span> {</span><br><span class=line>        role.setMp(<span class=number>100d</span>);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Role <span class="title function_">getResult</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> role;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Director</span> {</span><br><span class=line>    <span class=keyword>public</span> Role <span class="title function_">constructAndGet</span><span class=params>(Builder builder)</span>{</span><br><span class=line>        builder.buildBody();</span><br><span class=line>        builder.buildHead();</span><br><span class=line>        builder.buildFace();</span><br><span class=line>        builder.buildHp();</span><br><span class=line>        builder.buildMp();</span><br><span class=line>        builder.buildSp();</span><br><span class=line>        <span class=keyword>return</span> builder.getResult();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 建造者模式</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * 定义：</span></span><br><span class=line><span class=comment> *      建造者模式（英：Builder Pattern）是一种创建型设计模式，又名：</span></span><br><span class=line><span class=comment> *      生成器模式。GOF 给建造者模式的定义为：将一个复杂对象的构建与</span></span><br><span class=line><span class=comment> *      它的表示分离，使得同样的构建过程可以创建不同的表示。这句话说的</span></span><br><span class=line><span class=comment> *      比较抽象，其实解释一下就是：将建造复杂对象的过程和组成对象的部</span></span><br><span class=line><span class=comment> *      件解耦。</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * 建造者模式包含如下角色：</span></span><br><span class=line><span class=comment> *      Builder：抽象建造者</span></span><br><span class=line><span class=comment> *      ConcreteBuilder：具体建造者</span></span><br><span class=line><span class=comment> *      Director：指挥者</span></span><br><span class=line><span class=comment> *      Product：产品角色</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * 优缺点：</span></span><br><span class=line><span class=comment> *      -优点：较好封装性、客户端无需知道产品内部组成的细节、</span></span><br><span class=line><span class=comment> *            可以更精细控制产品的创建过程、容易扩展。</span></span><br><span class=line><span class=comment> *      -缺点：不适合产品间差异大的场景、使用范围受到影响、</span></span><br><span class=line><span class=comment> *             产品内部变化大，可能需要定义很多具体建造者</span></span><br><span class=line><span class=comment> *             来适应，这可能导致系统很庞大。</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * 适用场景：</span></span><br><span class=line><span class=comment> *      1、需要生成的产品对象有复杂的内部结构，这些产品对象通常包含多个</span></span><br><span class=line><span class=comment> *         成员属性。</span></span><br><span class=line><span class=comment> *      2、需要生成的产品对象的属性相互依赖，需要指定其生成顺序。</span></span><br><span class=line><span class=comment> *      3、对象的创建过程独立于创建该对象的类。在建造者模式中引入了指挥</span></span><br><span class=line><span class=comment> *         者类，将创建过程封装在指挥者类中，而不在建造者类中。</span></span><br><span class=line><span class=comment> *      4、隔离复杂对象的创建和使用，并使得相同的创建过程可以创建不同的</span></span><br><span class=line><span class=comment> *         产品。</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">App</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>Builder</span> <span class=variable>commonBuilder</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">CommonRoleBuilder</span>();</span><br><span class=line>        <span class=type>Director</span> <span class=variable>director</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Director</span>();</span><br><span class=line>        <span class=type>Role</span> <span class=variable>commonRole</span> <span class=operator>=</span> director.constructAndGet(commonBuilder);</span><br><span class=line>        System.out.println(commonRole);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-1-5、Prototype（原型模式）><a class=headerlink href=#1-1-5、Prototype（原型模式） title=1.1.5、Prototype（原型模式）></a>1.1.5、Prototype（原型模式）</h3><h4 id=简介-3><a class=headerlink href=#简介-3 title=简介></a>简介</h4><p><strong>原型实例指定创建对象的种类，且通过 拷贝原型 创建新对象</strong>。<p>相关知识点：Cloneable接口/Object.clone方法；浅拷贝/深拷贝；序列化实现深拷贝。<h4 id=何时使用-4><a class=headerlink href=#何时使用-4 title=何时使用></a>何时使用</h4><ol><li>当一个系统应该独立于它的产品创建，构成和表示时。<li>当要实例化的类是在运行时刻指定时，例如，通过动态装载。<li>为了避免创建一个与产品类层次平行的工厂类层次时。<li>当一个类的实例只能由几个不同状态组合中的一种时。建立相应数目的原型并克隆它们可能比每次用合适的状态手工实例化该类更方便一些。</ol><h4 id=优缺点-4><a class=headerlink href=#优缺点-4 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>性能提高。<li>逃避构造函数的约束。<li>可以不耦合具体类的情况下克隆对象。<li>避免重复的初始化代码。<li>更方便的构建复杂对象。</ol><li>缺点<ol><li>设计克隆方法需要对类的功能进行通盘考虑，这对于全新的类不是很难，但对于已有的类不一定很容易，特别当一个类引用不支持串行化的间接对象，或者引用含有循环结构时。<li>必须实现 Cloneable 接口。</ol></ul><h4 id=应用场景-3><a class=headerlink href=#应用场景-3 title=应用场景></a>应用场景</h4><ol><li>资源优化场景；<li>类初始化需要消化非常多的资源；<li>性能和安全要求的场景；<li>通过 new 创建对象需要繁杂步骤时；<li>一个对象有多个修改；<li>当多个对象需要对同一对象执行操作时，可以将共享对象拷贝多个来应付每一个调用者对象；<li>实际开发中，原型模式一般和工厂方法一起使用。工厂方法可以将 原型模式拷贝生成的对象提供给调用者；</ol><h4 id=应用实例-4><a class=headerlink href=#应用实例-4 title=应用实例></a>应用实例</h4><ol><li>细胞分裂。<li>JAVA 中的 Object clone() 方法。</ol><h4 id=源码中的应用><a class=headerlink href=#源码中的应用 title=源码中的应用></a>源码中的应用</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>org.springframework.beans.factory.support.AbstracBeanDefinition</span><br><span class=line>java.util.Arrays</span><br></pre></table></figure><h4 id=注意事项-4><a class=headerlink href=#注意事项-4 title=注意事项></a>注意事项</h4><p><font color=red>原型模式是通过拷贝现有对象来生成新对象。浅拷贝实现 Cloneable，重写，深拷贝通过实现 Serializable 读取二进制流。</font><h4 id=代码实例-4><a class=headerlink href=#代码实例-4 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br></pre><td class=code><pre><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 深拷贝/浅拷贝 测试注意事项：</span></span><br><span class=line><span class=comment> * 1、测试浅拷贝时，去掉Cloneable接口 和 clone方法。</span></span><br><span class=line><span class=comment> * 2、测试深拷贝时，加上Cloneable接口 和 clone方法。</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">PeopleInfo</span> <span class=keyword>implements</span> <span class="title class_">Cloneable</span>{</span><br><span class=line>    <span class=keyword>private</span> <span class=type>int</span> age;</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">PeopleInfo</span><span class=params>(<span class=type>int</span> age)</span> {</span><br><span class=line>        <span class=built_in>this</span>.age = age;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=type>int</span> <span class="title function_">getAge</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> age;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setAge</span><span class=params>(<span class=type>int</span> age)</span> {</span><br><span class=line>        <span class=built_in>this</span>.age = age;</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">toString</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=string>"PeopleInfo{"</span> +</span><br><span class=line>                <span class=string>"age="</span> + age +</span><br><span class=line>                <span class=string>'}'</span>;</span><br><span class=line>    }</span><br><span class=line>    <span class=comment>/** 测试 浅拷贝 时去掉该方法 */</span></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>protected</span> Object <span class="title function_">clone</span><span class=params>()</span> <span class=keyword>throws</span> CloneNotSupportedException {</span><br><span class=line>        <span class=keyword>return</span> <span class=built_in>super</span>.clone();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">People</span> <span class=keyword>implements</span> <span class="title class_">Cloneable</span>{</span><br><span class=line>    <span class=keyword>private</span> PeopleInfo peopleInfo;</span><br><span class=line>    <span class=keyword>private</span> <span class=type>int</span> type; <span class=comment>// 0 / 1</span></span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">People</span><span class=params>()</span>{}</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">People</span><span class=params>(PeopleInfo peopleInfo, <span class=type>int</span> type)</span> {</span><br><span class=line>        <span class=built_in>this</span>.peopleInfo = peopleInfo;</span><br><span class=line>        <span class=built_in>this</span>.type = type;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> PeopleInfo <span class="title function_">getPeopleInfo</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> peopleInfo;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setPeopleInfo</span><span class=params>(PeopleInfo peopleInfo)</span> {</span><br><span class=line>        <span class=built_in>this</span>.peopleInfo = peopleInfo;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=type>int</span> <span class="title function_">getType</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> type;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setType</span><span class=params>(<span class=type>int</span> type)</span> {</span><br><span class=line>        <span class=built_in>this</span>.type = type;</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">toString</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=string>"People{"</span> +</span><br><span class=line>                <span class=string>"peopleInfo="</span> + <span class=built_in>this</span>.getPeopleInfo().toString() +</span><br><span class=line>                <span class=string>", type="</span> + <span class=built_in>this</span>.getType() +</span><br><span class=line>                <span class=string>'}'</span>;</span><br><span class=line>    }</span><br><span class=line>    <span class=comment>/** 浅复制 clone方法实现 */</span></span><br><span class=line><span class=comment>//    @Override</span></span><br><span class=line><span class=comment>//    protected People clone() throws CloneNotSupportedException {</span></span><br><span class=line><span class=comment>//        return (People) super.clone();</span></span><br><span class=line><span class=comment>//    }</span></span><br><span class=line></span><br><span class=line>    <span class=comment>/** 深复制 clone方法实现 */</span></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>protected</span> People <span class="title function_">clone</span><span class=params>()</span> <span class=keyword>throws</span> CloneNotSupportedException {</span><br><span class=line>        <span class=type>People</span> <span class=variable>people</span> <span class=operator>=</span> (People) <span class=built_in>super</span>.clone();</span><br><span class=line>        people.peopleInfo = (PeopleInfo) people.getPeopleInfo().clone();</span><br><span class=line>        <span class=keyword>return</span> people;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 设计模式 - 原型模式</span></span><br><span class=line><span class=comment> * </span></span><br><span class=line><span class=comment> * 深拷贝：引用和基本数据类型 都会拷贝；</span></span><br><span class=line><span class=comment> * 浅拷贝：只会拷贝基本数据类型；</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">PrototypeApp</span> {</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 浅拷贝 测试 */</span></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">shallowReplication</span><span class=params>()</span> <span class=keyword>throws</span> CloneNotSupportedException {</span><br><span class=line>        <span class=type>PeopleInfo</span> <span class=variable>peopleInfo</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">PeopleInfo</span>(<span class=number>30</span>);</span><br><span class=line>        <span class=type>People</span> <span class=variable>p1</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">People</span>(peopleInfo, <span class=number>0</span>);</span><br><span class=line>        <span class=type>People</span> <span class=variable>p2</span> <span class=operator>=</span> p1.clone();</span><br><span class=line>        System.out.println(<span class=string>"p1-1: "</span> + p1.toString()); <span class=comment>// 30 0</span></span><br><span class=line>        System.out.println(<span class=string>"p2-1: "</span> + p2.toString()); <span class=comment>// 30 0</span></span><br><span class=line></span><br><span class=line>        p1.setType(<span class=number>1</span>);</span><br><span class=line>        peopleInfo.setAge(<span class=number>35</span>);</span><br><span class=line></span><br><span class=line>        System.out.println(<span class=string>"p1-2: "</span> + p1.toString()); <span class=comment>// 35 1</span></span><br><span class=line>        System.out.println(<span class=string>"p2-2: "</span> + p2.toString()); <span class=comment>// 35 0</span></span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 深拷贝 测试 */</span></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">deepReplication</span><span class=params>()</span> <span class=keyword>throws</span> CloneNotSupportedException {</span><br><span class=line>        <span class=type>PeopleInfo</span> <span class=variable>peopleInfo</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">PeopleInfo</span>(<span class=number>30</span>);</span><br><span class=line>        <span class=type>People</span> <span class=variable>p1</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">People</span>(peopleInfo, <span class=number>0</span>);</span><br><span class=line>        <span class=type>People</span> <span class=variable>p2</span> <span class=operator>=</span> p1.clone();</span><br><span class=line>        System.out.println(<span class=string>"p1-1: "</span> + p1.toString()); <span class=comment>// 30 0</span></span><br><span class=line>        System.out.println(<span class=string>"p2-1: "</span> + p2.toString()); <span class=comment>// 30 0</span></span><br><span class=line></span><br><span class=line>        p1.setType(<span class=number>1</span>);</span><br><span class=line>        peopleInfo.setAge(<span class=number>35</span>);</span><br><span class=line></span><br><span class=line>        System.out.println(<span class=string>"p1-2: "</span> + p1.toString()); <span class=comment>// 35 1</span></span><br><span class=line>        System.out.println(<span class=string>"p2-2: "</span> + p2.toString()); <span class=comment>// 30 0</span></span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h2 id=1-2、行为型（11种）><a class=headerlink href=#1-2、行为型（11种） title=1.2、行为型（11种）></a>1.2、行为型（11种）</h2><h3 id=1-2-1、Iterator（迭代器模式）><a class=headerlink href=#1-2-1、Iterator（迭代器模式） title=1.2.1、Iterator（迭代器模式）></a>1.2.1、Iterator（迭代器模式）</h3><h4 id=简介-4><a class=headerlink href=#简介-4 title=简介></a>简介</h4><p><strong>在不暴露对象内部的前提下，可以顺序访问对象的内部元素</strong>。<h4 id=何时使用-5><a class=headerlink href=#何时使用-5 title=何时使用></a>何时使用</h4><p>需要对容器/集合遍历时，可以使用迭代器模式。<h4 id=实现-1><a class=headerlink href=#实现-1 title=实现></a>实现</h4><ul><li>数组实现<li>链表实现</ul><h4 id=优缺点-5><a class=headerlink href=#优缺点-5 title=优缺点></a>优缺点</h4><ul><li><p>优点</p> <ol><li>它支持以不同方式遍历一个聚合对象；<li>迭代器简化了聚合类；<li>在同一聚合上可以有多个遍历；<li>迭代器模式中，增加新的聚合类和迭代器类都很方便，无须修改原有代码；</ol><li><p>缺点</p> <p>由于迭代器模式将存储数据和遍历数据的职责分离，增加新的聚合类需要对应增加新的迭代器类，类的个数成对增加，这在一定程度上增加了系统的复杂性。</p></ul><h4 id=应用场景-4><a class=headerlink href=#应用场景-4 title=应用场景></a>应用场景</h4><ol><li>访问一个聚合对象的内部元素而无须暴露其内部表示。<li>需要为聚合对象提供多种遍历方式。<li>为遍历不同的聚合结构提供一个统一的接口。</ol><h4 id=应用实例-5><a class=headerlink href=#应用实例-5 title=应用实例></a>应用实例</h4><p>JAVA 中的 iterator。<h4 id=注意事项-5><a class=headerlink href=#注意事项-5 title=注意事项></a>注意事项</h4><p><font color=red>迭代器模式分离了集合对象的遍历行为，抽象出一个迭代器类，可实现不爆露对象内部就可访问其内部元素；</font><h4 id=代码实例-5><a class=headerlink href=#代码实例-5 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">Iterator</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=type>boolean</span> <span class="title function_">hasNext</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>public</span> Object <span class="title function_">next</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>public</span> Object <span class="title function_">remove</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">IPerson</span> {</span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">getPersonInfo</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">IPersonList</span> {</span><br><span class=line>    <span class=keyword>public</span> ArrayList&LTIPerson> <span class="title function_">getPersonList</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>public</span> Iterator <span class="title function_">iterator</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Person</span> {</span><br><span class=line>    <span class=keyword>private</span> String name;</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">Person</span><span class=params>(String name)</span>{</span><br><span class=line>        System.out.println(<span class=string>"构造器进来了！"</span>);</span><br><span class=line>        <span class=built_in>this</span>.name = name;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">PersonIterator</span> <span class=keyword>implements</span> <span class="title class_">Iterator</span>{</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>final</span> ArrayList&LTIPerson> personList;</span><br><span class=line>    <span class=keyword>private</span> <span class=type>int</span> <span class=variable>index</span> <span class=operator>=</span> -<span class=number>1</span>;</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">PersonIterator</span><span class=params>(ArrayList&LTIPerson> personList)</span>{</span><br><span class=line>        <span class=built_in>this</span>.personList = personList;</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=type>boolean</span> <span class="title function_">hasNext</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> (<span class=built_in>this</span>.personList == <span class=literal>null</span> ? <span class=literal>false</span> : (index < <span class=built_in>this</span>.personList.size() - <span class=number>1</span>));</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Object <span class="title function_">next</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>if</span> (<span class=built_in>this</span>.personList != <span class=literal>null</span> && (index < <span class=built_in>this</span>.personList.size() - <span class=number>1</span>)){</span><br><span class=line>            <span class=keyword>return</span> <span class=built_in>this</span>.personList.get(++index);</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> <span class=literal>null</span>;</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Object <span class="title function_">remove</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>if</span> (<span class=built_in>this</span>.personList != <span class=literal>null</span>){</span><br><span class=line>            <span class=keyword>return</span> <span class=built_in>this</span>.personList.remove(index);</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> <span class=literal>null</span>;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">PersonList</span> <span class=keyword>implements</span> <span class="title class_">IPersonList</span>{</span><br><span class=line>    <span class=keyword>private</span> ArrayList&LTIPerson> personList = <span class=keyword>new</span> <span class="title class_">ArrayList</span>&LTIPerson>();</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">PersonList</span><span class=params>()</span>{</span><br><span class=line>        <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>i</span> <span class=operator>=</span> <span class=number>0</span>; i < <span class=number>10</span>; i++){</span><br><span class=line>            <span class=type>IPerson</span> <span class=variable>person</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Person</span>(<span class=string>"孙悟空"</span>, <span class=number>30</span>);</span><br><span class=line>            <span class=built_in>this</span>.personList.add(person);</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> ArrayList&LTIPerson> <span class="title function_">getPersonList</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=built_in>this</span>.personList;</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Iterator <span class="title function_">iterator</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">PersonIterator</span>(<span class=built_in>this</span>.personList);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">IteratorApp</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>IPersonList</span> <span class=variable>personList</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">PersonList</span>();</span><br><span class=line>        ArrayList&LTIPerson> list = personList.getPersonList();</span><br><span class=line>        <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>i</span> <span class=operator>=</span> <span class=number>0</span>; i < list.size(); i++){</span><br><span class=line>            System.out.println(list.get(i).getPersonInfo());</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        System.out.println(<span class=string>"----------------------------------"</span>);</span><br><span class=line></span><br><span class=line>        <span class=type>Iterator</span> <span class=variable>iterator</span> <span class=operator>=</span> personList.iterator();</span><br><span class=line>        <span class=keyword>while</span> (iterator.hasNext()){</span><br><span class=line>            <span class=type>IPerson</span> <span class=variable>person</span> <span class=operator>=</span> (IPerson) iterator.next();</span><br><span class=line>            <span class=keyword>if</span> (person != <span class=literal>null</span>){</span><br><span class=line>                System.out.println(person.getPersonInfo());</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-2、Observer（观察者模式）><a class=headerlink href=#1-2-2、Observer（观察者模式） title=1.2.2、Observer（观察者模式）></a>1.2.2、Observer（观察者模式）</h3><h4 id=简介-5><a class=headerlink href=#简介-5 title=简介></a>简介</h4><p><strong>多个参与者对象同时监听参考对象A，当参考对象A发生变化时，所有参与者对象依据该变化会做出相应的改变；</strong><h4 id=何时使用-6><a class=headerlink href=#何时使用-6 title=何时使用></a>何时使用</h4><p>一个对象（目标对象）的状态发生改变，所有的依赖对象（观察者对象）都将得到通知。<h4 id=优缺点-6><a class=headerlink href=#优缺点-6 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>观察者和被观察者是抽象耦合的。<li>建立一套触发机制。</ol><li>缺点<ol><li>参与者太多 导致 参照者发送通知会消耗很多资源；<li>参与者和参照者中间发生 循坏依赖可能导致系统崩溃。<li>参与者只知道参照者发生了变化，而如何变化却不知道；</ol></ul><h4 id=应用场景-5><a class=headerlink href=#应用场景-5 title=应用场景></a>应用场景</h4><ol><li>一个抽象模型有两个方面，其中一个方面依赖于另一个方面。将这些方面封装在独立的对象中使它们可以各自独立地改变和复用。<li>一个对象的改变将导致其他一个或多个对象也发生改变，而不知道具体有多少对象将发生改变，可以降低对象之间的耦合度。<li>一个对象必须通知其他对象，而并不知道这些对象是谁。<li>需要在系统中创建一个触发链，A 对象的行为将影响 B 对象，B 对象的行为将影响 C 对象……，可以使用观察者模式创建一种链式触发机制。</ol><h4 id=应用实例-6><a class=headerlink href=#应用实例-6 title=应用实例></a>应用实例</h4><ol><li>拍卖的时候，拍卖师观察最高标价，然后通知给其他竞价者竞价。<li>西游记里面悟空请求菩萨降服红孩儿，菩萨洒了一地水招来一个老乌龟，这个乌龟就是观察者，他观察菩萨洒水这个动作。</ol><h4 id=源码应用-2><a class=headerlink href=#源码应用-2 title=源码应用></a>源码应用</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>java.util.Observable</span><br><span class=line>org.springframework.context.ApplicationListener</span><br></pre></table></figure><h4 id=注意事项-6><a class=headerlink href=#注意事项-6 title=注意事项></a>注意事项</h4><ol><li><font color=red>JAVA 中存在相关支持类；</font><li><font color=red>应该避免循环引用；</font><li><font color=red>顺序执行将导致某一观察者错误进而导致系统卡壳，故一般采用异步方式；</font></ol><h4 id=代码实例-6><a class=headerlink href=#代码实例-6 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br></pre><td class=code><pre><span class=line><span class=keyword>import</span> java.util.Observable;</span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 观察目标</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * 观察目标的逻辑是先发表文章，再改变观察目标的状态，再通知观察者。</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ObserverTarget</span> <span class=keyword>extends</span> <span class="title class_">Observable</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>static</span> String article;</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> String <span class="title function_">getArticle</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> article;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">publish</span><span class=params>(String article)</span>{</span><br><span class=line>        <span class=built_in>this</span>.article = article;</span><br><span class=line>        <span class=comment>// 改变状态</span></span><br><span class=line>        <span class=built_in>this</span>.setChanged();</span><br><span class=line>        <span class=comment>/* 作用：通知所有观察者；内部逻辑：先获取同步锁，判断状态是否更新，若更新了则清空</span></span><br><span class=line><span class=comment>         * 观察目标状态，然后再使用for循环遍历所有观察者，一一调用观察者的更新方法通知观</span></span><br><span class=line><span class=comment>         * 察者更新。 **/</span></span><br><span class=line>        <span class=built_in>this</span>.notifyObservers();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.Observable;</span><br><span class=line><span class=keyword>import</span> java.util.Observer;</span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 观察者：读者</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ReaderObserver</span> <span class=keyword>implements</span> <span class="title class_">Observer</span> {</span><br><span class=line>    <span class=keyword>private</span> String name;</span><br><span class=line>    <span class=keyword>private</span> String article;</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">ReaderObserver</span><span class=params>(String name)</span>{</span><br><span class=line>        <span class=built_in>this</span>.name = name;</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">update</span><span class=params>(Observable o, Object arg)</span> {</span><br><span class=line>        updateArticle(o);</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>void</span> <span class="title function_">updateArticle</span><span class=params>(Observable o)</span> {</span><br><span class=line>        <span class=type>ObserverTarget</span> <span class=variable>target</span> <span class=operator>=</span> (ObserverTarget) o;</span><br><span class=line>        <span class=built_in>this</span>.article = ObserverTarget.getArticle();</span><br><span class=line>        System.out.printf(<span class=string>"读者 %s，你好，文章已更新：%s\n"</span>, <span class=built_in>this</span>.name, <span class=built_in>this</span>.article);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ObserverApp</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=comment>// 创建一个观察目标</span></span><br><span class=line>        <span class=type>ObserverTarget</span> <span class=variable>target</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ObserverTarget</span>();</span><br><span class=line>        <span class=comment>// 添加观察者</span></span><br><span class=line>        target.addObserver(<span class=keyword>new</span> <span class="title class_">ReaderObserver</span>(<span class=string>"小明"</span>));</span><br><span class=line>        target.addObserver(<span class=keyword>new</span> <span class="title class_">ReaderObserver</span>(<span class=string>"小王"</span>));</span><br><span class=line>        target.addObserver(<span class=keyword>new</span> <span class="title class_">ReaderObserver</span>(<span class=string>"小张"</span>));</span><br><span class=line>        <span class=comment>// 发表文章</span></span><br><span class=line>        target.publish(<span class=string>"啥是观察者模式。"</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-3、TemplateMethod（模板方法）><a class=headerlink href=#1-2-3、TemplateMethod（模板方法） title=1.2.3、TemplateMethod（模板方法）></a>1.2.3、TemplateMethod（模板方法）</h3><h4 id=简介-6><a class=headerlink href=#简介-6 title=简介></a>简介</h4><p><strong>也称钩子函数，其定义一个操作算法骨架，而将一些步骤延迟到子类中，模板方法使得子类可以不改变一个算法的结果，即可重定义该算法的某些特定步骤。</strong><h4 id=何时使用-7><a class=headerlink href=#何时使用-7 title=何时使用></a>何时使用</h4><p>系统中存在一部分通用方法。<h4 id=优缺点-7><a class=headerlink href=#优缺点-7 title=优缺点></a>优缺点</h4><ul><li><p>优点</p> <ol><li>封装不变部分，扩展可变部分。<li>提取公共代码，便于维护。<li>行为由父类控制，子类实现。</ol><li><p>缺点</p> <p>每一个不同的实现都需要一个子类来实现，类的数量增加导致系统愈加庞大。</p></ul><h4 id=应用场景-6><a class=headerlink href=#应用场景-6 title=应用场景></a>应用场景</h4><ol><li>有多个子类共有的方法，且逻辑相同。<li>重要的、复杂的方法，可以考虑作为模板方法。</ol><h4 id=应用实例-7><a class=headerlink href=#应用实例-7 title=应用实例></a>应用实例</h4><ol><li>在造房子的时候，地基、走线、水管都一样，只有后期加壁橱加栅栏等差异。<li>西游记中的 81 难，就是一个顶层逻辑骨架。<li>spring 对 Hibernate 的支持，将一些规定好的方法封装起来，编程人员直接使用即可。</ol><h4 id=注意事项-7><a class=headerlink href=#注意事项-7 title=注意事项></a>注意事项</h4><p><font color=red>为防止恶意操作，模板方法一般会使用 final 修饰。</font><h4 id=代码实例-7><a class=headerlink href=#代码实例-7 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>class</span> <span class="title class_">AbstractTemplate</span> {</span><br><span class=line>    <span class=comment>// 模板方法</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">templateMethod</span><span class=params>()</span>{</span><br><span class=line>        init();</span><br><span class=line>        apply();  <span class=comment>// 重点</span></span><br><span class=line>        end();    <span class=comment>// 可以作为钩子方法</span></span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>protected</span> <span class=keyword>void</span> <span class="title function_">init</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"init 抽象层已经实现，子类也可以选择覆写"</span>);</span><br><span class=line>    }</span><br><span class=line>    <span class=comment>// 留给子类实现</span></span><br><span class=line>    <span class=keyword>protected</span> <span class=keyword>abstract</span> <span class=keyword>void</span> <span class="title function_">apply</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>protected</span> <span class=keyword>void</span> <span class="title function_">end</span><span class=params>()</span> {}</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ConcreteTemplate</span> <span class=keyword>extends</span> <span class="title class_">AbstractTemplate</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">apply</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"子类实现抽象方法 apply"</span>);</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">end</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"我们可以把 method3 当做钩子方法来使用，需要的时候覆写就可以了"</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">TemplateMethodApp</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>AbstractTemplate</span> <span class=variable>t</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ConcreteTemplate</span>();</span><br><span class=line>        <span class=comment>// 调用模板方法</span></span><br><span class=line>        t.templateMethod();</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-4、Strategy（策略模式）><a class=headerlink href=#1-2-4、Strategy（策略模式） title=1.2.4、Strategy（策略模式）></a>1.2.4、Strategy（策略模式）</h3><h4 id=简介-7><a class=headerlink href=#简介-7 title=简介></a>简介</h4><p><strong>一个类的行为或算法可在运行时修改。创建各种策略对象和一个随策略对象改变而会改变行为的context对象。策略对象会改变context对象的执行算法。</strong><h4 id=何时使用-8><a class=headerlink href=#何时使用-8 title=何时使用></a>何时使用</h4><p>一个系统有许多类，而区分它们的只是他们直接的行为。<h4 id=优缺点-8><a class=headerlink href=#优缺点-8 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>算法可以自由切换。<li>避免使用多重条件判断。<li>扩展性良好。</ol><li>缺点<ol><li>策略类会增多。<li>所有策略类都需要对外暴露。</ol></ul><h4 id=应用场景-7><a class=headerlink href=#应用场景-7 title=应用场景></a>应用场景</h4><ol><li>一个系统中的许多类只存在行为上的区别时，该模式可以动态让一个对象在许多行为中选择一种行为。<li>一个系统需要动态地在几种算法中选择一种。<li>如果一个对象有很多行为，如果不用恰当的模式，这些行为就只好使用多重的条件选择语句来实现。</ol><h4 id=应用实例-8><a class=headerlink href=#应用实例-8 title=应用实例></a>应用实例</h4><ol><li>诸葛亮的锦囊妙计，每一个锦囊就是一个策略。<li>旅行的交通方式可以选择骑自行车、开汽车等，每一种旅行方式都是一个策略。<li>JAVA AWT 中的 LayoutManager。</ol><h4 id=注意事项-8><a class=headerlink href=#注意事项-8 title=注意事项></a>注意事项</h4><p><font color=red>如果一个系统的策略多于四个，就需要考虑使用混合模式，解决策略类膨胀的问题。</font>、<h4 id=代码实例-8><a class=headerlink href=#代码实例-8 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br></pre><td class=code><pre><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 会员接口</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">Member</span> {</span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 计算应付价格</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> bookPrice 书籍原价(针对金额,建议使用BigDecimal,double会损失精度)</span></span><br><span class=line><span class=comment>     * <span class=doctag>@return</span> 应付金额</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>public</span> <span class=type>double</span> <span class="title function_">calPrice</span><span class=params>(<span class=type>double</span> bookPrice)</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 初级会员</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">PrimaryMember</span> <span class=keyword>implements</span> <span class="title class_">Member</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=type>double</span> <span class="title function_">calPrice</span><span class=params>(<span class=type>double</span> bookPrice)</span> {</span><br><span class=line>        System.out.println(<span class=string>"对于初级会员的没有折扣"</span>);</span><br><span class=line>        <span class=keyword>return</span> bookPrice;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 中级会员，买书打九折</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">IntermediateMember</span> <span class=keyword>implements</span> <span class="title class_">Member</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=type>double</span> <span class="title function_">calPrice</span><span class=params>(<span class=type>double</span> bookPrice)</span> {</span><br><span class=line>        System.out.println(<span class=string>"对于中级会员的折扣为10%"</span>);</span><br><span class=line>        <span class=keyword>return</span> bookPrice * <span class=number>0.9</span>;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 高级会员，买书打八折</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">AdvancedMember</span> <span class=keyword>implements</span> <span class="title class_">Member</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=type>double</span> <span class="title function_">calPrice</span><span class=params>(<span class=type>double</span> bookPrice)</span> {</span><br><span class=line>        System.out.println(<span class=string>"对于高级会员的折扣为20%"</span>);</span><br><span class=line>        <span class=keyword>return</span> bookPrice * <span class=number>0.8</span>;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 书籍价格类</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Cashier</span> {</span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 会员,策略对象</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>private</span> Member member;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">Cashier</span><span class=params>(Member member)</span>{</span><br><span class=line>        <span class=built_in>this</span>.member = member;</span><br><span class=line>    }</span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 计算应付价格</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> booksPrice</span></span><br><span class=line><span class=comment>     * <span class=doctag>@return</span></span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>public</span> <span class=type>double</span> <span class="title function_">quote</span><span class=params>(<span class=type>double</span> booksPrice)</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=built_in>this</span>.member.calPrice(booksPrice);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">BookStoreApp</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=comment>//选择并创建需要使用的策略对象</span></span><br><span class=line>        <span class=type>Member</span> <span class=variable>strategy</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">AdvancedMember</span>();</span><br><span class=line>        <span class=comment>//创建环境</span></span><br><span class=line>        <span class=type>Cashier</span> <span class=variable>cashier</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Cashier</span>(strategy);</span><br><span class=line>        <span class=comment>//计算价格</span></span><br><span class=line>        <span class=type>double</span> <span class=variable>quote</span> <span class=operator>=</span> cashier.quote(<span class=number>300</span>);</span><br><span class=line>        System.out.println(<span class=string>"高级会员图书的最终价格为："</span> + quote);</span><br><span class=line></span><br><span class=line>        strategy = <span class=keyword>new</span> <span class="title class_">IntermediateMember</span>();</span><br><span class=line>        cashier = <span class=keyword>new</span> <span class="title class_">Cashier</span>(strategy);</span><br><span class=line>        quote = cashier.quote(<span class=number>300</span>);</span><br><span class=line>        System.out.println(<span class=string>"中级会员图书的最终价格为："</span> + quote);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-5、ChainOfResponsibility（职责链模式）><a class=headerlink href=#1-2-5、ChainOfResponsibility（职责链模式） title=1.2.5、ChainOfResponsibility（职责链模式）></a>1.2.5、ChainOfResponsibility（职责链模式）</h3><h4 id=简介-8><a class=headerlink href=#简介-8 title=简介></a>简介</h4><p><strong>创建一个请求接收者链，每一个请求接收者通过一个引用与其它接收者相连。请求发送者发送的请求会经过 接收者链，链中的每一个接收者都有机会处理该请求。实现了发送者与接收者的解耦。</strong><h4 id=何时使用-9><a class=headerlink href=#何时使用-9 title=何时使用></a>何时使用</h4><p>过滤消息中各种不雅内容；<h4 id=优缺点-9><a class=headerlink href=#优缺点-9 title=优缺点></a>优缺点</h4><ol><li>请求的发送者和接收者解耦。<li>可以执行控制顺序。<li>符合开闭原则和单一职责原则。</ol><h4 id=应用场景-8><a class=headerlink href=#应用场景-8 title=应用场景></a>应用场景</h4><ol><li>多个对象都能处理同一个请求，具体由哪个对象处理该请求则在运行时自动确定。<li>在不明确指定接收者的情况下，向多个对象中的某个对象发送一个请求。<li>动态指定一组对象处理请求的场景。</ol><h4 id=应用实例-9><a class=headerlink href=#应用实例-9 title=应用实例></a>应用实例</h4><ol><li>红楼梦中的 “击鼓传花”。<li>JS 中的事件冒泡。<li>JAVA WEB 中 Apache Tomcat 对 Encoding 的处理，Struts2 的拦截器，jsp servlet 的 Filter。</ol><h4 id=源码应用-3><a class=headerlink href=#源码应用-3 title=源码应用></a>源码应用</h4><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>javax.servlet.Filter</span><br><span class=line>javax.servlet.FilterChain</span><br></pre></table></figure><h4 id=注意事项-9><a class=headerlink href=#注意事项-9 title=注意事项></a>注意事项</h4><p><font color=red>JAVA WEB 中有很多应用。</font><h4 id=代码实例-9><a class=headerlink href=#代码实例-9 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br></pre><td class=code><pre><span class=line><span class=keyword>import</span> java.util.Random;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">App</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>ProcessHandler</span> <span class=variable>processHandler</span> <span class=operator>=</span> ProcessHandler.getInstance();</span><br><span class=line>        <span class=type>Random</span> <span class=variable>random</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Random</span>();</span><br><span class=line>        <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>i</span> <span class=operator>=</span> <span class=number>0</span>; i < <span class=number>3</span>; i++){</span><br><span class=line>            <span class=type>int</span> <span class=variable>radom</span> <span class=operator>=</span> random.nextInt(<span class=number>3</span>);</span><br><span class=line>            <span class=type>IStudent</span> <span class=variable>student</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Student</span>(radom, <span class=string>"学生"</span> + i + <span class=string>"生病了，需要请假。"</span>);</span><br><span class=line></span><br><span class=line>            System.out.println(<span class=string>"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"</span>);</span><br><span class=line>            processHandler.sendMsg(student);</span><br><span class=line>            System.out.println(<span class=string>"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"</span>);</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-6、Mediator（中介者模式）><a class=headerlink href=#1-2-6、Mediator（中介者模式） title=1.2.6、Mediator（中介者模式）></a>1.2.6、Mediator（中介者模式）</h3><h4 id=简介-9><a class=headerlink href=#简介-9 title=简介></a>简介</h4><p><strong>创建一个中介类来处理不同类之间的通信，且支持松耦合，代码易维护。</strong><h4 id=何时使用-10><a class=headerlink href=#何时使用-10 title=何时使用></a>何时使用</h4><p>多个类相互耦合，形成了网状结构。<h4 id=优缺点-10><a class=headerlink href=#优缺点-10 title=优缺点></a>优缺点</h4><ul><li><p>优点</p> <ol><li>降低了类的复杂度，将一对多转化成了一对一。<li>实现了类之间的解耦。<li>符合迪米特原则。</ol><li><p>缺点</p> <p>中介者会庞大，变得复杂难以维护。</p></ul><h4 id=应用场景-9><a class=headerlink href=#应用场景-9 title=应用场景></a>应用场景</h4><ol><li>对象间存在复杂引用关系，内部结构复杂难以使用；<li>通过一个中间类来封装多个类中的行为，而又不想生成太多的子类；</ol><h4 id=应用实例-10><a class=headerlink href=#应用实例-10 title=应用实例></a>应用实例</h4><ol><li>中国加入 WTO 之前是各个国家相互贸易，结构复杂，现在是各个国家通过 WTO 来互相贸易。<li>机场调度系统。<li>MVC 框架中 C（控制器）就是 M（模型）和 V（视图）的中介者。</ol><h4 id=注意事项-10><a class=headerlink href=#注意事项-10 title=注意事项></a>注意事项</h4><p><font color=red>不应当在职责混乱时使用。</font><h4 id=代码实例-10><a class=headerlink href=#代码实例-10 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br></pre><td class=code><pre><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 用户接口</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">IUser</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">receiveMsg</span><span class=params>(String msg)</span>;</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">sendMsg</span><span class=params>(String msg)</span>;</span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">getMsg</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 中介者接口</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">IMediator</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">regist</span><span class=params>(IUser iUser)</span>;</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">notifyAllMsg</span><span class=params>(IUser iUser)</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>class</span> <span class="title class_">AbstractUser</span> <span class=keyword>implements</span> <span class="title class_">IUser</span>{</span><br><span class=line>    <span class=keyword>protected</span> IMediator mediator;</span><br><span class=line>    <span class=keyword>protected</span>  String name;</span><br><span class=line>    <span class=keyword>protected</span> String msg;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">AbstractUser</span><span class=params>(IMediator mediator, String name)</span>{</span><br><span class=line>        <span class=built_in>this</span>.mediator = mediator;</span><br><span class=line>        <span class=built_in>this</span>.name = name;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">sendMsg</span><span class=params>(String msg)</span>{</span><br><span class=line>        <span class=built_in>this</span>.msg = msg;</span><br><span class=line>        System.out.println(<span class=built_in>this</span>.name + <span class=string>"说： "</span> + <span class=built_in>this</span>.msg );</span><br><span class=line>        mediator.notifyAllMsg(<span class=built_in>this</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">getMsg</span><span class=params>()</span>{</span><br><span class=line>        <span class=keyword>return</span> msg;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ConcreteMediator</span> <span class=keyword>implements</span> <span class="title class_">IMediator</span>{</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>final</span> List&LTIUser> userList = <span class=keyword>new</span> <span class="title class_">ArrayList</span>&LTIUser>();</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">regist</span><span class=params>(IUser iUser)</span> {</span><br><span class=line>        <span class=keyword>if</span> (iUser != <span class=literal>null</span> && !userList.contains(iUser)){</span><br><span class=line>            userList.add(iUser);</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">notifyAllMsg</span><span class=params>(IUser iUser)</span> {</span><br><span class=line>        Iterator&LTIUser> iterator = userList.iterator();</span><br><span class=line>        <span class=type>IUser</span> <span class=variable>tmp</span> <span class=operator>=</span> <span class=literal>null</span>;</span><br><span class=line>        <span class=keyword>while</span> (iterator.hasNext()){</span><br><span class=line>            tmp = iterator.next();</span><br><span class=line>            <span class=keyword>if</span> (tmp != <span class=literal>null</span> && !tmp.equals(iUser)){</span><br><span class=line>                tmp.receiveMsg(iUser.getMsg());</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">UserA</span> <span class=keyword>extends</span> <span class="title class_">AbstractUser</span>{</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">UserA</span><span class=params>(IMediator mediator, String name)</span>{</span><br><span class=line>        <span class=built_in>super</span>(mediator, name);</span><br><span class=line>        mediator.regist(<span class=built_in>this</span>);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">receiveMsg</span><span class=params>(String msg)</span> {</span><br><span class=line>        System.out.println(<span class=string>"UserA received msg: "</span> + msg);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">UserB</span> <span class=keyword>extends</span> <span class="title class_">AbstractUser</span>{</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">UserB</span><span class=params>(IMediator mediator, String name)</span>{</span><br><span class=line>        <span class=built_in>super</span>(mediator, name);</span><br><span class=line>        mediator.regist(<span class=built_in>this</span>);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">receiveMsg</span><span class=params>(String msg)</span> {</span><br><span class=line>        System.out.println(<span class=string>"UserB received msg: "</span> + msg);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">UserC</span> <span class=keyword>extends</span> <span class="title class_">AbstractUser</span>{</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">UserC</span><span class=params>(IMediator mediator, String name)</span>{</span><br><span class=line>        <span class=built_in>super</span>(mediator, name);</span><br><span class=line>        mediator.regist(<span class=built_in>this</span>);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">receiveMsg</span><span class=params>(String msg)</span> {</span><br><span class=line>        System.out.println(<span class=string>"UserC received msg: "</span> + msg);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">MediatorApp</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>IMediator</span> <span class=variable>mediator</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ConcreteMediator</span>();</span><br><span class=line>        <span class=type>IUser</span> <span class=variable>userA</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">UserA</span>(mediator, <span class=string>"孙悟空"</span>);</span><br><span class=line>        <span class=type>IUser</span> <span class=variable>userB</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">UserB</span>(mediator, <span class=string>"猪八戒"</span>);</span><br><span class=line>        <span class=type>IUser</span> <span class=variable>userC</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">UserC</span>(mediator, <span class=string>"沙和尚"</span>);</span><br><span class=line></span><br><span class=line>        userA.sendMsg(<span class=string>"大家好，我乃齐天大圣 孙悟空！"</span>);</span><br><span class=line>        userB.sendMsg(<span class=string>"大家好，我乃高老庄 猪八戒！"</span>);</span><br><span class=line>        userC.sendMsg(<span class=string>"大家好，我乃 沙和尚！"</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-7、Interpreter（解释器模式）><a class=headerlink href=#1-2-7、Interpreter（解释器模式） title=1.2.7、Interpreter（解释器模式）></a>1.2.7、Interpreter（解释器模式）</h3><h4 id=简介-10><a class=headerlink href=#简介-10 title=简介></a>简介</h4><p><strong>实现一个表达式接口，该接口解释一个特定上下文。该模式在SQL解析、符号处理引擎中有使用。</strong><h4 id=何时使用-11><a class=headerlink href=#何时使用-11 title=何时使用></a>何时使用</h4><p>某一个类型的问题发送频率特高，可以将该类型问题的各实例封装成一个简单描述，然后通过解释器来解释处理该描述。<h4 id=优缺点-11><a class=headerlink href=#优缺点-11 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>可扩展性比较好，灵活。<li>增加了新的解释表达式的方式。<li>易于实现简单文法。</ol><li>缺点<ol><li>可利用场景比较少。<li>对于复杂的文法比较难维护。<li>解释器模式会引起类膨胀。<li>解释器模式采用递归调用方法。</ol></ul><h4 id=应用场景-10><a class=headerlink href=#应用场景-10 title=应用场景></a>应用场景</h4><ol><li>将一个解释执行语言中的句子表示为一个抽象语法树。<li>重复出现的问题可以用一种简单的语言来进行表达。<li>简单语法需要解释的场景。</ol><h4 id=应用实例-11><a class=headerlink href=#应用实例-11 title=应用实例></a>应用实例</h4><p>编译器、运算表达式计算。<h4 id=注意事项-11><a class=headerlink href=#注意事项-11 title=注意事项></a>注意事项</h4><p><font color=red>可利用场景比较少，JAVA 中可以用 expression4J 代替。</font><h4 id=代码实例-11><a class=headerlink href=#代码实例-11 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br><span class=line>120</span><br><span class=line>121</span><br><span class=line>122</span><br><span class=line>123</span><br><span class=line>124</span><br><span class=line>125</span><br><span class=line>126</span><br><span class=line>127</span><br><span class=line>128</span><br><span class=line>129</span><br><span class=line>130</span><br><span class=line>131</span><br><span class=line>132</span><br><span class=line>133</span><br><span class=line>134</span><br><span class=line>135</span><br><span class=line>136</span><br><span class=line>137</span><br><span class=line>138</span><br><span class=line>139</span><br><span class=line>140</span><br><span class=line>141</span><br><span class=line>142</span><br><span class=line>143</span><br><span class=line>144</span><br><span class=line>145</span><br><span class=line>146</span><br><span class=line>147</span><br><span class=line>148</span><br><span class=line>149</span><br><span class=line>150</span><br><span class=line>151</span><br><span class=line>152</span><br><span class=line>153</span><br><span class=line>154</span><br><span class=line>155</span><br><span class=line>156</span><br><span class=line>157</span><br><span class=line>158</span><br><span class=line>159</span><br><span class=line>160</span><br><span class=line>161</span><br><span class=line>162</span><br><span class=line>163</span><br><span class=line>164</span><br><span class=line>165</span><br><span class=line>166</span><br><span class=line>167</span><br><span class=line>168</span><br><span class=line>169</span><br><span class=line>170</span><br><span class=line>171</span><br><span class=line>172</span><br><span class=line>173</span><br><span class=line>174</span><br><span class=line>175</span><br><span class=line>176</span><br><span class=line>177</span><br><span class=line>178</span><br><span class=line>179</span><br><span class=line>180</span><br><span class=line>181</span><br><span class=line>182</span><br><span class=line>183</span><br><span class=line>184</span><br><span class=line>185</span><br><span class=line>186</span><br><span class=line>187</span><br><span class=line>188</span><br><span class=line>189</span><br><span class=line>190</span><br><span class=line>191</span><br><span class=line>192</span><br><span class=line>193</span><br><span class=line>194</span><br><span class=line>195</span><br><span class=line>196</span><br><span class=line>197</span><br><span class=line>198</span><br><span class=line>199</span><br><span class=line>200</span><br><span class=line>201</span><br><span class=line>202</span><br><span class=line>203</span><br><span class=line>204</span><br><span class=line>205</span><br><span class=line>206</span><br><span class=line>207</span><br><span class=line>208</span><br><span class=line>209</span><br><span class=line>210</span><br><span class=line>211</span><br><span class=line>212</span><br><span class=line>213</span><br><span class=line>214</span><br><span class=line>215</span><br><span class=line>216</span><br><span class=line>217</span><br><span class=line>218</span><br><span class=line>219</span><br><span class=line>220</span><br><span class=line>221</span><br><span class=line>222</span><br><span class=line>223</span><br><span class=line>224</span><br><span class=line>225</span><br><span class=line>226</span><br></pre><td class=code><pre><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 上下文环境</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Context</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>final</span> StringTokenizer stringTokenizer;</span><br><span class=line>    <span class=keyword>private</span> String currentToken;</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>final</span> Map&LTString, Object> map = <span class=keyword>new</span> <span class="title class_">HashMap</span>&LTString, Object>();</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">Context</span><span class=params>(String text)</span>{</span><br><span class=line>        <span class=built_in>this</span>.stringTokenizer = <span class=keyword>new</span> <span class="title class_">StringTokenizer</span>(text);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">next</span><span class=params>()</span>{</span><br><span class=line>        <span class=keyword>if</span> (<span class=built_in>this</span>.stringTokenizer.hasMoreTokens()){</span><br><span class=line>            currentToken = <span class=built_in>this</span>.stringTokenizer.nextToken();</span><br><span class=line>        }<span class=keyword>else</span> {</span><br><span class=line>            currentToken = <span class=literal>null</span>;</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> currentToken;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=type>boolean</span> <span class="title function_">equalsWithCommand</span><span class=params>(String command)</span>{</span><br><span class=line>        <span class=keyword>if</span> (command == <span class=literal>null</span> || !command.equals(<span class=built_in>this</span>.currentToken)){</span><br><span class=line>            <span class=keyword>return</span> <span class=literal>false</span>;</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> <span class=literal>true</span>;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">getCurrentToken</span><span class=params>()</span>{</span><br><span class=line>        <span class=keyword>return</span> <span class=built_in>this</span>.currentToken;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">getTokenContext</span><span class=params>(String text)</span>{</span><br><span class=line>        <span class=type>String</span> <span class=variable>str</span> <span class=operator>=</span> text;</span><br><span class=line>        <span class=keyword>if</span> (str != <span class=literal>null</span>){</span><br><span class=line>            Iterator&LTString> iterator = <span class=built_in>this</span>.map.keySet().iterator();</span><br><span class=line>            <span class=keyword>while</span> (iterator.hasNext()){</span><br><span class=line>                <span class=type>String</span> <span class=variable>key</span> <span class=operator>=</span> iterator.next();</span><br><span class=line>                <span class=type>Object</span> <span class=variable>obj</span> <span class=operator>=</span> map.get(key);</span><br><span class=line>                str = str.replaceAll(key, obj.toString());</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> str;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">put</span><span class=params>(String key, Object value)</span>{</span><br><span class=line>        <span class=built_in>this</span>.map.put(key, value);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">clear</span><span class=params>(String key)</span>{</span><br><span class=line>        <span class=built_in>this</span>.map.remove(key);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">IExpressions</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">parse</span><span class=params>(Context context)</span>;</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">interpret</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ListExpression</span> <span class=keyword>implements</span> <span class="title class_">IExpressions</span>{</span><br><span class=line>    <span class=keyword>private</span> Context context;</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>final</span> ArrayList&LTIExpressions> list = <span class=keyword>new</span> <span class="title class_">ArrayList</span>&LTIExpressions>();</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">parse</span><span class=params>(Context context)</span> {</span><br><span class=line>        <span class=built_in>this</span>.context = context;</span><br><span class=line>        <span class=keyword>while</span> (<span class=literal>true</span>){</span><br><span class=line>            <span class=keyword>if</span> (<span class=built_in>this</span>.context.getCurrentToken() == <span class=literal>null</span>){</span><br><span class=line>                System.out.println(<span class=string>"Error: the experssion missing end! "</span>);</span><br><span class=line>                <span class=keyword>break</span>;</span><br><span class=line>            }<span class=keyword>else</span> <span class=keyword>if</span> (<span class=built_in>this</span>.context.equalsWithCommand(<span class=string>"END"</span>)){</span><br><span class=line>                <span class=built_in>this</span>.context.next();</span><br><span class=line>                <span class=keyword>break</span>;</span><br><span class=line>            }<span class=keyword>else</span> {</span><br><span class=line>                <span class=type>IExpressions</span> <span class=variable>expressions</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">CommandExperssion</span>(<span class=built_in>this</span>.context);</span><br><span class=line>                list.add(expressions);</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">interpret</span><span class=params>()</span> {</span><br><span class=line>        Iterator&LTIExpressions> iterator = list.iterator();</span><br><span class=line>        <span class=keyword>while</span> (iterator.hasNext()){</span><br><span class=line>            iterator.next().interpret();</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">PrimitiveExpression</span> <span class=keyword>implements</span> <span class="title class_">IExpressions</span>{</span><br><span class=line>    <span class=keyword>private</span> Context context;</span><br><span class=line>    <span class=keyword>private</span> String tokenName;</span><br><span class=line>    <span class=keyword>private</span> String text;</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">PrimitiveExpression</span><span class=params>(Context context)</span>{</span><br><span class=line>        <span class=built_in>this</span>.parse(context);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">parse</span><span class=params>(Context context)</span> {</span><br><span class=line>        <span class=built_in>this</span>.context = context;</span><br><span class=line>        <span class=built_in>this</span>.tokenName = <span class=built_in>this</span>.context.getCurrentToken();</span><br><span class=line>        <span class=built_in>this</span>.context.next();</span><br><span class=line>        <span class=keyword>if</span> (<span class=string>"PRINTLN"</span>.equals(<span class=built_in>this</span>.tokenName)){</span><br><span class=line>            <span class=built_in>this</span>.text = <span class=built_in>this</span>.context.getCurrentToken();</span><br><span class=line>            <span class=built_in>this</span>.context.next();</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">interpret</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>if</span> (<span class=string>"PRINTLN"</span>.equals(tokenName)){</span><br><span class=line>            System.out.println(<span class=built_in>this</span>.context.getTokenContext(<span class=built_in>this</span>.text));</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ProgramExpression</span> <span class=keyword>implements</span> <span class="title class_">IExpressions</span>{</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>final</span> Context context;</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>final</span> <span class=keyword>static</span> <span class=type>String</span> <span class=variable>COMMAND</span> <span class=operator>=</span> <span class=string>"PROGRAM"</span>;</span><br><span class=line>    <span class=keyword>private</span> IExpressions expressions;</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">ProgramExpression</span><span class=params>(String text)</span>{</span><br><span class=line>        <span class=built_in>this</span>.context = <span class=keyword>new</span> <span class="title class_">Context</span>(text);</span><br><span class=line>        <span class=built_in>this</span>.parse(<span class=built_in>this</span>.context);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">parse</span><span class=params>(Context context)</span> {</span><br><span class=line>        <span class=built_in>this</span>.context.next();</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">interpret</span><span class=params>()</span>{</span><br><span class=line>        <span class=keyword>if</span> (!<span class=built_in>this</span>.context.equalsWithCommand(COMMAND)){</span><br><span class=line>            System.out.println(<span class=string>"the "</span> + COMMAND + <span class=string>"is Excepted for start!"</span>);</span><br><span class=line>        }<span class=keyword>else</span> {</span><br><span class=line>            <span class=built_in>this</span>.context.next();</span><br><span class=line>            <span class=built_in>this</span>.expressions = <span class=keyword>new</span> <span class="title class_">ListExpression</span>();</span><br><span class=line>            <span class=built_in>this</span>.expressions.parse(<span class=built_in>this</span>.context);</span><br><span class=line>            <span class=built_in>this</span>.expressions.interpret();</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ForExpression</span> <span class=keyword>implements</span> <span class="title class_">IExpressions</span>{</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>final</span> Context context;</span><br><span class=line>    <span class=keyword>private</span> String variable;</span><br><span class=line>    <span class=keyword>private</span> <span class=type>int</span> start_index;</span><br><span class=line>    <span class=keyword>private</span> <span class=type>int</span> end_index;</span><br><span class=line>    <span class=keyword>private</span> IExpressions expressions;</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">ForExpression</span><span class=params>(Context context)</span>{</span><br><span class=line>        <span class=built_in>this</span>.context = context;</span><br><span class=line>        <span class=built_in>this</span>.parse(<span class=built_in>this</span>.context);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">parse</span><span class=params>(Context context)</span> {</span><br><span class=line>        <span class=built_in>this</span>.context.next();</span><br><span class=line>        <span class=keyword>while</span> (<span class=literal>true</span>){</span><br><span class=line>            <span class=keyword>if</span> (<span class=built_in>this</span>.context.equalsWithCommand(<span class=string>"FROM"</span>)){</span><br><span class=line>                <span class=type>String</span> <span class=variable>nextStr</span> <span class=operator>=</span> <span class=built_in>this</span>.context.next();</span><br><span class=line>                <span class=keyword>try</span> {</span><br><span class=line>                    <span class=built_in>this</span>.start_index = Integer.parseInt(nextStr);</span><br><span class=line>                }<span class=keyword>catch</span> (Exception e){</span><br><span class=line>                    e.printStackTrace();</span><br><span class=line>                    <span class=keyword>break</span>;</span><br><span class=line>                }</span><br><span class=line>                <span class=built_in>this</span>.context.next();</span><br><span class=line>            }<span class=keyword>else</span> <span class=keyword>if</span> (<span class=built_in>this</span>.context.equalsWithCommand(<span class=string>"TO"</span>)){</span><br><span class=line>                <span class=type>String</span> <span class=variable>nextStr</span> <span class=operator>=</span> <span class=built_in>this</span>.context.next();</span><br><span class=line>                <span class=keyword>try</span> {</span><br><span class=line>                    <span class=built_in>this</span>.end_index = Integer.parseInt(nextStr);</span><br><span class=line>                }<span class=keyword>catch</span> (Exception e){</span><br><span class=line>                    e.printStackTrace();</span><br><span class=line>                }</span><br><span class=line>                <span class=built_in>this</span>.context.next();</span><br><span class=line>                <span class=keyword>break</span>;</span><br><span class=line>            }<span class=keyword>else</span> {</span><br><span class=line>                <span class=keyword>if</span> (<span class=built_in>this</span>.variable == <span class=literal>null</span>){</span><br><span class=line>                    <span class=built_in>this</span>.variable = <span class=built_in>this</span>.context.getCurrentToken();</span><br><span class=line>                }</span><br><span class=line>                <span class=built_in>this</span>.context.next();</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>        <span class=built_in>this</span>.expressions = <span class=keyword>new</span> <span class="title class_">ListExpression</span>();</span><br><span class=line>        <span class=built_in>this</span>.expressions.parse(<span class=built_in>this</span>.context);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">interpret</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>x</span> <span class=operator>=</span> <span class=built_in>this</span>.start_index; x < <span class=built_in>this</span>.end_index; x++){</span><br><span class=line>            <span class=built_in>this</span>.context.put(<span class=string>""</span> + <span class=built_in>this</span>.variable, x);</span><br><span class=line>            <span class=built_in>this</span>.expressions.interpret();</span><br><span class=line>        }</span><br><span class=line>        <span class=built_in>this</span>.context.clear(<span class=string>""</span> + <span class=built_in>this</span>.variable);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">CommandExperssion</span> <span class=keyword>implements</span> <span class="title class_">IExpressions</span>{</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>final</span> Context context;</span><br><span class=line>    <span class=keyword>private</span> IExpressions expressions;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">CommandExperssion</span><span class=params>(Context context)</span>{</span><br><span class=line>        <span class=built_in>this</span>.context = context;</span><br><span class=line>        <span class=built_in>this</span>.parse(<span class=built_in>this</span>.context);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">parse</span><span class=params>(Context context)</span> {</span><br><span class=line>        <span class=keyword>if</span> (<span class=built_in>this</span>.context.equalsWithCommand(<span class=string>"FOR"</span>)){</span><br><span class=line>            expressions = <span class=keyword>new</span> <span class="title class_">ForExpression</span>(<span class=built_in>this</span>.context);</span><br><span class=line>        }<span class=keyword>else</span>{</span><br><span class=line>            expressions = <span class=keyword>new</span> <span class="title class_">PrimitiveExpression</span>(<span class=built_in>this</span>.context);</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">interpret</span><span class=params>()</span> {</span><br><span class=line>        <span class=built_in>this</span>.expressions.interpret();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">InterpreterApp</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>String</span> <span class=variable>str</span> <span class=operator>=</span> <span class=string>"PROGRAM PRINTLN start... FOR i FROM 90 TO 100 PRINTLN i END PRINTLN end... END"</span>;</span><br><span class=line>        System.out.println(<span class=string>"str: "</span> + str);</span><br><span class=line>        <span class=type>IExpressions</span> <span class=variable>expressions</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ProgramExpression</span>(str);</span><br><span class=line>        expressions.interpret();</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-8、Command（命令模式）><a class=headerlink href=#1-2-8、Command（命令模式） title=1.2.8、Command（命令模式）></a>1.2.8、Command（命令模式）</h3><h4 id=简介-11><a class=headerlink href=#简介-11 title=简介></a>简介</h4><p><strong>将请求以 命令形式 封装至对象A中，然后调用对象B将对象A传递给 能处理A对象中命令的 对象C，对象C拿到A对象后执行其中的命令。</strong><h4 id=何时使用-12><a class=headerlink href=#何时使用-12 title=何时使用></a>何时使用</h4><p>在某些场合，比如要对行为进行 “记录、撤销 / 重做、事务” 等处理，这种无法抵御变化的紧耦合是不合适的。在这种情况下，如何将 “行为请求者” 与 “行为实现者” 解耦？将一组行为抽象为对象，可以实现二者之间的松耦合。<h4 id=优缺点-12><a class=headerlink href=#优缺点-12 title=优缺点></a>优缺点</h4><ul><li><p>优点</p> <ol><li>降低了系统耦合度。<li>新命令可以很容易添加到系统中去。</ol><li><p>缺点</p> <p>可能会导致某些系统有过多的具体命令类。</p></ul><h4 id=应用场景-11><a class=headerlink href=#应用场景-11 title=应用场景></a>应用场景</h4><ol><li>GUI 中每一个按钮都是一条命令。<li>模拟 CMD。</ol><h4 id=应用实例-12><a class=headerlink href=#应用实例-12 title=应用实例></a>应用实例</h4><p>struts 1 中 action 的核心控制器 ActionServlet 只有一个，相当于 Invoker，而模型层也会有对应不同的模型类，相当于具体的 Command。<h4 id=注意事项-12><a class=headerlink href=#注意事项-12 title=注意事项></a>注意事项</h4><p><font color=red>需要支持命令的撤销 (Undo) 操作和恢复 (Redo) 操作。</font><h4 id=代码实例-12><a class=headerlink href=#代码实例-12 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br></pre><td class=code><pre><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 邮局接口</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">IPost</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">sendMail</span><span class=params>(String msg)</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">IReceiver</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">readMail</span><span class=params>(String msg)</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 邮局实现</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Post</span> <span class=keyword>implements</span> <span class="title class_">IPost</span>{</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>final</span> IReceiver receiver;</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">Post</span><span class=params>(IReceiver receiver)</span>{</span><br><span class=line>        <span class=built_in>this</span>.receiver = receiver;</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">sendMail</span><span class=params>(String msg)</span> {</span><br><span class=line>        System.out.println(<span class=string>"邮局发送信件给收件人......"</span> );</span><br><span class=line>        <span class=built_in>this</span>.receiver.readMail(msg);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 发信人</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Invoker</span> {</span><br><span class=line>    <span class=keyword>private</span> IPost iPost;</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setiPost</span><span class=params>(IPost iPost)</span> {</span><br><span class=line>        <span class=built_in>this</span>.iPost = iPost;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">postMail</span><span class=params>(String msg)</span> {</span><br><span class=line>        System.out.println(<span class=string>"发信人投递邮件给邮局......"</span>);</span><br><span class=line>        <span class=built_in>this</span>.iPost.sendMail(msg);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 接收人</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Receiver</span>  <span class=keyword>implements</span> <span class="title class_">IReceiver</span>{</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">readMail</span><span class=params>(String msg)</span>{</span><br><span class=line>        System.out.println(<span class=string>"收件人收到信件，开始读取消息: "</span> + msg);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">CommandApp</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>Receiver</span> <span class=variable>receiver</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Receiver</span>();</span><br><span class=line>        <span class=type>IPost</span> <span class=variable>iPost</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Post</span>(receiver);</span><br><span class=line></span><br><span class=line>        <span class=type>Invoker</span> <span class=variable>invoker</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Invoker</span>();</span><br><span class=line>        invoker.setiPost(iPost);</span><br><span class=line>        invoker.postMail(<span class=string>"好久不见，近来如何？"</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-9、State（状态模式）><a class=headerlink href=#1-2-9、State（状态模式） title=1.2.9、State（状态模式）></a>1.2.9、State（状态模式）</h3><h4 id=简介-12><a class=headerlink href=#简介-12 title=简介></a>简介</h4><p><strong>状态模式下 会创建各种状态对象 和 一个会随状态对象改变而改变其行为的context对象。</strong><h4 id=何时使用-13><a class=headerlink href=#何时使用-13 title=何时使用></a>何时使用</h4><p>代码中包含大量与对象状态有关的条件语句。<h4 id=优缺点-13><a class=headerlink href=#优缺点-13 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>封装了转换规则。<li>枚举可能的状态，在枚举状态之前需要确定状态种类。<li>将所有与某个状态有关的行为放到一个类中，并且可以方便地增加新的状态，只需要改变对象状态即可改变对象的行为。<li>允许状态转换逻辑与状态对象合成一体，而不是某一个巨大的条件语句块。<li>可以让多个环境对象共享一个状态对象，从而减少系统中对象的个数。</ol><li>缺点<ol><li>状态模式的使用必然会增加系统类和对象的个数。<li>状态模式的结构与实现都较为复杂，如果使用不当将导致程序结构和代码的混乱。<li>状态模式对 “开闭原则” 的支持并不太好，对于可以切换状态的状态模式，增加新的状态类需要修改那些负责状态转换的源代码，否则无法切换到新增状态，而且修改某个状态类的行为也需修改对应类的源代码。</ol></ul><h4 id=应用场景-12><a class=headerlink href=#应用场景-12 title=应用场景></a>应用场景</h4><ol><li>行为随状态改变而改变的场景。<li>条件、分支语句的代替者。</ol><h4 id=应用实例-13><a class=headerlink href=#应用实例-13 title=应用实例></a>应用实例</h4><ol><li>打篮球的时候运动员可以有正常状态. 不正常状态和超常状态。<li>‘曾侯乙编钟’是具体环境(Context)，钟是抽象接口，钟 A是具体状态。</ol><h4 id=注意事项-13><a class=headerlink href=#注意事项-13 title=注意事项></a>注意事项</h4><p><font color=red>行为受状态约束时使用状态模式，而且状态不超过 5 个。</font><h4 id=代码实例-13><a class=headerlink href=#代码实例-13 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Context</span> {</span><br><span class=line>    <span class=keyword>private</span> State state;</span><br><span class=line>    <span class=keyword>private</span> String name;</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">Context</span><span class=params>(String name)</span> {</span><br><span class=line>        <span class=built_in>this</span>.name = name;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setState</span><span class=params>(State state)</span> {</span><br><span class=line>        <span class=built_in>this</span>.state = state;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> State <span class="title function_">getState</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=built_in>this</span>.state;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">State</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">doAction</span><span class=params>(Context context)</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">DeductState</span> <span class=keyword>implements</span> <span class="title class_">State</span> {</span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">toString</span><span class=params>()</span>{</span><br><span class=line>        <span class=keyword>return</span> <span class=string>"Deduct State"</span>;</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">doAction</span><span class=params>(Context context)</span> {</span><br><span class=line>        System.out.println(<span class=string>"商品卖出，准备减库存"</span>);</span><br><span class=line>        context.setState(<span class=built_in>this</span>);</span><br><span class=line></span><br><span class=line>        <span class=comment>//... 执行减库存的具体操作</span></span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">RevertState</span> <span class=keyword>implements</span> <span class="title class_">State</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">doAction</span><span class=params>(Context context)</span> {</span><br><span class=line>        System.out.println(<span class=string>"给此商品补库存"</span>);</span><br><span class=line>        context.setState(<span class=built_in>this</span>);</span><br><span class=line></span><br><span class=line>        <span class=comment>//... 执行加库存的具体操作</span></span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">toString</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=string>"Revert State"</span>;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">StateApp</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=comment>// 我们需要操作的是 iPhone X</span></span><br><span class=line>        <span class=type>Context</span> <span class=variable>context</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Context</span>(<span class=string>"iPhone X"</span>);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 看看怎么进行补库存操作</span></span><br><span class=line>        <span class=type>State</span> <span class=variable>revertState</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">RevertState</span>();</span><br><span class=line>        revertState.doAction(context);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 同样的，减库存操作也非常简单</span></span><br><span class=line>        <span class=type>State</span> <span class=variable>deductState</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">DeductState</span>();</span><br><span class=line>        deductState.doAction(context);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 如果需要我们可以获取当前的状态</span></span><br><span class=line>        <span class=comment>// context.getState().toString();</span></span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-10、Visitor（访问者模式）><a class=headerlink href=#1-2-10、Visitor（访问者模式） title=1.2.10、Visitor（访问者模式）></a>1.2.10、Visitor（访问者模式）</h3><h4 id=简介-13><a class=headerlink href=#简介-13 title=简介></a>简介</h4><p><strong>元素类的执行算法可以随着访问者改变而改变。访问者对象可以处理元素对象上的操作。</strong><h4 id=何时使用-14><a class=headerlink href=#何时使用-14 title=何时使用></a>何时使用</h4><p>对一个对象执行多种不同操作，且要避免这些操作影响对象关联的类，可以使用该模式将这些操作封装到类中。<h4 id=优缺点-14><a class=headerlink href=#优缺点-14 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>符合单一职责原则。<li>优秀的扩展性。<li>灵活性。</ol><li>缺点<ol><li>具体元素对访问者公布细节，违反了迪米特原则。<li>具体元素变更比较困难。<li>违反了依赖倒置原则，依赖具体类，没有依赖抽象。</ol></ul><h4 id=应用场景-13><a class=headerlink href=#应用场景-13 title=应用场景></a>应用场景</h4><ol><li>对象对应的类很少改变，但需要在对象上添加新操作。<li>需要对一个对象执行多种不同操作，且要避免这些操作影响对象对应的类，且在添加新操作时也不想修改该类的场景；</ol><h4 id=应用实例-14><a class=headerlink href=#应用实例-14 title=应用实例></a>应用实例</h4><p>你去朋友家做客，您是访问者，朋友接受您的访问，然后对朋友的描述做出一个判断，这就是访问者模式。<h4 id=注意事项-14><a class=headerlink href=#注意事项-14 title=注意事项></a>注意事项</h4><p><font color=red>访问者可以对功能进行统一，可以做报表、UI、拦截器与过滤器。</font><h4 id=代码实例-14><a class=headerlink href=#代码实例-14 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br><span class=line>120</span><br><span class=line>121</span><br><span class=line>122</span><br><span class=line>123</span><br><span class=line>124</span><br><span class=line>125</span><br><span class=line>126</span><br><span class=line>127</span><br><span class=line>128</span><br><span class=line>129</span><br><span class=line>130</span><br><span class=line>131</span><br><span class=line>132</span><br><span class=line>133</span><br><span class=line>134</span><br><span class=line>135</span><br><span class=line>136</span><br><span class=line>137</span><br><span class=line>138</span><br><span class=line>139</span><br><span class=line>140</span><br><span class=line>141</span><br><span class=line>142</span><br><span class=line>143</span><br><span class=line>144</span><br><span class=line>145</span><br><span class=line>146</span><br><span class=line>147</span><br><span class=line>148</span><br><span class=line>149</span><br><span class=line>150</span><br><span class=line>151</span><br><span class=line>152</span><br><span class=line>153</span><br><span class=line>154</span><br><span class=line>155</span><br><span class=line>156</span><br><span class=line>157</span><br><span class=line>158</span><br><span class=line>159</span><br><span class=line>160</span><br><span class=line>161</span><br><span class=line>162</span><br><span class=line>163</span><br><span class=line>164</span><br><span class=line>165</span><br><span class=line>166</span><br><span class=line>167</span><br><span class=line>168</span><br><span class=line>169</span><br><span class=line>170</span><br><span class=line>171</span><br><span class=line>172</span><br><span class=line>173</span><br><span class=line>174</span><br><span class=line>175</span><br><span class=line>176</span><br><span class=line>177</span><br><span class=line>178</span><br><span class=line>179</span><br><span class=line>180</span><br><span class=line>181</span><br><span class=line>182</span><br><span class=line>183</span><br><span class=line>184</span><br><span class=line>185</span><br><span class=line>186</span><br><span class=line>187</span><br><span class=line>188</span><br></pre><td class=code><pre><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 访问者接口</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">IVisitor</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">visit</span><span class=params>(Manager manager)</span>;</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">visit</span><span class=params>(Employees employees)</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 计算薪资访问者</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">ISalaryVisitor</span> <span class=keyword>extends</span> <span class="title class_">IVisitor</span>{</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">printManagerTotalSalary</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">printEmployeesTotalSalary</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">printTotalSalary</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 抽象员工类</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>class</span> <span class="title class_">Staff</span> {</span><br><span class=line>    <span class=keyword>protected</span> String no;</span><br><span class=line>    <span class=keyword>protected</span> String name;</span><br><span class=line>    <span class=keyword>protected</span> String position;</span><br><span class=line>    <span class=keyword>protected</span> <span class=type>float</span> salary;</span><br><span class=line>    <span class=keyword>private</span> <span class=type>int</span> length;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">Staff</span><span class=params>(String no, String name, String position, <span class=type>float</span> salary)</span> {</span><br><span class=line>        <span class=built_in>this</span>.no = no;</span><br><span class=line>        <span class=built_in>this</span>.name = name;</span><br><span class=line>        <span class=built_in>this</span>.position = position;</span><br><span class=line>        <span class=built_in>this</span>.salary = salary;</span><br><span class=line></span><br><span class=line>        <span class=built_in>this</span>.length += (no == <span class=literal>null</span> || <span class=string>""</span>.equals(no.trim())) ? <span class=number>0</span> : no.getBytes().length;</span><br><span class=line>        <span class=built_in>this</span>.length += (no == <span class=literal>null</span> || <span class=string>""</span>.equals(name.trim())) ? <span class=number>0</span> : name.getBytes().length;</span><br><span class=line>        <span class=built_in>this</span>.length += (no == <span class=literal>null</span> || <span class=string>""</span>.equals(position.trim())) ? <span class=number>0</span> : position.getBytes().length;</span><br><span class=line>        <span class=built_in>this</span>.length += String.valueOf(salary).getBytes().length;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">printUserBaseInfo</span><span class=params>()</span>{</span><br><span class=line>        System.out.println(<span class=built_in>this</span>.no + <span class=string>"/"</span> + <span class=built_in>this</span>.name + <span class=string>"/"</span> + <span class=built_in>this</span>.position + <span class=string>"/"</span> + <span class=built_in>this</span>.salary);</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>void</span> <span class="title function_">add</span><span class=params>(Staff staff)</span>;</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>abstract</span> Staff <span class="title function_">remove</span><span class=params>(String no)</span>;</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>void</span> <span class="title function_">accept</span><span class=params>(IVisitor visitor)</span>;</span><br><span class=line></span><br><span class=line>	<span class=comment>// set/get methods ...</span></span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Manager</span> <span class=keyword>extends</span> <span class="title class_">Staff</span>{</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>final</span> ArrayList&LTStaff> staffList = <span class=keyword>new</span> <span class="title class_">ArrayList</span>&LTStaff>();</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">Manager</span><span class=params>(String no, String name, String position, <span class=type>float</span> salary)</span>{</span><br><span class=line>        <span class=built_in>super</span>(no, name, position, salary);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">add</span><span class=params>(Staff staff)</span> {</span><br><span class=line>        <span class=built_in>this</span>.staffList.add(staff);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Staff <span class="title function_">remove</span><span class=params>(String no)</span> {</span><br><span class=line>        <span class=type>Staff</span> <span class=variable>staff</span> <span class=operator>=</span> <span class=literal>null</span>;</span><br><span class=line>        <span class=keyword>if</span> (no != <span class=literal>null</span> && !<span class=string>""</span>.equals(no.trim())){</span><br><span class=line>            <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>i</span> <span class=operator>=</span> <span class=number>0</span>; i < <span class=built_in>this</span>.staffList.size(); i++){</span><br><span class=line>                <span class=keyword>if</span> (<span class=built_in>this</span>.staffList.get(i) == <span class=literal>null</span>){</span><br><span class=line>                    <span class=keyword>continue</span>;</span><br><span class=line>                }</span><br><span class=line>                <span class=keyword>if</span> (no.equals(<span class=built_in>this</span>.staffList.get(i).getNo())){</span><br><span class=line>                    staff = <span class=built_in>this</span>.staffList.remove(i);</span><br><span class=line>                    <span class=keyword>break</span>;</span><br><span class=line>                }</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> staff;</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">accept</span><span class=params>(IVisitor visitor)</span> {</span><br><span class=line>        visitor.visit(<span class=built_in>this</span>);</span><br><span class=line>        <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>i</span> <span class=operator>=</span> <span class=number>0</span>; i < <span class=built_in>this</span>.staffList.size(); i++){</span><br><span class=line>            <span class=keyword>if</span> (<span class=built_in>this</span>.staffList.get(i) == <span class=literal>null</span>){</span><br><span class=line>                <span class=keyword>continue</span>;</span><br><span class=line>            }</span><br><span class=line>            <span class=built_in>this</span>.staffList.get(i).accept(visitor);</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Employees</span> <span class=keyword>extends</span> <span class="title class_">Staff</span>{</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">Employees</span><span class=params>(String no, String name, String position, <span class=type>float</span> salary)</span>{</span><br><span class=line>        <span class=built_in>super</span>(no, name, position, salary);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">add</span><span class=params>(Staff staff)</span> {</span><br><span class=line>        <span class=keyword>return</span>;</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Staff <span class="title function_">remove</span><span class=params>(String no)</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=literal>null</span>;</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">accept</span><span class=params>(IVisitor visitor)</span> {</span><br><span class=line>        visitor.visit(<span class=built_in>this</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 打印基本信息访问者</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">PrintBaseInfoVisitor</span> <span class=keyword>implements</span> <span class="title class_">IVisitor</span>{</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">visit</span><span class=params>(Manager manager)</span> {</span><br><span class=line>        System.out.print(<span class=string>"管理者: "</span>);</span><br><span class=line>        manager.printUserBaseInfo();</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">visit</span><span class=params>(Employees employees)</span> {</span><br><span class=line>        System.out.print(<span class=string>"普通员工: "</span>);</span><br><span class=line>        employees.printUserBaseInfo();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">SalaryVisitor</span> <span class=keyword>implements</span> <span class="title class_">ISalaryVisitor</span>{</span><br><span class=line>    <span class=keyword>private</span> <span class=type>float</span> managerSalary;</span><br><span class=line>    <span class=keyword>private</span> <span class=type>float</span> employeesSalary;</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">SalaryVisitor</span><span class=params>()</span>{</span><br><span class=line>        managerSalary = <span class=number>0</span>;</span><br><span class=line>        employeesSalary = <span class=number>0</span>;</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">printManagerTotalSalary</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"管理者薪资总和："</span> + managerSalary);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">printEmployeesTotalSalary</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"一般员工薪资总和："</span> + employeesSalary);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">printTotalSalary</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"员工薪资总和："</span> + (managerSalary + employeesSalary));</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">visit</span><span class=params>(Manager manager)</span> {</span><br><span class=line>        managerSalary += manager.getSalary();</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">visit</span><span class=params>(Employees employees)</span> {</span><br><span class=line>        employeesSalary += employees.getSalary();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">VisitorApp</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>Staff</span> <span class=variable>boss</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Manager</span>(<span class=string>"1"</span>, <span class=string>"大老板"</span>, <span class=string>"CEO"</span>, <span class=number>100000</span>);</span><br><span class=line></span><br><span class=line>        <span class=type>Staff</span> <span class=variable>financeManager</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Manager</span>(<span class=string>"11"</span>, <span class=string>"张总"</span>, <span class=string>"财务部经理"</span>, <span class=number>60000</span>);</span><br><span class=line>        <span class=type>Staff</span> <span class=variable>personnelManager</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Manager</span>(<span class=string>"12"</span>, <span class=string>"王总"</span>, <span class=string>"人事部经理"</span>, <span class=number>60000</span>);</span><br><span class=line></span><br><span class=line>        <span class=type>Staff</span> <span class=variable>technicalManager</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Manager</span>(<span class=string>"13"</span>, <span class=string>"陈总"</span>, <span class=string>"技术部经理"</span>, <span class=number>60000</span>);</span><br><span class=line>        <span class=type>Staff</span> <span class=variable>deptAssistant</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Manager</span>(<span class=string>"1301"</span>, <span class=string>"王助理"</span>, <span class=string>"技术部助理"</span>, <span class=number>20000</span>);</span><br><span class=line>        <span class=type>Staff</span> <span class=variable>deptManager1</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Manager</span>(<span class=string>"1302"</span>, <span class=string>"主管1"</span>, <span class=string>"技术部主管"</span>, <span class=number>30000</span>);</span><br><span class=line>        <span class=type>Staff</span> <span class=variable>softwareEngineer1</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Employees</span>(<span class=string>"1302001"</span>, <span class=string>"张三"</span>, <span class=string>"软件工程师"</span>, <span class=number>5000</span>);</span><br><span class=line>        <span class=type>Staff</span> <span class=variable>softwareEngineer2</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Employees</span>(<span class=string>"1302002"</span>, <span class=string>"李四"</span>, <span class=string>"软件工程师"</span>, <span class=number>5500</span>);</span><br><span class=line>        <span class=type>Staff</span> <span class=variable>softwareEngineer3</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Employees</span>(<span class=string>"1302003"</span>, <span class=string>"王五"</span>, <span class=string>"软件工程师"</span>, <span class=number>4500</span>);</span><br><span class=line></span><br><span class=line>        deptManager1.add(softwareEngineer1);</span><br><span class=line>        deptManager1.add(softwareEngineer2);</span><br><span class=line>        deptManager1.add(softwareEngineer3);</span><br><span class=line></span><br><span class=line>        <span class=type>Staff</span> <span class=variable>deptManager2</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Manager</span>(<span class=string>"1302"</span>, <span class=string>"主管2"</span>, <span class=string>"技术部主管"</span>, <span class=number>30000</span>);</span><br><span class=line>        technicalManager.add(deptAssistant);</span><br><span class=line>        technicalManager.add(deptManager1);</span><br><span class=line>        technicalManager.add(deptManager2);</span><br><span class=line></span><br><span class=line>        <span class=type>Staff</span> <span class=variable>marketingManager</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Manager</span>(<span class=string>"14"</span>, <span class=string>"吴总"</span>, <span class=string>"市场部经理"</span>, <span class=number>60000</span>);</span><br><span class=line></span><br><span class=line>        boss.add(financeManager);</span><br><span class=line>        boss.add(personnelManager);</span><br><span class=line>        boss.add(technicalManager);</span><br><span class=line>        boss.add(marketingManager);</span><br><span class=line></span><br><span class=line>        boss.printUserBaseInfo();</span><br><span class=line>        boss.accept(<span class=keyword>new</span> <span class="title class_">PrintBaseInfoVisitor</span>());</span><br><span class=line></span><br><span class=line>        <span class=type>SalaryVisitor</span> <span class=variable>visitor</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">SalaryVisitor</span>();</span><br><span class=line>        boss.accept(visitor);</span><br><span class=line>        visitor.printManagerTotalSalary();</span><br><span class=line>        visitor.printEmployeesTotalSalary();</span><br><span class=line>        visitor.printTotalSalary();</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-11、Memento（备忘录模式）><a class=headerlink href=#1-2-11、Memento（备忘录模式） title=1.2.11、Memento（备忘录模式）></a>1.2.11、Memento（备忘录模式）</h3><h4 id=简介-14><a class=headerlink href=#简介-14 title=简介></a>简介</h4><p><strong>在不破坏封装性的前提下捕获一个对象的内部状态，并将该状态存于对象外。后续可恢复对象至该状态；</strong><h4 id=何时使用-15><a class=headerlink href=#何时使用-15 title=何时使用></a>何时使用</h4><p>用户需要取消不确定或者错误的操作时，能够恢复到他原先的状态，使得他有 “后悔药” 可吃。<h4 id=优缺点-15><a class=headerlink href=#优缺点-15 title=优缺点></a>优缺点</h4><ul><li><p>优点</p> <ol><li>给用户提供了一种可以恢复状态的机制，可以使用户能够比较方便地回到某个历史的状态。<li>实现了信息的封装，使得用户不需要关心状态的保存细节。</ol><li><p>缺点</p> <p>消耗资源。类成员数量多导致占用大量资源，且保存时会占用内存。</p></ul><h4 id=应用场景-14><a class=headerlink href=#应用场景-14 title=应用场景></a>应用场景</h4><ol><li>需要保存 / 恢复数据的相关状态场景。<li>提供一个可回滚的操作。</ol><h4 id=应用实例-15><a class=headerlink href=#应用实例-15 title=应用实例></a>应用实例</h4><ol><li>后悔药。<li>打游戏时的存档。<li>Windows 里的 ctri + z。<li>IE 中的后退。<li>数据库的事务管理。</ol><h4 id=注意事项-15><a class=headerlink href=#注意事项-15 title=注意事项></a>注意事项</h4><ol><li><font color=red>为了符合迪米特原则，还要增加一个管理备忘录的类。</font><li><font color=red>为了节约内存，可使用原型模式 + 备忘录模式。</font></ol><h4 id=代码实例-15><a class=headerlink href=#代码实例-15 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">INarrowMemento</span> {</span><br><span class=line></span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Hero</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=type>int</span> blood;</span><br><span class=line>    <span class=keyword>private</span> <span class=type>int</span> sword;</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>final</span> <span class=type>Random</span> <span class=variable>random</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Random</span>();</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">Hero</span><span class=params>()</span>{</span><br><span class=line>        <span class=built_in>this</span>.blood = <span class=number>100</span>;</span><br><span class=line>        <span class=built_in>this</span>.sword = <span class=number>100</span>;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> INarrowMemento <span class="title function_">createMemento</span><span class=params>()</span>{</span><br><span class=line>        System.out.println(<span class=string>"创建备忘录..."</span>);</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">Memento</span>(<span class=built_in>this</span>.blood, <span class=built_in>this</span>.sword);</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">restoreFromMemento</span><span class=params>(INarrowMemento memento)</span>{</span><br><span class=line>        System.out.println(<span class=string>"修改备忘录的状态..."</span>);</span><br><span class=line>        <span class=keyword>if</span> (memento != <span class=literal>null</span>){</span><br><span class=line>            <span class=type>Memento</span> <span class=variable>memento2</span> <span class=operator>=</span> (Memento) memento;</span><br><span class=line>            <span class=built_in>this</span>.blood = memento2.getBlood();</span><br><span class=line>            <span class=built_in>this</span>.sword = memento2.getSword();</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=type>int</span> <span class="title function_">koBoss</span><span class=params>()</span>{</span><br><span class=line>        <span class=keyword>if</span> (<span class=built_in>this</span>.blood <= <span class=number>0</span> || <span class=built_in>this</span>.sword <= <span class=number>0</span>){</span><br><span class=line>            System.out.println(<span class=built_in>this</span>.toString());</span><br><span class=line>            System.out.println(<span class=string>"挑战BOSS失败！！！"</span>);</span><br><span class=line>            <span class=keyword>return</span> -<span class=number>1</span>;</span><br><span class=line>        }<span class=keyword>else</span> {</span><br><span class=line>            <span class=type>double</span> <span class=variable>win</span> <span class=operator>=</span> Math.random();</span><br><span class=line>            <span class=keyword>if</span> (win <= <span class=number>0.02</span>){</span><br><span class=line>                System.out.println(<span class=built_in>this</span>.toString());</span><br><span class=line>                System.out.println(<span class=string>"恭喜您，挑战BOSS成功。"</span>);</span><br><span class=line>                <span class=keyword>return</span> <span class=number>1</span>;</span><br><span class=line>            }<span class=keyword>else</span> {</span><br><span class=line>                System.out.println(<span class=built_in>this</span>.toString());</span><br><span class=line>                System.out.println(<span class=string>"继续攻击BOSS..."</span>);</span><br><span class=line>                <span class=type>int</span> <span class=variable>blood_sub</span> <span class=operator>=</span> random.nextInt(<span class=number>10</span>);</span><br><span class=line>                <span class=type>int</span> <span class=variable>sword_sub</span> <span class=operator>=</span> random.nextInt(<span class=number>10</span>);</span><br><span class=line>                <span class=built_in>this</span>.blood -= blood_sub;</span><br><span class=line>                <span class=built_in>this</span>.sword -= sword_sub;</span><br><span class=line>                <span class=keyword>return</span> <span class=number>0</span>;</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">toString</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=string>"当前血量："</span> + <span class=built_in>this</span>.blood + <span class=string>", 当前力量："</span> + <span class=built_in>this</span>.sword;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>class</span> <span class="title class_">Memento</span> <span class=keyword>implements</span> <span class="title class_">INarrowMemento</span>{</span><br><span class=line>        <span class=keyword>private</span> <span class=type>int</span> blood;</span><br><span class=line>        <span class=keyword>private</span> <span class=type>int</span> sword;</span><br><span class=line>        <span class=keyword>public</span> <span class="title function_">Memento</span><span class=params>(<span class=type>int</span> blood, <span class=type>int</span> sword)</span>{</span><br><span class=line>            <span class=built_in>this</span>.blood = blood;</span><br><span class=line>            <span class=built_in>this</span>.sword = sword;</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>public</span> <span class=type>int</span> <span class="title function_">getBlood</span><span class=params>()</span> {</span><br><span class=line>            <span class=keyword>return</span> blood;</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>public</span> <span class=type>int</span> <span class="title function_">getSword</span><span class=params>()</span> {</span><br><span class=line>            <span class=keyword>return</span> sword;</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Caretaker</span> {</span><br><span class=line>    <span class=keyword>private</span> INarrowMemento memento;</span><br><span class=line>    <span class=keyword>public</span> INarrowMemento <span class="title function_">getMemento</span><span class=params>()</span>{</span><br><span class=line>        <span class=keyword>return</span> memento;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setMemento</span><span class=params>(INarrowMemento memento)</span> {</span><br><span class=line>        <span class=built_in>this</span>.memento = memento;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">MementoOfBlackApp</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>Hero</span> <span class=variable>hero</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Hero</span>();</span><br><span class=line>        <span class=type>Caretaker</span> <span class=variable>caretaker</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Caretaker</span>();</span><br><span class=line>        caretaker.setMemento(hero.createMemento());</span><br><span class=line>        <span class=type>int</span> <span class=variable>cnt</span> <span class=operator>=</span> <span class=number>1</span>;</span><br><span class=line>        <span class=type>int</span> <span class=variable>ko</span> <span class=operator>=</span> -<span class=number>1</span>;</span><br><span class=line>        <span class=keyword>while</span> (ko != <span class=number>1</span> && cnt <= <span class=number>3</span>){</span><br><span class=line>            System.out.println(<span class=string>"第 "</span> + cnt + <span class=string>" 次挑战！"</span>);</span><br><span class=line>            ko = hero.koBoss();</span><br><span class=line>            <span class=keyword>while</span> (<span class=literal>true</span>){</span><br><span class=line>                <span class=keyword>if</span> (ko == -<span class=number>1</span>){</span><br><span class=line>                    hero.restoreFromMemento(caretaker.getMemento());</span><br><span class=line>                    cnt += <span class=number>1</span>;</span><br><span class=line>                    <span class=keyword>break</span>;</span><br><span class=line>                }<span class=keyword>else</span> <span class=keyword>if</span> (ko == <span class=number>0</span>){</span><br><span class=line>                    ko = hero.koBoss();</span><br><span class=line>                }<span class=keyword>else</span> <span class=keyword>if</span> (ko == <span class=number>1</span>){</span><br><span class=line>                    <span class=keyword>break</span>;</span><br><span class=line>                }</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h2 id=1-3、结构型（7种）><a class=headerlink href=#1-3、结构型（7种） title=1.3、结构型（7种）></a>1.3、结构型（7种）</h2><h3 id=1-3-1、Composite（组合模式）><a class=headerlink href=#1-3-1、Composite（组合模式） title=1.3.1、Composite（组合模式）></a>1.3.1、Composite（组合模式）</h3><h4 id=简介-15><a class=headerlink href=#简介-15 title=简介></a>简介</h4><p><strong>将对象组合成树形结构以表示 部分和整体 的层次结构。它使得客户对单个对象和复合对象的使用具有一致性</strong>。<h4 id=何时使用-16><a class=headerlink href=#何时使用-16 title=何时使用></a>何时使用</h4><ol><li>想表示对象部分 - 整体的层次结构（树形结构）。<li>忽略组合对象与单个对象的不同，用户将统一地使用组合结构中的所有对象。</ol><h5 id=优缺点-16><a class=headerlink href=#优缺点-16 title=优缺点></a>优缺点</h5><ul><li><p>优点</p> <ol><li>高层模块调用简单。<li>节点自由增加。</ol><li><p>缺点</p> <p>在使用组合模式时，其叶子和树枝的声明都是实现类，而不是接口，违反了依赖倒置原则。</p></ul><h4 id=应用场景-15><a class=headerlink href=#应用场景-15 title=应用场景></a>应用场景</h4><p>部分. 整体场景，如树形菜单，文件. 文件夹的管理。<h4 id=应用实例-16><a class=headerlink href=#应用实例-16 title=应用实例></a>应用实例</h4><ol><li>算术表达式包括操作数. 操作符和另一个操作数，其中，另一个操作符也可以是操作数. 操作符和另一个操作数。<li>在 JAVA AWT 和 SWING 中，对于 Button 和 Checkbox 是树叶，Container 是树枝。</ol><h4 id=注意事项-16><a class=headerlink href=#注意事项-16 title=注意事项></a>注意事项</h4><p><font color=red>定义时 为 具体类。</font><h4 id=代码实例-16><a class=headerlink href=#代码实例-16 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br></pre><td class=code><pre><span class=line><span class=keyword>import</span> java.util.ArrayList;</span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Employee</span> {</span><br><span class=line>    <span class=keyword>private</span> String name;</span><br><span class=line>    <span class=keyword>private</span> String dept;</span><br><span class=line>    <span class=keyword>private</span> <span class=type>int</span> salary;</span><br><span class=line>    <span class=keyword>private</span> List&LTEmployee> subordinates; <span class=comment>// 下属</span></span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">Employee</span><span class=params>(String name,String dept, <span class=type>int</span> sal)</span> {</span><br><span class=line>        <span class=built_in>this</span>.name = name;</span><br><span class=line>        <span class=built_in>this</span>.dept = dept;</span><br><span class=line>        <span class=built_in>this</span>.salary = sal;</span><br><span class=line>        subordinates = <span class=keyword>new</span> <span class="title class_">ArrayList</span>&LTEmployee>();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">add</span><span class=params>(Employee e)</span> {</span><br><span class=line>        subordinates.add(e);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">remove</span><span class=params>(Employee e)</span> {</span><br><span class=line>        subordinates.remove(e);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> List&LTEmployee> <span class="title function_">getSubordinates</span><span class=params>()</span>{</span><br><span class=line>        <span class=keyword>return</span> subordinates;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">toString</span><span class=params>()</span>{</span><br><span class=line>        <span class=keyword>return</span> (<span class=string>"Employee :[ Name : "</span> + name + <span class=string>", dept : "</span> + dept + <span class=string>", salary :"</span> + salary+<span class=string>" ]"</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-3-2、Facade（外观模式）><a class=headerlink href=#1-3-2、Facade（外观模式） title=1.3.2、Facade（外观模式）></a>1.3.2、Facade（外观模式）</h3><h4 id=简介-16><a class=headerlink href=#简介-16 title=简介></a>简介</h4><p><strong>为子系统内部一系列小接口提供一个高层接口，通过高层接口来统一访问操作系统，提高了使用子系统的便利性；</strong><h4 id=何时使用-17><a class=headerlink href=#何时使用-17 title=何时使用></a>何时使用</h4><ol><li>无需知道系统内部，只需提供一个系统 “接待员” 即可。<li>定义系统的入口。</ol><h4 id=优缺点-17><a class=headerlink href=#优缺点-17 title=优缺点></a>优缺点</h4><ul><li><p>优点</p> <ol><li>减少系统相互依赖。<li>提高灵活性。<li>提高了安全性。</ol><li><p>缺点</p> <p>不符合开闭原则，如果要改东西很麻烦，继承重写都不合适。</p></ul><h4 id=应用场景-16><a class=headerlink href=#应用场景-16 title=应用场景></a>应用场景</h4><ol><li>为复杂的模块或子系统提供外界访问的模块。<li>子系统相对独立。<li>预防低水平人员带来的风险。</ol><h4 id=应用实例-17><a class=headerlink href=#应用实例-17 title=应用实例></a>应用实例</h4><ol><li>去医院看病，可能要去挂号、门诊、划价、取药，让患者或患者家属觉得很复杂，如果有提供接待人员，只让接待人员来处理，就很方便。<li>JAVA 的三层开发模式。</ol><h4 id=注意事项-17><a class=headerlink href=#注意事项-17 title=注意事项></a>注意事项</h4><p><font color=red>在层次化结构中，可以使用外观模式定义系统每一层的入口。</font><h4 id=代码实例-17><a class=headerlink href=#代码实例-17 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">Shape</span> {</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">draw</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Circle</span> <span class=keyword>implements</span> <span class="title class_">Shape</span>{</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">draw</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Circle::draw()"</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Rectangle</span> <span class=keyword>implements</span> <span class="title class_">Shape</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">draw</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Rectangle::draw()"</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">FacadeApp</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=comment>// 画一个圆形</span></span><br><span class=line>        <span class=type>Shape</span> <span class=variable>circle</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Circle</span>();</span><br><span class=line>        circle.draw();</span><br><span class=line></span><br><span class=line>        <span class=comment>// 画一个长方形</span></span><br><span class=line>        <span class=type>Shape</span> <span class=variable>rectangle</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Rectangle</span>();</span><br><span class=line>        rectangle.draw();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ShapeMaker</span> {</span><br><span class=line>    <span class=keyword>private</span> Shape circle;</span><br><span class=line>    <span class=keyword>private</span> Shape rectangle;</span><br><span class=line>    <span class=keyword>private</span> Shape square;</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">ShapeMaker</span><span class=params>()</span> {</span><br><span class=line>        circle = <span class=keyword>new</span> <span class="title class_">Circle</span>();</span><br><span class=line>        rectangle = <span class=keyword>new</span> <span class="title class_">Rectangle</span>();</span><br><span class=line>        square = <span class=keyword>new</span> <span class="title class_">Square</span>();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 下面定义一堆方法，具体应该调用什么方法，由这个门面来决定</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">drawCircle</span><span class=params>()</span>{</span><br><span class=line>        circle.draw();</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">drawRectangle</span><span class=params>()</span>{</span><br><span class=line>        rectangle.draw();</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">drawSquare</span><span class=params>()</span>{</span><br><span class=line>        square.draw();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ShapeMakerApp</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>ShapeMaker</span> <span class=variable>shapeMaker</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ShapeMaker</span>();</span><br><span class=line>        <span class=comment>// 客户端调用现在更加清晰了</span></span><br><span class=line>        shapeMaker.drawCircle();</span><br><span class=line>        shapeMaker.drawRectangle();</span><br><span class=line>        shapeMaker.drawSquare();</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-3-3、Proxy（代理模式）><a class=headerlink href=#1-3-3、Proxy（代理模式） title=1.3.3、Proxy（代理模式）></a>1.3.3、Proxy（代理模式）</h3><h4 id=简介-17><a class=headerlink href=#简介-17 title=简介></a>简介</h4><p><strong>为某个动作生成一个代理，用来控制对目标对象的访问。</strong><h4 id=实现-2><a class=headerlink href=#实现-2 title=实现></a>实现</h4><ul><li>静态代理<li>动态代理</ul><h4 id=何时使用-18><a class=headerlink href=#何时使用-18 title=何时使用></a>何时使用</h4><p>想在访问一个类时做一些控制。<h4 id=优缺点-18><a class=headerlink href=#优缺点-18 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>职责清晰。<li>高扩展性。<li>智能化。</ol><li>缺点<ol><li>由于增加了代理对象，因此有些类型的代理模式可能会造成请求的处理速度变慢。<li>实现代理模式需要额外的工作，有些代理模式的实现非常复杂。</ol></ul><h4 id=应用场景-17><a class=headerlink href=#应用场景-17 title=应用场景></a>应用场景</h4><ol><li>远程代理。<li>虚拟代理。<li>Copy-on-Write 代理。<li>保护（Protect or Access）代理。<li>Cache 代理。<li>防火墙（Firewall）代理。<li>同步化（Synchronization）代理。<li>智能引用（Smart Reference）代理。</ol><h4 id=应用实例-18><a class=headerlink href=#应用实例-18 title=应用实例></a>应用实例</h4><ol><li>Windows 中的快捷方式。<li>猪八戒去找高翠兰结果是孙悟空变的，可以这样理解：把高翠兰的外貌抽象出来，高翠兰本人和孙悟空都实现了这个接口，猪八戒访问高翠兰的时候看不出来这个是孙悟空，所以说孙悟空是高翠兰代理类。<li>买火车票不一定在火车站买，也可以去代售点。<li>一张支票或银行存单是账户中资金的代理。支票在市场交易中用来代替现金，并提供对签发人账号上资金的控制。<li>spring aop。</ol><h4 id=注意事项-18><a class=headerlink href=#注意事项-18 title=注意事项></a>注意事项</h4><ol><li><font color=red>与适配器模式的区别：适配器模式主要改变所考虑对象的接口，而代理模式不能改变所代理类的接口。</font><li><font color=red>与装饰器模式的区别：装饰器模式为了增强功能，而代理模式是为了加以控制。</font></ol><h4 id=代码实例-18><a class=headerlink href=#代码实例-18 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>class</span> <span class="title class_">Food</span> {</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">setChicken</span><span class=params>(String chicken)</span> { }</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">setSpicy</span><span class=params>(String spicy)</span> { }</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">setNoodle</span><span class=params>(String noodle)</span> { }</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">setSalt</span><span class=params>(String salt)</span> { }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">FoodService</span> {</span><br><span class=line>    Food <span class="title function_">makeChicken</span><span class=params>()</span>;</span><br><span class=line>    Food <span class="title function_">makeNoodle</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">FoodServiceImpl</span> <span class=keyword>implements</span> <span class="title class_">FoodService</span>{</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Food <span class="title function_">makeChicken</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>Food</span> <span class=variable>f</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Chicken</span>();</span><br><span class=line>        f.setChicken(<span class=string>"1kg"</span>);</span><br><span class=line>        f.setSpicy(<span class=string>"1g"</span>);</span><br><span class=line>        f.setSalt(<span class=string>"3g"</span>);</span><br><span class=line>        <span class=keyword>return</span> f;</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Food <span class="title function_">makeNoodle</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>Food</span> <span class=variable>f</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Noodle</span>();</span><br><span class=line>        f.setNoodle(<span class=string>"500g"</span>);</span><br><span class=line>        f.setSalt(<span class=string>"5g"</span>);</span><br><span class=line>        <span class=keyword>return</span> f;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Chicken</span> <span class=keyword>extends</span> <span class="title class_">Food</span>{</span><br><span class=line>    <span class=keyword>private</span> String chicken;</span><br><span class=line>    <span class=keyword>private</span> String spicy;</span><br><span class=line>    <span class=keyword>private</span> String salt;</span><br><span class=line>	</span><br><span class=line>    <span class=comment>// set/get methods... </span></span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Noodle</span> <span class=keyword>extends</span> <span class="title class_">Food</span>{</span><br><span class=line>    <span class=keyword>private</span> String noodle;</span><br><span class=line>    <span class=keyword>private</span> String salt;</span><br><span class=line></span><br><span class=line>    <span class=comment>// set/get methods...</span></span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">FoodServiceProxy</span> <span class=keyword>implements</span> <span class="title class_">FoodService</span> {</span><br><span class=line>    <span class=comment>// 内部一定要有一个真实的实现类，当然也可以通过构造方法注入</span></span><br><span class=line>    <span class=keyword>private</span> <span class=type>FoodService</span> <span class=variable>foodService</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">FoodServiceImpl</span>();</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> Food <span class="title function_">makeChicken</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"我们马上要开始制作鸡肉了"</span>);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 如果我们定义这句为核心代码的话，那么，核心代码是真实实现类做的，</span></span><br><span class=line>        <span class=comment>// 代理只是在核心代码前后做些“无足轻重”的事情</span></span><br><span class=line>        <span class=type>Food</span> <span class=variable>food</span> <span class=operator>=</span> foodService.makeChicken();</span><br><span class=line></span><br><span class=line>        System.out.println(<span class=string>"鸡肉制作完成啦，加点胡椒粉"</span>); <span class=comment>// 增强</span></span><br><span class=line>        food.addCondiment(<span class=string>"pepper"</span>);</span><br><span class=line></span><br><span class=line>        <span class=keyword>return</span> food;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> Food <span class="title function_">makeNoodle</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"准备制作拉面~"</span>);</span><br><span class=line>        <span class=type>Food</span> <span class=variable>food</span> <span class=operator>=</span> foodService.makeNoodle();</span><br><span class=line>        System.out.println(<span class=string>"制作完成啦"</span>);</span><br><span class=line>        <span class=keyword>return</span> food;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ProxyApp</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>FoodService</span> <span class=variable>foodService</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">FoodServiceProxy</span>();</span><br><span class=line>        foodService.makeChicken();</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-3-4、Adpter（适配器模式）><a class=headerlink href=#1-3-4、Adpter（适配器模式） title=1.3.4、Adpter（适配器模式）></a>1.3.4、Adpter（适配器模式）</h3><h4 id=简介-18><a class=headerlink href=#简介-18 title=简介></a>简介</h4><p>Adapter模式可以使得 不兼容的接口变得兼容。<h4 id=实现-3><a class=headerlink href=#实现-3 title=实现></a>实现</h4><ul><li>Object Adapter<li>Class Adapter</ul><h4 id=何时使用-19><a class=headerlink href=#何时使用-19 title=何时使用></a>何时使用</h4><ol><li>系统需要使用现有的类，而此类的接口不符合系统需要。<li>想要建立一个可以重复使用的类，可以使得不兼容的类变得兼容起来。<li>通过接口转换，将一个类插入另一个类系中。（比如老虎和飞禽，现在多了一个飞虎，在不增加实体的需求下，增加一个适配器，在里面包容一个虎对象，实现飞的接口。）</ol><h4 id=优缺点-19><a class=headerlink href=#优缺点-19 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>可以让任何两个没有关联的类一起运行。<li>提高了类的复用。<li>增加了类的透明度。<li>灵活性好。</ol><li>缺点<ol><li>过多地使用适配器，会让系统非常零乱，不易整体进行把握。比如，明明看到调用的是 A 接口，其实内部被适配成了 B 接口的实现，一个系统如果太多出现这种情况，无异于一场灾难。因此如果不是很有必要，可以不使用适配器，而是直接对系统进行重构。<li>由于 JAVA 至多继承一个类，所以至多只能适配一个适配者类，而且目标类必须是抽象类。</ol></ul><h4 id=应用场景-18><a class=headerlink href=#应用场景-18 title=应用场景></a>应用场景</h4><ol><li>希望使用某些现有类，但接口与代码不兼容时，可以使用适配器模式。<li>希望重用几个现有子类，这些子类缺少一些不能添加到超类中的公共功能时，可以使用适配器模式。</ol><h4 id=应用实例-19><a class=headerlink href=#应用实例-19 title=应用实例></a>应用实例</h4><ol><li>美国电器 110V，中国 220V，就要有一个适配器将 110V 转化为 220V。<li>JAVA JDK 1.1 提供了 Enumeration 接口，而在 1.2 中提供了 Iterator 接口，想要使用 1.2 的 JDK，则要将以前系统的 Enumeration 接口转化为 Iterator 接口，这时就需要适配器模式。<li>在 LINUX 上运行 WINDOWS 程序。 4. JAVA 中的 jdbc。</ol><h4 id=源码应用-4><a class=headerlink href=#源码应用-4 title=源码应用></a>源码应用</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line>java.util.Arrays#asList();</span><br><span class=line>java.util.Collections#list();</span><br><span class=line>org.springframework.context.event.GenericApplicationListenerAdapter</span><br></pre></table></figure><h4 id=注意事项-19><a class=headerlink href=#注意事项-19 title=注意事项></a>注意事项</h4><p><font color=red>适配器不是在详细设计时添加的，而是解决正在服役的项目问题。</font><h4 id=代码实例-19><a class=headerlink href=#代码实例-19 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br></pre><td class=code><pre><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 适配器模式</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * 简介：</span></span><br><span class=line><span class=comment> *      GOF是这样给适配器模式(Adapter)定义的：将一个类的接口转化成用户需要的</span></span><br><span class=line><span class=comment> *      另外一个接口。Adapter模式使得原本由于接口不兼容而不能一起工作的那些类</span></span><br><span class=line><span class=comment> *      可以一起工作。</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * 实现方式-包含以下角色：</span></span><br><span class=line><span class=comment> *      Target：目标抽象类</span></span><br><span class=line><span class=comment> *      Adapter：适配器类</span></span><br><span class=line><span class=comment> *      Adaptee：适配者类</span></span><br><span class=line><span class=comment> *      Client：客户类</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * 优缺点：</span></span><br><span class=line><span class=comment> *      - 优点：将目标类和适配者类解耦，通过引入一个适配器类来重用现有的适配者</span></span><br><span class=line><span class=comment> *             类，而无须修改原有代码。</span></span><br><span class=line><span class=comment> *             增加了类的透明性和复用性，将具体的实现封装在适配者类中，对于客</span></span><br><span class=line><span class=comment> *             户端类来说是透明的，而且提高了适配者的复用性。</span></span><br><span class=line><span class=comment> *             灵活性和扩展性都非常好，通过使用配置文件，可以很方便地更换适配</span></span><br><span class=line><span class=comment> *             器，也可以在不修改原有代码的基础上增加新的适配器类，完全符合“开</span></span><br><span class=line><span class=comment> *             闭原则”。</span></span><br><span class=line><span class=comment> *      - 缺点：过多地使用适配器，会让系统非常零乱，不易整体进行把握。</span></span><br><span class=line><span class=comment> *             对于类适配器而言，由于 JAVA 至多继承一个类，所以至多只能适配一</span></span><br><span class=line><span class=comment> *             个适配者类，而且目标类必须是抽象类</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">App</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>Iphone6Plus</span> <span class=variable>iphone6Plus</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Iphone6Plus</span>(<span class=keyword>new</span> <span class="title class_">AppleCharger</span>());</span><br><span class=line>        iphone6Plus.charge();</span><br><span class=line></span><br><span class=line>        System.out.println(<span class=string>"=============================="</span>);</span><br><span class=line></span><br><span class=line>        <span class=type>GalaxyS7</span> <span class=variable>galaxyS7</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">GalaxyS7</span>(<span class=keyword>new</span> <span class="title class_">AndroidCharger</span>());</span><br><span class=line>        galaxyS7.charge();</span><br><span class=line></span><br><span class=line>        System.out.println(<span class=string>"=============================="</span>);</span><br><span class=line></span><br><span class=line>        <span class=type>Adapter</span> <span class=variable>adapter</span>  <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Adapter</span>(<span class=keyword>new</span> <span class="title class_">AndroidCharger</span>());</span><br><span class=line>        <span class=type>Iphone6Plus</span> <span class=variable>newIphone</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Iphone6Plus</span>();</span><br><span class=line>        newIphone.setLightningInterface(adapter);</span><br><span class=line>        newIphone.charge();</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-3-5、Decorator（装饰模式）><a class=headerlink href=#1-3-5、Decorator（装饰模式） title=1.3.5、Decorator（装饰模式）></a>1.3.5、Decorator（装饰模式）</h3><h4 id=简介-19><a class=headerlink href=#简介-19 title=简介></a>简介</h4><p><strong>动态地给一个对象添加一些额外职责</strong>。<h4 id=何时使用-20><a class=headerlink href=#何时使用-20 title=何时使用></a>何时使用</h4><p>既想扩展类，又不想通过子类的方式实现。<h4 id=优缺点-20><a class=headerlink href=#优缺点-20 title=优缺点></a>优缺点</h4><ul><li><p>优点</p> <ol><li>不改变原有对象的情况下给一个对象扩展功能。<li>使用不同的组合可以实现不同的效果。<li>符合开闭原则。</ol><li><p>缺点</p> <p>多层装饰比较复杂。</p></ul><h4 id=应用场景-19><a class=headerlink href=#应用场景-19 title=应用场景></a>应用场景</h4><ol><li>扩展一个类的功能。<li>动态增加功能，动态撤销。</ol><h4 id=应用实例-20><a class=headerlink href=#应用实例-20 title=应用实例></a>应用实例</h4><ol><li>孙悟空有 72 变，当他变成 “庙宇” 后，他的根本还是一只猴子，但是他又有了庙宇的功能。<li>不论一幅画有没有画框都可以挂在墙上，但是通常都是有画框的，并且实际上是画框被挂在墙上。在挂在墙上之前，画可以被蒙上玻璃，装到框子里；这时画、玻璃和画框形成了一个物体。</ol><h4 id=源码中的应用-1><a class=headerlink href=#源码中的应用-1 title=源码中的应用></a>源码中的应用</h4><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line>Servlet API</span><br><span class=line>javax.servlet.http.HttpServletRequestWrapper</span><br><span class=line>javax.servlet.http.HttpServletResponseWrapper</span><br></pre></table></figure><h4 id=注意事项-20><a class=headerlink href=#注意事项-20 title=注意事项></a>注意事项</h4><p><font color=red>可代替继承。</font><h4 id=代码实例-20><a class=headerlink href=#代码实例-20 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>class</span> <span class="title class_">Beverage</span> {</span><br><span class=line>    <span class=comment>// 返回描述</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>abstract</span> String <span class="title function_">getDescription</span><span class=params>()</span>;</span><br><span class=line>    <span class=comment>// 返回价格</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>abstract</span> <span class=type>double</span> <span class="title function_">cost</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">BlackTea</span> <span class=keyword>extends</span> <span class="title class_">Beverage</span> {</span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">getDescription</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=string>"红茶"</span>;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=type>double</span> <span class="title function_">cost</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=number>10</span>;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">GreenTea</span> <span class=keyword>extends</span> <span class="title class_">Beverage</span> {</span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">getDescription</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=string>"绿茶"</span>;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=type>double</span> <span class="title function_">cost</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=number>11</span>;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 调料</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>class</span> <span class="title class_">Condiment</span> <span class=keyword>extends</span> <span class="title class_">Beverage</span> {</span><br><span class=line></span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Mango</span> <span class=keyword>extends</span> <span class="title class_">Condiment</span> {</span><br><span class=line>    <span class=keyword>private</span> Beverage bevarage;</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">Mango</span><span class=params>(Beverage bevarage)</span> {</span><br><span class=line>        <span class=built_in>this</span>.bevarage = bevarage;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">getDescription</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> bevarage.getDescription() + <span class=string>", 加芒果"</span>;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=type>double</span> <span class="title function_">cost</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> bevarage.cost() + <span class=number>3</span>; <span class=comment>// 加芒果需要 3 元</span></span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Lemon</span> <span class=keyword>extends</span> <span class="title class_">Condiment</span> {</span><br><span class=line>    <span class=keyword>private</span> Beverage bevarage;</span><br><span class=line>    <span class=comment>// 这里很关键，需要传入具体的饮料，如需要传入没有被装饰的红茶或绿茶，</span></span><br><span class=line>    <span class=comment>// 当然也可以传入已经装饰好的芒果绿茶，这样可以做芒果柠檬绿茶</span></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">Lemon</span><span class=params>(Beverage bevarage)</span> {</span><br><span class=line>        <span class=built_in>this</span>.bevarage = bevarage;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">getDescription</span><span class=params>()</span> {</span><br><span class=line>        <span class=comment>// 装饰</span></span><br><span class=line>        <span class=keyword>return</span> bevarage.getDescription() + <span class=string>", 加柠檬"</span>;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=type>double</span> <span class="title function_">cost</span><span class=params>()</span> {</span><br><span class=line>        <span class=comment>// 装饰</span></span><br><span class=line>        <span class=keyword>return</span> bevarage.cost() + <span class=number>2</span>; <span class=comment>// 加柠檬需要 2 元</span></span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">DecoratorApp</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=comment>// 首先，我们需要一个基础饮料，红茶、绿茶或咖啡</span></span><br><span class=line>        <span class=type>Beverage</span> <span class=variable>beverage</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">GreenTea</span>();</span><br><span class=line>        <span class=comment>// 开始装饰</span></span><br><span class=line>        beverage = <span class=keyword>new</span> <span class="title class_">Lemon</span>(beverage); <span class=comment>// 先加一份柠檬</span></span><br><span class=line>        beverage = <span class=keyword>new</span> <span class="title class_">Mango</span>(beverage); <span class=comment>// 再加一份芒果</span></span><br><span class=line></span><br><span class=line>        System.out.println(beverage.getDescription() + <span class=string>" 价格：￥"</span> + beverage.cost());</span><br><span class=line>        <span class=comment>//"绿茶, 加柠檬, 加芒果 价格：￥16"</span></span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-3-6、Bridge（桥接模式）><a class=headerlink href=#1-3-6、Bridge（桥接模式） title=1.3.6、Bridge（桥接模式）></a>1.3.6、Bridge（桥接模式）</h3><h4 id=简介-20><a class=headerlink href=#简介-20 title=简介></a>简介</h4><p><strong>将抽象与实现分离，使它们都可以独立地变化</strong>。<h4 id=何时使用-21><a class=headerlink href=#何时使用-21 title=何时使用></a>何时使用</h4><p>系统的实现有多个方案，每一种都可能变化。<h4 id=优缺点-21><a class=headerlink href=#优缺点-21 title=优缺点></a>优缺点</h4><ul><li><p>优点</p> <ol><li>抽象和实现的分离。<li>优秀的扩展能力。<li>实现细节对客户透明。</ol><li><p>缺点</p> <p>桥接模式的引入会增加系统的理解与设计难度，由于聚合关联关系建立在抽象层，要求开发者针对抽象进行设计与编程。</p></ul><h4 id=应用场景-20><a class=headerlink href=#应用场景-20 title=应用场景></a>应用场景</h4><ol><li>不希望在抽象类和它的实现之间有一个固定的绑定关系；<li>类的抽象和实现都应该可以通过生成子类的方法加以扩充；<li>对一个抽象的实现部分的修改应对客户不产生影响，即客户代码无需重新编译；</ol><h4 id=应用实例-21><a class=headerlink href=#应用实例-21 title=应用实例></a>应用实例</h4><ol><li>猪八戒从天蓬元帅转世投胎到猪，转世投胎的机制将尘世划分为两个等级，即：灵魂和肉体，前者相当于抽象化，后者相当于实现化。生灵通过功能的委派，调用肉体对象的功能，使得生灵可以动态地选择。<li>墙上的开关，可以看到的开关是抽象的，不用管里面具体怎么实现的。</ol><h4 id=注意事项-21><a class=headerlink href=#注意事项-21 title=注意事项></a>注意事项</h4><p><font color=red>对于两个独立变化的维度，使用桥接模式非常合适。</font><h4 id=代码实例-21><a class=headerlink href=#代码实例-21 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br></pre><td class=code><pre><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 电灯接口</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">ILight</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">electricConnected</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">light</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">electricClosed</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 开关顶层类</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">BaseSwitch</span> {</span><br><span class=line>    <span class=keyword>protected</span> ILight light;</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">BaseSwitch</span><span class=params>(ILight light)</span>{</span><br><span class=line>        <span class=built_in>this</span>.light = light;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>final</span> <span class=keyword>void</span> <span class="title function_">makeLight</span><span class=params>()</span>{</span><br><span class=line>        <span class=built_in>this</span>.light.electricConnected();</span><br><span class=line>        <span class=built_in>this</span>.light.light();</span><br><span class=line>        <span class=built_in>this</span>.light.electricClosed();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 遥控开关</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">RemoteControISwitch</span> <span class=keyword>extends</span> <span class="title class_">BaseSwitch</span>{</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">RemoteControISwitch</span><span class=params>(ILight light)</span>{</span><br><span class=line>        <span class=built_in>super</span>(light);</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>final</span> <span class=keyword>void</span> <span class="title function_">makeRemoteLight</span><span class=params>(<span class=type>int</span> operColor)</span>{</span><br><span class=line>        <span class=built_in>this</span>.light.electricConnected();</span><br><span class=line>        <span class=built_in>this</span>.light.light();</span><br><span class=line>        <span class=type>String</span> <span class=variable>color</span> <span class=operator>=</span> <span class=string>""</span>;</span><br><span class=line>        <span class=keyword>switch</span> (operColor){</span><br><span class=line>            <span class=keyword>case</span> <span class=number>1</span>:</span><br><span class=line>                color = <span class=string>"暖色"</span>;</span><br><span class=line>                <span class=keyword>break</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>2</span>:</span><br><span class=line>                color = <span class=string>"蓝色"</span>;</span><br><span class=line>                <span class=keyword>break</span>;</span><br><span class=line>            <span class=keyword>case</span> <span class=number>3</span>:</span><br><span class=line>                color = <span class=string>"红色"</span>;</span><br><span class=line>                <span class=keyword>break</span>;</span><br><span class=line>            <span class=keyword>default</span>:</span><br><span class=line>                color = <span class=string>"白色"</span>;</span><br><span class=line>                <span class=keyword>break</span>;</span><br><span class=line>        }</span><br><span class=line>        System.out.println(<span class=string>"当前灯光颜色为："</span> + color);</span><br><span class=line>        <span class=built_in>this</span>.light.electricClosed();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 白炽灯实现</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">IncandescentLight</span> <span class=keyword>implements</span> <span class="title class_">ILight</span>{</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">electricConnected</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"白炽灯被打开了！"</span>);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">light</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"白炽灯在照明！"</span>);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">electricClosed</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"白炽灯被关闭了！"</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">CrystalLight</span> <span class=keyword>implements</span> <span class="title class_">ILight</span>{</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">electricConnected</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"水晶灯被打开了！"</span>);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">light</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"水晶灯在照明！"</span>);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">electricClosed</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"水晶灯被关闭了！"</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">BridgeApp</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>ILight</span> <span class=variable>incandescentLight</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">IncandescentLight</span>();</span><br><span class=line>        <span class=type>ILight</span> <span class=variable>crystalLight</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">CrystalLight</span>();</span><br><span class=line></span><br><span class=line>        <span class=type>BaseSwitch</span> <span class=variable>baseSwitch</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">BaseSwitch</span>(incandescentLight);</span><br><span class=line>        baseSwitch.makeLight();</span><br><span class=line></span><br><span class=line>        System.out.println(<span class=string>"--------------------------"</span>);</span><br><span class=line></span><br><span class=line>        <span class=type>RemoteControISwitch</span> <span class=variable>controISwitch</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">RemoteControISwitch</span>(crystalLight);</span><br><span class=line>        controISwitch.makeRemoteLight(<span class=number>1</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-3-7、Flyweight（享元模式）><a class=headerlink href=#1-3-7、Flyweight（享元模式） title=1.3.7、Flyweight（享元模式）></a>1.3.7、Flyweight（享元模式）</h3><h4 id=简介-21><a class=headerlink href=#简介-21 title=简介></a>简介</h4><p>主要用于减少创建对象的数量，减少内存占用以提高性能。该模式会尝试重用现有的同类对象，如果未找到匹配的对象，则创建新对象。<h4 id=何时使用-22><a class=headerlink href=#何时使用-22 title=何时使用></a>何时使用</h4><ol><li>系统中有大量对象。<li>这些对象消耗大量内存。<li>这些对象的状态大部分可以外部化。<li>这些对象可以按照内蕴状态分为很多组，当把外蕴对象从对象中拿出来时，每组对象都可用一个对象来代替。<li>系统不依赖于对象身份，因对象不可分辨。</ol><h4 id=优缺点-22><a class=headerlink href=#优缺点-22 title=优缺点></a>优缺点</h4><ul><li>优点：减少对象创建，降低内存消耗，效率提高。<li>缺点：提高了系统复杂度，需要分离出外部状态和内部状态，而且外部状态具有固有化的性质，不应该随着内部状态的变化而变化，否则会造成系统混乱。</ul><h4 id=应用场景-21><a class=headerlink href=#应用场景-21 title=应用场景></a>应用场景</h4><ol><li>系统有大量相似对象。<li>需要缓冲池的场景。</ol><h4 id=应用实例-22><a class=headerlink href=#应用实例-22 title=应用实例></a>应用实例</h4><ol><li>JAVA 中的 String，如果有则返回，如果没有则创建一个字符串保存在字符串缓存池里面。<li>数据库的数据池。</ol><h4 id=源码应用-5><a class=headerlink href=#源码应用-5 title=源码应用></a>源码应用</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>String / Integer / Long....</span><br><span class=line>com.sun.org.apache.bcel.internal.generic.InstructionConstants</span><br></pre></table></figure><h4 id=注意事项-22><a class=headerlink href=#注意事项-22 title=注意事项></a>注意事项</h4><ol><li><font color=red>注意划分外部状态和内部状态，否则可能会引起线程安全问题。</font><li><font color=red>这些类必须有一个工厂对象加以控制。</font></ol><h4 id=代码实例-22><a class=headerlink href=#代码实例-22 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>class</span> <span class="title class_">AbstractChessman</span> {</span><br><span class=line>    <span class=keyword>protected</span> <span class=type>int</span> x;</span><br><span class=line>    <span class=keyword>protected</span> <span class=type>int</span> y;</span><br><span class=line>    <span class=keyword>protected</span> String chess;</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">AbstractChessman</span><span class=params>(String chess)</span>{</span><br><span class=line>        <span class=built_in>this</span>.chess = chess;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>void</span> <span class="title function_">point</span><span class=params>(<span class=type>int</span> x, <span class=type>int</span> y)</span>;</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">show</span><span class=params>()</span>{</span><br><span class=line>        System.out.println(<span class=built_in>this</span>.chess + <span class=string>": "</span> + <span class=built_in>this</span>.x + <span class=string>"/"</span> + <span class=built_in>this</span>.y);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">BlackChessman</span> <span class=keyword>extends</span> <span class="title class_">AbstractChessman</span>{</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">BlackChessman</span><span class=params>()</span>{</span><br><span class=line>        <span class=built_in>super</span>(<span class=string>"."</span>);</span><br><span class=line>        System.out.println(<span class=string>"BlackChessman construction exec!"</span>);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">point</span><span class=params>(<span class=type>int</span> x, <span class=type>int</span> y)</span> {</span><br><span class=line>        <span class=built_in>this</span>.x = x;</span><br><span class=line>        <span class=built_in>this</span>.y = y;</span><br><span class=line>        <span class=built_in>this</span>.show();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">WhiteChessman</span> <span class=keyword>extends</span> <span class="title class_">AbstractChessman</span>{</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">WhiteChessman</span><span class=params>()</span>{</span><br><span class=line>        <span class=built_in>super</span>(<span class=string>"o"</span>);</span><br><span class=line>        System.out.println(<span class=string>"WhiteChessman construction exec!"</span>);</span><br><span class=line>    }</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">point</span><span class=params>(<span class=type>int</span> x, <span class=type>int</span> y)</span> {</span><br><span class=line>        <span class=built_in>this</span>.x = x;</span><br><span class=line>        <span class=built_in>this</span>.y = y;</span><br><span class=line>        <span class=built_in>this</span>.show();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">FiveChessmanFactory</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>static</span> <span class=type>FiveChessmanFactory</span> <span class=variable>fiveChessmanFactory</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">FiveChessmanFactory</span>();</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>final</span> Hashtable&LTCharacter, AbstractChessman> cache = <span class=keyword>new</span> <span class="title class_">Hashtable</span>&LTCharacter, AbstractChessman>();</span><br><span class=line>    <span class=keyword>private</span> <span class="title function_">FiveChessmanFactory</span><span class=params>()</span>{</span><br><span class=line></span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> FiveChessmanFactory <span class="title function_">getInstance</span><span class=params>()</span>{</span><br><span class=line>        <span class=keyword>return</span> fiveChessmanFactory;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> AbstractChessman <span class="title function_">getChessmanObject</span><span class=params>(<span class=type>char</span> c)</span>{</span><br><span class=line>        <span class=type>AbstractChessman</span> <span class=variable>chessman</span> <span class=operator>=</span> <span class=built_in>this</span>.cache.get(c);</span><br><span class=line>        <span class=keyword>if</span> (chessman == <span class=literal>null</span>){</span><br><span class=line>            <span class=keyword>switch</span> (c){</span><br><span class=line>                <span class=keyword>case</span> <span class=string>'B'</span>:</span><br><span class=line>                    chessman = <span class=keyword>new</span> <span class="title class_">BlackChessman</span>();</span><br><span class=line>                    <span class=keyword>break</span>;</span><br><span class=line>                <span class=keyword>case</span> <span class=string>'W'</span>:</span><br><span class=line>                    chessman = <span class=keyword>new</span> <span class="title class_">WhiteChessman</span>();</span><br><span class=line>                    <span class=keyword>break</span>;</span><br><span class=line>                <span class=keyword>default</span>:</span><br><span class=line>                    <span class=keyword>break</span>;</span><br><span class=line>            }</span><br><span class=line>            <span class=keyword>if</span> (chessman != <span class=literal>null</span>){</span><br><span class=line>                <span class=built_in>this</span>.cache.put(c, chessman);</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> chessman;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">FlyweightApp</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>FiveChessmanFactory</span> <span class=variable>fiveChessmanFactory</span> <span class=operator>=</span> FiveChessmanFactory.getInstance();</span><br><span class=line>        </span><br><span class=line>        <span class=type>Random</span> <span class=variable>random</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Random</span>();</span><br><span class=line>        <span class=type>int</span> <span class=variable>radom</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>        <span class=type>AbstractChessman</span> <span class=variable>abstractChessman</span> <span class=operator>=</span> <span class=literal>null</span>;</span><br><span class=line>        </span><br><span class=line>        <span class=keyword>for</span> (<span class=type>int</span> <span class=variable>i</span> <span class=operator>=</span> <span class=number>0</span>; i < <span class=number>10</span>; i++){</span><br><span class=line>            radom = random.nextInt(<span class=number>2</span>);</span><br><span class=line>            <span class=keyword>switch</span> (radom){</span><br><span class=line>                <span class=keyword>case</span> <span class=number>0</span>:</span><br><span class=line>                    abstractChessman = fiveChessmanFactory.getChessmanObject(<span class=string>'B'</span>);</span><br><span class=line>                    <span class=keyword>break</span>;</span><br><span class=line>                <span class=keyword>case</span> <span class=number>1</span>:</span><br><span class=line>                    abstractChessman = fiveChessmanFactory.getChessmanObject(<span class=string>'W'</span>);</span><br><span class=line>                    <span class=keyword>break</span>;</span><br><span class=line>            }</span><br><span class=line>            <span class=keyword>if</span> (abstractChessman != <span class=literal>null</span>){</span><br><span class=line>                abstractChessman.point(i, random.nextInt(<span class=number>15</span>));</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h2 id=1-4、设计模式间的关系><a class=headerlink href=#1-4、设计模式间的关系 title=1.4、设计模式间的关系></a>1.4、设计模式间的关系</h2><p><img alt=设计模式间的关系 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/06/image-20210420203056818.png?token=AIGEF3L6P4ZSWPM3RWVOD3LEZZZVE><h1 id=2、设计模式原则><a class=headerlink href=#2、设计模式原则 title=2、设计模式原则></a>2、设计模式原则</h1><h2 id=2-1、开闭原则（OCP）><a class=headerlink href=#2-1、开闭原则（OCP） title=2.1、开闭原则（OCP）></a>2.1、开闭原则（OCP）</h2><h3 id=2-1-1、简介><a class=headerlink href=#2-1-1、简介 title=2.1.1、简介></a>2.1.1、简介</h3><p><strong>开闭原则规定：软件中的对象（类，模块，函数等）对于扩展应该开放，对于修改应该封闭。</strong>也就是说，应该在不修改类源代码前提下来更改类的行为。<h3 id=2-1-2、分类><a class=headerlink href=#2-1-2、分类 title=2.1.2、分类></a>2.1.2、分类</h3><ul><li><p><strong>梅耶开闭原则</strong></p> <p>梅耶原则 提倡继承实现。具体实现可以通过继承来重用，但是接口规格不必如此。已存在的实现对于修改是封闭的，但是新的实现不必实现原有接口。</p><li><p><strong>多态开闭原则</strong></p> <p>多态开闭原则 倡导继承抽象类。接口规约可以通过继承来重用，但是实现不必如此。已存在的接口对于修改是封闭的，并且新的实现必须至少实现那个接口。</p></ul><h2 id=2-2、单一职责原则（SRP）><a class=headerlink href=#2-2、单一职责原则（SRP） title=2.2、单一职责原则（SRP）></a>2.2、单一职责原则（SRP）</h2><h3 id=2-2-1、简介><a class=headerlink href=#2-2-1、简介 title=2.2.1、简介></a>2.2.1、简介</h3><p>面向对象五个基本原则（SOLID）之一。<p><strong>单一职责原则（SRP：Single responsibility principle）又称单一功能原则。该原则规定：一个类或者模块应该有且只有一个改变原因。</strong><p>单一职责原则由罗伯特·C·马丁（Robert C. Martin）于《敏捷软件开发：原则、模式和实践》一书中给出。马丁表示此原则是基于汤姆·狄马克(Tom DeMarco)和Meilir Page-Jones的=著作中的 内聚性原则 来实现。<p><strong>所谓职责是指类变化的原因。如果类改变的原因多于一个，那就违反了该职责。</strong><h3 id=2-2-2、问题由来><a class=headerlink href=#2-2-2、问题由来 title=2.2.2、问题由来></a>2.2.2、问题由来</h3><p>之所以会出现单一职责原则就是因为在软件设计时会出现以下类似场景：<p>T负责两个不同的职责：职责P1，职责P2。当由于职责P1需求发生改变而需要修改类T时，有可能会导致原本运行正常的职责P2功能发生故障。也就是说职责P1和P2耦合在了一起。<h3 id=2-2-3、产生原因><a class=headerlink href=#2-2-3、产生原因 title=2.2.3、产生原因></a>2.2.3、产生原因</h3><p>很多耦合常常发生在不经意之间，原因就是 职责扩散：因为某种原因，某一职责被分化为颗粒度更细多个职责。<h3 id=2-2-4、解决方法><a class=headerlink href=#2-2-4、解决方法 title=2.2.4、解决方法></a>2.2.4、解决方法</h3><p>遵守单一职责原则，将不同的职责封装到不同的类或模块中。<h2 id=2-3、依赖倒置原则（DIP）><a class=headerlink href=#2-3、依赖倒置原则（DIP） title=2.3、依赖倒置原则（DIP）></a>2.3、依赖倒置原则（DIP）</h2><h3 id=2-3-1、简介><a class=headerlink href=#2-3-1、简介 title=2.3.1、简介></a>2.3.1、简介</h3><p><strong>开闭原则的基础。依赖倒置原则（Dependence Inversion Principle）是指：程序要依赖于抽象接口，不要依赖于具体实现。</strong>简单说就是一定要面向抽象编程，而不要面向实现编程，这样就降低了客户与实现模块间的耦合。<h3 id=2-3-2、意图><a class=headerlink href=#2-3-2、意图 title=2.3.2、意图></a>2.3.2、意图</h3><p><strong>面向过程开发，上层调用下层，上层依赖于下层，当下层剧烈变动时上层也要跟着变动，这就会降低模块的复用性且大大提高了开发成本</strong><p>面向对象开发解决了这个问题，一般情况下抽象的变化概率很小，让用户程序依赖于抽象，实现的细节也依赖于抽象。即使实现细节不断变动，只要抽象不变，客户程序就不需要变化。这大大降低了客户程序与实现细节的耦合度。<h3 id=2-3-3、注意事项><a class=headerlink href=#2-3-3、注意事项 title=2.3.3、注意事项></a>2.3.3、注意事项</h3><ol><li>高层次的模块不应该依赖于低层次的模块，他们都应该依赖于抽象。<li>抽象不应该依赖于具体，而是具体应该依赖于抽象。</ol><h2 id=2-4、接口隔离原则（ISP）><a class=headerlink href=#2-4、接口隔离原则（ISP） title=2.4、接口隔离原则（ISP）></a>2.4、接口隔离原则（ISP）</h2><h3 id=2-4-1、简介><a class=headerlink href=#2-4-1、简介 title=2.4.1、简介></a>2.4.1、简介</h3><p>接口隔离原则（Interface Segregation Principle，ISP）是面向对象设计中的一个原则，它强调的是 <strong>客户端不应该依赖它不需要的接口，将臃肿的接口拆分为更小、更具体的接口，避免接口的冗余</strong>。<p>接口隔离原则的核心思想是 <strong>定义接口时要精简、单一，不应该包含不需要的方法，这样可以减少类与接口之间的耦合，提高代码可读性、可维护性、可扩展性</strong>。<p>接口隔离原则可以参考如下几点来实现：<ul><li>将庞大的接口拆分为多个小接口。<li>根据需要只使用特定的接口。<li>接口的职责要单一。</ul><h3 id=2-4-2、优点><a class=headerlink href=#2-4-2、优点 title=2.4.2、优点></a>2.4.2、优点</h3><p>接口隔离原则可以使得系统的接口设计更加灵活、可扩展和易于维护。能降低类与接口之间的耦合度，减少不必要的依赖关系，使得系统的各个模块能够独立地发展与演化。<h2 id=2-5、里氏替换原则（LSP）><a class=headerlink href=#2-5、里氏替换原则（LSP） title=2.5、里氏替换原则（LSP）></a>2.5、里氏替换原则（LSP）</h2><h3 id=2-5-1、简介><a class=headerlink href=#2-5-1、简介 title=2.5.1、简介></a>2.5.1、简介</h3><p>里氏代换原则（Liskov Substitution Principle LSP）是指：<strong>基类可以出现的地方，子类也可以出现</strong>。<p>LSP是继承复用的基石，只有当衍生类可以替换掉基类，软件的功能不受到影响时，基类才能真正被复用，而衍生类也能够在基类的基础上增加新的行为。<em><strong>里氏代换原则是对“开闭”原则的补充。实现“开闭”原则的关键步骤就是抽象化</strong></em>。而基类与子类的继承关系就是抽象化的具体实现，所以里氏代换原则是对实现抽象化的具体步骤的规范。<h3 id=2-5-2、注意事项><a class=headerlink href=#2-5-2、注意事项 title=2.5.2、注意事项></a>2.5.2、注意事项</h3><p><strong>设计时，尽量继承抽象类，而不要继承具体类。</strong>如果从继承等级树来看，所有叶子节点应当是具体类，而所有的树枝节点应当是抽象类或者接口。当然这只是一般性的指导原则，使用时还需具体情况具体分析。<p>简单的理解为一个软件实体如果使用的是一个父类，那么一定适用于其子类，而且它察觉不出父类对象和子类对象的区别。也就是说，软件里面，把父类都替换成它的子类，程序的行为没有变化。<h2 id=2-6、迪米特原则（LOD）><a class=headerlink href=#2-6、迪米特原则（LOD） title=2.6、迪米特原则（LOD）></a>2.6、迪米特原则（LOD）</h2><h3 id=2-6-1、简介><a class=headerlink href=#2-6-1、简介 title=2.6.1、简介></a>2.6.1、简介</h3><p>迪米特原则（Law Of Demeter）也被称为最少知道原则，是面向对象设计中的一个原则。迪米特原则的核心思想是 <strong>降低对象之间的耦合，使得对象之间的通信变得简单和直接</strong>。<p>迪米特原则的目标是 实现高内聚、低耦合。具体包括如下几点：<ul><li>减少对象之间的耦合<li>保护对象的隐私<li>提高代码可维护性</ul><p>迪米特原则可以参考如下几个方面来实现：<ul><li>在类中尽量减少对其它类的引用，不应该直接引用与本类关系较远的类。<li>通过封装和信息隐藏，将对象的内部细节隐藏起来，只暴漏必要的接口。<li>使用中介者模式或外观模式来降低对象之间的直接依赖关系。</ul><h2 id=2-7、合成复用原则（CRP）><a class=headerlink href=#2-7、合成复用原则（CRP） title=2.7、合成复用原则（CRP）></a>2.7、合成复用原则（CRP）</h2><h3 id=2-7-1、简介><a class=headerlink href=#2-7-1、简介 title=2.7.1、简介></a>2.7.1、简介</h3><p>合成复用原则是设计模式中的一个原则，也称之为CRP原则。它指的是在软件设计中，<strong>优先使用对象组合而不是继承来实现代码的复用</strong>。<p>合成复用原则的核心思想是：<strong>通过将现有的对象组合成新的对象，实现代码复用和灵活性</strong>。相对于通过继承实现复用，使用对象组合可以更好的控制类之间的关系，且可以动态改变对象的行为。<h3 id=2-7-2、优点><a class=headerlink href=#2-7-2、优点 title=2.7.2、优点></a>2.7.2、优点</h3><p>合成复用有如下几个优点：<ul><li>减少类之间的耦合：继承会导致子类和父类之间的紧耦合，而对象组合可以在对象之间建立松散的关系，减少类之间的依赖。<li>提高系统灵活性：对象组合可以动态改变对象的行为，通过替换组合中的对象，可以灵活扩展和修改系统的功能。<li>更好地复用代码：组合现有对象，可以构建出具有不同功能的新对象，实现代码复用。<li>更好的维护：对象组合关系松散，需要修改系统行为时，可以更容易的定位和修改相关的对象。</ul></div><footer class=post-footer><div class=post-tags><a href=/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/ rel=tag># 设计模式</a></div><div class=post-nav><div class=post-nav-item><a href=/2024/08/21/%E8%BF%9B%E5%88%B6%E6%95%B0%E6%8D%AE%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/ rel=prev title=数据与算法系列-原码反码补码移码转换> <i class="fa fa-angle-left"></i> 数据与算法系列-原码反码补码移码转换 </a></div><div class=post-nav-item><a href=/2024/08/21/%E6%A0%91%E5%9E%8B%E7%BB%93%E6%9E%84%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/ rel=next title=数据与算法系列-树结构> 数据与算法系列-树结构 <i class="fa fa-angle-right"></i> </a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>© <span itemprop=copyrightYear>2024</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>豪哥</span></div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label=返回顶部 class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script crossorigin=anonymous integrity=sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY= src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js></script><script src=/js/comments.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/sidebar.js></script><script src=/js/next-boot.js></script><script crossorigin=anonymous integrity=sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc= src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js></script><script src=/js/third-party/search/local-search.js></script>