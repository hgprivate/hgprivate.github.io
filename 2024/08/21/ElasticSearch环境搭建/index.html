<!doctypehtml><html lang=zh-CN><meta charset=UTF-8><meta content=width=device-width name=viewport><meta media="(prefers-color-scheme: light)" content=#222 name=theme-color><meta media="(prefers-color-scheme: dark)" content=#222 name=theme-color><meta content="Hexo 7.3.0" name=generator><link href=/images/apple-touch-icon-next.png rel=apple-touch-icon sizes=180x180><link href=/images/favicon-32x32-next.png rel=icon sizes=32x32 type=image/png><link href=/images/favicon-16x16-next.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><link href=/css/main.css rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css integrity=sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA= rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css integrity=sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE= rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"hshz21.gitee.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src=/js/config.js></script><meta content="1、ElasticSearch单节点1.1、下载ES压缩包ElasticSearch分为Linux和Window版本。 ElasticSearch的官方地址： https://www.elastic.co/products/elasticsearch在资料中已经提供了下载好的5.6.8的压缩包：  1.2、安装ES服务Window版的ElasticSearch的安装很简单，类似Window版的To" name=description><meta content=article property=og:type><meta content=ElasticSearch系列-ElasticSearch环境搭建 property=og:title><meta content=https://hshz21.gitee.io/2024/08/21/ElasticSearch%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/index.html property=og:url><meta content=豪哥博客 property=og:site_name><meta content="1、ElasticSearch单节点1.1、下载ES压缩包ElasticSearch分为Linux和Window版本。 ElasticSearch的官方地址： https://www.elastic.co/products/elasticsearch在资料中已经提供了下载好的5.6.8的压缩包：  1.2、安装ES服务Window版的ElasticSearch的安装很简单，类似Window版的To" property=og:description><meta content=zh_CN property=og:locale><meta content=2024-08-21T13:39:13.596Z property=article:published_time><meta content=2023-08-07T08:44:58.076Z property=article:modified_time><meta content=豪哥 property=article:author><meta content=ElasticSearch property=article:tag><meta content=ElasticSearch环境 property=article:tag><meta content=summary name=twitter:card><link href=https://hshz21.gitee.io/2024/08/21/ElasticSearch%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://hshz21.gitee.io/2024/08/21/ElasticSearch%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/","path":"2024/08/21/ElasticSearch环境搭建/","title":"ElasticSearch系列-ElasticSearch环境搭建"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>ElasticSearch系列-ElasticSearch环境搭建 | 豪哥博客</title><noscript><link href=/css/noscript.css rel=stylesheet></noscript><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label=切换导航栏 class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <p class=site-title>豪哥博客</p> <i class=logo-line></i> </a><p class=site-subtitle itemprop=description>豪哥博客</div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=搜索 role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>分类</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>搜索 </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=搜索... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-1"><a class=nav-link href=#1%E3%80%81ElasticSearch%E5%8D%95%E8%8A%82%E7%82%B9><span class=nav-number>1.</span> <span class=nav-text>1、ElasticSearch单节点</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#1-1%E3%80%81%E4%B8%8B%E8%BD%BDES%E5%8E%8B%E7%BC%A9%E5%8C%85><span class=nav-number>1.1.</span> <span class=nav-text>1.1、下载ES压缩包</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-2%E3%80%81%E5%AE%89%E8%A3%85ES%E6%9C%8D%E5%8A%A1><span class=nav-number>1.2.</span> <span class=nav-text>1.2、安装ES服务</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-3%E3%80%81%E5%90%AF%E5%8A%A8ES%E6%9C%8D%E5%8A%A1><span class=nav-number>1.3.</span> <span class=nav-text>1.3、启动ES服务</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-4%E3%80%81%E5%AE%89%E8%A3%85ES%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2%E6%8F%92%E4%BB%B6><span class=nav-number>1.4.</span> <span class=nav-text>1.4、安装ES图形化界面插件</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#1-4-1%E3%80%81%E5%AE%89%E8%A3%85head><span class=nav-number>1.4.1.</span> <span class=nav-text>1.4.1、安装head</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#1-4-2%E3%80%81%E5%AE%89%E8%A3%85node><span class=nav-number>1.4.2.</span> <span class=nav-text>1.4.2、安装node</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#1-4-3%E3%80%81%E5%AE%89%E8%A3%85grunt%E6%8F%92%E4%BB%B6><span class=nav-number>1.4.3.</span> <span class=nav-text>1.4.3、安装grunt插件</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#1-4-4%E3%80%81%E5%90%AF%E5%8A%A8head><span class=nav-number>1.4.4.</span> <span class=nav-text>1.4.4、启动head</span></a></ol></ol><li class="nav-item nav-level-1"><a class=nav-link href=#6%E3%80%81ElasticSearch%E9%9B%86%E7%BE%A4><span class=nav-number>2.</span> <span class=nav-text>6、ElasticSearch集群</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#6-1%E3%80%81%E9%9B%86%E7%BE%A4%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5><span class=nav-number>2.1.</span> <span class=nav-text>6.1、集群相关概念</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#6-1-1%E3%80%81%E9%9B%86%E7%BE%A4cluster><span class=nav-number>2.1.1.</span> <span class=nav-text>6.1.1、集群cluster</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#6-1-2%E3%80%81%E8%8A%82%E7%82%B9node><span class=nav-number>2.1.2.</span> <span class=nav-text>6.1.2、节点node</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#6-1-3%E3%80%81%E5%88%86%E7%89%87%E5%92%8C%E5%A4%8D%E5%88%B6shards-replicas><span class=nav-number>2.1.3.</span> <span class=nav-text>6.1.3、分片和复制shards&replicas</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#6-2%E3%80%81%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA><span class=nav-number>2.2.</span> <span class=nav-text>6.2、集群搭建</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#6-2-1%E3%80%81%E5%87%86%E5%A4%87%E6%9C%8D%E5%8A%A1%E5%99%A8><span class=nav-number>2.2.1.</span> <span class=nav-text>6.2.1、准备服务器</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#6-2-2%E3%80%81%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE><span class=nav-number>2.2.2.</span> <span class=nav-text>6.2.2、服务器配置</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#6-2-3%E3%80%81%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1%E5%99%A8><span class=nav-number>2.2.3.</span> <span class=nav-text>6.2.3、启动服务器</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#6-2-4%E3%80%81%E9%9B%86%E7%BE%A4%E6%B5%8B%E8%AF%95><span class=nav-number>2.2.4.</span> <span class=nav-text>6.2.4、集群测试</span></a></ol></ol></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><img alt=豪哥 class=site-author-image itemprop=image src=/static/imgs/avatar.png><p class=site-author-name itemprop=name>豪哥<div class=site-description itemprop=description>豪哥博客</div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>116</span> <span class=site-state-item-name>日志</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>36</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/> <span class=site-state-item-count>129</span> <span class=site-state-item-name>标签</span></a></div></nav></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article lang=zh-CN><link href=https://hshz21.gitee.io/2024/08/21/ElasticSearch%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/static/imgs/avatar.png itemprop=image> <meta content=豪哥 itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=豪哥博客 itemprop=name> <meta content=豪哥博客 itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="ElasticSearch系列-ElasticSearch环境搭建 | 豪哥博客" itemprop=name> <meta itemprop=description> </span><header class=post-header><h1 itemprop="name headline" class=post-title>ElasticSearch系列-ElasticSearch环境搭建</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2024-08-21 21:39:13" datetime=2024-08-21T21:39:13+08:00>2024-08-21</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-08-07 16:44:58" datetime=2023-08-07T16:44:58+08:00 itemprop=dateModified>2023-08-07</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/ElasticSearch/ itemprop=url rel=index><span itemprop=name>ElasticSearch</span></a> </span> </span></div></div></header><div class=post-body itemprop=articleBody><h1 id=1、ElasticSearch单节点><a class=headerlink href=#1、ElasticSearch单节点 title=1、ElasticSearch单节点></a>1、ElasticSearch单节点</h1><h2 id=1-1、下载ES压缩包><a class=headerlink href=#1-1、下载ES压缩包 title=1.1、下载ES压缩包></a>1.1、下载ES压缩包</h2><p>ElasticSearch分为Linux和Window版本。<p>ElasticSearch的官方地址： <a href=https://www.elastic.co/products/elasticsearch%E5%9C%A8%E8%B5%84%E6%96%99%E4%B8%AD%E5%B7%B2%E7%BB%8F%E6%8F%90%E4%BE%9B%E4%BA%86%E4%B8%8B%E8%BD%BD%E5%A5%BD%E7%9A%845.6.8%E7%9A%84%E5%8E%8B%E7%BC%A9%E5%8C%85%EF%BC%9A rel=noopener target=_blank>https://www.elastic.co/products/elasticsearch在资料中已经提供了下载好的5.6.8的压缩包：</a><h2 id=1-2、安装ES服务><a class=headerlink href=#1-2、安装ES服务 title=1.2、安装ES服务></a>1.2、安装ES服务</h2><p>Window版的ElasticSearch的安装很简单，类似Window版的Tomcat，解压开即安装完毕，解压后的ElasticSearch 的目录结构如下：修改elasticsearch配置文件<code>confifig/elasticsearch.yml</code>，增加以下两句命令：<figure class="highlight properties"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line><span class=attr>http.cors.enabled</span>: <span class=string>true </span></span><br><span class=line><span class=attr>http.cors.allow‐origin</span>: <span class=string>"*"</span></span><br></pre></table></figure><p>此步为允许elasticsearch跨越访问，如果不安装后面的elasticsearch-head是可以不修改，直接启动。<h2 id=1-3、启动ES服务><a class=headerlink href=#1-3、启动ES服务 title=1.3、启动ES服务></a>1.3、启动ES服务</h2><p>点击ElasticSearch下的bin目录下的elasticsearch.bat启动，控制台显示的日志信息如下：<p>注意：9300是tcp通讯端口，集群间和TCPClient都执行该端口，9200是http协议的RESTful接口 。<p>通过浏览器访问ElasticSearch服务器。<blockquote><p>注意：ElasticSearch使用java开发，且本版本的es需要的jdk版本要是1.8以上，所以 安装ElasticSearch之前保证JDK1.8+安装完毕，并正确的配置好JDK环境变量，否则启动ElasticSearch失败。</blockquote><h2 id=1-4、安装ES图形化界面插件><a class=headerlink href=#1-4、安装ES图形化界面插件 title=1.4、安装ES图形化界面插件></a>1.4、安装ES图形化界面插件</h2><p>ElasticSearch不同于Solr自带图形化界面，我们可以通过安装ElasticSearch的head插件，完成图形化界面的效果，完成索引数据的查看。安装插件的方式有两种，在线安装和本地安装。这里采用本地安装方式进行head插件的安装。elasticsearch-5-*以上版本安装head需要安装node和grunt。<h3 id=1-4-1、安装head><a class=headerlink href=#1-4-1、安装head title=1.4.1、安装head></a>1.4.1、安装head</h3><p>下载head插件：<a href=https://github.com/mobz/elasticsearch-head rel=noopener target=_blank>https://github.com/mobz/elasticsearch-head</a><p>注意：ElasticSearch使用java开发制作，且本版本的es 依赖 Jdk1.8 以上。将elasticsearch-head-master压缩包解压到任意目录，但要与 elasticsearch安装目录 区分开<h3 id=1-4-2、安装node><a class=headerlink href=#1-4-2、安装node title=1.4.2、安装node></a>1.4.2、安装node</h3><ol><li>下载nodejs：<a href=https://nodejs.org/en/download/ rel=noopener target=_blank>https://nodejs.org/en/download/</a> 。<li>双击安装程序，步骤截图如下：安装完毕，可以通过cmd控制台输入：node -v 查看版本号。</ol><h3 id=1-4-3、安装grunt插件><a class=headerlink href=#1-4-3、安装grunt插件 title=1.4.3、安装grunt插件></a>1.4.3、安装grunt插件</h3><p>将grunt安装为全局命令 ，Grunt是基于Node.js的项目构建工具。<p>在cmd控制台中输入如下执行命令：<figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>npm install ‐g grunt‐cli</span><br></pre></table></figure><h3 id=1-4-4、启动head><a class=headerlink href=#1-4-4、启动head title=1.4.4、启动head></a>1.4.4、启动head</h3><p>进入elasticsearch-head-master目录启动head，在命令提示符下输入命令：<figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>npm install</span><br><span class=line>grunt server</span><br></pre></table></figure><p>打开浏览器，输入 <a href=http://localhost:9100，看到如下页面：>http://localhost:9100，看到如下页面：</a><p>如果无法连接到es服务，那么需要修改 <code>config/elasticsearch.yml</code>，增加 以下命令：<figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line><span class=attr>http.cors.enabled:</span> <span class=literal>true</span> </span><br><span class=line><span class=string>http.cors.allow‐origin:</span> <span class=string>"*"</span></span><br></pre></table></figure><p>然后重新启动ElasticSearch服务后 重试 即可。<h1 id=6、ElasticSearch集群><a class=headerlink href=#6、ElasticSearch集群 title=6、ElasticSearch集群></a>6、ElasticSearch集群</h1><p>ES集群是一个 P2P类型（使用 gossip 协议）的分布式系统，除了集群状态管理以外，其他所有的请求都可以发送到 集群内任意一台节点上，这个节点可以自己找到需要转发给哪些节点，并且直接跟这些节点通信。所以，从网络架 构及服务配置上来说，构建集群所需要的配置极其简单。在 Elasticsearch 2.0 之前，无阻碍的网络下，所有配置了 相同 cluster.name 的节点都自动归属到一个集群中。2.0 版本之后，基于安全的考虑避免开发环境过于随便造成的 麻烦，从 2.0 版本开始，默认的自动发现方式改为了单播(unicast)方式。配置里提供几台节点的地址，ES 将其视作 gossip router 角色，借以完成集群的发现。由于这只是 ES 内一个很小的功能，所以 gossip router 角色并不需要 单独配置，每个 ES 节点都可以担任。所以，采用单播方式的集群，各节点都配置相同的几个节点列表作为 router 即可。<p>集群中节点数量没有限制，一般大于等于2个节点就可以看做是集群了。一般处于高性能及高可用方面来考虑一般 集群中的节点数量都是3个及3个以上。<h2 id=6-1、集群相关概念><a class=headerlink href=#6-1、集群相关概念 title=6.1、集群相关概念></a>6.1、集群相关概念</h2><h3 id=6-1-1、集群cluster><a class=headerlink href=#6-1-1、集群cluster title=6.1.1、集群cluster></a>6.1.1、集群cluster</h3><p>一个集群就是由一个或多个节点组织在一起，它们共同持有整个的数据，并一起提供索引和搜索功能。一个集群由 一个唯一的名字标识，这个名字默认就是“elasticsearch”。这个名字是重要的，因为一个节点只能通过指定某个集 群的名字，来加入这个集群<h3 id=6-1-2、节点node><a class=headerlink href=#6-1-2、节点node title=6.1.2、节点node></a>6.1.2、节点node</h3><p>一个节点是集群中的一个服务器，作为集群的一部分，它存储数据，参与集群的索引和搜索功能。和集群类似，一 个节点也是由一个名字来标识的，默认情况下，这个名字是一个随机的漫威漫画角色的名字，这个名字会在启动的 时候赋予节点。这个名字对于管理工作来说挺重要的，因为在这个管理过程中，你会去确定网络中的哪些服务器对 应于Elasticsearch集群中的哪些节点。<p>一个节点可以通过配置集群名称的方式来加入一个指定的集群。默认情况下，每个节点都会被安排加入到一个叫 做“elasticsearch”的集群中，这意味着，如果你在你的网络中启动了若干个节点，并假定它们能够相互发现彼此， 它们将会自动地形成并加入到一个叫做“elasticsearch”的集群中。<p>在一个集群里，只要你想，可以拥有任意多个节点。而且，如果当前你的网络中没有运行任何Elasticsearch节点， 这时启动一个节点，会默认创建并加入一个叫做“elasticsearch”的集群。<h3 id=6-1-3、分片和复制shards-replicas><a class=headerlink href=#6-1-3、分片和复制shards-replicas title=6.1.3、分片和复制shards&replicas></a>6.1.3、分片和复制shards&replicas</h3><p>一个索引可以存储超出单个结点硬件限制的大量数据。比如，一个具有10亿文档的索引占据1TB磁盘空间，而任一节点都没有如此大的磁盘空间；或者单个节点处理搜索请求，响应太慢。为了解决这个问题，Elasticsearch提供 了将索引划分成多份的能力，这些份就叫做分片。当你创建一个索引的时候，你可以指定你想要的分片的数量。每 个分片本身也是一个功能完善并且独立的“索引”，这个“索引”可以被放置到集群中的任何节点上。分片很重要，主 要有两方面的原因： 1）允许你水平分割/扩展你的内容容量。 2）允许你在分片（潜在地，位于多个节点上）之上 进行分布式的、并行的操作，进而提高性能/吞吐量。<p>至于一个分片怎样分布，它的文档怎样聚合回搜索请求，是完全由Elasticsearch管理的，对于作为用户的你来说， 这些都是透明的。<p>在一个网络/云的环境里，失败随时都可能发生，在某个分片/节点不知怎么的就处于离线状态，或者由于任何原因 消失了，这种情况下，有一个故障转移机制是非常有用并且是强烈推荐的。为此目的，Elasticsearch允许你创建分 片的一份或多份拷贝，这些拷贝叫做复制分片，或者直接叫复制。<p>复制之所以重要，有两个主要原因： 在分片/节点失败的情况下，提供了高可用性。因为这个原因，注意到复制分 片从不与原/主要（original/primary）分片置于同一节点上是非常重要的。扩展你的搜索量/吞吐量，因为搜索可以 在所有的复制上并行运行。总之，每个索引可以被分成多个分片。一个索引也可以被复制0次（意思是没有复制） 或多次。一旦复制了，每个索引就有了主分片（作为复制源的原来的分片）和复制分片（主分片的拷贝）之别。分 片和复制的数量可以在索引创建的时候指定。在索引创建之后，你可以在任何时候动态地改变复制的数量，但是你 事后不能改变分片的数量。<p>默认情况下，Elasticsearch中的每个索引被分片5个主分片和1个复制，这意味着，如果你的集群中至少有两个节 点，你的索引将会有5个主分片和另外5个复制分片（1个完全拷贝），这样的话每个索引总共就有10个分片。<h2 id=6-2、集群搭建><a class=headerlink href=#6-2、集群搭建 title=6.2、集群搭建></a>6.2、集群搭建</h2><h3 id=6-2-1、准备服务器><a class=headerlink href=#6-2-1、准备服务器 title=6.2.1、准备服务器></a>6.2.1、准备服务器</h3><p>创建elasticsearch-cluster文件夹，在内部复制三个elasticsearch服务。<h3 id=6-2-2、服务器配置><a class=headerlink href=#6-2-2、服务器配置 title=6.2.2、服务器配置></a>6.2.2、服务器配置</h3><p>修改<code>elasticsearch-cluster\node*\confifig\elasticsearch.yml</code>配置文件。<p><strong>node1节点</strong><figure class="highlight properties"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br></pre><td class=code><pre><span class=line><span class=comment>#节点1的配置信息： </span></span><br><span class=line><span class=comment>#集群名称，保证唯一 </span></span><br><span class=line><span class=attr>cluster.name</span>: <span class=string>my‐elasticsearch </span></span><br><span class=line><span class=comment>#节点名称，必须不一样 </span></span><br><span class=line><span class=attr>node.name</span>: <span class=string>node‐1 </span></span><br><span class=line><span class=comment>#必须为本机的ip地址 </span></span><br><span class=line><span class=attr>network.host</span>: <span class=string>127.0.0.1 </span></span><br><span class=line><span class=comment>#服务端口号，在同一机器下必须不一样 </span></span><br><span class=line><span class=attr>http.port</span>: <span class=string>9200 </span></span><br><span class=line><span class=comment>#集群间通信端口号，在同一机器下必须不一样 </span></span><br><span class=line><span class=attr>transport.tcp.port</span>: <span class=string>9300 </span></span><br><span class=line><span class=comment>#设置集群自动发现机器ip集合 </span></span><br><span class=line><span class=attr>discovery.zen.ping.unicast.hosts</span>: <span class=string>["127.0.0.1:9300","127.0.0.1:9301","127.0.0.1:9302"]</span></span><br></pre></table></figure><p><strong>node2节点</strong><figure class="highlight properties"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br></pre><td class=code><pre><span class=line><span class=comment>#节点1的配置信息： </span></span><br><span class=line><span class=comment>#集群名称，保证唯一 </span></span><br><span class=line><span class=attr>cluster.name</span>: <span class=string>my‐elasticsearch </span></span><br><span class=line><span class=comment>#节点名称，必须不一样 </span></span><br><span class=line><span class=attr>node.name</span>: <span class=string>node‐2 </span></span><br><span class=line><span class=comment>#必须为本机的ip地址 </span></span><br><span class=line><span class=attr>network.host</span>: <span class=string>127.0.0.1 </span></span><br><span class=line><span class=comment>#服务端口号，在同一机器下必须不一样 </span></span><br><span class=line><span class=attr>http.port</span>: <span class=string>9200 </span></span><br><span class=line><span class=comment>#集群间通信端口号，在同一机器下必须不一样 </span></span><br><span class=line><span class=attr>transport.tcp.port</span>: <span class=string>9301 </span></span><br><span class=line><span class=comment>#设置集群自动发现机器ip集合 </span></span><br><span class=line><span class=attr>discovery.zen.ping.unicast.hosts</span>: <span class=string>["127.0.0.1:9300","127.0.0.1:9301","127.0.0.1:9302"]</span></span><br></pre></table></figure><p><strong>node3节点</strong><figure class="highlight properties"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br></pre><td class=code><pre><span class=line><span class=comment>#节点1的配置信息： </span></span><br><span class=line><span class=comment>#集群名称，保证唯一 </span></span><br><span class=line><span class=attr>cluster.name</span>: <span class=string>my‐elasticsearch </span></span><br><span class=line><span class=comment>#节点名称，必须不一样 </span></span><br><span class=line><span class=attr>node.name</span>: <span class=string>node‐3</span></span><br><span class=line><span class=comment>#必须为本机的ip地址 </span></span><br><span class=line><span class=attr>network.host</span>: <span class=string>127.0.0.1 </span></span><br><span class=line><span class=comment>#服务端口号，在同一机器下必须不一样 </span></span><br><span class=line><span class=attr>http.port</span>: <span class=string>9200 </span></span><br><span class=line><span class=comment>#集群间通信端口号，在同一机器下必须不一样 </span></span><br><span class=line><span class=attr>transport.tcp.port</span>: <span class=string>9302 </span></span><br><span class=line><span class=comment>#设置集群自动发现机器ip集合 </span></span><br><span class=line><span class=attr>discovery.zen.ping.unicast.hosts</span>: <span class=string>["127.0.0.1:9300","127.0.0.1:9301","127.0.0.1:9302"]</span></span><br></pre></table></figure><h3 id=6-2-3、启动服务器><a class=headerlink href=#6-2-3、启动服务器 title=6.2.3、启动服务器></a>6.2.3、启动服务器</h3><p>双击<code>elasticsearch-cluster\node*\bin\elasticsearch.bat</code>，请按顺序启动节点1、节点2、节点3。<h3 id=6-2-4、集群测试><a class=headerlink href=#6-2-4、集群测试 title=6.2.4、集群测试></a>6.2.4、集群测试</h3><p><strong>添加索引和映射</strong><figure class="highlight http"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>PUT localhost:9200/blog1 </span><br></pre></table></figure><figure class="highlight json"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br></pre><td class=code><pre><span class=line><span class=punctuation>{</span> </span><br><span class=line>    <span class=attr>"mappings"</span><span class=punctuation>:</span> <span class=punctuation>{</span> </span><br><span class=line>        <span class=attr>"article"</span><span class=punctuation>:</span> <span class=punctuation>{</span> </span><br><span class=line>            <span class=attr>"properties"</span><span class=punctuation>:</span> <span class=punctuation>{</span> </span><br><span class=line>                <span class=attr>"id"</span><span class=punctuation>:</span> <span class=punctuation>{</span> </span><br><span class=line>                    <span class=attr>"type"</span><span class=punctuation>:</span> <span class=string>"long"</span><span class=punctuation>,</span> </span><br><span class=line>                    <span class=attr>"store"</span><span class=punctuation>:</span> <span class=literal><span class=keyword>true</span></span><span class=punctuation>,</span> </span><br><span class=line>                    <span class=attr>"index"</span><span class=punctuation>:</span><span class=string>"not_analyzed"</span> </span><br><span class=line>                <span class=punctuation>}</span><span class=punctuation>,</span></span><br><span class=line>                <span class=attr>"title"</span><span class=punctuation>:</span> <span class=punctuation>{</span></span><br><span class=line>                    <span class=attr>"type"</span><span class=punctuation>:</span> <span class=string>"text"</span><span class=punctuation>,</span> </span><br><span class=line>                    <span class=attr>"store"</span><span class=punctuation>:</span> <span class=literal><span class=keyword>true</span></span><span class=punctuation>,</span> </span><br><span class=line>                    <span class=attr>"index"</span><span class=punctuation>:</span><span class=string>"analyzed"</span><span class=punctuation>,</span> </span><br><span class=line>                    <span class=attr>"analyzer"</span><span class=punctuation>:</span><span class=string>"standard"</span> </span><br><span class=line>                <span class=punctuation>}</span><span class=punctuation>,</span></span><br><span class=line>                <span class=attr>"content"</span><span class=punctuation>:</span> <span class=punctuation>{</span> </span><br><span class=line>                    <span class=attr>"type"</span><span class=punctuation>:</span> <span class=string>"text"</span><span class=punctuation>,</span> </span><br><span class=line>                    <span class=attr>"store"</span><span class=punctuation>:</span> <span class=literal><span class=keyword>true</span></span><span class=punctuation>,</span> </span><br><span class=line>                    <span class=attr>"index"</span><span class=punctuation>:</span><span class=string>"analyzed"</span><span class=punctuation>,</span> </span><br><span class=line>                    <span class=attr>"analyzer"</span><span class=punctuation>:</span><span class=string>"standard"</span> </span><br><span class=line>                <span class=punctuation>}</span> </span><br><span class=line>            <span class=punctuation>}</span> </span><br><span class=line>        <span class=punctuation>}</span> </span><br><span class=line>    <span class=punctuation>}</span> </span><br><span class=line><span class=punctuation>}</span></span><br></pre></table></figure><p><strong>添加文档</strong><figure class="highlight http"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>POST localhost:9200/blog1/article/1</span><br></pre></table></figure><figure class="highlight json"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre><td class=code><pre><span class=line><span class=punctuation>{</span> </span><br><span class=line>    <span class=attr>"id"</span><span class=punctuation>:</span><span class=number>1</span><span class=punctuation>,</span> </span><br><span class=line>    <span class=attr>"title"</span><span class=punctuation>:</span><span class=string>"ElasticSearch是一个基于Lucene的搜索服务器"</span><span class=punctuation>,</span> </span><br><span class=line>    <span class=attr>"content"</span><span class=punctuation>:</span><span class=string>"它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java 开发的，并作为Apache许可条款下的开放源码发布，是当前流行的企业级搜索引擎。设计用于云计算中，能够达到实时 搜索，稳定，可靠，快速，安装使用方便。"</span> </span><br><span class=line><span class=punctuation>}</span></span><br></pre></table></figure></div><footer class=post-footer><div class=post-tags><a href=/tags/ElasticSearch/ rel=tag># ElasticSearch</a><a href=/tags/ElasticSearch%E7%8E%AF%E5%A2%83/ rel=tag># ElasticSearch环境</a></div><div class=post-nav><div class=post-nav-item><a href=/2024/08/21/Docker%E4%B9%8BZookeeper%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/ rel=prev title=Docker系列-Zookeeper环境搭建> <i class="fa fa-angle-left"></i> Docker系列-Zookeeper环境搭建 </a></div><div class=post-nav-item><a href=/2024/08/21/ElasticSearch%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/ rel=next title=ElasticSearch系列-ElasticSearch基础应用> ElasticSearch系列-ElasticSearch基础应用 <i class="fa fa-angle-right"></i> </a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>© <span itemprop=copyrightYear>2024</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>豪哥</span></div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label=返回顶部 class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script crossorigin=anonymous integrity=sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY= src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js></script><script src=/js/comments.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/sidebar.js></script><script src=/js/next-boot.js></script><script crossorigin=anonymous integrity=sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc= src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js></script><script src=/js/third-party/search/local-search.js></script>