<!doctypehtml><html lang=zh-CN><meta charset=UTF-8><meta content=width=device-width name=viewport><meta media="(prefers-color-scheme: light)" content=#222 name=theme-color><meta media="(prefers-color-scheme: dark)" content=#222 name=theme-color><meta content="Hexo 7.3.0" name=generator><link href=/images/apple-touch-icon-next.png rel=apple-touch-icon sizes=180x180><link href=/images/favicon-32x32-next.png rel=icon sizes=32x32 type=image/png><link href=/images/favicon-16x16-next.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><link href=/css/main.css rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css integrity=sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA= rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css integrity=sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE= rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"hshz21.gitee.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src=/js/config.js></script><meta content="1、IOC容器1.1、概述org.springframework.beans 和 org.springframework.context 是 Spring IOC 容器的基础。 BeanFactory是IOC容器的基础类，提供了框架配置和基本功能，ApplicationContext实现并扩展了BeanFactory，提供了国际化、环境配置、资源读取、事件监听等功能。 Spring关于IOC的特点" name=description><meta content=article property=og:type><meta content=Spring系列-SpringIOC property=og:title><meta content=https://hshz21.gitee.io/2024/08/21/SpringIOC/index.html property=og:url><meta content=豪哥博客 property=og:site_name><meta content="1、IOC容器1.1、概述org.springframework.beans 和 org.springframework.context 是 Spring IOC 容器的基础。 BeanFactory是IOC容器的基础类，提供了框架配置和基本功能，ApplicationContext实现并扩展了BeanFactory，提供了国际化、环境配置、资源读取、事件监听等功能。 Spring关于IOC的特点" property=og:description><meta content=zh_CN property=og:locale><meta content=2024-08-21T13:39:14.735Z property=article:published_time><meta content=2023-10-04T03:28:57.364Z property=article:modified_time><meta content=豪哥 property=article:author><meta content=Spring property=article:tag><meta content=SpringIOC property=article:tag><meta content=summary name=twitter:card><link href=https://hshz21.gitee.io/2024/08/21/SpringIOC/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://hshz21.gitee.io/2024/08/21/SpringIOC/","path":"2024/08/21/SpringIOC/","title":"Spring系列-SpringIOC"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>Spring系列-SpringIOC | 豪哥博客</title><noscript><link href=/css/noscript.css rel=stylesheet></noscript><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label=切换导航栏 class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <p class=site-title>豪哥博客</p> <i class=logo-line></i> </a><p class=site-subtitle itemprop=description>豪哥博客</div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=搜索 role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>分类</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>搜索 </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=搜索... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-1"><a class=nav-link href=#1%E3%80%81IOC%E5%AE%B9%E5%99%A8><span class=nav-number>1.</span> <span class=nav-text>1、IOC容器</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#1-1%E3%80%81%E6%A6%82%E8%BF%B0><span class=nav-number>1.1.</span> <span class=nav-text>1.1、概述</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-2%E3%80%81BeanFactory><span class=nav-number>1.2.</span> <span class=nav-text>1.2、BeanFactory</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-3%E3%80%81ApplicationContext><span class=nav-number>1.3.</span> <span class=nav-text>1.3、ApplicationContext</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#1-3-1%E3%80%81%E7%AE%80%E4%BB%8B><span class=nav-number>1.3.1.</span> <span class=nav-text>1.3.1、简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#1-3-2%E3%80%81BeanFactory-VS-ApplicationContext><span class=nav-number>1.3.2.</span> <span class=nav-text>1.3.2、BeanFactory VS ApplicationContext</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#1-4%E3%80%81WebApplicationContext><span class=nav-number>1.4.</span> <span class=nav-text>1.4、WebApplicationContext</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#1-4-1%E3%80%81%E7%AE%80%E4%BB%8B><span class=nav-number>1.4.1.</span> <span class=nav-text>1.4.1、简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#1-4-2%E3%80%81%E5%88%9D%E5%A7%8B%E5%8C%96><span class=nav-number>1.4.2.</span> <span class=nav-text>1.4.2、初始化</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#1-5%E3%80%81Bean><span class=nav-number>1.5.</span> <span class=nav-text>1.5、Bean</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#1-5-1%E3%80%81Bean%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F><span class=nav-number>1.5.1.</span> <span class=nav-text>1.5.1、Bean生命周期</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#1-5-2%E3%80%81Bean%E5%AE%9E%E4%BE%8B%E5%8C%96><span class=nav-number>1.5.2.</span> <span class=nav-text>1.5.2、Bean实例化</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#1-5-3%E3%80%81Bean%E4%BD%9C%E7%94%A8%E5%9F%9F><span class=nav-number>1.5.3.</span> <span class=nav-text>1.5.3、Bean作用域</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#1-6%E3%80%81%E6%B3%A8%E5%85%A5%E9%9B%86%E5%90%88><span class=nav-number>1.6.</span> <span class=nav-text>1.6、注入集合</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-7%E3%80%81%E5%A2%9E%E5%BC%BA%E5%99%A8><span class=nav-number>1.7.</span> <span class=nav-text>1.7、增强器</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link href=#2%E3%80%81Spring%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6><span class=nav-number>2.</span> <span class=nav-text>2、Spring事件机制</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#2-1%E3%80%81%E4%BA%8B%E4%BB%B6%E7%B1%BB%E5%9E%8B><span class=nav-number>2.1.</span> <span class=nav-text>2.1、事件类型</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link href=#%E6%80%BB%E7%BB%93><span class=nav-number>3.</span> <span class=nav-text>总结</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%AE%B9%E5%99%A8%E5%90%AF%E5%8A%A8%E5%8E%9F%E7%90%86><span class=nav-number>3.1.</span> <span class=nav-text>容器启动原理</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%AE%B9%E5%99%A8%E5%8A%A0%E8%BD%BDBean%E5%8E%9F%E7%90%86><span class=nav-number>3.2.</span> <span class=nav-text>容器加载Bean原理</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#ApplicationContext%E5%92%8CBeanFactory%E7%9A%84%E5%8C%BA%E5%88%AB><span class=nav-number>3.3.</span> <span class=nav-text>ApplicationContext和BeanFactory的区别</span></a></ol></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><img alt=豪哥 class=site-author-image itemprop=image src=/static/imgs/avatar.png><p class=site-author-name itemprop=name>豪哥<div class=site-description itemprop=description>豪哥博客</div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>116</span> <span class=site-state-item-name>日志</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>36</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/> <span class=site-state-item-count>129</span> <span class=site-state-item-name>标签</span></a></div></nav></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article lang=zh-CN><link href=https://hshz21.gitee.io/2024/08/21/SpringIOC/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/static/imgs/avatar.png itemprop=image> <meta content=豪哥 itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=豪哥博客 itemprop=name> <meta content=豪哥博客 itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="Spring系列-SpringIOC | 豪哥博客" itemprop=name> <meta itemprop=description> </span><header class=post-header><h1 itemprop="name headline" class=post-title>Spring系列-SpringIOC</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2024-08-21 21:39:14" datetime=2024-08-21T21:39:14+08:00>2024-08-21</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-10-04 11:28:57" datetime=2023-10-04T11:28:57+08:00 itemprop=dateModified>2023-10-04</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/Spring/ itemprop=url rel=index><span itemprop=name>Spring</span></a> </span> </span></div></div></header><div class=post-body itemprop=articleBody><h1 id=1、IOC容器><a class=headerlink href=#1、IOC容器 title=1、IOC容器></a>1、IOC容器</h1><h2 id=1-1、概述><a class=headerlink href=#1-1、概述 title=1.1、概述></a>1.1、概述</h2><p><strong>org.springframework.beans 和 org.springframework.context 是 Spring IOC 容器的基础</strong>。<p><strong>BeanFactory是IOC容器的基础类，提供了框架配置和基本功能，ApplicationContext实现并扩展了BeanFactory，提供了国际化、环境配置、资源读取、事件监听等功能</strong>。<p>Spring关于IOC的特点总结如下：<ul><li>Spring 利用Java反射实例化Bean并管理Bean之间的依赖关系。<li>基础环境下，bean的scope只能设置single、prototype两个属性值。web环境下可以设置request、session两个属性。<li>IOC容器中bean的名字取值优先级为：<strong>id属性值 > name属性值 > class类路径全名</strong>。</ul><blockquote><p>Spring发布时就可以支持XML配置，Spring 2.5支持注解配置，Spring 3.0开始支持Java类配置。<p>注解注入先于XML执行，故XML配置会覆盖注解注入。</blockquote><h2 id=1-2、BeanFactory><a class=headerlink href=#1-2、BeanFactory title=1.2、BeanFactory></a>1.2、BeanFactory</h2><p><strong>BeanFactory是Spring IOC的基础</strong>。<p>通过<code>BeanFactory</code>和<code>BeanFactoryAware</code>、<code>InitializingBean</code>、<code>DisposableBean</code>等接口可<strong>实现容器和组件间的有效交互</strong>。<p><code>BeanFactory</code>会缓存单例Bean实例，第二次获取 Bean 时将直接从缓存中获取。其原理是在<code>DefaultSingletonBeanRegistry</code>类中设计了一个单实例 Bean 缓存，该缓存基于<code>HashMap</code>实现，键就是单实例Bean的<code>beanName</code>。<h2 id=1-3、ApplicationContext><a class=headerlink href=#1-3、ApplicationContext title=1.3、ApplicationContext></a>1.3、ApplicationContext</h2><h3 id=1-3-1、简介><a class=headerlink href=#1-3-1、简介 title=1.3.1、简介></a>1.3.1、简介</h3><p><strong>org.springframework.context.ApplicationContext 接口代表Spring IOC容器，负责配置、组装、实例化 Bean</strong>。<p><code>BeanFactory</code>大多功能需要通过编程方式实现，能管理任何类型对象。<code>ApplicationContext</code>继承了<code>BeanFactory</code>并扩展了很多功能：<ul><li><strong>与 Spring AOP 轻松集成</strong>。<li><strong>消息资源处理（用于国际化）</strong><li><strong>事件发布</strong><li><strong>特定于应用程序层的上下文</strong>，例如，用于 Web 应用程序的<code>WebApplicationContext</code>。</ul><p><code>ApplicationContext</code>常见实现有：<code>ClassPathXmlApplicationContext</code> 和<code>FileSystemXmlApplicationContext</code>等。<h3 id=1-3-2、BeanFactory-VS-ApplicationContext><a title="1.3.2、BeanFactory VS ApplicationContext" class=headerlink href=#1-3-2、BeanFactory-VS-ApplicationContext></a>1.3.2、BeanFactory VS ApplicationContext</h3><ol><li>BeanFactory 是Spring的早期接口，称为Spring Bean工厂。ApplicationContext是后期的高级接口，称为Sprng容器。<li>ApplicationContext 在 BeanFactory 基础上对功能进行了扩展，例如：<strong>监听、资源访问、国际化</strong>等。BeanFactory的API更底层，ApplicatinContext的API大多是对底层API的封装。<li><strong>ApplicatinContext 继承了 BeanFactory，且内部维护了其引用</strong>。故 ApplicationContext 与 BeanFactory 既有继承关系，又有融合关系。<li>BeanFactory 对于Bean的实例化采用的是懒加载方式，而 ApplicationContext 采用的是立即加载。</ol><h2 id=1-4、WebApplicationContext><a class=headerlink href=#1-4、WebApplicationContext title=1.4、WebApplicationContext></a>1.4、WebApplicationContext</h2><h3 id=1-4-1、简介><a class=headerlink href=#1-4-1、简介 title=1.4.1、简介></a>1.4.1、简介</h3><p><strong>WebApplicationContext 专门为Web应用服务，它允许从 相对于Web根目录的路径中 装载配置文件 并完成初始化工作</strong>。从<code>WebApplicationContext</code>中可获得<code>ServletContext</code>引用，整个Web应用上下文对象将作为属性放置到<code>ServletContext</code>中，以便 Web应用环境可以访问Spring应用上下文。 <code>WebApplicationContext</code>定义了一个常量：<code>ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE（= WebApplicationContext.class.getName() + ".ROOT";）</code>，在上下文启动时，<code>WebApplicationContext</code>实例会以此为键放置在<code>ServletContext</code>属性列表中。<h3 id=1-4-2、初始化><a class=headerlink href=#1-4-2、初始化 title=1.4.2、初始化></a>1.4.2、初始化</h3><p><strong>WebApplicationContext需要ServletContext实例，它必须拥有Web容器才能完成启动工作</strong>。<p><strong>可以在 web.xml 中配置自启动的 Servlet 或定义Web容器监听器（ ServletContextListener），满足两者之一 即可启动 Spring Web应用上下文</strong>。Spring提供了启动 <code>WebApplicationContext</code> 的 <code>Servlet</code> 和 Web容器监听器：<ol><li><code>org.springframework.web.context.ContextLoaderServlet</code><li><code>org.springframework.web.context.ContextLoaderListener</code></ol><h2 id=1-5、Bean><a class=headerlink href=#1-5、Bean title=1.5、Bean></a>1.5、Bean</h2><h3 id=1-5-1、Bean生命周期><a class=headerlink href=#1-5-1、Bean生命周期 title=1.5.1、Bean生命周期></a>1.5.1、Bean生命周期</h3><p>Spring Bean的生命周期指的是<strong>从Bean的实例化到最终存储到单例池中的一个过程</strong>。<p>Spring生命周期体现在三个阶段：<ul><li><strong>Beean实例化阶段</strong><li><strong>Bean初始化阶段</strong><li><strong>Bean完成阶段</strong></ul><p>Bean生命周期详细流程分析如下：<ol><li><p><strong>实例化 Bean</strong></p> <p>若容器注册了<code>org.springframework.beans.factory.config.InstantiationAwareBeanPostProcessor</code> 接口，则：</p> <ol><li>实例化 Bean 前，先调用该接口的<code>postProcessBeforeInstantiation()</code>方法；<li>实例化Bean（根据配置情况调用Bean构造函数或工厂方法）；<li>实例化 Bean 后，调用该接口的<code>postProcessAfterInstantiation()</code>方法，可在这里对已经实例化的对象做一点扩展；</ol><li><p><strong>填充Bean属性值</strong></p> <ol><li>先调用 <code>InstantiationAwareBeanPostProcessor</code> 接口的 <code>postProcessPropertyValues()</code> 方法（5.1版本后，推荐使用 <code>postProcessProperties</code> 方法代替）；<li>填充 Bean属性值；</ol><li><p><strong>给Bean起个名</strong></p> <ol><li>如果 Bean 实现了 <code>org.springframework.beans.factory.BeanNameAware</code> 接口，将调用setBeanName()接口方法，将配置文件中该Bean对应的名称设置到 Bean 中；</ol><li><p><strong>将BeanFactory填充至Bean中</strong></p> <ol><li>如果 Bean 实现了 <code>org.springframework.beans.factory.BeanFactoryAware</code> 接口，将调用<code>setBeanFactory()</code> 接口方法，将BeanFactory容器实例设置到Bean中；</ol><li><p><strong>对Bean进行再加工</strong></p> <ol><li>如果 BeanFactory 装配了 <code>BeanPostProcessor</code> 后处理器，则会调用它的<code>postProcessBeforeInitialization(Object bean, String beanName)</code> 接口方法对 Bean 进行加工操作。（其中入参 bean 是当前正在处理的Bean，而beanName是当前Bean配置名，返回的对象为加工处理后的Bean。用户可以使用该方法对某些 Bean进行特殊的处理，甚至改变 Bean的行为。）（Spring容器所提供的各种神奇功能，如 AOP，动态代理等都是通过BeanPostProcessor来实现）<li>如果Bean实现了<code>InitializingBean</code> 接口，将调用接口的 <code>afterPropertiesSet()</code> 方法；<li>如果 <code>init-method</code> 属性指定了初始化方法，则执行这个方法；<li>调用 <code>BeanPostProcessor</code> 的 <code>postProcessAfterInitialization(Object bean, String beanName)</code> 方法。</ol><li><p><strong>使用Bean</strong></p><li><p><strong>销毁处理</strong></p> <p>如果是Prototype Bean，直接返回bean给调用者，调用者将负责Bean后续生命的管理。如果是Singleton Bean，则将Bean放入Spring IOC容器的缓存中，并将Bean引用返回给调用者， Spring继续负责Bean生命周期的管理：</p> <ol><li>对于Singleton Bean，容器关闭时会触发Spring对Bean后续生命周期的管理工作。如果Bean实现了 <code>DisposableBean</code> 接口，则调用接口的 <code>destroy()</code> 方法（5.0开始，推荐使用close方法）。<li>对于Singleton Bean，如果 <code>destroy-method</code> 属性指定了Bean的销毁方法， Spring将执行该这个方法来完成Bean资源的释放等操作。</ol></ol><h3 id=1-5-2、Bean实例化><a class=headerlink href=#1-5-2、Bean实例化 title=1.5.2、Bean实例化></a>1.5.2、Bean实例化</h3><p>工厂方式实例化Bean，可以分为三种：<ul><li><strong>静态工厂方法实例化Bean</strong>。<li><strong>实例工厂方法实例化Bean</strong>。<li><strong>实现FactoryBean接口实例化Bean</strong>。</ul><h3 id=1-5-3、Bean作用域><a class=headerlink href=#1-5-3、Bean作用域 title=1.5.3、Bean作用域></a>1.5.3、Bean作用域</h3><ul><li><strong>Singleton（默认）</strong>：每个容器中只有一个Bean实例，单例Bean由Spring来维护。<li><strong>Prototype</strong>：原形范围与单例范围相反，为每一个Bean请求提供一个实例。<li><strong>Request</strong>：每一个请求都会创建一个实例，请求完成后，Bean会失效并被垃圾回收器回收。<li><strong>Session</strong>：每个session中有一个bean实例，Session过期后，Bean会随之失效。<li><strong>Global Session</strong>：与Portlet应用有关。当应用部署在Portlet容器中时，它包含很多portlet。所有的portlet共用全局的存储变量。</ul><h2 id=1-6、注入集合><a class=headerlink href=#1-6、注入集合 title=1.6、注入集合></a>1.6、注入集合</h2><p>Spring提供以下几种集合的配置元素：<ul><li><code>&LTlist></code>：注入一列值，允许有相同的值。<li><code>&LTset> </code>：注入一组值，不允许有相同的值。<li><code>&LTmap></code>：注入一组键值对，键和值都<strong>可以为任意类型</strong>。<li><code>&LTprops></code>：注入一组键值对，键和值都<strong>只能为String类型</strong>。</ul><h2 id=1-7、增强器><a class=headerlink href=#1-7、增强器 title=1.7、增强器></a>1.7、增强器</h2><p>Spring中的增强器分为两种：<ul><li><p><strong>BeanFactoryPostProccessor</strong></p> <p>该增强器会在准备好bean定义信息后且实例化Bean前执行，仅执行一次。</p><li><p><strong>BeanPostProcessor</strong></p> <p>该增强器会在实例化bean后且将bean放入一级缓存前执行，每创建一个Bean都会执行一次。</p></ul><h1 id=2、Spring事件机制><a class=headerlink href=#2、Spring事件机制 title=2、Spring事件机制></a>2、Spring事件机制</h1><h2 id=2-1、事件类型><a class=headerlink href=#2-1、事件类型 title=2.1、事件类型></a>2.1、事件类型</h2><p>Spring 提供了以下5种标准事件：<ol><li><p><strong>上下文开始事件</strong></p> <p>当容器调用<code>ConfigurableApplicationContext.Start()</code>方法开始/重新开始容器时触发该事件。</p><li><p><strong>上下文停止事件</strong></p> <p>当容器调用<code>ConfigurableApplicationContext.Stop()</code>方法停止容器时触发该事件。</p><li><p><strong>上下文更新事件</strong></p> <p>该事件会在<code>ApplicationContext</code>被初始化或者更新时发布。也可以在调用<code>ConfigurableApplicationContext.refresh()</code>方法时被触发。</p><li><p><strong>上下文关闭事件</strong></p> <p>当<code>ApplicationContext</code>被关闭时触发该事件。容器被关闭时，其管理的所有单例Bean都被销毁。</p><li><p><strong>请求处理事件</strong></p> <p>在Web应用中，当一个http请求（request）结束时触发该事件。</p></ol><h1 id=总结><a class=headerlink href=#总结 title=总结></a>总结</h1><p><strong>Spring IOC容器主要有BeanFactory、ApplicationContext、WebApplicationContext</strong>。<h2 id=容器启动原理><a class=headerlink href=#容器启动原理 title=容器启动原理></a>容器启动原理</h2><p>Spring IOC容器通过tomcat的Servlet或Listener监听来启动加载：<ul><li><strong>Spring MVC的容器由DispatchServlet作为入口加载；</strong><li><strong>Spring容器是Spring MVC容器的父容器；</strong></ul><h2 id=容器加载Bean原理><a class=headerlink href=#容器加载Bean原理 title=容器加载Bean原理></a>容器加载Bean原理</h2><ol><li>BeanDefinitionReader 读取 Resource 所指向的配置文件资源，然后解析配置文件。配置文件中的每一个Bean定义会被解析成一个BeanDefinition对象，并保存到 BeanDefinitionRegistry 中；<li>容器扫描 BeanDefinitionRegistry 中的 BeanDefinition；通过 InstantiationStrategy 实例化Bean；通过BeanWrapper 设置Bean属性；<li>单例Bean缓存池：Spring 在 DefaultSingletonBeanRegistry 类中提供了一个用于缓存单例Bean的缓存，其基于HashMap实现，单实例Bean以 beanName 为键保存在这个HashMap中。</ol><h2 id=ApplicationContext和BeanFactory的区别><a class=headerlink href=#ApplicationContext和BeanFactory的区别 title=ApplicationContext和BeanFactory的区别></a>ApplicationContext和BeanFactory的区别</h2><ol><li><p>BeanFactory：是Spring中的底层接口，包含各种Bean定义，读取bean配置文档，管理bean的加载、实例化，控制bean的生命周期，维护bean之间的依赖关系。</p> <p>ApplicationContext接口除了提供BeanFactory所具有的功能外，还提供了其它功能：</p> <ul><li><p><strong>默认立即初始化所有Singleton bean，也可通过配置 取消 预初始化</strong>。</p><li><p><strong>继承MessageSource，支持国际化</strong>。</p><li><p><em><strong>资源访问</strong></em>，比如访问URL和文件。</p><li><p><em><strong>事件机制</strong></em>（在监听器中注册bean事件）。</p><li><p><strong>同时加载多个配置文件</strong>。</p><li><p><strong>以声明式方式启动并创建Spring容器</strong>。</p></ul><li><p>ApplicationContext会<strong>利用Java反射机制自动识别</strong> 出配置文件中定义的<strong>BeanPostProcessor、 InstantiationAwareBeanPostProcessor和 BeanFactoryPostProcessor，并自动将它们注册到应用上下文中</strong>；而 <strong>BeanFactory需要在代码中通过显式调用 addBeanPostProcessor() 方法进行注册</strong>。这也是普遍使用 ApplicationContext 而很少使用 BeanFactory 的原因之一。</p><li><p>ApplicationContext <strong>初始化上下文时会立即实例化所有单例Bean</strong>，可通过参数<code>lazy-init=true</code>来延迟Bean实例化；BeanFactory初始化容器时 不会实例化Bean，<strong>只有在第一次从容器中拿Bean时才会实例化</strong>。 </p><li><p><strong>BeanFactory一般通过编程方式来创建，ApplicationContext还能以声明方式创建</strong>，比如 使用ContextLoader。</p></ol></div><footer class=post-footer><div class=post-tags><a href=/tags/Spring/ rel=tag># Spring</a><a href=/tags/SpringIOC/ rel=tag># SpringIOC</a></div><div class=post-nav><div class=post-nav-item><a href=/2024/08/21/SpringBoo%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/ rel=prev title=SpringBoot系列-SpringBoot基础应用> <i class="fa fa-angle-left"></i> SpringBoot系列-SpringBoot基础应用 </a></div><div class=post-nav-item><a href=/2024/08/21/SpringMVC/ rel=next title=Spring系列-SpringMVC> Spring系列-SpringMVC <i class="fa fa-angle-right"></i> </a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>© <span itemprop=copyrightYear>2024</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>豪哥</span></div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label=返回顶部 class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script crossorigin=anonymous integrity=sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY= src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js></script><script src=/js/comments.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/sidebar.js></script><script src=/js/next-boot.js></script><script crossorigin=anonymous integrity=sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc= src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js></script><script src=/js/third-party/search/local-search.js></script>