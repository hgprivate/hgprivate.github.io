<!doctypehtml><html lang=zh-CN><meta charset=UTF-8><meta content=width=device-width name=viewport><meta media="(prefers-color-scheme: light)" content=#222 name=theme-color><meta media="(prefers-color-scheme: dark)" content=#222 name=theme-color><meta content="Hexo 7.3.0" name=generator><link href=/images/apple-touch-icon-next.png rel=apple-touch-icon sizes=180x180><link href=/images/favicon-32x32-next.png rel=icon sizes=32x32 type=image/png><link href=/images/favicon-16x16-next.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><link href=/css/main.css rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css integrity=sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA= rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css integrity=sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE= rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"hgprivate.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src=/js/config.js></script><meta content="Tomcat优化1、内存优化启动时告诉JVM需要一块大内存（调优内存是最直接的方式）。 修改配置文件catalina.sh（Windows下为catalina.bat，Linux下为catalina.sh）： 1JAVA_OPTS='-Xms512m -Xmx1024m'   -Xms<size> ：JVM 初始化堆的大小； -Xmx<size>：JVM" name=description><meta content=article property=og:type><meta content=Tomcat系列-Tomcat优化 property=og:title><meta content=https://hgprivate.github.io/2024/08/21/Tomcat%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/index.html property=og:url><meta content=豪哥博客 property=og:site_name><meta content="Tomcat优化1、内存优化启动时告诉JVM需要一块大内存（调优内存是最直接的方式）。 修改配置文件catalina.sh（Windows下为catalina.bat，Linux下为catalina.sh）： 1JAVA_OPTS='-Xms512m -Xmx1024m'   -Xms<size> ：JVM 初始化堆的大小； -Xmx<size>：JVM" property=og:description><meta content=zh_CN property=og:locale><meta content=2024-08-21T13:39:14.851Z property=article:published_time><meta content=2023-10-03T02:15:46.538Z property=article:modified_time><meta content=豪哥 property=article:author><meta content=Tomcat property=article:tag><meta content=Tomcat优化 property=article:tag><meta content=summary name=twitter:card><link href=https://hgprivate.github.io/2024/08/21/Tomcat%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://hgprivate.github.io/2024/08/21/Tomcat%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/","path":"2024/08/21/Tomcat性能优化/","title":"Tomcat系列-Tomcat优化"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>Tomcat系列-Tomcat优化 | 豪哥博客</title><noscript><link href=/css/noscript.css rel=stylesheet></noscript><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label=切换导航栏 class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <p class=site-title>豪哥博客</p> <i class=logo-line></i> </a><p class=site-subtitle itemprop=description>豪哥博客</div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=搜索 role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>分类</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>搜索 </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=搜索... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-1"><a class=nav-link href=#Tomcat%E4%BC%98%E5%8C%96><span class=nav-number>1.</span> <span class=nav-text>Tomcat优化</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#1%E3%80%81%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96><span class=nav-number>1.1.</span> <span class=nav-text>1、内存优化</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#2%E3%80%81%E7%BA%BF%E7%A8%8B%E4%BC%98%E5%8C%96><span class=nav-number>1.2.</span> <span class=nav-text>2、线程优化</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#2-1%E3%80%81%E8%BF%9E%E6%8E%A5%E7%BA%BF%E7%A8%8B%E4%BC%98%E5%8C%96><span class=nav-number>1.2.1.</span> <span class=nav-text>2.1、连接线程优化</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#2-2%E3%80%81%E4%B8%9A%E5%8A%A1%E5%A4%84%E7%90%86%E7%BA%BF%E7%A8%8B%E4%BC%98%E5%8C%96><span class=nav-number>1.2.2.</span> <span class=nav-text>2.2、业务处理线程优化</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#3%E3%80%81IO%E4%BC%98%E5%8C%96><span class=nav-number>1.3.</span> <span class=nav-text>3、IO优化</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#4%E3%80%81%E7%BC%93%E5%AD%98%E5%8E%8B%E7%BC%A9%E4%BC%98%E5%8C%96><span class=nav-number>1.4.</span> <span class=nav-text>4、缓存压缩优化</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#4-1%E3%80%81%E5%8E%8B%E7%BC%A9%E4%BC%98%E5%8C%96%E5%AE%9A%E4%B9%89><span class=nav-number>1.4.1.</span> <span class=nav-text>4.1、压缩优化定义</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#4-2%E3%80%81%E5%BC%80%E5%90%AF%E5%8E%8B%E7%BC%A9%E4%BC%98%E5%8C%96><span class=nav-number>1.4.2.</span> <span class=nav-text>4.2、开启压缩优化</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#4-3%E3%80%81%E7%BC%93%E5%AD%98%E7%AD%96%E7%95%A5><span class=nav-number>1.4.3.</span> <span class=nav-text>4.3、缓存策略</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#5%E3%80%81%E5%AE%89%E5%85%A8%E4%BC%98%E5%8C%96><span class=nav-number>1.5.</span> <span class=nav-text>5、安全优化</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#6%E3%80%81APR%EF%BC%88%E5%A4%A7%E6%9D%80%E5%99%A8%EF%BC%89><span class=nav-number>1.6.</span> <span class=nav-text>6、APR（大杀器）</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#6-1%E3%80%81%E6%A6%82%E8%BF%B0><span class=nav-number>1.7.</span> <span class=nav-text>6.1、概述</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#6-2%E3%80%81%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8><span class=nav-number>1.8.</span> <span class=nav-text>6.2、安装使用</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link href=#Tomcat%E4%B9%8BJVM%E4%BC%98%E5%8C%96><span class=nav-number>2.</span> <span class=nav-text>Tomcat之JVM优化</span></a><li class="nav-item nav-level-1"><a class=nav-link href=#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%BC%98%E5%8C%96%EF%BC%88Linux%EF%BC%89><span class=nav-number>3.</span> <span class=nav-text>操作系统优化（Linux）</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#1%E3%80%81%E6%9C%80%E5%A4%A7%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6%E6%95%B0><span class=nav-number>3.1.</span> <span class=nav-text>1、最大打开文件数</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#1-1%E3%80%81%E7%B3%BB%E7%BB%9F%E7%BA%A7%E5%8F%A5%E6%9F%84%E6%95%B0%E9%87%8F><span class=nav-number>3.1.1.</span> <span class=nav-text>1.1、系统级句柄数量</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#1-2%E3%80%81%E8%BF%9B%E7%A8%8B%E7%BA%A7%E5%8F%A5%E6%9F%84%E6%95%B0%E9%87%8F><span class=nav-number>3.1.2.</span> <span class=nav-text>1.2、进程级句柄数量</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#2%E3%80%81TCP%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96><span class=nav-number>3.2.</span> <span class=nav-text>2、TCP参数优化</span></a></ol></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><img alt=豪哥 class=site-author-image itemprop=image src=/static/imgs/avatar.png><p class=site-author-name itemprop=name>豪哥<div class=site-description itemprop=description>豪哥博客</div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>117</span> <span class=site-state-item-name>日志</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>36</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/> <span class=site-state-item-count>129</span> <span class=site-state-item-name>标签</span></a></div></nav></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article lang=zh-CN><link href=https://hgprivate.github.io/2024/08/21/Tomcat%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/static/imgs/avatar.png itemprop=image> <meta content=豪哥 itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=豪哥博客 itemprop=name> <meta content=豪哥博客 itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="Tomcat系列-Tomcat优化 | 豪哥博客" itemprop=name> <meta itemprop=description> </span><header class=post-header><h1 itemprop="name headline" class=post-title>Tomcat系列-Tomcat优化</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2024-08-21 21:39:14" datetime=2024-08-21T21:39:14+08:00>2024-08-21</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-10-03 10:15:46" datetime=2023-10-03T10:15:46+08:00 itemprop=dateModified>2023-10-03</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/Tomcat/ itemprop=url rel=index><span itemprop=name>Tomcat</span></a> </span> </span></div></div></header><div class=post-body itemprop=articleBody><h1 id=Tomcat优化><a class=headerlink href=#Tomcat优化 title=Tomcat优化></a>Tomcat优化</h1><h2 id=1、内存优化><a class=headerlink href=#1、内存优化 title=1、内存优化></a>1、内存优化</h2><p><strong>启动时告诉JVM需要一块大内存（调优内存是最直接的方式）</strong>。<p>修改配置文件catalina.sh（Windows下为catalina.bat，Linux下为catalina.sh）：<figure class="highlight sh"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>JAVA_OPTS=<span class=string>'-Xms512m -Xmx1024m'</span></span><br></pre></table></figure><ul><li><code>-Xms&LTsize></code> ：JVM 初始化堆的大小；<li><code>-Xmx&LTsize></code>：JVM 堆的最大值；</ul><h2 id=2、线程优化><a class=headerlink href=#2、线程优化 title=2、线程优化></a>2、线程优化</h2><h3 id=2-1、连接线程优化><a class=headerlink href=#2-1、连接线程优化 title=2.1、连接线程优化></a>2.1、连接线程优化</h3><p>在 server.xml 中进行如下配置：<figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br></pre><td class=code><pre><span class=line><span class=tag><<span class=name>Connector</span> <span class=attr>port</span>=<span class=string>"80"</span> <span class=attr>protocol</span>=<span class=string>"HTTP/1.1"</span>  </span></span><br><span class=line><span class=tag>    <span class=attr>connectionTimeout</span>=<span class=string>"20000"</span> </span></span><br><span class=line><span class=tag>    <span class=attr>redirectPort</span>=<span class=string>"8443"</span>   </span></span><br><span class=line><span class=tag>    <span class=attr>executor</span>=<span class=string>"tomcatThreadPool"</span>  </span></span><br><span class=line><span class=tag>    <span class=attr>enableLookups</span>=<span class=string>"false"</span>   </span></span><br><span class=line><span class=tag>    <span class=attr>maxIdleTime</span>= <span class=string>"60000"</span></span></span><br><span class=line><span class=tag>    <span class=attr>acceptCount</span>=<span class=string>"100"</span>   </span></span><br><span class=line><span class=tag>    <span class=attr>maxPostSize</span>=<span class=string>"10485760"</span> </span></span><br><span class=line><span class=tag>    <span class=attr>acceptorThreadCount</span>=<span class=string>"2"</span>    </span></span><br><span class=line><span class=tag>    <span class=attr>disableUploadTimeout</span>=<span class=string>"true"</span>   </span></span><br><span class=line><span class=tag>    <span class=attr>URIEncoding</span>=<span class=string>"utf-8"</span></span></span><br><span class=line><span class=tag>    <span class=attr>keepAliveTimeout</span> =<span class=string>"6000"</span>  </span></span><br><span class=line><span class=tag>    <span class=attr>maxKeppAliveRequests</span>=<span class=string>"500"</span> /></span></span><br></pre></table></figure><ul><li><strong>port</strong>：连接端口；<li><strong>protocol</strong>：连接器使用的传输方式；<li><strong>executor</strong>： 连接器使用的线程池名称；<li><strong>enableLookups</strong>：禁用 DNS查询；<li><strong>maxIdleTime</strong>：线程空闲时间，超过该时间后，空闲线程会被销毁；（默认值为6000（1分钟），单位毫秒。）<li><strong>acceptCount</strong>：当没有处理请求的空闲线程时，可以放到队列中的请求数量，超过该阈值的请求将不予处理；（默认设置 100 。）<li><strong>maxPostSize</strong>：限制 FORM URL参数方式的POST请求的内容大小；（单位字节，默认是 2097152(2兆)，10485760 为 10M。如果要禁用限制，则可以设置为 -1。）<li><strong>acceptorThreadCount</strong>： 接收连接的线程数量；（默认值是1，如果是多核 CPU，则一般配置为 2）<li><strong>disableUploadTimeOut</strong>：允许Servlet容器使用一个较长的连接超时值来完成复杂的逻辑；（默认值为false）<li><strong>keepAliveTimeout</strong>：连接持续存活时间；<li><strong>maxKeepAliveRequests</strong>：连接能承受的最大请求数量，超过该阈值的连接将被关闭；（该参数值为1时表示禁用，-1表示不限制个数，默认100个。一般设置在100~200之间。）</ul><h3 id=2-2、业务处理线程优化><a class=headerlink href=#2-2、业务处理线程优化 title=2.2、业务处理线程优化></a>2.2、业务处理线程优化</h3><p>在server.xml中进行如下编辑：<figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre><td class=code><pre><span class=line><span class=tag><<span class=name>Executor</span> <span class=attr>name</span>=<span class=string>"tomcatThreadPool"</span> <span class=attr>namePrefix</span>=<span class=string>"catalina-exec-"</span></span></span><br><span class=line><span class=tag>    <span class=attr>maxThreads</span>=<span class=string>"150"</span> </span></span><br><span class=line><span class=tag>    <span class=attr>minSpareThreads</span>=<span class=string>"100"</span></span></span><br><span class=line><span class=tag>    <span class=attr>prestartminSpareThreads</span>=<span class=string>"true"</span></span></span><br><span class=line><span class=tag>    <span class=attr>maxQueueSize</span>=<span class=string>"100"</span>/></span></span><br></pre></table></figure><ul><li>name：线程名称；<li>namePrefix：线程前缀；<li>maxThreads：最大并发连接数；（默认200，一般设置为500~ 800 ，要根据实际情况来定）<li><strong>minSpareThreads</strong>：Tomcat启动初始化的线程数；（默认值25）<li><strong>prestartminSpareThreads</strong>：tomcat初始化时会初始化参数<code>minSpareThreads</code>值，不设置就不会初始化；<li><strong>maxQueueSize</strong>：最大的等待队列数，超过则拒绝请求；</ul><p>相关参数解析如下：<ol><li>maxThreads：客户请求最大线程数；<li>minSpareThreads：Tomcat初始化时创建的 socket 线程数；<li>maxSpareThreads：Tomcat连接器的最大空闲 socket 线程数；<li>enableLookups：若设为true, 则支持域名解析，可把 ip 地址解析为主机名；<li>redirectPort：在需要基于安全通道的场合，把客户请求转发到基于SSL 的 redirectPort 端口；<li>acceptAccount：监听端口队列最大数，满了之后客户请求会被拒绝（不能小于maxSpareThreads ）；<li>connectionTimeout：连接超时；<li>minProcessors：服务器创建时的最小处理线程数；<li>maxProcessors：服务器同时最大处理线程数；<li>URIEncoding：URL统一编码；</ol><h2 id=3、IO优化><a class=headerlink href=#3、IO优化 title=3、IO优化></a>3、IO优化</h2><p>IO类型主要有如下三种：<ol><li><p><strong>同步阻塞（BIO）</strong>：一个线程一个连接，当然可以通过线程池机制改善；</p> <p>适用场景：<strong>BIO适用于 连接少且固定 的场景</strong>。这种方式对服务器资源要求比较高，并发局限于应用中，JDK1.4以前的唯一选择，但程序直观简单易理解。</p><li><p><em><strong>异步阻塞（NIO）</strong></em>：同一个线程处理多个连接(多路复用)；</p> <p>适用场景：<strong>NIO适用于 连接多且连接短 的场景</strong>。比如聊天服务器，并发局限于应用中，编程比较复杂，JDK1.4开始支持。</p><li><p><strong>异步非阻塞（NIO2，又叫AIO）</strong>：与NIO的区别主要在操作系统底层；</p> <p>适用场景：<strong>AIO适用于 连接多且连接长 的场景</strong>。比如相册服务器，充分调用OS参与并发操作，编程比较复杂，JDK7开始支持。</p></ol><p>如下配置可实现 Tomcat IO 模型的切换：<figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line><span class=tag><<span class=name>Connector</span> <span class=attr>port</span>=<span class=string>"80"</span> <span class=attr>protocol</span>=<span class=string>"org.apache.coyote.http11.Http11NioProtocol"</span> </span></span><br><span class=line><span class=tag>           <span class=attr>connectionTimeout</span>=<span class=string>"20000"</span> </span></span><br><span class=line><span class=tag>           <span class=attr>URIEncoding</span>=<span class=string>"UTF-8"</span> </span></span><br><span class=line><span class=tag>           <span class=attr>useBodyEncodingForURI</span>=<span class=string>"true"</span> </span></span><br><span class=line><span class=tag>           <span class=attr>enableLookups</span>=<span class=string>"false"</span> </span></span><br><span class=line><span class=tag>           <span class=attr>redirectPort</span>=<span class=string>"8443"</span> /></span></span><br></pre></table></figure><p>Connector使用哪种protocol，可以通过<code>&LTconnector></code>元素中的protocol属性进行指定，也可以使用默认值。<p>protocol取值及对应协议如下：<ul><li>HTTP/1.1：<strong>默认值，使用的协议与Tomcat版本有关</strong><li>org.apache.coyote.http11.Http11Protocol：BIO<li>org.apache.coyote.http11.Http11NioProtocol：NIO<li>org.apache.coyote.http11.Http11Nio2Protocol：NIO2<li>org.apache.coyote.http11.Http11AprProtocol：APR</ul><p>如果没有指定protocol，则默认HTTP/1.1，其含义如下：在Tomcat7中，自动选取使用BIO或APR（如果找到APR需要的本地库，则使用APR，否则使用BIO）；在Tomcat8中，自动选取使用NIO或APR（如果找到APR需要的本地库，则使用APR，否则使用NIO）<h2 id=4、缓存压缩优化><a class=headerlink href=#4、缓存压缩优化 title=4、缓存压缩优化></a>4、缓存压缩优化</h2><h3 id=4-1、压缩优化定义><a class=headerlink href=#4-1、压缩优化定义 title=4.1、压缩优化定义></a>4.1、压缩优化定义</h3><p>压缩优化是指：<strong>将返回的 html 页面等内容压缩成 gzip 格式后发送给浏览器，浏览器在本地解压缩的过程</strong>。<h3 id=4-2、开启压缩优化><a class=headerlink href=#4-2、开启压缩优化 title=4.2、开启压缩优化></a>4.2、开启压缩优化</h3><p>可以根据自己的业务场景在 server.xml 中进行如下相关配置：<figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br></pre><td class=code><pre><span class=line><span class=tag><<span class=name>Connector</span> <span class=attr>port</span>=<span class=string>"9027"</span></span></span><br><span class=line><span class=tag>           <span class=attr>protocol</span>=<span class=string>"HTTP/1.1"</span></span></span><br><span class=line><span class=tag>           <span class=attr>maxHttpHeaderSize</span>=<span class=string>"8192"</span></span></span><br><span class=line><span class=tag>           <span class=attr>maxThreads</span>=<span class=string>"1000"</span></span></span><br><span class=line><span class=tag>           <span class=attr>minSpareThreads</span>=<span class=string>"100"</span></span></span><br><span class=line><span class=tag>           <span class=attr>maxSpareThreads</span>=<span class=string>"1000"</span></span></span><br><span class=line><span class=tag>           <span class=attr>minProcessors</span>=<span class=string>"100"</span></span></span><br><span class=line><span class=tag>           <span class=attr>maxProcessors</span>=<span class=string>"1000"</span></span></span><br><span class=line><span class=tag>           <span class=attr>enableLookups</span>=<span class=string>"false"</span></span></span><br><span class=line><span class=tag>           <span class=attr>compression</span>=<span class=string>"on"</span></span></span><br><span class=line><span class=tag>           <span class=attr>compressionMinSize</span>=<span class=string>"2048"</span></span></span><br><span class=line><span class=tag>           <span class=attr>compressableMimeType</span>=<span class=string>"text/html,text/xml,text/javascript,text/css,text/plain"</span></span></span><br><span class=line><span class=tag>           <span class=attr>connectionTimeout</span>=<span class=string>"20000"</span></span></span><br><span class=line><span class=tag>           <span class=attr>URIEncoding</span>=<span class=string>"utf-8"</span></span></span><br><span class=line><span class=tag>           <span class=attr>acceptCount</span>=<span class=string>"1000"</span></span></span><br><span class=line><span class=tag>           <span class=attr>redirectPort</span>=<span class=string>"8443"</span></span></span><br><span class=line><span class=tag>           <span class=attr>disableUploadTimeout</span>=<span class=string>"true"</span>/></span></span><br></pre></table></figure><p>参数解析：<ul><li>**compression=”on”**：打开压缩功能；<li>**compressionMinSize=”2048”**：启用压缩的输出内容大小，默认为2KB；<li>**noCompressionUserAgents=”gozilla,traviata”**：对于以下的浏览器，不启用压缩；<li>**compressableMimeType=”text/html,text/xml,text/javascript,text/css,text/plain”**：哪些资源类型需要压缩；</ul><h3 id=4-3、缓存策略><a class=headerlink href=#4-3、缓存策略 title=4.3、缓存策略></a>4.3、缓存策略</h3><p>开启浏览器缓存，可以快速读取webapps文件夹里的静态内容，提高了整体性能。<ol><li>浏览器第一次请求tomcat服务器某资源。<li>tomcat拿到资源后将该资源最后修改的时间保存在响应头的Last-Modified中 （Last-Modified: Tue, 11 Jul 2000 18:23:51 GMT）。<li>浏览器第二次访问tomcat请求该资源时将该资源的最后修改时间放入If-Modified-Since请求头中。<li>服务器收到请求并比较请求中的If-Modified-Since与资源最后修改时间 Last-Modified 是否一致，如果一致则发送响应代码304，告知其在本地缓存拿就可以了。</ol><h2 id=5、安全优化><a class=headerlink href=#5、安全优化 title=5、安全优化></a>5、安全优化</h2><p>安全优化参考如下：<ol><li><p><strong>降权启动</strong></p><li><p><strong>修改端口号</strong></p><li><p><strong>更改 tomcat 关闭指令</strong></p><li><p><strong>修改管理员用户名、密码</strong></p><li><p><strong>清空站点目录root下的管理页面等</strong></p><li><p><strong>错误页面的优雅展示</strong></p><li><p><strong>隐藏版本号</strong></p><li><p><strong>禁用DNS查询</strong></p> <p>当web应用记录客户端信息时，它也会记录客户端IP地址或通过域名服务器查找机器名然后转为IP地址。DNS查询需要网络开销，且还有远距离获取IP的开销。</p> <p>关闭DNS查询可提高性能，关闭DNS查询的方式是：<strong>将 server.xml 文件中参数 enableLookups 的值设为false即可</strong>。</p><li><p><strong>设置session过期时间</strong><br>Tomcat采用数据库连接池技术，该技术的执行逻辑是：<strong>当用户在设置的 session 超时时间内没有对数据库执行操作时，就会自动关闭该连接，避免浪费宝贵的数据库连接资源</strong>。设置 session 过期时间的方法是 <strong>在 tomcat_home / conf / web.xml文件中找到 session-config 标签的子标签 session-timeout 标签，为该子标签设置超时时间即可，单位是分钟</strong>。</p><li><p>server.xml中进行如下定义：</p></ol><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line><span class=tag><<span class=name>Context</span> <span class=attr>path</span>=<span class=string>"/test"</span> <span class=attr>docBase</span>=<span class=string>"/test"</span> </span></span><br><span class=line><span class=tag>         <span class=attr>isWARExpanded</span>=<span class=string>"true"</span></span></span><br><span class=line><span class=tag>         <span class=attr>isWARValidated</span>=<span class=string>"false"</span> </span></span><br><span class=line><span class=tag>         <span class=attr>isInvokerEnabled</span>=<span class=string>"true"</span></span></span><br><span class=line><span class=tag>         <span class=attr>isWorkDirPersistent</span>=<span class=string>"false"</span> </span></span><br><span class=line><span class=tag>         <span class=attr>defaultSessionTimeOut</span>=<span class=string>"3600"</span> /></span></span><br></pre></table></figure><p>项目所在目录下的web.xml中定义：<figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line><span class=tag><<span class=name>session-config</span>></span></span><br><span class=line>　　<span class=tag><<span class=name>session-timeout</span>></span>20<span class=tag>&LT/<span class=name>session-timeout</span>></span></span><br><span class=line><span class=tag>&LT/<span class=name>session-config</span>></span></span><br></pre></table></figure><p>在程序中定义：<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>session.setMaxInactiveInterval(<span class=number>30</span>*<span class=number>60</span>);   <span class=comment>// 单位：秒，设为-1表示永不过期。</span></span><br></pre></table></figure><h2 id=6、APR（大杀器）><a class=headerlink href=#6、APR（大杀器） title=6、APR（大杀器）></a>6、APR（大杀器）</h2><h2 id=6-1、概述><a class=headerlink href=#6-1、概述 title=6.1、概述></a>6.1、概述</h2><p><strong>APR（Apache Portable Runtime）是Apache的一个库，它提供了跨平台的API，用于支持Apache HTTP Server 及其它Apache项目。</strong>APR通过对操作系统底层功能的封装，提供了一种高效、可移植和可靠的编程接口。<p><strong>Tomcat 中 APR 通常指的是 APR/native 组件，它是一个与操作系统级别的库进行交互的接口</strong>。APR/native 组件可以与Tomcat一起使用，以提高性能和可扩展性。<p>APR/native 组件的主要功能包括：<ul><li><strong>提供高效的网络IO操作</strong>：通过操作系统级别的多路复用技术，可以显著提高网络性能。<li><strong>支持更高级的加密功能</strong>：可以利用操作系统提供的高级加密库，提供更好的加密性和安全性。<li><strong>提供更好的静态资源服务功能</strong>：利用操作系统的高性能文件IO接口，提供高效的静态资源服务能力。</ul><h2 id=6-2、安装使用><a class=headerlink href=#6-2、安装使用 title=6.2、安装使用></a>6.2、安装使用</h2><p>安装使用步骤参考如下：<ol><li><p>从Apache官网下载APR的库。</p><li><p>编译安装APR库</p> <figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line>./configure</span><br><span class=line>make</span><br><span class=line>make install</span><br></pre></table></figure><li><p>编译安装APR/native模块</p> <figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line>./configure --with-apr=/path/to/apr/source</span><br><span class=line>make</span><br><span class=line>make install</span><br></pre></table></figure> <p><code>/path/to/apr/source</code>是APR库源代码的路径。</p><li><p>配置Tomcat使用APR/native模块</p> <p>打开 conf/server.xml 文件，在该文件中找到标签 Connector，在该标签中配置属性 <code>protocol=org.apache.coyote.http11.Http11AprProtocol</code>，修改完后保存server.xml文件。</p><li><p>重启Tomcat服务使其生效</p></ol><h1 id=Tomcat之JVM优化><a class=headerlink href=#Tomcat之JVM优化 title=Tomcat之JVM优化></a>Tomcat之JVM优化</h1><p>在catalina.sh 文件中加入如下配置：<figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>JAVA_OPTS=<span class=string>"-Xms2G -Xmx2G -Xmn512m -XX:MetaspaceSize=512M -XX:MaxMetaspaceSize=512M -XX:+UseConcMarkSweepGC -XX:+CMSClassUnloadingEnabled -XX:CMSInitiatingOccupancyFraction=75 -XX:+UseCMSInitiatingOccupancyOnly -XX:+HeapDumpOnOutOfMemoryError -verbose:gc -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintGCDateStamps -Xloggc:/appl/gc.log"</span></span><br></pre></table></figure><p>参数解析：<ul><li>-Xms2G：初始堆内存；<li>-Xmx2G：最大堆内存；<li>-Xmn512m：年轻代大小；<li>-XX:MetaspaceSize=512M：初始元空间大小，达到该值会触发垃圾回收并进行类型卸载，同时GC会对该值进行动态调整：如果垃圾回收后释放了大量空间就降低该值；如果释放了少量空间，那么就在不超过 MaxMetaspaceSize设定值的前提下适当提高该值。<li>-XX:+UseConcMarkSweepGC：使用 并发标记清除类型的 CMS垃圾回收器；<li>-XX:+CMSClassUnloadingEnabled： 表示 是否启用类卸载；（+表示启用，-表示关闭，默认关闭。该功能只有在使用CM回收器时才有效。）<li>-XX:+HeapDumpOnOutOfMemoryError：表示 发生OOM时会自动生成DUMP文件；<li>-XX:HeapDumpPath=${目录}：表示生成DUMP文件的路径，也可以指定文件名称，例如：<code>-XX:HeapDumpPath=${目录}/java_heapdump.hprof</code>。如果不指定文件名，默认为：<code>java_&LTpid>_&LTdate>_&LTtime>_heapDump.hprof</code>；<li>-verbose:gc：输出GC日志 ， -XX:+PrintGC 与 -verbose:gc 是一样的，可以认为-verbose:gc 是 -XX:+PrintGC的别名；<li>-XX:+PrintGCDetails：打印GC详细信息；<li>-XX:+PrintGCTimeStamps：输出GC时间戳；（以JVM启动到当期的总时长的时间戳形式）<li>-XX:+PrintGCDateStamps：输出GC的时间戳；（以日期的形式，如 2013-05-04T21:53:59.234+0800）<li>-Xloggc:/appl/gc.log：定义gc日志目录；<li>-XX:CMSInitiatingOccupancyFraction=75：内存占用率达到75%时开启CMS GC；<li>-XX:+UseCMSInitiatingOccupancyOnly：设定该选项 表示 CMS始终使用参数<code>&LTfont color='orange'>-XX:CMSInitiatingOccupancyFraction</code>指定的垃圾回收阈值，如果不设定该选项，则表示只有在最开始阶段使用上面参数指定的垃圾回收阈值，后期会根据实际情况动态调整垃圾回收阈值；</ul><h1 id=操作系统优化（Linux）><a class=headerlink href=#操作系统优化（Linux） title=操作系统优化（Linux）></a>操作系统优化（Linux）</h1><h2 id=1、最大打开文件数><a class=headerlink href=#1、最大打开文件数 title=1、最大打开文件数></a>1、最大打开文件数</h2><h3 id=1-1、系统级句柄数量><a class=headerlink href=#1-1、系统级句柄数量 title=1.1、系统级句柄数量></a>1.1、系统级句柄数量</h3><p>（1）查看<figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line><span class=built_in>cat</span> /proc/sys/fs/file-max</span><br></pre></table></figure><p>（2）修改<figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line><span class=built_in>echo</span> 数量 > /proc/sys/fs/file-max</span><br></pre></table></figure><p>（3）永久生效<figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line><span class=comment># 1、修改文件</span></span><br><span class=line>vim /etc/sysctl.conf</span><br><span class=line><span class=comment># 2、在文件末尾添加如下内容</span></span><br><span class=line>fs.file-max = 2000000</span><br><span class=line><span class=comment># 3、执行如下命令，使修改配置立即生效</span></span><br><span class=line>sysctl -p</span><br></pre></table></figure><h3 id=1-2、进程级句柄数量><a class=headerlink href=#1-2、进程级句柄数量 title=1.2、进程级句柄数量></a>1.2、进程级句柄数量</h3><figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br></pre><td class=code><pre><span class=line><span class=comment># 1、打开文件</span></span><br><span class=line>vim /etc/security/limits.conf</span><br><span class=line><span class=comment># 2、在文件最后添加如下内容</span></span><br><span class=line>* soft <span class=built_in>nproc</span> 100001     <span class=comment># 警告设定 所有用户最大打开进程数为10001</span></span><br><span class=line>* hard <span class=built_in>nproc</span> 100001     <span class=comment># 严格设定 所有用户最大打开进程数为100001</span></span><br><span class=line>* soft nofile 100001    <span class=comment># 警告设定 所有用户最大打开文件数为100001</span></span><br><span class=line>* hard nofile 100002    <span class=comment># 严格设定 所有用户最大打开文件数为100002</span></span><br></pre></table></figure><ul><li><strong>soft</strong> 表示警告设定，超过该值会有警告信息；<li><strong>hard</strong> 表示严格设定，不能超过该值；</ul><p><font color=red>注意：修改后，要重启服务器才生效。</font><h2 id=2、TCP参数优化><a class=headerlink href=#2、TCP参数优化 title=2、TCP参数优化></a>2、TCP参数优化</h2><p>以下命令参数的修改全部基于<code>/etc/sysctl.conf</code>文件，修改完后，通过命令<code>sysctl -p</code>使其修改生效。<figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br></pre><td class=code><pre><span class=line><span class=comment>#（4G 内存机器 使用，TCP连接最多约使用1.6GB内存 ， 393216*4096/1024/1024=1.6G）</span></span><br><span class=line><span class=comment>#内核分配给TCP连接的内存，单位是Page，1 Page = 4096 Bytes</span></span><br><span class=line>net.ipv4.tcp_mem = 196608  262144  393216  </span><br><span class=line></span><br><span class=line><span class=comment>#（8G 内存使用，TCP连接最多约使用4GB内存）     </span></span><br><span class=line>net.ipv4.tcp_mem = 524288  699050  1048576      </span><br><span class=line></span><br><span class=line><span class=comment>#为每个TCP连接分配的读、写缓冲区内存大小，单位是Byte</span></span><br><span class=line><span class=comment># 一般按照缺省值分配，上面的例子就是读写均为8KB，共16KB</span></span><br><span class=line><span class=comment>#1.6G 内存服务器， TCP内存能容纳的连接数，约为  1600MB/16KB = 100K = 10万</span></span><br><span class=line><span class=comment>#4.G TCP内存能容纳的连接数，约为  4000MB/16KB = 250K = 25万</span></span><br><span class=line><span class=comment>#                  最小内存  缺省内存  最大内存</span></span><br><span class=line>net.ipv4.tcp_rmem = 4096     8192    4194304</span><br><span class=line>net.ipv4.tcp_wmem = 4096     8192    4194304</span><br><span class=line></span><br><span class=line><span class=comment>#（端口最大的监听队列长度）</span></span><br><span class=line><span class=comment>#同时，修改下全局配置</span></span><br><span class=line><span class=comment># echo 4000 > /proc/sys/net/core/somaxconn 定义了系统中每一个端口最大的监听队列的长度,这是个全局的参数,默认值为128,</span></span><br><span class=line>net.core.somaxconn= 4000</span><br><span class=line></span><br><span class=line><span class=comment>#表示开启SYN Cookies。当出现SYN等待队列溢出时，启用cookies来处理，可防范少量SYN攻击，默认为0，表示关闭；</span></span><br><span class=line>net.ipv4.tcp_syncookies = 1</span><br><span class=line></span><br><span class=line><span class=comment>#表示开启重用。允许将TIME-WAIT sockets重新用于新的TCP连接，默认为0，表示关闭；</span></span><br><span class=line>net.ipv4.tcp_tw_reuse = 1</span><br><span class=line></span><br><span class=line><span class=comment>#表示开启TCP连接中TIME-WAIT sockets的快速回收，默认为0，表示关闭；</span></span><br><span class=line>net.ipv4.tcp_tw_recycle = 1</span><br><span class=line></span><br><span class=line><span class=comment>#修改系統默认的 TIMEOUT 时间。</span></span><br><span class=line>net.ipv4.tcp_fin_timeout = 30</span><br><span class=line></span><br><span class=line><span class=comment>#表示当keepalive起作用时，TCP发送keepalive消息的频度。缺省是2小时，改为20分钟。</span></span><br><span class=line>net.ipv4.tcp_keepalive_time = 1200  </span><br><span class=line></span><br><span class=line><span class=comment>#表示用于向外连接的端口范围。缺省情况下很小：32768到61000，改为10000到65000。</span></span><br><span class=line><span class=comment>#（注意：不要将最低值设太低，否则可能会占用正常端口！）</span></span><br><span class=line>net.ipv4.ip_local_port_range = 10000 65000  </span><br><span class=line></span><br><span class=line><span class=comment>#表示SYN队列长度，默认为1024，加大队列长度为8192，可以容纳更多等待连接的网络连接数。</span></span><br><span class=line>net.ipv4.tcp_max_syn_backlog = 8192</span><br><span class=line></span><br><span class=line><span class=comment>#表示系统同时保持TIME_WAIT的最大数量，如果超过这个数字，TIME_WAIT将立刻被清除并打印警告信息。默认为180000，改为5000。</span></span><br><span class=line>net.ipv4.tcp_max_tw_buckets = 5000</span><br><span class=line></span><br><span class=line><span class=comment>#当orphans达到32768个时，会报Out of socket memory，此时占用内存 32K*64KB=2048MB=2GB</span></span><br><span class=line><span class=comment>#（每个孤儿socket可占用多达64KB内存），实际可能小一些</span></span><br><span class=line>net.ipv4.tcp_max_orphans = 65536</span><br><span class=line></span><br><span class=line><span class=comment>#孤儿socket废弃前重试的次数，重负载web服务器建议调小，设置较小的数值，可以有效降低orphans的数量</span></span><br><span class=line>net.ipv4.tcp_orphan_retries = 1</span><br><span class=line></span><br><span class=line><span class=comment>#活动TCP连接重传次数，超过次数视为掉线，放弃连接。缺省值：15，建议设为 2或者3.</span></span><br><span class=line>net.ipv4.tcp_retries=2</span><br><span class=line></span><br><span class=line><span class=comment>#TCP三次握手的syn/ack阶段，重试次数，缺省5，设为2-3</span></span><br><span class=line>net.ipv4.tcp_synack_retries=2</span><br><span class=line></span><br><span class=line><span class=comment># 网络设备的收发包的队列大小</span></span><br><span class=line>net.core.netdev_max_backlog = 2048</span><br></pre></table></figure></div><footer class=post-footer><div class=post-tags><a href=/tags/Tomcat/ rel=tag># Tomcat</a><a href=/tags/Tomcat%E4%BC%98%E5%8C%96/ rel=tag># Tomcat优化</a></div><div class=post-nav><div class=post-nav-item><a href=/2024/08/21/Tomcat%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/ rel=prev title=Tomcat系列-Tomcat基础> <i class="fa fa-angle-left"></i> Tomcat系列-Tomcat基础 </a></div><div class=post-nav-item><a href=/2024/08/21/Vue%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97-%E5%9F%BA%E7%A1%80%E7%AF%87/ rel=next title=前端系列-Vue使用指南> 前端系列-Vue使用指南 <i class="fa fa-angle-right"></i> </a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>© <span itemprop=copyrightYear>2024</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>豪哥</span></div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label=返回顶部 class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script crossorigin=anonymous integrity=sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY= src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js></script><script src=/js/comments.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/sidebar.js></script><script src=/js/next-boot.js></script><script crossorigin=anonymous integrity=sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc= src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js></script><script src=/js/third-party/search/local-search.js></script>