<!doctypehtml><html lang=zh-CN><meta charset=UTF-8><meta content=width=device-width name=viewport><meta media="(prefers-color-scheme: light)" content=#222 name=theme-color><meta media="(prefers-color-scheme: dark)" content=#222 name=theme-color><meta content="Hexo 7.3.0" name=generator><link href=/images/apple-touch-icon-next.png rel=apple-touch-icon sizes=180x180><link href=/images/favicon-32x32-next.png rel=icon sizes=32x32 type=image/png><link href=/images/favicon-16x16-next.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><link href=/css/main.css rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css integrity=sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA= rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css integrity=sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE= rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"hshz21.gitee.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src=/js/config.js></script><meta content="1、练习题1.1、(175)组合两个表编写一个SQL查询来报告 Person 表中每个人的姓、名、城市和州。如果 personId 的地址不在 Address 表中，则报告为空  null 。 123456789101112131415161718192021222324252627282930Person表:+----------+----------+-----------+| personI" name=description><meta content=article property=og:type><meta content=MySQL系列-MySQL经典SQL练习题之Leetcode篇（一） property=og:title><meta content=https://hshz21.gitee.io/2024/08/21/MySQL%E7%BB%8F%E5%85%B8SQL%E7%BB%83%E4%B9%A0%E9%A2%98%E4%B9%8BLeetcode%E7%AF%87%EF%BC%88%E4%B8%80%EF%BC%89/index.html property=og:url><meta content=豪哥博客 property=og:site_name><meta content="1、练习题1.1、(175)组合两个表编写一个SQL查询来报告 Person 表中每个人的姓、名、城市和州。如果 personId 的地址不在 Address 表中，则报告为空  null 。 123456789101112131415161718192021222324252627282930Person表:+----------+----------+-----------+| personI" property=og:description><meta content=zh_CN property=og:locale><meta content=2024-08-21T13:39:14.134Z property=article:published_time><meta content=2023-09-01T08:41:34.332Z property=article:modified_time><meta content=豪哥 property=article:author><meta content=SQL练习 property=article:tag><meta content=MySQL练习 property=article:tag><meta content=LeetcodeSQL property=article:tag><meta content=summary name=twitter:card><link href=https://hshz21.gitee.io/2024/08/21/MySQL%E7%BB%8F%E5%85%B8SQL%E7%BB%83%E4%B9%A0%E9%A2%98%E4%B9%8BLeetcode%E7%AF%87%EF%BC%88%E4%B8%80%EF%BC%89/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://hshz21.gitee.io/2024/08/21/MySQL%E7%BB%8F%E5%85%B8SQL%E7%BB%83%E4%B9%A0%E9%A2%98%E4%B9%8BLeetcode%E7%AF%87%EF%BC%88%E4%B8%80%EF%BC%89/","path":"2024/08/21/MySQL经典SQL练习题之Leetcode篇（一）/","title":"MySQL系列-MySQL经典SQL练习题之Leetcode篇（一）"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>MySQL系列-MySQL经典SQL练习题之Leetcode篇（一） | 豪哥博客</title><noscript><link href=/css/noscript.css rel=stylesheet></noscript><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label=切换导航栏 class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <p class=site-title>豪哥博客</p> <i class=logo-line></i> </a><p class=site-subtitle itemprop=description>豪哥博客</div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=搜索 role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>分类</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>搜索 </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=搜索... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-1"><a class=nav-link href=#1%E3%80%81%E7%BB%83%E4%B9%A0%E9%A2%98><span class=nav-number>1.</span> <span class=nav-text>1、练习题</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#1-1%E3%80%81-175-%E7%BB%84%E5%90%88%E4%B8%A4%E4%B8%AA%E8%A1%A8><span class=nav-number>1.1.</span> <span class=nav-text>1.1、(175)组合两个表</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-2%E3%80%81-176-%E7%AC%AC%E4%BA%8C%E9%AB%98%E7%9A%84%E8%96%AA%E6%B0%B4><span class=nav-number>1.2.</span> <span class=nav-text>1.2、(176)第二高的薪水</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-3%E3%80%81-177-%E7%AC%ACN%E9%AB%98%E7%9A%84%E8%96%AA%E6%B0%B4><span class=nav-number>1.3.</span> <span class=nav-text>1.3、(177)第N高的薪水</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-4%E3%80%81-178-%E5%88%86%E6%95%B0%E6%8E%92%E5%90%8D><span class=nav-number>1.4.</span> <span class=nav-text>1.4、(178)分数排名</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-5%E3%80%81-180-%E8%BF%9E%E7%BB%AD%E5%87%BA%E7%8E%B0%E7%9A%84%E6%95%B0%E5%AD%97><span class=nav-number>1.5.</span> <span class=nav-text>1.5、(180)连续出现的数字</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-6%E3%80%81-181-%E8%B6%85%E8%BF%87%E7%BB%8F%E7%90%86%E6%94%B6%E5%85%A5%E7%9A%84%E5%91%98%E5%B7%A5><span class=nav-number>1.6.</span> <span class=nav-text>1.6、(181)超过经理收入的员工</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-7%E3%80%81-182-%E6%9F%A5%E6%89%BE%E9%87%8D%E5%A4%8D%E7%9A%84%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1><span class=nav-number>1.7.</span> <span class=nav-text>1.7、(182)查找重复的电子邮箱</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-8%E3%80%81-183-%E4%BB%8E%E4%B8%8D%E8%AE%A2%E8%B4%AD%E7%9A%84%E5%AE%A2%E6%88%B7><span class=nav-number>1.8.</span> <span class=nav-text>1.8、(183)从不订购的客户</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-9%E3%80%81-184-%E9%83%A8%E9%97%A8%E5%B7%A5%E8%B5%84%E6%9C%80%E9%AB%98%E7%9A%84%E5%91%98%E5%B7%A5><span class=nav-number>1.9.</span> <span class=nav-text>1.9、(184)部门工资最高的员工</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-10%E3%80%81-185-%E9%83%A8%E9%97%A8%E5%B7%A5%E8%B5%84%E5%89%8D%E4%B8%89%E9%AB%98%E7%9A%84%E6%89%80%E6%9C%89%E5%91%98%E5%B7%A5><span class=nav-number>1.10.</span> <span class=nav-text>1.10、(185)部门工资前三高的所有员工</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-11%E3%80%81-196-%E5%88%A0%E9%99%A4%E9%87%8D%E5%A4%8D%E7%9A%84%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1><span class=nav-number>1.11.</span> <span class=nav-text>1.11、(196)删除重复的电子邮箱</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-12%E3%80%81-197-%E4%B8%8A%E5%8D%87%E7%9A%84%E6%B8%A9%E5%BA%A6><span class=nav-number>1.12.</span> <span class=nav-text>1.12、(197)上升的温度</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-13%E3%80%81-262-%E8%A1%8C%E7%A8%8B%E5%92%8C%E7%94%A8%E6%88%B7><span class=nav-number>1.13.</span> <span class=nav-text>1.13、(262)行程和用户</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-14%E3%80%81-511-%E6%B8%B8%E6%88%8F%E7%8E%A9%E6%B3%95%E5%88%86%E6%9E%901><span class=nav-number>1.14.</span> <span class=nav-text>1.14、(511)游戏玩法分析1</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-15%E3%80%81-550-%E6%B8%B8%E6%88%8F%E7%8E%A9%E6%B3%95%E5%88%86%E6%9E%904><span class=nav-number>1.15.</span> <span class=nav-text>1.15、(550)游戏玩法分析4</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-16%E3%80%81-570-%E8%87%B3%E5%B0%91%E6%9C%895%E5%90%8D%E7%9B%B4%E6%8E%A5%E4%B8%8B%E5%B1%9E%E7%9A%84%E7%BB%8F%E7%90%86><span class=nav-number>1.16.</span> <span class=nav-text>1.16、(570)至少有5名直接下属的经理</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-17%E3%80%81-577-%E5%91%98%E5%B7%A5%E5%A5%96%E9%87%91><span class=nav-number>1.17.</span> <span class=nav-text>1.17、(577)员工奖金</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-18%E3%80%81-584-%E5%AF%BB%E6%89%BE%E7%94%A8%E6%88%B7%E6%8E%A8%E8%8D%90%E4%BA%BA><span class=nav-number>1.18.</span> <span class=nav-text>1.18、(584)寻找用户推荐人</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-19%E3%80%81-585-2016%E5%B9%B4%E7%9A%84%E6%8A%95%E8%B5%84><span class=nav-number>1.19.</span> <span class=nav-text>1.19、(585)2016年的投资</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-20%E3%80%81-586-%E8%AE%A2%E5%8D%95%E6%9C%80%E5%A4%9A%E7%9A%84%E5%AE%A2%E6%88%B7><span class=nav-number>1.20.</span> <span class=nav-text>1.20、(586)订单最多的客户</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-21%E3%80%81-595-%E5%A4%A7%E7%9A%84%E5%9B%BD%E5%AE%B6><span class=nav-number>1.21.</span> <span class=nav-text>1.21、(595)大的国家</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-22%E3%80%81-596-%E8%B6%85%E8%BF%875%E5%90%8D%E5%AD%A6%E7%94%9F%E7%9A%84%E8%AF%BE><span class=nav-number>1.22.</span> <span class=nav-text>1.22、(596)超过5名学生的课</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-23%E3%80%81-601-%E4%BD%93%E8%82%B2%E9%A6%86%E7%9A%84%E4%BA%BA%E6%B5%81%E9%87%8F><span class=nav-number>1.23.</span> <span class=nav-text>1.23、(601)体育馆的人流量</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-24%E3%80%81-602-%E5%A5%BD%E5%8F%8B%E7%94%B3%E8%AF%B72%EF%BC%9A%E8%B0%81%E6%9C%89%E6%9C%80%E5%A4%9A%E7%9A%84%E5%A5%BD%E5%8F%8B><span class=nav-number>1.24.</span> <span class=nav-text>1.24、(602)好友申请2：谁有最多的好友</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#1-25%E3%80%81-607-%E9%94%80%E5%94%AE%E5%91%98><span class=nav-number>1.25.</span> <span class=nav-text>1.25、(607)销售员</span></a></ol></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><img alt=豪哥 class=site-author-image itemprop=image src=/static/imgs/avatar.png><p class=site-author-name itemprop=name>豪哥<div class=site-description itemprop=description>豪哥博客</div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>116</span> <span class=site-state-item-name>日志</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>36</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/> <span class=site-state-item-count>129</span> <span class=site-state-item-name>标签</span></a></div></nav></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article lang=zh-CN><link href=https://hshz21.gitee.io/2024/08/21/MySQL%E7%BB%8F%E5%85%B8SQL%E7%BB%83%E4%B9%A0%E9%A2%98%E4%B9%8BLeetcode%E7%AF%87%EF%BC%88%E4%B8%80%EF%BC%89/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/static/imgs/avatar.png itemprop=image> <meta content=豪哥 itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=豪哥博客 itemprop=name> <meta content=豪哥博客 itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="MySQL系列-MySQL经典SQL练习题之Leetcode篇（一） | 豪哥博客" itemprop=name> <meta itemprop=description> </span><header class=post-header><h1 itemprop="name headline" class=post-title>MySQL系列-MySQL经典SQL练习题之Leetcode篇（一）</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2024-08-21 21:39:14" datetime=2024-08-21T21:39:14+08:00>2024-08-21</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-09-01 16:41:34" datetime=2023-09-01T16:41:34+08:00 itemprop=dateModified>2023-09-01</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/MySQL/ itemprop=url rel=index><span itemprop=name>MySQL</span></a> </span> </span></div></div></header><div class=post-body itemprop=articleBody><h1 id=1、练习题><a class=headerlink href=#1、练习题 title=1、练习题></a>1、练习题</h1><h2 id=1-1、-175-组合两个表><a class=headerlink href=#1-1、-175-组合两个表 title=1.1、(175)组合两个表></a>1.1、(175)组合两个表</h2><p>编写一个SQL查询来报告 <code>Person</code> 表中每个人的姓、名、城市和州。如果 <code>personId</code> 的地址不在 <code>Address</code> 表中，则报告为空 <code>null</code> 。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br></pre><td class=code><pre><span class=line>Person表:</span><br><span class=line><span class=operator>+</span><span class=comment>----------+----------+-----------+</span></span><br><span class=line><span class=operator>|</span> personId <span class=operator>|</span> lastName <span class=operator>|</span> firstName <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----------+----------+-----------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>        <span class=operator>|</span> Wang     <span class=operator>|</span> Allen     <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>        <span class=operator>|</span> Alice    <span class=operator>|</span> Bob       <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----------+----------+-----------+</span></span><br><span class=line>Address表:</span><br><span class=line><span class=operator>+</span><span class=comment>-----------+----------+---------------+------------+</span></span><br><span class=line><span class=operator>|</span> addressId <span class=operator>|</span> personId <span class=operator>|</span> city          <span class=operator>|</span> state      <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-----------+----------+---------------+------------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>         <span class=operator>|</span> <span class=number>2</span>        <span class=operator>|</span> <span class=keyword>New</span> York City <span class=operator>|</span> <span class=keyword>New</span> York   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>         <span class=operator>|</span> <span class=number>3</span>        <span class=operator>|</span> Leetcode      <span class=operator>|</span> California <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-----------+----------+---------------+------------+</span></span><br><span class=line>输出: </span><br><span class=line><span class=operator>+</span><span class=comment>-----------+----------+---------------+----------+</span></span><br><span class=line><span class=operator>|</span> firstName <span class=operator>|</span> lastName <span class=operator>|</span> city          <span class=operator>|</span> state    <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-----------+----------+---------------+----------+</span></span><br><span class=line><span class=operator>|</span> Allen     <span class=operator>|</span> Wang     <span class=operator>|</span> <span class=keyword>Null</span>          <span class=operator>|</span> <span class=keyword>Null</span>     <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> Bob       <span class=operator>|</span> Alice    <span class=operator>|</span> <span class=keyword>New</span> York City <span class=operator>|</span> <span class=keyword>New</span> York <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-----------+----------+---------------+----------+</span></span><br><span class=line></span><br><span class=line>#解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	p.firstName,</span><br><span class=line>	p.lastName,</span><br><span class=line>	a.city,</span><br><span class=line>	a.state</span><br><span class=line><span class=keyword>from</span> Person <span class=keyword>as</span> p</span><br><span class=line><span class=keyword>left</span> <span class=keyword>join</span> Address <span class=keyword>as</span> a <span class=keyword>on</span> p.personId <span class=operator>=</span> a.personId</span><br></pre></table></figure><h2 id=1-2、-176-第二高的薪水><a class=headerlink href=#1-2、-176-第二高的薪水 title=1.2、(176)第二高的薪水></a>1.2、(176)第二高的薪水</h2><p>查询并返回 <code>Employee</code> 表中第二高的薪水 。如果不存在第二高的薪水，查询应该返回 <code>null(Pandas 则返回 None)</code> 。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br></pre><td class=code><pre><span class=line>Employee 表：</span><br><span class=line><span class=operator>+</span><span class=comment>----+--------+</span></span><br><span class=line><span class=operator>|</span> id <span class=operator>|</span> salary <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+--------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>  <span class=operator>|</span> <span class=number>100</span>    <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>  <span class=operator>|</span> <span class=number>200</span>    <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>  <span class=operator>|</span> <span class=number>300</span>    <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+--------+</span></span><br><span class=line>输出：</span><br><span class=line><span class=operator>+</span><span class=comment>---------------------+</span></span><br><span class=line><span class=operator>|</span> SecondHighestSalary <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>---------------------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>200</span>                 <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>---------------------+</span></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	IF(<span class=built_in>count</span>(<span class=operator>*</span>) <span class=operator>=</span> <span class=number>0</span>, <span class=keyword>null</span>, </span><br><span class=line>	IF(o1.s_level <span class=operator>=</span> <span class=number>2</span>, o1.salary, <span class=keyword>null</span>)) <span class=keyword>as</span> "SecondHighestSalary"</span><br><span class=line><span class=keyword>from</span> (</span><br><span class=line>	<span class=keyword>select</span></span><br><span class=line>		e.<span class=operator>*</span>,</span><br><span class=line>		<span class=built_in>DENSE_RANK</span>() <span class=keyword>over</span> (<span class=keyword>order</span> <span class=keyword>by</span> e.salary <span class=keyword>desc</span>) <span class=keyword>as</span> "s_level"</span><br><span class=line>	<span class=keyword>from</span> Employee <span class=keyword>as</span> e</span><br><span class=line>) <span class=keyword>as</span> o1</span><br><span class=line><span class=keyword>where</span> o1.s_level <span class=operator>=</span> <span class=number>2</span></span><br><span class=line></span><br><span class=line># 解法<span class=number>2</span>：</span><br><span class=line><span class=keyword>SELECT</span> (</span><br><span class=line>   <span class=keyword>SELECT</span> <span class=keyword>DISTINCT</span> salary</span><br><span class=line>   <span class=keyword>FROM</span> Employee e</span><br><span class=line>   <span class=keyword>ORDER</span> <span class=keyword>BY</span> e.salary <span class=keyword>DESC</span></span><br><span class=line>   LIMIT <span class=number>1</span> <span class=keyword>OFFSET</span> <span class=number>1</span></span><br><span class=line>) <span class=keyword>AS</span> SecondHighestSalary;</span><br><span class=line></span><br><span class=line># 解法<span class=number>3</span>：</span><br><span class=line><span class=keyword>SELECT</span> IFNULL(( </span><br><span class=line>     <span class=keyword>SELECT</span> <span class=keyword>DISTINCT</span> salary <span class=keyword>FROM</span> Employee e </span><br><span class=line>     <span class=keyword>ORDER</span> <span class=keyword>BY</span> e.Salary <span class=keyword>DESC</span></span><br><span class=line>     LIMIT <span class=number>1</span> <span class=keyword>OFFSET</span> <span class=number>1</span></span><br><span class=line>   ), <span class=keyword>NULL</span>) <span class=keyword>AS</span> SecondHighestSalary;</span><br></pre></table></figure><h2 id=1-3、-177-第N高的薪水><a class=headerlink href=#1-3、-177-第N高的薪水 title=1.3、(177)第N高的薪水></a>1.3、(177)第N高的薪水</h2><p>查询 <code>Employee</code> 表中第 <code>n</code> 高的工资。如果没有第 <code>n</code> 个最高工资，结果应该为 <code>null</code> 。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br></pre><td class=code><pre><span class=line>Employee <span class=keyword>table</span>:</span><br><span class=line><span class=operator>+</span><span class=comment>----+--------+</span></span><br><span class=line><span class=operator>|</span> id <span class=operator>|</span> salary <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+--------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>  <span class=operator>|</span> <span class=number>100</span>    <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>  <span class=operator>|</span> <span class=number>200</span>    <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>  <span class=operator>|</span> <span class=number>300</span>    <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+--------+</span></span><br><span class=line>输出: </span><br><span class=line><span class=operator>+</span><span class=comment>------------------------+</span></span><br><span class=line><span class=operator>|</span> getNthHighestSalary(<span class=number>2</span>) <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>------------------------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>200</span>                    <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>------------------------+</span></span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span> IFNULL(</span><br><span class=line>    <span class=keyword>select</span> e.salary</span><br><span class=line>    <span class=keyword>from</span> Employee <span class=keyword>as</span> e</span><br><span class=line>    <span class=keyword>order</span> <span class=keyword>by</span> e.salary <span class=keyword>desc</span></span><br><span class=line>    limit (N<span class=number>-1</span>) <span class=keyword>OFFSET</span> <span class=number>1</span></span><br><span class=line>    , <span class=keyword>null</span>) <span class=keyword>as</span> getNthHighestSalary(N)</span><br></pre></table></figure><h2 id=1-4、-178-分数排名><a class=headerlink href=#1-4、-178-分数排名 title=1.4、(178)分数排名></a>1.4、(178)分数排名</h2><p>查询并对分数进行排序。排名按以下规则计算:<ul><li>分数应按从高到低排列。<li>如果两个分数相等，那么两个分数的排名应该相同。<li>在排名相同的分数后，排名数应该是下一个连续的整数。换句话说，排名之间不应该有空缺的数字。</ul><p>按 <code>score</code> 降序返回结果表。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br></pre><td class=code><pre><span class=line>Scores 表:</span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+</span></span><br><span class=line><span class=operator>|</span> id <span class=operator>|</span> score <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>  <span class=operator>|</span> <span class=number>3.50</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>  <span class=operator>|</span> <span class=number>3.65</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>  <span class=operator>|</span> <span class=number>4.00</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>4</span>  <span class=operator>|</span> <span class=number>3.85</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>5</span>  <span class=operator>|</span> <span class=number>4.00</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>6</span>  <span class=operator>|</span> <span class=number>3.65</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+</span></span><br><span class=line>输出: </span><br><span class=line><span class=operator>+</span><span class=comment>-------+------+</span></span><br><span class=line><span class=operator>|</span> score <span class=operator>|</span> rank <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-------+------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>4.00</span>  <span class=operator>|</span> <span class=number>1</span>    <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>4.00</span>  <span class=operator>|</span> <span class=number>1</span>    <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3.85</span>  <span class=operator>|</span> <span class=number>2</span>    <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3.65</span>  <span class=operator>|</span> <span class=number>3</span>    <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3.65</span>  <span class=operator>|</span> <span class=number>3</span>    <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3.50</span>  <span class=operator>|</span> <span class=number>4</span>    <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-------+------+</span></span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	s.score,</span><br><span class=line>	<span class=built_in>DENSE_RANK</span>() <span class=keyword>over</span> (<span class=keyword>order</span> <span class=keyword>by</span> s.score <span class=keyword>desc</span>) <span class=keyword>as</span> "rank"</span><br><span class=line><span class=keyword>from</span> Scores <span class=keyword>as</span> s</span><br></pre></table></figure><h2 id=1-5、-180-连续出现的数字><a class=headerlink href=#1-5、-180-连续出现的数字 title=1.5、(180)连续出现的数字></a>1.5、(180)连续出现的数字</h2><p>编写一个 SQL 查询，查找所有至少连续出现三次的数字。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br></pre><td class=code><pre><span class=line>Logs 表：</span><br><span class=line><span class=operator>+</span><span class=comment>----+-----+</span></span><br><span class=line><span class=operator>|</span> Id <span class=operator>|</span> Num <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-----+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>  <span class=operator>|</span> <span class=number>1</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>  <span class=operator>|</span> <span class=number>1</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>  <span class=operator>|</span> <span class=number>1</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>4</span>  <span class=operator>|</span> <span class=number>2</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>5</span>  <span class=operator>|</span> <span class=number>1</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>6</span>  <span class=operator>|</span> <span class=number>2</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>7</span>  <span class=operator>|</span> <span class=number>2</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-----+</span></span><br><span class=line>输出：</span><br><span class=line><span class=operator>+</span><span class=comment>-----------------+</span></span><br><span class=line><span class=operator>|</span> ConsecutiveNums <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-----------------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>               <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-----------------+</span></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>set</span> <span class=variable>@p</span>:<span class=operator>=</span><span class=number>0</span>;</span><br><span class=line><span class=keyword>set</span> <span class=variable>@q</span>:<span class=operator>=</span><span class=number>0</span>;</span><br><span class=line><span class=keyword>set</span> <span class=variable>@i</span>:<span class=operator>=</span><span class=number>0</span>;</span><br><span class=line><span class=keyword>select</span> o1.Num <span class=keyword>as</span> "ConsecutiveNums"</span><br><span class=line><span class=keyword>from</span> (</span><br><span class=line>	<span class=keyword>select</span></span><br><span class=line>		l.Num,</span><br><span class=line>		<span class=variable>@p</span>:<span class=operator>=</span>l.Num,</span><br><span class=line>		IF(<span class=variable>@p</span><span class=operator>=</span><span class=variable>@q</span>, <span class=variable>@i</span>, <span class=variable>@i</span>:<span class=operator>=</span><span class=variable>@i</span><span class=operator>+</span><span class=number>1</span>) <span class=keyword>as</span> "level",</span><br><span class=line>		<span class=variable>@q</span>:<span class=operator>=</span><span class=variable>@p</span></span><br><span class=line>	<span class=keyword>from</span> Logs <span class=keyword>as</span> l</span><br><span class=line>) <span class=keyword>as</span> o1</span><br><span class=line><span class=keyword>group</span> <span class=keyword>by</span> o1.level</span><br><span class=line><span class=keyword>having</span> <span class=built_in>COUNT</span>(o1.Id) <span class=operator>>=</span> <span class=number>3</span></span><br><span class=line></span><br><span class=line># 解法<span class=number>2</span>：</span><br><span class=line><span class=keyword>select</span> <span class=keyword>DISTINCT</span></span><br><span class=line>	l1.Num <span class=keyword>as</span> "ConsecutiveNums"</span><br><span class=line><span class=keyword>from</span> Logs l1 </span><br><span class=line><span class=keyword>join</span> Logs l2 <span class=keyword>on</span> l1.Id <span class=operator>=</span> l2.Id <span class=operator>-</span> <span class=number>1</span> <span class=keyword>and</span> l1.Num <span class=operator>=</span> l2.Num</span><br><span class=line><span class=keyword>join</span> Logs l3 <span class=keyword>on</span> l2.Id <span class=operator>=</span> l3.Id <span class=operator>-</span> <span class=number>1</span> <span class=keyword>and</span> l2.num <span class=operator>=</span> l3.num</span><br></pre></table></figure><h2 id=1-6、-181-超过经理收入的员工><a class=headerlink href=#1-6、-181-超过经理收入的员工 title=1.6、(181)超过经理收入的员工></a>1.6、(181)超过经理收入的员工</h2><p>编写一个SQL查询来查找收入比经理高的员工。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br></pre><td class=code><pre><span class=line>Employee 表:</span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+--------+-----------+</span></span><br><span class=line><span class=operator>|</span> id <span class=operator>|</span> name  <span class=operator>|</span> salary <span class=operator>|</span> managerId <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+--------+-----------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>  <span class=operator>|</span> Joe   <span class=operator>|</span> <span class=number>70000</span>  <span class=operator>|</span> <span class=number>3</span>         <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>  <span class=operator>|</span> Henry <span class=operator>|</span> <span class=number>80000</span>  <span class=operator>|</span> <span class=number>4</span>         <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>  <span class=operator>|</span> Sam   <span class=operator>|</span> <span class=number>60000</span>  <span class=operator>|</span> <span class=keyword>Null</span>      <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>4</span>  <span class=operator>|</span> Max   <span class=operator>|</span> <span class=number>90000</span>  <span class=operator>|</span> <span class=keyword>Null</span>      <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+--------+-----------+</span></span><br><span class=line>输出: </span><br><span class=line><span class=operator>+</span><span class=comment>----------+</span></span><br><span class=line><span class=operator>|</span> Employee <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----------+</span></span><br><span class=line><span class=operator>|</span> Joe      <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----------+</span></span><br><span class=line># 解释: Joe 是唯一挣得比经理多的雇员。</span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span> o1.name <span class=keyword>as</span> "Employee"</span><br><span class=line><span class=keyword>from</span> (</span><br><span class=line>	<span class=keyword>select</span></span><br><span class=line>		e.<span class=operator>*</span>,</span><br><span class=line>		e2.salary <span class=keyword>as</span> "m_s"</span><br><span class=line>	<span class=keyword>from</span> Employee <span class=keyword>as</span> e</span><br><span class=line>	<span class=keyword>left</span> <span class=keyword>join</span> Employee <span class=keyword>as</span> e2 <span class=keyword>on</span> e.managerId <span class=operator>=</span> e2.id</span><br><span class=line>) <span class=keyword>as</span> o1</span><br><span class=line><span class=keyword>where</span> o1.salary <span class=operator>></span> o1.m_s</span><br><span class=line></span><br><span class=line># 解法<span class=number>2</span>：</span><br><span class=line><span class=keyword>SELECT</span> </span><br><span class=line>   e.name <span class=keyword>as</span> Employee</span><br><span class=line><span class=keyword>FROM</span> Employee e</span><br><span class=line><span class=keyword>join</span> Employee e2 <span class=keyword>on</span> e.`ManagerId` <span class=operator>=</span> e2.id </span><br><span class=line>	<span class=keyword>AND</span> e.`salary` <span class=operator>></span> e2.`salary`</span><br></pre></table></figure><h2 id=1-7、-182-查找重复的电子邮箱><a class=headerlink href=#1-7、-182-查找重复的电子邮箱 title=1.7、(182)查找重复的电子邮箱></a>1.7、(182)查找重复的电子邮箱</h2><p>编写一个 SQL 查询来报告所有重复的电子邮件。 请注意，可以保证电子邮件字段不为 NULL。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br></pre><td class=code><pre><span class=line>Person 表:</span><br><span class=line><span class=operator>+</span><span class=comment>----+---------+</span></span><br><span class=line><span class=operator>|</span> id <span class=operator>|</span> email   <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+---------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>  <span class=operator>|</span> a<span class=variable>@b</span>.com <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>  <span class=operator>|</span> c<span class=variable>@d</span>.com <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>  <span class=operator>|</span> a<span class=variable>@b</span>.com <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+---------+</span></span><br><span class=line>输出: </span><br><span class=line><span class=operator>+</span><span class=comment>---------+</span></span><br><span class=line><span class=operator>|</span> Email   <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>---------+</span></span><br><span class=line><span class=operator>|</span> a<span class=variable>@b</span>.com <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>---------+</span></span><br><span class=line># 解释: a<span class=variable>@b</span>.com 出现了两次。</span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>:</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	p.email <span class=keyword>as</span> "Email"</span><br><span class=line><span class=keyword>from</span> Person <span class=keyword>as</span> p</span><br><span class=line><span class=keyword>group</span> <span class=keyword>by</span> p.email</span><br><span class=line><span class=keyword>having</span> <span class=built_in>count</span>(p.id) <span class=operator>></span> <span class=number>1</span></span><br></pre></table></figure><h2 id=1-8、-183-从不订购的客户><a class=headerlink href=#1-8、-183-从不订购的客户 title=1.8、(183)从不订购的客户></a>1.8、(183)从不订购的客户</h2><p>找出所有从不点任何东西的顾客。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br></pre><td class=code><pre><span class=line>Customers <span class=keyword>table</span>:</span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+</span></span><br><span class=line><span class=operator>|</span> id <span class=operator>|</span> name  <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>  <span class=operator>|</span> Joe   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>  <span class=operator>|</span> Henry <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>  <span class=operator>|</span> Sam   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>4</span>  <span class=operator>|</span> Max   <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+</span></span><br><span class=line>Orders <span class=keyword>table</span>:</span><br><span class=line><span class=operator>+</span><span class=comment>----+------------+</span></span><br><span class=line><span class=operator>|</span> id <span class=operator>|</span> customerId <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+------------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>  <span class=operator>|</span> <span class=number>3</span>          <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>  <span class=operator>|</span> <span class=number>1</span>          <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+------------+</span></span><br><span class=line>输出：</span><br><span class=line><span class=operator>+</span><span class=comment>-----------+</span></span><br><span class=line><span class=operator>|</span> Customers <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-----------+</span></span><br><span class=line><span class=operator>|</span> Henry     <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> Max       <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-----------+</span></span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span> c.name <span class=keyword>as</span> "Customers"</span><br><span class=line><span class=keyword>from</span> Customers <span class=keyword>as</span> c</span><br><span class=line><span class=keyword>where</span> c.id <span class=keyword>not</span> <span class=keyword>in</span> (</span><br><span class=line>	<span class=keyword>select</span> customerId <span class=keyword>from</span> Orders</span><br><span class=line>)</span><br></pre></table></figure><h2 id=1-9、-184-部门工资最高的员工><a class=headerlink href=#1-9、-184-部门工资最高的员工 title=1.9、(184)部门工资最高的员工></a>1.9、(184)部门工资最高的员工</h2><p>查找出每个部门中薪资最高的员工。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br></pre><td class=code><pre><span class=line>Employee 表:</span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+--------+--------------+</span></span><br><span class=line><span class=operator>|</span> id <span class=operator>|</span> name  <span class=operator>|</span> salary <span class=operator>|</span> departmentId <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+--------+--------------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>  <span class=operator>|</span> Joe   <span class=operator>|</span> <span class=number>70000</span>  <span class=operator>|</span> <span class=number>1</span>            <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>  <span class=operator>|</span> Jim   <span class=operator>|</span> <span class=number>90000</span>  <span class=operator>|</span> <span class=number>1</span>            <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>  <span class=operator>|</span> Henry <span class=operator>|</span> <span class=number>80000</span>  <span class=operator>|</span> <span class=number>2</span>            <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>4</span>  <span class=operator>|</span> Sam   <span class=operator>|</span> <span class=number>60000</span>  <span class=operator>|</span> <span class=number>2</span>            <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>5</span>  <span class=operator>|</span> Max   <span class=operator>|</span> <span class=number>90000</span>  <span class=operator>|</span> <span class=number>1</span>            <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+--------+--------------+</span></span><br><span class=line>Department 表:</span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+</span></span><br><span class=line><span class=operator>|</span> id <span class=operator>|</span> name  <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>  <span class=operator>|</span> IT    <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>  <span class=operator>|</span> Sales <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+</span></span><br><span class=line>输出：</span><br><span class=line><span class=operator>+</span><span class=comment>------------+----------+--------+</span></span><br><span class=line><span class=operator>|</span> Department <span class=operator>|</span> Employee <span class=operator>|</span> Salary <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>------------+----------+--------+</span></span><br><span class=line><span class=operator>|</span> IT         <span class=operator>|</span> Jim      <span class=operator>|</span> <span class=number>90000</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> Sales      <span class=operator>|</span> Henry    <span class=operator>|</span> <span class=number>80000</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> IT         <span class=operator>|</span> Max      <span class=operator>|</span> <span class=number>90000</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>------------+----------+--------+</span></span><br><span class=line># 解释：Max 和 Jim 在 IT 部门的工资都是最高的，Henry 在销售部的工资最高。</span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>set</span> <span class=variable>@p1</span>:<span class=operator>=</span><span class=number>0</span>;</span><br><span class=line><span class=keyword>set</span> <span class=variable>@p2</span>:<span class=operator>=</span><span class=number>0</span>;</span><br><span class=line><span class=keyword>set</span> <span class=variable>@q1</span>:<span class=operator>=</span><span class=number>0</span>;</span><br><span class=line><span class=keyword>set</span> <span class=variable>@q2</span>:<span class=operator>=</span><span class=number>0</span>;</span><br><span class=line><span class=keyword>set</span> <span class=variable>@i</span>:<span class=operator>=</span><span class=number>0</span>;</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	d.name <span class=keyword>as</span> "Department ",</span><br><span class=line>	o3.name <span class=keyword>as</span> "Employee ",</span><br><span class=line>	o3.salary <span class=keyword>as</span> "Salary "</span><br><span class=line><span class=keyword>from</span> s3_dept <span class=keyword>as</span> d</span><br><span class=line><span class=keyword>join</span> (</span><br><span class=line>	<span class=keyword>select</span></span><br><span class=line>		o2.id,</span><br><span class=line>		o2.name,</span><br><span class=line>		o2.salary,</span><br><span class=line>		o2.departmentId</span><br><span class=line>	<span class=keyword>from</span> (</span><br><span class=line>		<span class=keyword>select</span></span><br><span class=line>			o1.id,</span><br><span class=line>			o1.name,</span><br><span class=line>			o1.salary,</span><br><span class=line>			o1.departmentId,</span><br><span class=line>			<span class=variable>@p1</span>:<span class=operator>=</span>o1.departmentId,</span><br><span class=line>			<span class=variable>@p2</span>:<span class=operator>=</span>o1.salary,</span><br><span class=line>			IF(<span class=variable>@p1</span><span class=operator>=</span><span class=variable>@q1</span>, IF(<span class=variable>@p2</span><span class=operator>=</span><span class=variable>@q2</span>, <span class=variable>@i</span>, <span class=variable>@i</span>:<span class=operator>=</span><span class=variable>@i</span><span class=operator>+</span><span class=number>1</span>), <span class=variable>@i</span>:<span class=operator>=</span><span class=number>1</span>) <span class=keyword>as</span> "level",</span><br><span class=line>			<span class=variable>@q1</span>:<span class=operator>=</span><span class=variable>@p1</span>,</span><br><span class=line>			<span class=variable>@q2</span>:<span class=operator>=</span><span class=variable>@p2</span></span><br><span class=line>		<span class=keyword>from</span> (</span><br><span class=line>			<span class=keyword>select</span> e.<span class=operator>*</span></span><br><span class=line>			<span class=keyword>from</span> s3_emp <span class=keyword>as</span> e</span><br><span class=line>			<span class=keyword>order</span> <span class=keyword>by</span> e.departmentId <span class=keyword>asc</span>, e.salary <span class=keyword>desc</span></span><br><span class=line>		) <span class=keyword>as</span> o1</span><br><span class=line>	) <span class=keyword>as</span> o2</span><br><span class=line>	<span class=keyword>where</span> o2.level <span class=operator>=</span> <span class=number>1</span></span><br><span class=line>) <span class=keyword>as</span> o3 <span class=keyword>on</span> d.id <span class=operator>=</span> o3.departmentId</span><br><span class=line></span><br><span class=line># 解法<span class=number>2</span>：</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	d.name <span class=keyword>as</span> "Department",</span><br><span class=line>	o4.name <span class=keyword>as</span> "Employee",</span><br><span class=line>	o4.salary <span class=keyword>as</span> "Salary"</span><br><span class=line><span class=keyword>from</span> s3_dept <span class=keyword>as</span> d</span><br><span class=line><span class=keyword>join</span> (</span><br><span class=line>	<span class=keyword>select</span></span><br><span class=line>		o2.id,</span><br><span class=line>		o2.name,</span><br><span class=line>		o2.salary,</span><br><span class=line>		o2.departmentId</span><br><span class=line>	<span class=keyword>from</span> (</span><br><span class=line>		<span class=keyword>select</span></span><br><span class=line>			e.<span class=operator>*</span>,</span><br><span class=line>			<span class=built_in>DENSE_RANK</span>() <span class=keyword>over</span> (<span class=keyword>order</span> <span class=keyword>by</span> e.departmentId <span class=keyword>asc</span>, salary <span class=keyword>desc</span>) <span class=keyword>as</span> "level"</span><br><span class=line>		<span class=keyword>from</span> s3_emp <span class=keyword>as</span> e</span><br><span class=line>	) <span class=keyword>as</span> o2 </span><br><span class=line>	<span class=keyword>join</span>  (</span><br><span class=line>		<span class=keyword>select</span></span><br><span class=line>			<span class=built_in>min</span>(o1.level) <span class=keyword>as</span> "level2"</span><br><span class=line>		<span class=keyword>from</span> (</span><br><span class=line>			<span class=keyword>select</span></span><br><span class=line>				e.<span class=operator>*</span>,</span><br><span class=line>				<span class=built_in>DENSE_RANK</span>() <span class=keyword>over</span> (<span class=keyword>order</span> <span class=keyword>by</span> e.departmentId <span class=keyword>asc</span>, salary <span class=keyword>desc</span>) <span class=keyword>as</span> "level"</span><br><span class=line>			<span class=keyword>from</span> s3_emp <span class=keyword>as</span> e</span><br><span class=line>		) <span class=keyword>as</span> o1</span><br><span class=line>		<span class=keyword>group</span> <span class=keyword>by</span> o1.departmentId </span><br><span class=line>	) <span class=keyword>as</span> o3 <span class=keyword>on</span> o2.level <span class=operator>=</span> o3.level2</span><br><span class=line>) <span class=keyword>as</span> o4 <span class=keyword>on</span> d.id <span class=operator>=</span> o4.departmentId</span><br><span class=line><span class=keyword>order</span> <span class=keyword>by</span> o4.id</span><br><span class=line></span><br><span class=line># 解法<span class=number>3</span>：</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	d.name <span class=keyword>as</span> "Department",</span><br><span class=line>	e.name <span class=keyword>as</span> "Employee ",</span><br><span class=line>	e.salary <span class=keyword>as</span> "Salary " </span><br><span class=line><span class=keyword>from</span> s3_emp <span class=keyword>as</span> e</span><br><span class=line><span class=keyword>join</span> s3_dept <span class=keyword>as</span> d <span class=keyword>on</span> e.departmentId <span class=operator>=</span> d.id</span><br><span class=line><span class=keyword>where</span> (e.departmentId, e.salary) <span class=keyword>in</span> (</span><br><span class=line>	<span class=keyword>select</span> departmentId, <span class=built_in>MAX</span>(salary)</span><br><span class=line>	<span class=keyword>from</span> s3_emp</span><br><span class=line>	<span class=keyword>group</span> <span class=keyword>by</span> departmentId</span><br><span class=line>)</span><br></pre></table></figure><h2 id=1-10、-185-部门工资前三高的所有员工><a class=headerlink href=#1-10、-185-部门工资前三高的所有员工 title=1.10、(185)部门工资前三高的所有员工></a>1.10、(185)部门工资前三高的所有员工</h2><p>公司的主管们感兴趣的是公司每个部门中谁赚的钱最多。一个部门的 <strong>高收入者</strong> 是指一个员工的工资在该部门的 <strong>不同</strong> 工资中 <strong>排名前三</strong> 。<p>编写一个SQL查询，找出每个部门中 <strong>收入高的员工</strong> 。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br></pre><td class=code><pre><span class=line>Employee 表:</span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+--------+--------------+</span></span><br><span class=line><span class=operator>|</span> id <span class=operator>|</span> name  <span class=operator>|</span> salary <span class=operator>|</span> departmentId <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+--------+--------------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>  <span class=operator>|</span> Joe   <span class=operator>|</span> <span class=number>85000</span>  <span class=operator>|</span> <span class=number>1</span>            <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>  <span class=operator>|</span> Henry <span class=operator>|</span> <span class=number>80000</span>  <span class=operator>|</span> <span class=number>2</span>            <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>  <span class=operator>|</span> Sam   <span class=operator>|</span> <span class=number>60000</span>  <span class=operator>|</span> <span class=number>2</span>            <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>4</span>  <span class=operator>|</span> Max   <span class=operator>|</span> <span class=number>90000</span>  <span class=operator>|</span> <span class=number>1</span>            <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>5</span>  <span class=operator>|</span> Janet <span class=operator>|</span> <span class=number>69000</span>  <span class=operator>|</span> <span class=number>1</span>            <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>6</span>  <span class=operator>|</span> Randy <span class=operator>|</span> <span class=number>85000</span>  <span class=operator>|</span> <span class=number>1</span>            <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>7</span>  <span class=operator>|</span> Will  <span class=operator>|</span> <span class=number>70000</span>  <span class=operator>|</span> <span class=number>1</span>            <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+--------+--------------+</span></span><br><span class=line>Department  表:</span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+</span></span><br><span class=line><span class=operator>|</span> id <span class=operator>|</span> name  <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>  <span class=operator>|</span> IT    <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>  <span class=operator>|</span> Sales <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-------+</span></span><br><span class=line>输出: </span><br><span class=line><span class=operator>+</span><span class=comment>------------+----------+--------+</span></span><br><span class=line><span class=operator>|</span> Department <span class=operator>|</span> Employee <span class=operator>|</span> Salary <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>------------+----------+--------+</span></span><br><span class=line><span class=operator>|</span> IT         <span class=operator>|</span> Max      <span class=operator>|</span> <span class=number>90000</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> IT         <span class=operator>|</span> Joe      <span class=operator>|</span> <span class=number>85000</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> IT         <span class=operator>|</span> Randy    <span class=operator>|</span> <span class=number>85000</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> IT         <span class=operator>|</span> Will     <span class=operator>|</span> <span class=number>70000</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> Sales      <span class=operator>|</span> Henry    <span class=operator>|</span> <span class=number>80000</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> Sales      <span class=operator>|</span> Sam      <span class=operator>|</span> <span class=number>60000</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>------------+----------+--------+</span></span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	d.name <span class=keyword>as</span> "Department",</span><br><span class=line>	o3.name <span class=keyword>as</span> "Employee",</span><br><span class=line>	o3.salary <span class=keyword>as</span> "Salary"</span><br><span class=line><span class=keyword>from</span> s3_dept <span class=keyword>as</span> d</span><br><span class=line><span class=keyword>join</span> (</span><br><span class=line>	<span class=keyword>select</span></span><br><span class=line>		o2.name,</span><br><span class=line>		o2.salary,</span><br><span class=line>		o2.departmentId</span><br><span class=line>	<span class=keyword>from</span> (</span><br><span class=line>		<span class=keyword>select</span></span><br><span class=line>			o1.<span class=operator>*</span>,</span><br><span class=line>			<span class=variable>@c1</span>:<span class=operator>=</span>o1.departmentId,</span><br><span class=line>			<span class=variable>@c2</span>:<span class=operator>=</span>o1.salary,</span><br><span class=line>			IF(<span class=variable>@c1</span><span class=operator>=</span><span class=variable>@o1</span>,IF(<span class=variable>@c2</span><span class=operator>=</span><span class=variable>@o2</span>, <span class=variable>@i</span>, <span class=variable>@i</span>:<span class=operator>=</span><span class=variable>@i</span><span class=operator>+</span><span class=number>1</span>), <span class=variable>@i</span>:<span class=operator>=</span><span class=number>1</span>) <span class=keyword>as</span> "level",</span><br><span class=line>			<span class=variable>@o1</span>:<span class=operator>=</span><span class=variable>@c1</span>,</span><br><span class=line>			<span class=variable>@o2</span>:<span class=operator>=</span><span class=variable>@c2</span></span><br><span class=line>		<span class=keyword>from</span> (</span><br><span class=line>			<span class=keyword>select</span></span><br><span class=line>				e.<span class=operator>*</span>,</span><br><span class=line>				<span class=variable>@c1</span>:<span class=operator>=</span><span class=number>0</span>,</span><br><span class=line>				<span class=variable>@c2</span>:<span class=operator>=</span><span class=number>0</span>,</span><br><span class=line>				<span class=variable>@o1</span>:<span class=operator>=</span><span class=number>0</span>,</span><br><span class=line>				<span class=variable>@o2</span>:<span class=operator>=</span><span class=number>0</span>,</span><br><span class=line>				<span class=variable>@i</span>:<span class=operator>=</span><span class=number>0</span></span><br><span class=line>			<span class=keyword>from</span> s3_emp <span class=keyword>as</span> e</span><br><span class=line>			<span class=keyword>order</span> <span class=keyword>by</span> e.departmentId <span class=keyword>asc</span>, e.salary <span class=keyword>desc</span></span><br><span class=line>		) <span class=keyword>as</span> o1</span><br><span class=line>	) <span class=keyword>as</span> o2</span><br><span class=line>	<span class=keyword>where</span> o2.level <span class=operator><=</span> <span class=number>3</span></span><br><span class=line>	<span class=keyword>order</span> <span class=keyword>by</span> o2.id </span><br><span class=line>) <span class=keyword>as</span> o3 <span class=keyword>on</span> d.id <span class=operator>=</span> o3.departmentId</span><br><span class=line></span><br><span class=line># 解法<span class=number>2</span>：</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	d.name <span class=keyword>as</span> "Department",</span><br><span class=line>	e1.name <span class=keyword>as</span> "Employee",</span><br><span class=line>	e1.salary <span class=keyword>as</span> "Salary"</span><br><span class=line><span class=keyword>from</span> s3_dept <span class=keyword>as</span> d</span><br><span class=line><span class=keyword>join</span> s3_emp <span class=keyword>as</span> e1 <span class=keyword>on</span> d.id<span class=operator>=</span> e1.departmentId</span><br><span class=line><span class=keyword>where</span> <span class=number>3</span> <span class=operator>></span> (</span><br><span class=line>	<span class=keyword>select</span> <span class=built_in>COUNT</span>(<span class=keyword>DISTINCT</span> e2.salary)</span><br><span class=line>	<span class=keyword>from</span> s3_emp <span class=keyword>as</span> e2</span><br><span class=line>	<span class=keyword>where</span> e1.departmentId <span class=operator>=</span> e2.departmentId <span class=keyword>and</span> e2.salary <span class=operator>></span> e1.salary</span><br><span class=line>)</span><br><span class=line><span class=keyword>order</span> <span class=keyword>by</span> d.id <span class=keyword>asc</span></span><br></pre></table></figure><h2 id=1-11、-196-删除重复的电子邮箱><a class=headerlink href=#1-11、-196-删除重复的电子邮箱 title=1.11、(196)删除重复的电子邮箱></a>1.11、(196)删除重复的电子邮箱</h2><p><strong>删除</strong> 所有重复的电子邮件，只保留一个具有最小 <code>id</code> 的唯一电子邮件。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br></pre><td class=code><pre><span class=line>输入: </span><br><span class=line>Person 表:</span><br><span class=line><span class=operator>+</span><span class=comment>----+------------------+</span></span><br><span class=line><span class=operator>|</span> id <span class=operator>|</span> email            <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+------------------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>  <span class=operator>|</span> john<span class=variable>@example</span>.com <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>  <span class=operator>|</span> bob<span class=variable>@example</span>.com  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>  <span class=operator>|</span> john<span class=variable>@example</span>.com <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+------------------+</span></span><br><span class=line>输出: </span><br><span class=line><span class=operator>+</span><span class=comment>----+------------------+</span></span><br><span class=line><span class=operator>|</span> id <span class=operator>|</span> email            <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+------------------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>  <span class=operator>|</span> john<span class=variable>@example</span>.com <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>  <span class=operator>|</span> bob<span class=variable>@example</span>.com  <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+------------------+</span></span><br><span class=line># 解释: john<span class=variable>@example</span>.com重复两次。我们保留最小的Id <span class=operator>=</span> <span class=number>1</span>。</span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>delete</span> p1</span><br><span class=line><span class=keyword>from</span> s3_person <span class=keyword>as</span> p1, s3_person <span class=keyword>as</span> p2</span><br><span class=line><span class=keyword>where</span> p1.email <span class=operator>=</span> p2.email <span class=keyword>and</span> p1.id <span class=operator>></span> p2.id</span><br><span class=line></span><br><span class=line># 解法<span class=number>2</span>：</span><br><span class=line><span class=keyword>delete</span> p1.<span class=operator>*</span></span><br><span class=line><span class=keyword>from</span> s3_person <span class=keyword>as</span> p1 </span><br><span class=line><span class=keyword>join</span> s3_person <span class=keyword>as</span> p2 </span><br><span class=line><span class=keyword>on</span> p1.email <span class=operator>=</span> p2.email <span class=keyword>and</span> p1.id <span class=operator>></span> p2.id</span><br></pre></table></figure><h2 id=1-12、-197-上升的温度><a class=headerlink href=#1-12、-197-上升的温度 title=1.12、(197)上升的温度></a>1.12、(197)上升的温度</h2><p>编写一个 SQL 查询，来查找与之前（昨天的）日期相比温度更高的所有日期的 <code>id</code> 。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br></pre><td class=code><pre><span class=line>Weather 表：</span><br><span class=line><span class=operator>+</span><span class=comment>----+------------+-------------+</span></span><br><span class=line><span class=operator>|</span> id <span class=operator>|</span> recordDate <span class=operator>|</span> Temperature <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+------------+-------------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>  <span class=operator>|</span> <span class=number>2015</span><span class=number>-01</span><span class=number>-01</span> <span class=operator>|</span> <span class=number>10</span>          <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>  <span class=operator>|</span> <span class=number>2015</span><span class=number>-01</span><span class=number>-02</span> <span class=operator>|</span> <span class=number>25</span>          <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>  <span class=operator>|</span> <span class=number>2015</span><span class=number>-01</span><span class=number>-03</span> <span class=operator>|</span> <span class=number>20</span>          <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>4</span>  <span class=operator>|</span> <span class=number>2015</span><span class=number>-01</span><span class=number>-04</span> <span class=operator>|</span> <span class=number>30</span>          <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+------------+-------------+</span></span><br><span class=line>输出：</span><br><span class=line><span class=operator>+</span><span class=comment>----+</span></span><br><span class=line><span class=operator>|</span> id <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>4</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+</span></span><br><span class=line># 解释：</span><br><span class=line><span class=number>2015</span><span class=number>-01</span><span class=number>-02</span> 的温度比前一天高（<span class=number>10</span> <span class=operator>-</span><span class=operator>></span> <span class=number>25</span>）</span><br><span class=line><span class=number>2015</span><span class=number>-01</span><span class=number>-04</span> 的温度比前一天高（<span class=number>20</span> <span class=operator>-</span><span class=operator>></span> <span class=number>30</span>）</span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	o2.id</span><br><span class=line><span class=keyword>from</span> (</span><br><span class=line>	<span class=keyword>select</span></span><br><span class=line>		o1.id,</span><br><span class=line>		o1.recordDate,</span><br><span class=line>		o1.Temperature,</span><br><span class=line>		<span class=variable>@cd</span>:<span class=operator>=</span>o1.recordDate,</span><br><span class=line>		<span class=variable>@ct</span>:<span class=operator>=</span>o1.Temperature,</span><br><span class=line>		IF(<span class=built_in>abs</span>(DATEDIFF(<span class=variable>@od</span>, <span class=variable>@cd</span>)) <span class=operator>=</span> <span class=number>1</span>,<span class=number>11</span>,<span class=number>22</span>) <span class=keyword>as</span> "tmp",</span><br><span class=line>		IF(<span class=built_in>abs</span>(DATEDIFF(<span class=variable>@od</span>, <span class=variable>@cd</span>)) <span class=operator>=</span> <span class=number>1</span>, IF(<span class=variable>@ct</span> <span class=operator>></span> <span class=variable>@ot</span>, <span class=variable>@v</span>:<span class=operator>=</span><span class=variable>@v</span><span class=operator>+</span><span class=number>1</span>, <span class=variable>@v</span>:<span class=operator>=</span><span class=number>1</span>), <span class=variable>@v</span>:<span class=operator>=</span><span class=number>1</span>) <span class=keyword>as</span> "level",</span><br><span class=line>		<span class=variable>@od</span>:<span class=operator>=</span><span class=variable>@cd</span>,</span><br><span class=line>		<span class=variable>@ot</span>:<span class=operator>=</span><span class=variable>@ct</span></span><br><span class=line>	<span class=keyword>from</span> (</span><br><span class=line>		<span class=keyword>select</span></span><br><span class=line>			w.<span class=operator>*</span>,</span><br><span class=line>			<span class=variable>@od</span>:<span class=operator>=</span>"1000-01-01",</span><br><span class=line>			<span class=variable>@cd</span>:<span class=operator>=</span>"1000-01-01",</span><br><span class=line>			<span class=variable>@ot</span>:<span class=operator>=</span><span class=number>0</span>,</span><br><span class=line>			<span class=variable>@ct</span>:<span class=operator>=</span><span class=number>0</span>,</span><br><span class=line>			<span class=variable>@v</span>:<span class=operator>=</span><span class=number>0</span></span><br><span class=line>		<span class=keyword>from</span> s3_weather <span class=keyword>as</span> w</span><br><span class=line>		<span class=keyword>order</span> <span class=keyword>by</span> w.recordDate <span class=keyword>asc</span></span><br><span class=line>	) <span class=keyword>as</span> o1</span><br><span class=line>) <span class=keyword>as</span> o2</span><br><span class=line><span class=keyword>where</span> o2.level <span class=operator>=</span> <span class=number>2</span></span><br><span class=line></span><br><span class=line># 解法<span class=number>2</span>：</span><br><span class=line><span class=keyword>select</span> w.id</span><br><span class=line><span class=keyword>from</span> s3_weather <span class=keyword>as</span> w</span><br><span class=line><span class=keyword>join</span> S3_weather <span class=keyword>as</span> w2 </span><br><span class=line>	<span class=keyword>on</span> w.recordDate <span class=operator>=</span> DATE_ADD(w2.recordDate, <span class=type>INTERVAL</span> <span class=number>1</span> <span class=keyword>DAY</span>)</span><br><span class=line>		<span class=keyword>and</span> w.temperature <span class=operator>></span> w2.temperature</span><br></pre></table></figure><h2 id=1-13、-262-行程和用户><a class=headerlink href=#1-13、-262-行程和用户 title=1.13、(262)行程和用户></a>1.13、(262)行程和用户</h2><p><strong>取消率</strong> 计算方式：(被司机或乘客取消的非禁止用户生成的订单数量) / (非禁止用户生成的订单总数)。<p>写一段 SQL 语句查出 <code>"2013-10-01"</code> 至 <code>"2013-10-03"</code> 期间非禁止用户（<strong>乘客和司机都必须未被禁止</strong>）的取消率。非禁止用户即 banned 为 No 的用户，禁止用户即 banned 为 Yes 的用户。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br></pre><td class=code><pre><span class=line>Trips 表：</span><br><span class=line><span class=operator>+</span><span class=comment>----+-----------+-----------+---------+---------------------+------------+</span></span><br><span class=line><span class=operator>|</span> id <span class=operator>|</span> client_id <span class=operator>|</span> driver_id <span class=operator>|</span> city_id <span class=operator>|</span> status              <span class=operator>|</span> request_at <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-----------+-----------+---------+---------------------+------------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>  <span class=operator>|</span> <span class=number>1</span>         <span class=operator>|</span> <span class=number>10</span>        <span class=operator>|</span> <span class=number>1</span>       <span class=operator>|</span> completed           <span class=operator>|</span> <span class=number>2013</span><span class=number>-10</span><span class=number>-01</span> <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>  <span class=operator>|</span> <span class=number>2</span>         <span class=operator>|</span> <span class=number>11</span>        <span class=operator>|</span> <span class=number>1</span>       <span class=operator>|</span> cancelled_by_driver <span class=operator>|</span> <span class=number>2013</span><span class=number>-10</span><span class=number>-01</span> <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>  <span class=operator>|</span> <span class=number>3</span>         <span class=operator>|</span> <span class=number>12</span>        <span class=operator>|</span> <span class=number>6</span>       <span class=operator>|</span> completed           <span class=operator>|</span> <span class=number>2013</span><span class=number>-10</span><span class=number>-01</span> <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>4</span>  <span class=operator>|</span> <span class=number>4</span>         <span class=operator>|</span> <span class=number>13</span>        <span class=operator>|</span> <span class=number>6</span>       <span class=operator>|</span> cancelled_by_client <span class=operator>|</span> <span class=number>2013</span><span class=number>-10</span><span class=number>-01</span> <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>5</span>  <span class=operator>|</span> <span class=number>1</span>         <span class=operator>|</span> <span class=number>10</span>        <span class=operator>|</span> <span class=number>1</span>       <span class=operator>|</span> completed           <span class=operator>|</span> <span class=number>2013</span><span class=number>-10</span><span class=number>-02</span> <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>6</span>  <span class=operator>|</span> <span class=number>2</span>         <span class=operator>|</span> <span class=number>11</span>        <span class=operator>|</span> <span class=number>6</span>       <span class=operator>|</span> completed           <span class=operator>|</span> <span class=number>2013</span><span class=number>-10</span><span class=number>-02</span> <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>7</span>  <span class=operator>|</span> <span class=number>3</span>         <span class=operator>|</span> <span class=number>12</span>        <span class=operator>|</span> <span class=number>6</span>       <span class=operator>|</span> completed           <span class=operator>|</span> <span class=number>2013</span><span class=number>-10</span><span class=number>-02</span> <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>8</span>  <span class=operator>|</span> <span class=number>2</span>         <span class=operator>|</span> <span class=number>12</span>        <span class=operator>|</span> <span class=number>12</span>      <span class=operator>|</span> completed           <span class=operator>|</span> <span class=number>2013</span><span class=number>-10</span><span class=number>-03</span> <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>9</span>  <span class=operator>|</span> <span class=number>3</span>         <span class=operator>|</span> <span class=number>10</span>        <span class=operator>|</span> <span class=number>12</span>      <span class=operator>|</span> completed           <span class=operator>|</span> <span class=number>2013</span><span class=number>-10</span><span class=number>-03</span> <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>10</span> <span class=operator>|</span> <span class=number>4</span>         <span class=operator>|</span> <span class=number>13</span>        <span class=operator>|</span> <span class=number>12</span>      <span class=operator>|</span> cancelled_by_driver <span class=operator>|</span> <span class=number>2013</span><span class=number>-10</span><span class=number>-03</span> <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-----------+-----------+---------+---------------------+------------+</span></span><br><span class=line>Users 表：</span><br><span class=line><span class=operator>+</span><span class=comment>----------+--------+--------+</span></span><br><span class=line><span class=operator>|</span> users_id <span class=operator>|</span> banned <span class=operator>|</span> role   <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----------+--------+--------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>        <span class=operator>|</span> <span class=keyword>No</span>     <span class=operator>|</span> client <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>        <span class=operator>|</span> Yes    <span class=operator>|</span> client <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>        <span class=operator>|</span> <span class=keyword>No</span>     <span class=operator>|</span> client <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>4</span>        <span class=operator>|</span> <span class=keyword>No</span>     <span class=operator>|</span> client <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>10</span>       <span class=operator>|</span> <span class=keyword>No</span>     <span class=operator>|</span> driver <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>11</span>       <span class=operator>|</span> <span class=keyword>No</span>     <span class=operator>|</span> driver <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>12</span>       <span class=operator>|</span> <span class=keyword>No</span>     <span class=operator>|</span> driver <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>13</span>       <span class=operator>|</span> <span class=keyword>No</span>     <span class=operator>|</span> driver <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----------+--------+--------+</span></span><br><span class=line>输出：</span><br><span class=line><span class=operator>+</span><span class=comment>------------+-------------------+</span></span><br><span class=line><span class=operator>|</span> <span class=keyword>Day</span>        <span class=operator>|</span> Cancellation Rate <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>------------+-------------------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>2013</span><span class=number>-10</span><span class=number>-01</span> <span class=operator>|</span> <span class=number>0.33</span>              <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2013</span><span class=number>-10</span><span class=number>-02</span> <span class=operator>|</span> <span class=number>0.00</span>              <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2013</span><span class=number>-10</span><span class=number>-03</span> <span class=operator>|</span> <span class=number>0.50</span>              <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>------------+-------------------+</span></span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	t.request_at <span class=keyword>as</span> "Day",</span><br><span class=line>	ROUND(<span class=built_in>SUM</span>(IF(t.status <span class=operator>=</span> "completed", <span class=number>0</span>, <span class=number>1</span>)) <span class=operator>/</span> <span class=built_in>count</span>(t.status), <span class=number>2</span>) <span class=keyword>as</span> "Cancellation Rate"</span><br><span class=line><span class=keyword>from</span> trips <span class=keyword>as</span> t</span><br><span class=line><span class=keyword>where</span> t.client_id <span class=keyword>not</span> <span class=keyword>in</span>(</span><br><span class=line>	<span class=keyword>select</span> users_id <span class=keyword>from</span> users <span class=keyword>where</span> banned <span class=operator>=</span> "yes"</span><br><span class=line>) <span class=keyword>and</span> t.driver_id <span class=keyword>not</span> <span class=keyword>in</span>(</span><br><span class=line>	<span class=keyword>select</span> users_id <span class=keyword>from</span> users <span class=keyword>where</span> banned <span class=operator>=</span> "yes"</span><br><span class=line>) <span class=keyword>and</span> t.request_at <span class=keyword>BETWEEN</span> "2013-10-01" <span class=keyword>and</span> "2013-10-03"</span><br><span class=line><span class=keyword>group</span> <span class=keyword>by</span> t.request_at</span><br><span class=line></span><br><span class=line># 解法<span class=number>2</span>：</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	t.request_at <span class=keyword>as</span> "Day",</span><br><span class=line>	ROUND(<span class=built_in>SUM</span>(IF(t.status <span class=operator>=</span> "completed", <span class=number>0</span>, <span class=number>1</span>)) <span class=operator>/</span> <span class=built_in>count</span>(t.status), <span class=number>2</span>) <span class=keyword>as</span> "`Cancellation Rate`"</span><br><span class=line><span class=keyword>from</span> trips <span class=keyword>as</span> t</span><br><span class=line><span class=keyword>left</span> <span class=keyword>join</span> (</span><br><span class=line>	<span class=keyword>select</span> users_id <span class=keyword>from</span> users <span class=keyword>where</span> banned <span class=operator>=</span> "yes"</span><br><span class=line>) <span class=keyword>as</span> o1 <span class=keyword>on</span> t.client_id <span class=operator>=</span> o1.users_id</span><br><span class=line><span class=keyword>left</span> <span class=keyword>join</span> (</span><br><span class=line>	<span class=keyword>select</span> users_id <span class=keyword>from</span> users <span class=keyword>where</span> banned <span class=operator>=</span> "yes"</span><br><span class=line>) <span class=keyword>as</span> o2 <span class=keyword>on</span> t.driver_id <span class=operator>=</span> o2.users_id</span><br><span class=line><span class=keyword>where</span> o1.users_id <span class=keyword>is</span> <span class=keyword>null</span> </span><br><span class=line>	<span class=keyword>and</span> o2.users_id <span class=keyword>is</span> <span class=keyword>null</span> </span><br><span class=line>	<span class=keyword>and</span> t.request_at <span class=keyword>BETWEEN</span> "2013-10-01" <span class=keyword>and</span> "2013-10-03"</span><br><span class=line><span class=keyword>group</span> <span class=keyword>by</span> t.request_at </span><br></pre></table></figure><h2 id=1-14、-511-游戏玩法分析1><a class=headerlink href=#1-14、-511-游戏玩法分析1 title=1.14、(511)游戏玩法分析1></a>1.14、(511)游戏玩法分析1</h2><p>查询每位玩家 <strong>第一次登陆平台的日期</strong>。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br></pre><td class=code><pre><span class=line>Activity 表：</span><br><span class=line><span class=operator>+</span><span class=comment>-----------+-----------+------------+--------------+</span></span><br><span class=line><span class=operator>|</span> player_id <span class=operator>|</span> device_id <span class=operator>|</span> event_date <span class=operator>|</span> games_played <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-----------+-----------+------------+--------------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>         <span class=operator>|</span> <span class=number>2</span>         <span class=operator>|</span> <span class=number>2016</span><span class=number>-03</span><span class=number>-01</span> <span class=operator>|</span> <span class=number>5</span>            <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>         <span class=operator>|</span> <span class=number>2</span>         <span class=operator>|</span> <span class=number>2016</span><span class=number>-05</span><span class=number>-02</span> <span class=operator>|</span> <span class=number>6</span>            <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>         <span class=operator>|</span> <span class=number>3</span>         <span class=operator>|</span> <span class=number>2017</span><span class=number>-06</span><span class=number>-25</span> <span class=operator>|</span> <span class=number>1</span>            <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>         <span class=operator>|</span> <span class=number>1</span>         <span class=operator>|</span> <span class=number>2016</span><span class=number>-03</span><span class=number>-02</span> <span class=operator>|</span> <span class=number>0</span>            <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>         <span class=operator>|</span> <span class=number>4</span>         <span class=operator>|</span> <span class=number>2018</span><span class=number>-07</span><span class=number>-03</span> <span class=operator>|</span> <span class=number>5</span>            <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-----------+-----------+------------+--------------+</span></span><br><span class=line><span class=keyword>Result</span> 表：</span><br><span class=line><span class=operator>+</span><span class=comment>-----------+-------------+</span></span><br><span class=line><span class=operator>|</span> player_id <span class=operator>|</span> first_login <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-----------+-------------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>         <span class=operator>|</span> <span class=number>2016</span><span class=number>-03</span><span class=number>-01</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>         <span class=operator>|</span> <span class=number>2017</span><span class=number>-06</span><span class=number>-25</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>         <span class=operator>|</span> <span class=number>2016</span><span class=number>-03</span><span class=number>-02</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-----------+-------------+</span></span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	a.player_id,</span><br><span class=line>	<span class=built_in>min</span>(a.event_date) <span class=keyword>as</span> "d"</span><br><span class=line><span class=keyword>from</span> Activity <span class=keyword>as</span> a</span><br><span class=line><span class=keyword>group</span> <span class=keyword>by</span> a.player_id</span><br></pre></table></figure><h2 id=1-15、-550-游戏玩法分析4><a class=headerlink href=#1-15、-550-游戏玩法分析4 title=1.15、(550)游戏玩法分析4></a>1.15、(550)游戏玩法分析4</h2><p>编写一个 SQL 查询，报告在首次登录的第二天再次登录的玩家的比率，四舍五入到小数点后两位。换句话说，您需要计算从首次登录日期开始至少连续两天登录的玩家的数量，然后除以玩家总数。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br></pre><td class=code><pre><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	ROUND(<span class=built_in>AVG</span>(a2.event_date <span class=keyword>is</span> <span class=keyword>not</span> <span class=keyword>null</span>), <span class=number>2</span>)</span><br><span class=line><span class=keyword>from</span> (</span><br><span class=line>	<span class=keyword>select</span> </span><br><span class=line>		a.player_id,</span><br><span class=line>		<span class=built_in>min</span>(a.event_date) <span class=keyword>as</span> "firstL" </span><br><span class=line>	<span class=keyword>from</span> s3_activity <span class=keyword>as</span> a</span><br><span class=line>	<span class=keyword>group</span> <span class=keyword>by</span> a.player_id</span><br><span class=line>) <span class=keyword>as</span> o1</span><br><span class=line><span class=keyword>left</span> <span class=keyword>join</span> s3_activity <span class=keyword>as</span> a2 <span class=keyword>on</span> o1.player_id <span class=operator>=</span> a2.player_id <span class=keyword>and</span> DATEDIFF(a2.event_date, o1.firstL) <span class=operator>=</span> <span class=number>1</span></span><br><span class=line></span><br><span class=line># 解法<span class=number>2</span>：</span><br><span class=line><span class=keyword>select</span> </span><br><span class=line>	round(o3.p_count <span class=operator>/</span> (<span class=keyword>select</span> <span class=built_in>count</span>(<span class=keyword>DISTINCT</span> a.player_id) <span class=keyword>from</span> s3_activity <span class=keyword>as</span> a), <span class=number>2</span>) <span class=keyword>as</span> "fraction"</span><br><span class=line><span class=keyword>from</span> (</span><br><span class=line>	<span class=keyword>select</span> </span><br><span class=line>		<span class=built_in>count</span>(<span class=keyword>DISTINCT</span> o2.player_id) <span class=keyword>as</span> "p_count"</span><br><span class=line>	<span class=keyword>from</span> (</span><br><span class=line>		<span class=keyword>select</span></span><br><span class=line>			o1.<span class=operator>*</span>,</span><br><span class=line>			<span class=variable>@op</span>:<span class=operator>=</span>o1.player_id,</span><br><span class=line>			<span class=variable>@cp</span>:<span class=operator>=</span>o1.player_id,</span><br><span class=line>			<span class=variable>@cd</span>:<span class=operator>=</span>o1.event_date,</span><br><span class=line>			IF(<span class=variable>@cp</span><span class=operator>=</span><span class=variable>@op</span> <span class=operator>||</span> (<span class=variable>@t</span>:<span class=operator>=</span><span class=number>0</span>)<span class=operator>!=</span><span class=number>0</span>, IF(<span class=built_in>abs</span>(DATEDIFF(<span class=variable>@od</span>, <span class=variable>@cd</span>))<span class=operator>=</span><span class=number>1</span> <span class=operator>||</span> (<span class=variable>@t</span>:<span class=operator>=</span><span class=number>1</span>)<span class=operator>!=</span><span class=number>1</span>, IF(<span class=variable>@t</span><span class=operator>=</span><span class=number>0</span>,<span class=variable>@v</span>:<span class=operator>=</span><span class=variable>@v</span><span class=operator>+</span><span class=number>1</span>,<span class=number>0</span>), <span class=variable>@v</span>:<span class=operator>=</span><span class=number>1</span>), <span class=variable>@v</span>:<span class=operator>=</span><span class=number>1</span>) <span class=keyword>as</span> "level",</span><br><span class=line>			<span class=variable>@op</span>:<span class=operator>=</span><span class=variable>@cp</span>,</span><br><span class=line>			<span class=variable>@od</span>:<span class=operator>=</span><span class=variable>@cd</span></span><br><span class=line>		<span class=keyword>from</span> (</span><br><span class=line>			<span class=keyword>select</span></span><br><span class=line>				a.<span class=operator>*</span>,</span><br><span class=line>				<span class=variable>@op</span>:<span class=operator>=</span><span class=number>0</span>,</span><br><span class=line>				<span class=variable>@cp</span>:<span class=operator>=</span><span class=number>0</span>,</span><br><span class=line>				<span class=variable>@od</span>:<span class=operator>=</span>"1000-01-01",</span><br><span class=line>				<span class=variable>@cd</span>:<span class=operator>=</span>"1000-01-01",</span><br><span class=line>				<span class=variable>@v</span>:<span class=operator>=</span><span class=number>0</span>,</span><br><span class=line>				<span class=variable>@t</span>:<span class=operator>=</span><span class=number>0</span></span><br><span class=line>			<span class=keyword>from</span> s3_activity <span class=keyword>as</span> a</span><br><span class=line>			<span class=keyword>order</span> <span class=keyword>by</span> a.player_id <span class=keyword>asc</span>, a.event_date <span class=keyword>asc</span></span><br><span class=line>		) <span class=keyword>as</span> o1</span><br><span class=line>	) <span class=keyword>as</span> o2</span><br><span class=line>	<span class=keyword>where</span> o2.level <span class=operator>=</span> <span class=number>2</span></span><br><span class=line>) <span class=keyword>as</span> o3</span><br></pre></table></figure><h2 id=1-16、-570-至少有5名直接下属的经理><a class=headerlink href=#1-16、-570-至少有5名直接下属的经理 title=1.16、(570)至少有5名直接下属的经理></a>1.16、(570)至少有5名直接下属的经理</h2><p>查询<strong>至少有5名直接下属</strong>的经理 。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br></pre><td class=code><pre><span class=line>Employee 表:</span><br><span class=line><span class=operator>+</span><span class=comment>-----+-------+------------+-----------+</span></span><br><span class=line><span class=operator>|</span> id  <span class=operator>|</span> name  <span class=operator>|</span> department <span class=operator>|</span> managerId <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-----+-------+------------+-----------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>101</span> <span class=operator>|</span> John  <span class=operator>|</span> A          <span class=operator>|</span> <span class=keyword>None</span>      <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>102</span> <span class=operator>|</span> Dan   <span class=operator>|</span> A          <span class=operator>|</span> <span class=number>101</span>       <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>103</span> <span class=operator>|</span> James <span class=operator>|</span> A          <span class=operator>|</span> <span class=number>101</span>       <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>104</span> <span class=operator>|</span> Amy   <span class=operator>|</span> A          <span class=operator>|</span> <span class=number>101</span>       <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>105</span> <span class=operator>|</span> Anne  <span class=operator>|</span> A          <span class=operator>|</span> <span class=number>101</span>       <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>106</span> <span class=operator>|</span> Ron   <span class=operator>|</span> B          <span class=operator>|</span> <span class=number>101</span>       <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-----+-------+------------+-----------+</span></span><br><span class=line>输出: </span><br><span class=line><span class=operator>+</span><span class=comment>------+</span></span><br><span class=line><span class=operator>|</span> name <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>------+</span></span><br><span class=line><span class=operator>|</span> John <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>------+</span></span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	e2.name</span><br><span class=line><span class=keyword>from</span> Employee <span class=keyword>as</span> e2</span><br><span class=line><span class=keyword>join</span> (</span><br><span class=line>	<span class=keyword>select</span> e.managerId</span><br><span class=line>	<span class=keyword>from</span> Employee <span class=keyword>as</span> e</span><br><span class=line>	<span class=keyword>group</span> <span class=keyword>by</span> e.managerId</span><br><span class=line>	<span class=keyword>having</span> <span class=built_in>count</span>(e.id) <span class=operator>>=</span> <span class=number>5</span></span><br><span class=line>) <span class=keyword>as</span> o1 <span class=keyword>on</span> e2.id <span class=operator>=</span> o1.managerId</span><br></pre></table></figure><h2 id=1-17、-577-员工奖金><a class=headerlink href=#1-17、-577-员工奖金 title=1.17、(577)员工奖金></a>1.17、(577)员工奖金</h2><p>选出所有 bonus < 1000 的员工的 name 及其 bonus。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br></pre><td class=code><pre><span class=line>Employee表</span><br><span class=line><span class=operator>+</span><span class=comment>-------+--------+-----------+--------+</span></span><br><span class=line><span class=operator>|</span> empId <span class=operator>|</span>  name  <span class=operator>|</span> supervisor<span class=operator>|</span> salary <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-------+--------+-----------+--------+</span></span><br><span class=line><span class=operator>|</span>   <span class=number>1</span>   <span class=operator>|</span> John   <span class=operator>|</span>  <span class=number>3</span>        <span class=operator>|</span> <span class=number>1000</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span>   <span class=number>2</span>   <span class=operator>|</span> Dan    <span class=operator>|</span>  <span class=number>3</span>        <span class=operator>|</span> <span class=number>2000</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span>   <span class=number>3</span>   <span class=operator>|</span> Brad   <span class=operator>|</span>  <span class=keyword>null</span>     <span class=operator>|</span> <span class=number>4000</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span>   <span class=number>4</span>   <span class=operator>|</span> Thomas <span class=operator>|</span>  <span class=number>3</span>        <span class=operator>|</span> <span class=number>4000</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-------+--------+-----------+--------+</span></span><br><span class=line>Bonus 表单</span><br><span class=line><span class=operator>+</span><span class=comment>-------+-------+</span></span><br><span class=line><span class=operator>|</span> empId <span class=operator>|</span> bonus <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-------+-------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>     <span class=operator>|</span> <span class=number>500</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>4</span>     <span class=operator>|</span> <span class=number>2000</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-------+-------+</span></span><br><span class=line>输出示例：</span><br><span class=line><span class=operator>+</span><span class=comment>-------+-------+</span></span><br><span class=line><span class=operator>|</span> name  <span class=operator>|</span> bonus <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-------+-------+</span></span><br><span class=line><span class=operator>|</span> John  <span class=operator>|</span> <span class=keyword>null</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> Dan   <span class=operator>|</span> <span class=number>500</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> Brad  <span class=operator>|</span> <span class=keyword>null</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-------+-------+</span></span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	e.name, </span><br><span class=line>	b.bonus</span><br><span class=line><span class=keyword>from</span> Employee <span class=keyword>as</span> e</span><br><span class=line><span class=keyword>left</span> <span class=keyword>join</span> Bonus <span class=keyword>as</span> b <span class=keyword>on</span> e.empId <span class=operator>=</span> b.empId</span><br><span class=line><span class=keyword>where</span> b.bonus <span class=operator><</span> <span class=number>1000</span> <span class=keyword>or</span> b.bonus <span class=keyword>is</span> <span class=keyword>null</span></span><br></pre></table></figure><h2 id=1-18、-584-寻找用户推荐人><a class=headerlink href=#1-18、-584-寻找用户推荐人 title=1.18、(584)寻找用户推荐人></a>1.18、(584)寻找用户推荐人</h2><p>找出那些 <strong>没有被</strong> <code>id = 2</code> 的客户 <strong>推荐</strong> 的客户的姓名。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br></pre><td class=code><pre><span class=line>customer表</span><br><span class=line><span class=operator>+</span><span class=comment>------+------+-----------+</span></span><br><span class=line><span class=operator>|</span> id   <span class=operator>|</span> name <span class=operator>|</span> referee_id<span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>------+------+-----------+</span></span><br><span class=line><span class=operator>|</span>    <span class=number>1</span> <span class=operator>|</span> Will <span class=operator>|</span>      <span class=keyword>NULL</span> <span class=operator>|</span></span><br><span class=line><span class=operator>|</span>    <span class=number>2</span> <span class=operator>|</span> Jane <span class=operator>|</span>      <span class=keyword>NULL</span> <span class=operator>|</span></span><br><span class=line><span class=operator>|</span>    <span class=number>3</span> <span class=operator>|</span> Alex <span class=operator>|</span>         <span class=number>2</span> <span class=operator>|</span></span><br><span class=line><span class=operator>|</span>    <span class=number>4</span> <span class=operator>|</span> Bill <span class=operator>|</span>      <span class=keyword>NULL</span> <span class=operator>|</span></span><br><span class=line><span class=operator>|</span>    <span class=number>5</span> <span class=operator>|</span> Zack <span class=operator>|</span>         <span class=number>1</span> <span class=operator>|</span></span><br><span class=line><span class=operator>|</span>    <span class=number>6</span> <span class=operator>|</span> Mark <span class=operator>|</span>         <span class=number>2</span> <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>------+------+-----------+</span></span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span> c.name</span><br><span class=line><span class=keyword>from</span> customer <span class=keyword>as</span> c</span><br><span class=line><span class=keyword>where</span> c.referee_id <span class=operator>!=</span> <span class=number>2</span> <span class=keyword>or</span> c.referee_id <span class=keyword>is</span> <span class=keyword>null</span></span><br></pre></table></figure><h2 id=1-19、-585-2016年的投资><a class=headerlink href=#1-19、-585-2016年的投资 title=1.19、(585)2016年的投资></a>1.19、(585)2016年的投资</h2><p>请你编写一个 SQL 查询，报告 2016 年 (tiv_2016) 所有满足下述条件的投保人的投保金额之和：<ul><li>他在 2015 年的投保额 (tiv_2015) 至少跟一个其他投保人在 2015 年的投保额相同。<li>他所在的城市必须与其他投保人都不同（也就是说 (lat, lon) 不能跟其他任何一个投保人完全相同）。<br>输入：</ul><figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br></pre><td class=code><pre><span class=line>Insurance 表：</span><br><span class=line><span class=operator>+</span><span class=comment>-----+----------+----------+-----+-----+</span></span><br><span class=line><span class=operator>|</span> pid <span class=operator>|</span> tiv_2015 <span class=operator>|</span> tiv_2016 <span class=operator>|</span> lat <span class=operator>|</span> lon <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-----+----------+----------+-----+-----+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>   <span class=operator>|</span> <span class=number>10</span>       <span class=operator>|</span> <span class=number>5</span>        <span class=operator>|</span> <span class=number>10</span>  <span class=operator>|</span> <span class=number>10</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>   <span class=operator>|</span> <span class=number>20</span>       <span class=operator>|</span> <span class=number>20</span>       <span class=operator>|</span> <span class=number>20</span>  <span class=operator>|</span> <span class=number>20</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>   <span class=operator>|</span> <span class=number>10</span>       <span class=operator>|</span> <span class=number>30</span>       <span class=operator>|</span> <span class=number>20</span>  <span class=operator>|</span> <span class=number>20</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>4</span>   <span class=operator>|</span> <span class=number>10</span>       <span class=operator>|</span> <span class=number>40</span>       <span class=operator>|</span> <span class=number>40</span>  <span class=operator>|</span> <span class=number>40</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-----+----------+----------+-----+-----+</span></span><br><span class=line>输出：</span><br><span class=line><span class=operator>+</span><span class=comment>----------+</span></span><br><span class=line><span class=operator>|</span> tiv_2016 <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>45.00</span>    <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----------+</span></span><br><span class=line></span><br><span class=line>解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span> <span class=built_in>SUM</span>(i.tiv_2016) <span class=keyword>as</span> "tiv_2016"</span><br><span class=line><span class=keyword>from</span> s3_insurance <span class=keyword>as</span> i</span><br><span class=line><span class=keyword>join</span> (</span><br><span class=line>	<span class=keyword>select</span> <span class=keyword>DISTINCT</span> pid <span class=keyword>from</span> s3_insurance</span><br><span class=line>) <span class=keyword>as</span> o1 <span class=keyword>on</span> i.pid <span class=operator>=</span> o1.pid</span><br><span class=line><span class=keyword>where</span> i.tiv_2015 <span class=keyword>in</span> (</span><br><span class=line>	<span class=keyword>select</span> i.tiv_2015</span><br><span class=line>	<span class=keyword>from</span> s3_insurance <span class=keyword>as</span> i</span><br><span class=line>	<span class=keyword>join</span> (</span><br><span class=line>		<span class=keyword>select</span> <span class=keyword>DISTINCT</span> pid</span><br><span class=line>		<span class=keyword>from</span> s3_insurance</span><br><span class=line>	) <span class=keyword>as</span> o1 <span class=keyword>on</span> i.pid <span class=operator>=</span> o1.pid</span><br><span class=line>	<span class=keyword>group</span> <span class=keyword>by</span> i.tiv_2015</span><br><span class=line>	<span class=keyword>having</span> <span class=built_in>count</span>(i.tiv_2015) <span class=operator>></span> <span class=number>1</span></span><br><span class=line>) <span class=keyword>and</span> (i.lat, i.lon) <span class=keyword>in</span> (</span><br><span class=line>	<span class=keyword>select</span> i2.lat, i2.lon</span><br><span class=line>	<span class=keyword>from</span> s3_insurance <span class=keyword>as</span> i2</span><br><span class=line>	<span class=keyword>join</span> (</span><br><span class=line>		<span class=keyword>select</span> <span class=keyword>DISTINCT</span> pid</span><br><span class=line>		<span class=keyword>from</span> s3_insurance</span><br><span class=line>	) <span class=keyword>as</span> o1 <span class=keyword>on</span> i2.pid <span class=operator>=</span> o1.pid</span><br><span class=line>	<span class=keyword>group</span> <span class=keyword>by</span> i2.lat, i2.lon</span><br><span class=line>	<span class=keyword>having</span> <span class=built_in>count</span>(i2.pid) <span class=operator>=</span> <span class=number>1</span></span><br><span class=line>)</span><br></pre></table></figure><h2 id=1-20、-586-订单最多的客户><a class=headerlink href=#1-20、-586-订单最多的客户 title=1.20、(586)订单最多的客户></a>1.20、(586)订单最多的客户</h2><p>查找下了 <strong>最多订单</strong> 的客户的 <code>customer_number</code> 。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br></pre><td class=code><pre><span class=line>Orders 表:</span><br><span class=line><span class=operator>+</span><span class=comment>--------------+-----------------+</span></span><br><span class=line><span class=operator>|</span> order_number <span class=operator>|</span> customer_number <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>--------------+-----------------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>            <span class=operator>|</span> <span class=number>1</span>               <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>            <span class=operator>|</span> <span class=number>2</span>               <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>            <span class=operator>|</span> <span class=number>3</span>               <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>4</span>            <span class=operator>|</span> <span class=number>3</span>               <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>--------------+-----------------+</span></span><br><span class=line>输出: </span><br><span class=line><span class=operator>+</span><span class=comment>-----------------+</span></span><br><span class=line><span class=operator>|</span> customer_number <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-----------------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>               <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-----------------+</span></span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	o1.customer_number</span><br><span class=line><span class=keyword>from</span> (</span><br><span class=line>	<span class=keyword>select</span></span><br><span class=line>		o.customer_number,</span><br><span class=line>		<span class=built_in>count</span>(o.order_number) <span class=keyword>as</span> "o_count"</span><br><span class=line>	<span class=keyword>from</span> orders <span class=keyword>as</span> o</span><br><span class=line>	<span class=keyword>group</span> <span class=keyword>by</span> o.customer_number</span><br><span class=line>	<span class=keyword>order</span> <span class=keyword>by</span> o_count <span class=keyword>desc</span></span><br><span class=line>) <span class=keyword>as</span> o1</span><br><span class=line>limit <span class=number>0</span>, <span class=number>1</span></span><br></pre></table></figure><h2 id=1-21、-595-大的国家><a class=headerlink href=#1-21、-595-大的国家 title=1.21、(595)大的国家></a>1.21、(595)大的国家</h2><p>如果一个国家满足下述两个条件之一，则认为该国是大国 ：<ul><li>面积至少为 300 万平方公里（即，3000000 km2）<li>人口至少为 2500 万（即 25000000）</ul><p>编写SQL找出 大国 的国家名称、人口和面积。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br></pre><td class=code><pre><span class=line>World 表：</span><br><span class=line><span class=operator>+</span><span class=comment>-------------+-----------+---------+------------+--------------+</span></span><br><span class=line><span class=operator>|</span> name        <span class=operator>|</span> continent <span class=operator>|</span> area    <span class=operator>|</span> population <span class=operator>|</span> gdp          <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-------------+-----------+---------+------------+--------------+</span></span><br><span class=line><span class=operator>|</span> Afghanistan <span class=operator>|</span> Asia      <span class=operator>|</span> <span class=number>652230</span>  <span class=operator>|</span> <span class=number>25500100</span>   <span class=operator>|</span> <span class=number>20343000000</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> Albania     <span class=operator>|</span> Europe    <span class=operator>|</span> <span class=number>28748</span>   <span class=operator>|</span> <span class=number>2831741</span>    <span class=operator>|</span> <span class=number>12960000000</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> Algeria     <span class=operator>|</span> Africa    <span class=operator>|</span> <span class=number>2381741</span> <span class=operator>|</span> <span class=number>37100000</span>   <span class=operator>|</span> <span class=number>188681000000</span> <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> Andorra     <span class=operator>|</span> Europe    <span class=operator>|</span> <span class=number>468</span>     <span class=operator>|</span> <span class=number>78115</span>      <span class=operator>|</span> <span class=number>3712000000</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> Angola      <span class=operator>|</span> Africa    <span class=operator>|</span> <span class=number>1246700</span> <span class=operator>|</span> <span class=number>20609294</span>   <span class=operator>|</span> <span class=number>100990000000</span> <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-------------+-----------+---------+------------+--------------+</span></span><br><span class=line>输出：</span><br><span class=line><span class=operator>+</span><span class=comment>-------------+------------+---------+</span></span><br><span class=line><span class=operator>|</span> name        <span class=operator>|</span> population <span class=operator>|</span> area    <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-------------+------------+---------+</span></span><br><span class=line><span class=operator>|</span> Afghanistan <span class=operator>|</span> <span class=number>25500100</span>   <span class=operator>|</span> <span class=number>652230</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> Algeria     <span class=operator>|</span> <span class=number>37100000</span>   <span class=operator>|</span> <span class=number>2381741</span> <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>-------------+------------+---------+</span></span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	w.name,</span><br><span class=line>	w.population,</span><br><span class=line>	w.area</span><br><span class=line><span class=keyword>from</span> world <span class=keyword>as</span> w</span><br><span class=line><span class=keyword>where</span> w.area <span class=operator>>=</span> <span class=number>3000000</span> <span class=keyword>or</span> w.population <span class=operator>>=</span> <span class=number>25000000</span></span><br></pre></table></figure><h2 id=1-22、-596-超过5名学生的课><a class=headerlink href=#1-22、-596-超过5名学生的课 title=1.22、(596)超过5名学生的课></a>1.22、(596)超过5名学生的课</h2><p>查询 至少有5个学生 的所有班级。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br></pre><td class=code><pre><span class=line>Courses <span class=keyword>table</span>:</span><br><span class=line><span class=operator>+</span><span class=comment>---------+----------+</span></span><br><span class=line><span class=operator>|</span> student <span class=operator>|</span> class    <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>---------+----------+</span></span><br><span class=line><span class=operator>|</span> A       <span class=operator>|</span> Math     <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> B       <span class=operator>|</span> English  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> C       <span class=operator>|</span> Math     <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> D       <span class=operator>|</span> Biology  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> E       <span class=operator>|</span> Math     <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> F       <span class=operator>|</span> Computer <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> G       <span class=operator>|</span> Math     <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> H       <span class=operator>|</span> Math     <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> I       <span class=operator>|</span> Math     <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>---------+----------+</span></span><br><span class=line>输出: </span><br><span class=line><span class=operator>+</span><span class=comment>---------+ </span></span><br><span class=line><span class=operator>|</span> class   <span class=operator>|</span> </span><br><span class=line><span class=operator>+</span><span class=comment>---------+ </span></span><br><span class=line><span class=operator>|</span> Math    <span class=operator>|</span> </span><br><span class=line><span class=operator>+</span><span class=comment>---------+</span></span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span> c.class</span><br><span class=line><span class=keyword>from</span> courses <span class=keyword>as</span> c</span><br><span class=line><span class=keyword>group</span> <span class=keyword>by</span> c.class</span><br><span class=line><span class=keyword>having</span> <span class=built_in>count</span>(c.student) <span class=operator>>=</span> <span class=number>5</span></span><br></pre></table></figure><h2 id=1-23、-601-体育馆的人流量><a class=headerlink href=#1-23、-601-体育馆的人流量 title=1.23、(601)体育馆的人流量></a>1.23、(601)体育馆的人流量</h2><p>编写一个 SQL 查询以找出每行的人数大于或等于 100 且 id 连续的三行或更多行记录。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br></pre><td class=code><pre><span class=line>Stadium 表:</span><br><span class=line><span class=operator>+</span><span class=comment>------+------------+-----------+</span></span><br><span class=line><span class=operator>|</span> id   <span class=operator>|</span> visit_date <span class=operator>|</span> people    <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>------+------------+-----------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>    <span class=operator>|</span> <span class=number>2017</span><span class=number>-01</span><span class=number>-01</span> <span class=operator>|</span> <span class=number>10</span>        <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>    <span class=operator>|</span> <span class=number>2017</span><span class=number>-01</span><span class=number>-02</span> <span class=operator>|</span> <span class=number>109</span>       <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>    <span class=operator>|</span> <span class=number>2017</span><span class=number>-01</span><span class=number>-03</span> <span class=operator>|</span> <span class=number>150</span>       <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>4</span>    <span class=operator>|</span> <span class=number>2017</span><span class=number>-01</span><span class=number>-04</span> <span class=operator>|</span> <span class=number>99</span>        <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>5</span>    <span class=operator>|</span> <span class=number>2017</span><span class=number>-01</span><span class=number>-05</span> <span class=operator>|</span> <span class=number>145</span>       <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>6</span>    <span class=operator>|</span> <span class=number>2017</span><span class=number>-01</span><span class=number>-06</span> <span class=operator>|</span> <span class=number>1455</span>      <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>7</span>    <span class=operator>|</span> <span class=number>2017</span><span class=number>-01</span><span class=number>-07</span> <span class=operator>|</span> <span class=number>199</span>       <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>8</span>    <span class=operator>|</span> <span class=number>2017</span><span class=number>-01</span><span class=number>-09</span> <span class=operator>|</span> <span class=number>188</span>       <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>------+------------+-----------+</span></span><br><span class=line>输出：</span><br><span class=line><span class=operator>+</span><span class=comment>------+------------+-----------+</span></span><br><span class=line><span class=operator>|</span> id   <span class=operator>|</span> visit_date <span class=operator>|</span> people    <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>------+------------+-----------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>5</span>    <span class=operator>|</span> <span class=number>2017</span><span class=number>-01</span><span class=number>-05</span> <span class=operator>|</span> <span class=number>145</span>       <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>6</span>    <span class=operator>|</span> <span class=number>2017</span><span class=number>-01</span><span class=number>-06</span> <span class=operator>|</span> <span class=number>1455</span>      <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>7</span>    <span class=operator>|</span> <span class=number>2017</span><span class=number>-01</span><span class=number>-07</span> <span class=operator>|</span> <span class=number>199</span>       <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>8</span>    <span class=operator>|</span> <span class=number>2017</span><span class=number>-01</span><span class=number>-09</span> <span class=operator>|</span> <span class=number>188</span>       <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>------+------------+-----------+</span></span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	o3.id,</span><br><span class=line>	o3.visit_date,</span><br><span class=line>	o3.people</span><br><span class=line><span class=keyword>from</span> (</span><br><span class=line>	<span class=keyword>select</span></span><br><span class=line>		o1.<span class=operator>*</span>,</span><br><span class=line>		<span class=variable>@c2</span>:<span class=operator>=</span>o1.id,</span><br><span class=line>		IF(<span class=variable>@c2</span><span class=operator>-</span><span class=variable>@oc2</span><span class=operator>=</span><span class=number>1</span>, <span class=variable>@v2</span>, <span class=variable>@v2</span>:<span class=operator>=</span><span class=variable>@v2</span><span class=operator>+</span><span class=number>1</span>) <span class=keyword>as</span> "level",</span><br><span class=line>		<span class=variable>@oc2</span>:<span class=operator>=</span><span class=variable>@c2</span></span><br><span class=line>	<span class=keyword>from</span> (</span><br><span class=line>		<span class=keyword>select</span> s.<span class=operator>*</span>, <span class=variable>@v2</span>:<span class=operator>=</span><span class=number>0</span></span><br><span class=line>		<span class=keyword>from</span> s3_stadium <span class=keyword>as</span> s</span><br><span class=line>		<span class=keyword>where</span> s.people <span class=operator>>=</span> <span class=number>100</span></span><br><span class=line>		<span class=keyword>order</span> <span class=keyword>by</span> s.id</span><br><span class=line>	) <span class=keyword>as</span> o1</span><br><span class=line>) <span class=keyword>as</span> o3 </span><br><span class=line><span class=keyword>where</span> o3.level <span class=keyword>in</span> (</span><br><span class=line>	<span class=keyword>select</span></span><br><span class=line>		o2.level</span><br><span class=line>	<span class=keyword>from</span> (</span><br><span class=line>		<span class=keyword>select</span></span><br><span class=line>			o1.<span class=operator>*</span>,</span><br><span class=line>			<span class=variable>@c</span>:<span class=operator>=</span>o1.id,</span><br><span class=line>			IF(<span class=variable>@c</span><span class=operator>-</span><span class=variable>@oc</span><span class=operator>=</span><span class=number>1</span>, <span class=variable>@v</span>, <span class=variable>@v</span>:<span class=operator>=</span><span class=variable>@v</span><span class=operator>+</span><span class=number>1</span>) <span class=keyword>as</span> "level",</span><br><span class=line>			<span class=variable>@oc</span>:<span class=operator>=</span><span class=variable>@c</span></span><br><span class=line>		<span class=keyword>from</span> (</span><br><span class=line>			<span class=keyword>select</span> s.<span class=operator>*</span>, <span class=variable>@v</span>:<span class=operator>=</span><span class=number>0</span></span><br><span class=line>			<span class=keyword>from</span> s3_stadium <span class=keyword>as</span> s</span><br><span class=line>			<span class=keyword>where</span> s.people <span class=operator>>=</span> <span class=number>100</span></span><br><span class=line>			<span class=keyword>order</span> <span class=keyword>by</span> s.id</span><br><span class=line>		) <span class=keyword>as</span> o1</span><br><span class=line>	) <span class=keyword>as</span> o2</span><br><span class=line>	<span class=keyword>group</span> <span class=keyword>by</span> o2.level</span><br><span class=line>	<span class=keyword>having</span> <span class=built_in>count</span>(o2.id) <span class=operator>>=</span> <span class=number>3</span></span><br><span class=line>)</span><br><span class=line></span><br><span class=line># 解法<span class=number>2</span>：</span><br><span class=line><span class=keyword>select</span> <span class=keyword>DISTINCT</span> s.<span class=operator>*</span></span><br><span class=line><span class=keyword>from</span> s3_stadium <span class=keyword>as</span> s</span><br><span class=line><span class=keyword>inner</span> <span class=keyword>join</span> s3_stadium <span class=keyword>as</span> s2</span><br><span class=line><span class=keyword>inner</span> <span class=keyword>join</span> s3_stadium <span class=keyword>as</span> s3</span><br><span class=line><span class=keyword>where</span> s.people <span class=operator>></span> <span class=number>100</span> <span class=keyword>and</span> s2.people <span class=operator>></span> <span class=number>100</span> <span class=keyword>and</span> s3.people <span class=operator>></span> <span class=number>100</span></span><br><span class=line>	<span class=keyword>and</span> (</span><br><span class=line>		(s.id <span class=operator>-</span> s2.id <span class=operator>=</span> <span class=number>1</span> <span class=keyword>and</span> s.id <span class=operator>-</span> s3.id <span class=operator>=</span> <span class=number>2</span> <span class=keyword>and</span> s2.id <span class=operator>-</span> s3.id <span class=operator>=</span> <span class=number>1</span>) <span class=keyword>or</span></span><br><span class=line>		(s2.id <span class=operator>-</span> s.id <span class=operator>=</span> <span class=number>1</span> <span class=keyword>and</span> s2.id <span class=operator>-</span> s3.id <span class=operator>=</span> <span class=number>2</span> <span class=keyword>and</span> s.id <span class=operator>-</span> s3.id <span class=operator>=</span> <span class=number>1</span>) <span class=keyword>or</span></span><br><span class=line>		(s3.id <span class=operator>-</span> s2.id <span class=operator>=</span> <span class=number>1</span> <span class=keyword>and</span> s2.id <span class=operator>-</span> s.id <span class=operator>=</span> <span class=number>1</span> <span class=keyword>and</span> s3.id <span class=operator>-</span> s.id <span class=operator>=</span> <span class=number>2</span>)</span><br><span class=line>	)</span><br><span class=line><span class=keyword>order</span> <span class=keyword>by</span> s.id</span><br><span class=line></span><br><span class=line># 解法<span class=number>3</span>：</span><br><span class=line><span class=keyword>with</span> t1 <span class=keyword>as</span> (</span><br><span class=line>	<span class=keyword>select</span></span><br><span class=line>		s.<span class=operator>*</span>,</span><br><span class=line>		s.id <span class=operator>-</span> <span class=built_in>ROW_NUMBER</span>() <span class=keyword>over</span>(<span class=keyword>order</span> <span class=keyword>by</span> s.id) <span class=keyword>as</span> "rn"</span><br><span class=line>	<span class=keyword>from</span> s3_stadium <span class=keyword>as</span> s</span><br><span class=line>	<span class=keyword>where</span> s.people <span class=operator>>=</span> <span class=number>100</span></span><br><span class=line>)</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	id,</span><br><span class=line>	visit_date,</span><br><span class=line>	people</span><br><span class=line><span class=keyword>from</span> t1</span><br><span class=line><span class=keyword>where</span> rn <span class=keyword>in</span> (</span><br><span class=line>	<span class=keyword>select</span> rn <span class=keyword>from</span> t1 <span class=keyword>group</span> <span class=keyword>by</span> rn <span class=keyword>having</span> <span class=built_in>count</span>(id) <span class=operator>>=</span> <span class=number>3</span></span><br><span class=line>)</span><br><span class=line></span><br><span class=line># 解法<span class=number>4</span>：</span><br><span class=line><span class=keyword>with</span> t1 <span class=keyword>as</span> (</span><br><span class=line>	<span class=keyword>select</span></span><br><span class=line>		s.<span class=operator>*</span>,</span><br><span class=line>		s.id <span class=operator>-</span> <span class=built_in>ROW_NUMBER</span>() <span class=keyword>over</span>(<span class=keyword>order</span> <span class=keyword>by</span> s.id) <span class=keyword>as</span> "rn"</span><br><span class=line>	<span class=keyword>from</span> s3_stadium <span class=keyword>as</span> s</span><br><span class=line>	<span class=keyword>where</span> s.people <span class=operator>>=</span> <span class=number>100</span></span><br><span class=line>)</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	o1.id,</span><br><span class=line>	o1.visit_date,</span><br><span class=line>	o1.people</span><br><span class=line><span class=keyword>from</span> (</span><br><span class=line>	<span class=keyword>select</span> <span class=operator>*</span>, <span class=built_in>count</span>(rn) <span class=keyword>over</span>(<span class=keyword>partition</span> <span class=keyword>by</span> rn) <span class=keyword>as</span> "pb" <span class=keyword>from</span> t1</span><br><span class=line>) <span class=keyword>as</span> o1</span><br><span class=line><span class=keyword>where</span> o1.pb <span class=operator>>=</span> <span class=number>3</span></span><br><span class=line><span class=keyword>order</span> <span class=keyword>by</span> o1.id</span><br></pre></table></figure><h2 id=1-24、-602-好友申请2：谁有最多的好友><a class=headerlink href=#1-24、-602-好友申请2：谁有最多的好友 title=1.24、(602)好友申请2：谁有最多的好友></a>1.24、(602)好友申请2：谁有最多的好友</h2><p>写一个查询语句，找出拥有最多的好友的人和他拥有的好友数目。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br></pre><td class=code><pre><span class=line>RequestAccepted 表：</span><br><span class=line><span class=operator>+</span><span class=comment>--------------+-------------+-------------+</span></span><br><span class=line><span class=operator>|</span> requester_id <span class=operator>|</span> accepter_id <span class=operator>|</span> accept_date <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>--------------+-------------+-------------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>            <span class=operator>|</span> <span class=number>2</span>           <span class=operator>|</span> <span class=number>2016</span><span class=operator>/</span><span class=number>06</span><span class=operator>/</span><span class=number>03</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>            <span class=operator>|</span> <span class=number>3</span>           <span class=operator>|</span> <span class=number>2016</span><span class=operator>/</span><span class=number>06</span><span class=operator>/</span><span class=number>08</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>            <span class=operator>|</span> <span class=number>3</span>           <span class=operator>|</span> <span class=number>2016</span><span class=operator>/</span><span class=number>06</span><span class=operator>/</span><span class=number>08</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>            <span class=operator>|</span> <span class=number>4</span>           <span class=operator>|</span> <span class=number>2016</span><span class=operator>/</span><span class=number>06</span><span class=operator>/</span><span class=number>09</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>--------------+-------------+-------------+</span></span><br><span class=line>输出：</span><br><span class=line><span class=operator>+</span><span class=comment>----+-----+</span></span><br><span class=line><span class=operator>|</span> id <span class=operator>|</span> num <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-----+</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>  <span class=operator>|</span> <span class=number>3</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----+-----+</span></span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>with</span> t1 <span class=keyword>as</span> (</span><br><span class=line>	<span class=keyword>select</span> <span class=operator>*</span></span><br><span class=line>	<span class=keyword>from</span> (</span><br><span class=line>		<span class=keyword>select</span> ra.requester_id</span><br><span class=line>		<span class=keyword>from</span> s3_requestaccepted <span class=keyword>as</span> ra</span><br><span class=line>		<span class=keyword>union</span> <span class=keyword>all</span></span><br><span class=line>		<span class=keyword>select</span> ra2.accepter_id</span><br><span class=line>		<span class=keyword>from</span> s3_requestaccepted <span class=keyword>as</span> ra2</span><br><span class=line>	) <span class=keyword>as</span> alldata</span><br><span class=line>)</span><br><span class=line><span class=keyword>select</span></span><br><span class=line>	requester_id,</span><br><span class=line>	<span class=built_in>count</span>(requester_id) <span class=keyword>as</span> "cn"</span><br><span class=line><span class=keyword>from</span> t1</span><br><span class=line><span class=keyword>group</span> <span class=keyword>by</span> requester_id</span><br><span class=line><span class=keyword>order</span> <span class=keyword>by</span> cn <span class=keyword>desc</span></span><br><span class=line>limit <span class=number>0</span>, <span class=number>1</span></span><br></pre></table></figure><h2 id=1-25、-607-销售员><a class=headerlink href=#1-25、-607-销售员 title=1.25、(607)销售员></a>1.25、(607)销售员</h2><p>查询没有任何与名为 “RED” 的公司相关的订单的所有销售人员的姓名。<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br></pre><td class=code><pre><span class=line>SalesPerson 表:</span><br><span class=line><span class=operator>+</span><span class=comment>----------+------+--------+-----------------+------------+</span></span><br><span class=line><span class=operator>|</span> sales_id <span class=operator>|</span> name <span class=operator>|</span> salary <span class=operator>|</span> commission_rate <span class=operator>|</span> hire_date  <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----------+------+--------+-----------------+------------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>        <span class=operator>|</span> John <span class=operator>|</span> <span class=number>100000</span> <span class=operator>|</span> <span class=number>6</span>               <span class=operator>|</span> <span class=number>4</span><span class=operator>/</span><span class=number>1</span><span class=operator>/</span><span class=number>2006</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>        <span class=operator>|</span> Amy  <span class=operator>|</span> <span class=number>12000</span>  <span class=operator>|</span> <span class=number>5</span>               <span class=operator>|</span> <span class=number>5</span><span class=operator>/</span><span class=number>1</span><span class=operator>/</span><span class=number>2010</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>        <span class=operator>|</span> Mark <span class=operator>|</span> <span class=number>65000</span>  <span class=operator>|</span> <span class=number>12</span>              <span class=operator>|</span> <span class=number>12</span><span class=operator>/</span><span class=number>25</span><span class=operator>/</span><span class=number>2008</span> <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>4</span>        <span class=operator>|</span> Pam  <span class=operator>|</span> <span class=number>25000</span>  <span class=operator>|</span> <span class=number>25</span>              <span class=operator>|</span> <span class=number>1</span><span class=operator>/</span><span class=number>1</span><span class=operator>/</span><span class=number>2005</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>5</span>        <span class=operator>|</span> Alex <span class=operator>|</span> <span class=number>5000</span>   <span class=operator>|</span> <span class=number>10</span>              <span class=operator>|</span> <span class=number>2</span><span class=operator>/</span><span class=number>3</span><span class=operator>/</span><span class=number>2007</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----------+------+--------+-----------------+------------+</span></span><br><span class=line>Company 表:</span><br><span class=line><span class=operator>+</span><span class=comment>--------+--------+----------+</span></span><br><span class=line><span class=operator>|</span> com_id <span class=operator>|</span> name   <span class=operator>|</span> city     <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>--------+--------+----------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>      <span class=operator>|</span> RED    <span class=operator>|</span> Boston   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>      <span class=operator>|</span> ORANGE <span class=operator>|</span> <span class=keyword>New</span> York <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>      <span class=operator>|</span> YELLOW <span class=operator>|</span> Boston   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>4</span>      <span class=operator>|</span> GREEN  <span class=operator>|</span> Austin   <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>--------+--------+----------+</span></span><br><span class=line>Orders 表:</span><br><span class=line><span class=operator>+</span><span class=comment>----------+------------+--------+----------+--------+</span></span><br><span class=line><span class=operator>|</span> order_id <span class=operator>|</span> order_date <span class=operator>|</span> com_id <span class=operator>|</span> sales_id <span class=operator>|</span> amount <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----------+------------+--------+----------+--------+</span></span><br><span class=line><span class=operator>|</span> <span class=number>1</span>        <span class=operator>|</span> <span class=number>1</span><span class=operator>/</span><span class=number>1</span><span class=operator>/</span><span class=number>2014</span>   <span class=operator>|</span> <span class=number>3</span>      <span class=operator>|</span> <span class=number>4</span>        <span class=operator>|</span> <span class=number>10000</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>2</span>        <span class=operator>|</span> <span class=number>2</span><span class=operator>/</span><span class=number>1</span><span class=operator>/</span><span class=number>2014</span>   <span class=operator>|</span> <span class=number>4</span>      <span class=operator>|</span> <span class=number>5</span>        <span class=operator>|</span> <span class=number>5000</span>   <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>3</span>        <span class=operator>|</span> <span class=number>3</span><span class=operator>/</span><span class=number>1</span><span class=operator>/</span><span class=number>2014</span>   <span class=operator>|</span> <span class=number>1</span>      <span class=operator>|</span> <span class=number>1</span>        <span class=operator>|</span> <span class=number>50000</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> <span class=number>4</span>        <span class=operator>|</span> <span class=number>4</span><span class=operator>/</span><span class=number>1</span><span class=operator>/</span><span class=number>2014</span>   <span class=operator>|</span> <span class=number>1</span>      <span class=operator>|</span> <span class=number>4</span>        <span class=operator>|</span> <span class=number>25000</span>  <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>----------+------------+--------+----------+--------+</span></span><br><span class=line>输出：</span><br><span class=line><span class=operator>+</span><span class=comment>------+</span></span><br><span class=line><span class=operator>|</span> name <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>------+</span></span><br><span class=line><span class=operator>|</span> Amy  <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> Mark <span class=operator>|</span></span><br><span class=line><span class=operator>|</span> Alex <span class=operator>|</span></span><br><span class=line><span class=operator>+</span><span class=comment>------+</span></span><br><span class=line></span><br><span class=line># 解法<span class=number>1</span>：</span><br><span class=line><span class=keyword>select</span> sp.name</span><br><span class=line><span class=keyword>from</span> SalesPerson <span class=keyword>as</span> sp</span><br><span class=line><span class=keyword>where</span> sp.sales_id <span class=keyword>not</span> <span class=keyword>in</span> (</span><br><span class=line>	<span class=keyword>select</span> o.sales_id</span><br><span class=line>	<span class=keyword>from</span> orders <span class=keyword>as</span> o</span><br><span class=line>	<span class=keyword>where</span> o.com_id <span class=keyword>in</span> (</span><br><span class=line>		<span class=keyword>select</span> c.com_id</span><br><span class=line>		<span class=keyword>from</span> company <span class=keyword>as</span> c</span><br><span class=line>		<span class=keyword>where</span> c.name <span class=operator>=</span> "RED"</span><br><span class=line>	)</span><br><span class=line>)</span><br></pre></table></figure></div><footer class=post-footer><div class=post-tags><a href=/tags/SQL%E7%BB%83%E4%B9%A0/ rel=tag># SQL练习</a><a href=/tags/MySQL%E7%BB%83%E4%B9%A0/ rel=tag># MySQL练习</a><a href=/tags/LeetcodeSQL/ rel=tag># LeetcodeSQL</a></div><div class=post-nav><div class=post-nav-item><a href=/2024/08/21/MySQL%E7%BB%8F%E5%85%B8SQL%E7%BB%83%E4%B9%A0%E9%A2%98%E7%AC%AC%E4%B8%80%E7%AF%87/ rel=prev title=MySQL系列-MySQL经典SQL练习题第一篇> <i class="fa fa-angle-left"></i> MySQL系列-MySQL经典SQL练习题第一篇 </a></div><div class=post-nav-item><a href=/2024/08/21/MySQL%E7%B2%BE%E9%80%9A%E8%B0%83%E4%BC%98/ rel=next title=MySQL系列-MySQL调优> MySQL系列-MySQL调优 <i class="fa fa-angle-right"></i> </a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>© <span itemprop=copyrightYear>2024</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>豪哥</span></div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label=返回顶部 class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script crossorigin=anonymous integrity=sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY= src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js></script><script src=/js/comments.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/sidebar.js></script><script src=/js/next-boot.js></script><script crossorigin=anonymous integrity=sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc= src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js></script><script src=/js/third-party/search/local-search.js></script>