<!doctypehtml><html lang=zh-CN><meta charset=UTF-8><meta content=width=device-width name=viewport><meta media="(prefers-color-scheme: light)" content=#222 name=theme-color><meta media="(prefers-color-scheme: dark)" content=#222 name=theme-color><meta content="Hexo 7.3.0" name=generator><link href=/images/apple-touch-icon-next.png rel=apple-touch-icon sizes=180x180><link href=/images/favicon-32x32-next.png rel=icon sizes=32x32 type=image/png><link href=/images/favicon-16x16-next.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><link href=/css/main.css rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css integrity=sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA= rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css integrity=sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE= rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"hgprivate.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src=/js/config.js></script><meta content="0、概述0.1、软件设计基本原则 高内聚，低耦合； 面向抽象编程； 多用组合少用继承； 遵循开闭原则；  0.2、设计模式简介设计模式是计算机软件领域较抽象的东西，设计模式的作用：使软件系统变得更加稳定、更易扩展、更易维护。 设计模式不分语言，共23种，分3种类型：创建型、行为型、结构型。 1、设计模式分类1.1、创建型（5种）1.1.1、Singleton（单例模式）简介保证一个类仅有一个实例，" name=description><meta content=article property=og:type><meta content=Java系列-设计模式 property=og:title><meta content=https://hgprivate.github.io/2024/10/12/Java%E4%B9%8B%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%9F%A5%E8%AF%86%E7%AF%87/index.html property=og:url><meta content=豪哥博客 property=og:site_name><meta content="0、概述0.1、软件设计基本原则 高内聚，低耦合； 面向抽象编程； 多用组合少用继承； 遵循开闭原则；  0.2、设计模式简介设计模式是计算机软件领域较抽象的东西，设计模式的作用：使软件系统变得更加稳定、更易扩展、更易维护。 设计模式不分语言，共23种，分3种类型：创建型、行为型、结构型。 1、设计模式分类1.1、创建型（5种）1.1.1、Singleton（单例模式）简介保证一个类仅有一个实例，" property=og:description><meta content=zh_CN property=og:locale><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/06/image-20210420203056818.png?token=AIGEF3L6P4ZSWPM3RWVOD3LEZZZVE property=og:image><meta content=2024-10-12T03:23:46.496Z property=article:published_time><meta content=2024-10-10T12:57:19.147Z property=article:modified_time><meta content=豪哥 property=article:author><meta content=设计模式 property=article:tag><meta content=summary name=twitter:card><meta content=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/06/image-20210420203056818.png?token=AIGEF3L6P4ZSWPM3RWVOD3LEZZZVE name=twitter:image><link href=https://hgprivate.github.io/2024/10/12/Java%E4%B9%8B%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%9F%A5%E8%AF%86%E7%AF%87/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://hgprivate.github.io/2024/10/12/Java%E4%B9%8B%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%9F%A5%E8%AF%86%E7%AF%87/","path":"2024/10/12/Java之设计模式知识篇/","title":"Java系列-设计模式"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>Java系列-设计模式 | 豪哥博客</title><noscript><link href=/css/noscript.css rel=stylesheet></noscript><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label=切换导航栏 class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <p class=site-title>豪哥博客</p> <i class=logo-line></i> </a><p class=site-subtitle itemprop=description>豪哥博客</div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=搜索 role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>分类</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>搜索 </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=搜索... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-1"><a class=nav-link href=#0%E3%80%81%E6%A6%82%E8%BF%B0><span class=nav-number>1.</span> <span class=nav-text>0、概述</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#0-1%E3%80%81%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1%E5%9F%BA%E6%9C%AC%E5%8E%9F%E5%88%99><span class=nav-number>1.1.</span> <span class=nav-text>0.1、软件设计基本原则</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#0-2%E3%80%81%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AE%80%E4%BB%8B><span class=nav-number>1.2.</span> <span class=nav-text>0.2、设计模式简介</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link href=#1%E3%80%81%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%88%86%E7%B1%BB><span class=nav-number>2.</span> <span class=nav-text>1、设计模式分类</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#1-1%E3%80%81%E5%88%9B%E5%BB%BA%E5%9E%8B%EF%BC%885%E7%A7%8D%EF%BC%89><span class=nav-number>2.1.</span> <span class=nav-text>1.1、创建型（5种）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#1-1-1%E3%80%81Singleton%EF%BC%88%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.1.1.</span> <span class=nav-text>1.1.1、Singleton（单例模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B><span class=nav-number>2.1.1.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9E%E7%8E%B0><span class=nav-number>2.1.1.2.</span> <span class=nav-text>实现</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8><span class=nav-number>2.1.1.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9><span class=nav-number>2.1.1.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B><span class=nav-number>2.1.1.5.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF><span class=nav-number>2.1.1.6.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9><span class=nav-number>2.1.1.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B><span class=nav-number>2.1.1.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-1-2%E3%80%81FactoryMethod%EF%BC%88%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%EF%BC%89><span class=nav-number>2.1.2.</span> <span class=nav-text>1.1.2、FactoryMethod（工厂方法）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-1><span class=nav-number>2.1.2.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84><span class=nav-number>2.1.2.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-1><span class=nav-number>2.1.2.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-1><span class=nav-number>2.1.2.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-1><span class=nav-number>2.1.2.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-1><span class=nav-number>2.1.2.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%BA%90%E7%A0%81%E5%BA%94%E7%94%A8><span class=nav-number>2.1.2.7.</span> <span class=nav-text>源码应用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-1><span class=nav-number>2.1.2.8.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-1><span class=nav-number>2.1.2.9.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-1-3%E3%80%81AbstractFactory%EF%BC%88%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%EF%BC%89><span class=nav-number>2.1.3.</span> <span class=nav-text>1.1.3、AbstractFactory（抽象工厂）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89><span class=nav-number>2.1.3.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-1><span class=nav-number>2.1.3.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-2><span class=nav-number>2.1.3.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-2><span class=nav-number>2.1.3.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-2><span class=nav-number>2.1.3.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-2><span class=nav-number>2.1.3.6.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#QA><span class=nav-number>2.1.3.7.</span> <span class=nav-text>QA</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-2><span class=nav-number>2.1.3.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-1-4%E3%80%81Builder%EF%BC%88%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.1.4.</span> <span class=nav-text>1.1.4、Builder（建造者模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%AE%80%E4%BB%8B-2><span class=nav-number>2.1.4.1.</span> <span class=nav-text>简介</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-2><span class=nav-number>2.1.4.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-3><span class=nav-number>2.1.4.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-3><span class=nav-number>2.1.4.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-3><span class=nav-number>2.1.4.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-2><span class=nav-number>2.1.4.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%BA%90%E7%A0%81%E5%BA%94%E7%94%A8-1><span class=nav-number>2.1.4.7.</span> <span class=nav-text>源码应用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-3><span class=nav-number>2.1.4.8.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-3><span class=nav-number>2.1.4.9.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-1-5%E3%80%81Prototype%EF%BC%88%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.1.5.</span> <span class=nav-text>1.1.5、Prototype（原型模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89-1><span class=nav-number>2.1.5.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-3><span class=nav-number>2.1.5.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-4><span class=nav-number>2.1.5.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-4><span class=nav-number>2.1.5.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-4><span class=nav-number>2.1.5.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-3><span class=nav-number>2.1.5.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%BA%90%E7%A0%81%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8><span class=nav-number>2.1.5.7.</span> <span class=nav-text>源码中的应用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-4><span class=nav-number>2.1.5.8.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-4><span class=nav-number>2.1.5.9.</span> <span class=nav-text>代码实例</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#1-2%E3%80%81%E8%A1%8C%E4%B8%BA%E5%9E%8B%EF%BC%8811%E7%A7%8D%EF%BC%89><span class=nav-number>2.2.</span> <span class=nav-text>1.2、行为型（11种）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-1%E3%80%81Iterator%EF%BC%88%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.1.</span> <span class=nav-text>1.2.1、Iterator（迭代器模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89-2><span class=nav-number>2.2.1.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-4><span class=nav-number>2.2.1.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-5><span class=nav-number>2.2.1.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9E%E7%8E%B0-1><span class=nav-number>2.2.1.4.</span> <span class=nav-text>实现</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-5><span class=nav-number>2.2.1.5.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-5><span class=nav-number>2.2.1.6.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-4><span class=nav-number>2.2.1.7.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-5><span class=nav-number>2.2.1.8.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-5><span class=nav-number>2.2.1.9.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-2%E3%80%81Observer%EF%BC%88%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.2.</span> <span class=nav-text>1.2.2、Observer（观察者模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89-3><span class=nav-number>2.2.2.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-5><span class=nav-number>2.2.2.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-6><span class=nav-number>2.2.2.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-6><span class=nav-number>2.2.2.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-6><span class=nav-number>2.2.2.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-5><span class=nav-number>2.2.2.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%BA%90%E7%A0%81%E5%BA%94%E7%94%A8-2><span class=nav-number>2.2.2.7.</span> <span class=nav-text>源码应用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-6><span class=nav-number>2.2.2.8.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-6><span class=nav-number>2.2.2.9.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-3%E3%80%81TemplateMethod%EF%BC%88%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%EF%BC%89><span class=nav-number>2.2.3.</span> <span class=nav-text>1.2.3、TemplateMethod（模板方法）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89-4><span class=nav-number>2.2.3.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-6><span class=nav-number>2.2.3.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-7><span class=nav-number>2.2.3.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-7><span class=nav-number>2.2.3.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-7><span class=nav-number>2.2.3.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-6><span class=nav-number>2.2.3.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-7><span class=nav-number>2.2.3.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-7><span class=nav-number>2.2.3.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-4%E3%80%81Strategy%EF%BC%88%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.4.</span> <span class=nav-text>1.2.4、Strategy（策略模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89-5><span class=nav-number>2.2.4.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-7><span class=nav-number>2.2.4.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-8><span class=nav-number>2.2.4.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-8><span class=nav-number>2.2.4.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-8><span class=nav-number>2.2.4.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-7><span class=nav-number>2.2.4.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-8><span class=nav-number>2.2.4.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-8><span class=nav-number>2.2.4.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-5%E3%80%81ChainOfResponsibility%EF%BC%88%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.5.</span> <span class=nav-text>1.2.5、ChainOfResponsibility（职责链模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89-6><span class=nav-number>2.2.5.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-8><span class=nav-number>2.2.5.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-9><span class=nav-number>2.2.5.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-9><span class=nav-number>2.2.5.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-9><span class=nav-number>2.2.5.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-8><span class=nav-number>2.2.5.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%BA%90%E7%A0%81%E5%BA%94%E7%94%A8-3><span class=nav-number>2.2.5.7.</span> <span class=nav-text>源码应用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-9><span class=nav-number>2.2.5.8.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-9><span class=nav-number>2.2.5.9.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-6%E3%80%81Mediator%EF%BC%88%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.6.</span> <span class=nav-text>1.2.6、Mediator（中介者模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89-7><span class=nav-number>2.2.6.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-9><span class=nav-number>2.2.6.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-10><span class=nav-number>2.2.6.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-10><span class=nav-number>2.2.6.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-10><span class=nav-number>2.2.6.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-9><span class=nav-number>2.2.6.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-10><span class=nav-number>2.2.6.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-10><span class=nav-number>2.2.6.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-7%E3%80%81Interpreter%EF%BC%88%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.7.</span> <span class=nav-text>1.2.7、Interpreter（解释器模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89-8><span class=nav-number>2.2.7.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-10><span class=nav-number>2.2.7.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-11><span class=nav-number>2.2.7.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-11><span class=nav-number>2.2.7.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-11><span class=nav-number>2.2.7.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-10><span class=nav-number>2.2.7.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-11><span class=nav-number>2.2.7.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-11><span class=nav-number>2.2.7.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-8%E3%80%81Command%EF%BC%88%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.8.</span> <span class=nav-text>1.2.8、Command（命令模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89-9><span class=nav-number>2.2.8.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-11><span class=nav-number>2.2.8.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-12><span class=nav-number>2.2.8.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-12><span class=nav-number>2.2.8.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-12><span class=nav-number>2.2.8.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-11><span class=nav-number>2.2.8.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-12><span class=nav-number>2.2.8.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-12><span class=nav-number>2.2.8.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-9%E3%80%81State%EF%BC%88%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.9.</span> <span class=nav-text>1.2.9、State（状态模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89-10><span class=nav-number>2.2.9.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-12><span class=nav-number>2.2.9.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-13><span class=nav-number>2.2.9.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-13><span class=nav-number>2.2.9.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-13><span class=nav-number>2.2.9.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-12><span class=nav-number>2.2.9.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-13><span class=nav-number>2.2.9.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-13><span class=nav-number>2.2.9.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-10%E3%80%81Visitor%EF%BC%88%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.10.</span> <span class=nav-text>1.2.10、Visitor（访问者模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89-11><span class=nav-number>2.2.10.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-13><span class=nav-number>2.2.10.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-14><span class=nav-number>2.2.10.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-14><span class=nav-number>2.2.10.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-14><span class=nav-number>2.2.10.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-13><span class=nav-number>2.2.10.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-14><span class=nav-number>2.2.10.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-14><span class=nav-number>2.2.10.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-2-11%E3%80%81Memento%EF%BC%88%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.2.11.</span> <span class=nav-text>1.2.11、Memento（备忘录模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89-12><span class=nav-number>2.2.11.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-14><span class=nav-number>2.2.11.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-15><span class=nav-number>2.2.11.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-15><span class=nav-number>2.2.11.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-15><span class=nav-number>2.2.11.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-14><span class=nav-number>2.2.11.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-15><span class=nav-number>2.2.11.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-15><span class=nav-number>2.2.11.8.</span> <span class=nav-text>代码实例</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#1-3%E3%80%81%E7%BB%93%E6%9E%84%E5%9E%8B%EF%BC%887%E7%A7%8D%EF%BC%89><span class=nav-number>2.3.</span> <span class=nav-text>1.3、结构型（7种）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#1-3-1%E3%80%81Composite%EF%BC%88%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.3.1.</span> <span class=nav-text>1.3.1、Composite（组合模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89-13><span class=nav-number>2.3.1.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-15><span class=nav-number>2.3.1.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-16><span class=nav-number>2.3.1.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-16><span class=nav-number>2.3.1.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-16><span class=nav-number>2.3.1.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-15><span class=nav-number>2.3.1.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-16><span class=nav-number>2.3.1.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-16><span class=nav-number>2.3.1.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-3-2%E3%80%81Facade%EF%BC%88%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.3.2.</span> <span class=nav-text>1.3.2、Facade（外观模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89-14><span class=nav-number>2.3.2.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-16><span class=nav-number>2.3.2.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-17><span class=nav-number>2.3.2.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-17><span class=nav-number>2.3.2.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-17><span class=nav-number>2.3.2.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-16><span class=nav-number>2.3.2.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-17><span class=nav-number>2.3.2.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-17><span class=nav-number>2.3.2.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-3-3%E3%80%81Proxy%EF%BC%88%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.3.3.</span> <span class=nav-text>1.3.3、Proxy（代理模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89-15><span class=nav-number>2.3.3.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9E%E7%8E%B0-2><span class=nav-number>2.3.3.2.</span> <span class=nav-text>实现</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-18><span class=nav-number>2.3.3.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-18><span class=nav-number>2.3.3.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-18><span class=nav-number>2.3.3.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-17><span class=nav-number>2.3.3.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-18><span class=nav-number>2.3.3.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-18><span class=nav-number>2.3.3.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-3-4%E3%80%81Adpter%EF%BC%88%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.3.4.</span> <span class=nav-text>1.3.4、Adpter（适配器模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89-16><span class=nav-number>2.3.4.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-17><span class=nav-number>2.3.4.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9E%E7%8E%B0-3><span class=nav-number>2.3.4.3.</span> <span class=nav-text>实现</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-19><span class=nav-number>2.3.4.4.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-19><span class=nav-number>2.3.4.5.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-19><span class=nav-number>2.3.4.6.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-18><span class=nav-number>2.3.4.7.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%BA%90%E7%A0%81%E5%BA%94%E7%94%A8-4><span class=nav-number>2.3.4.8.</span> <span class=nav-text>源码应用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-19><span class=nav-number>2.3.4.9.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-19><span class=nav-number>2.3.4.10.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-3-5%E3%80%81Decorator%EF%BC%88%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.3.5.</span> <span class=nav-text>1.3.5、Decorator（装饰模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89-17><span class=nav-number>2.3.5.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-18><span class=nav-number>2.3.5.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-20><span class=nav-number>2.3.5.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-20><span class=nav-number>2.3.5.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-20><span class=nav-number>2.3.5.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-19><span class=nav-number>2.3.5.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%BA%90%E7%A0%81%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8-1><span class=nav-number>2.3.5.7.</span> <span class=nav-text>源码中的应用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-20><span class=nav-number>2.3.5.8.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-20><span class=nav-number>2.3.5.9.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-3-6%E3%80%81Bridge%EF%BC%88%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.3.6.</span> <span class=nav-text>1.3.6、Bridge（桥接模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89-18><span class=nav-number>2.3.6.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-19><span class=nav-number>2.3.6.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-21><span class=nav-number>2.3.6.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-21><span class=nav-number>2.3.6.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-21><span class=nav-number>2.3.6.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-20><span class=nav-number>2.3.6.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-21><span class=nav-number>2.3.6.7.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-21><span class=nav-number>2.3.6.8.</span> <span class=nav-text>代码实例</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#1-3-7%E3%80%81Flyweight%EF%BC%88%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F%EF%BC%89><span class=nav-number>2.3.7.</span> <span class=nav-text>1.3.7、Flyweight（享元模式）</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9A%E4%B9%89-19><span class=nav-number>2.3.7.1.</span> <span class=nav-text>定义</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%BB%93%E6%9E%84-20><span class=nav-number>2.3.7.2.</span> <span class=nav-text>结构</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-22><span class=nav-number>2.3.7.3.</span> <span class=nav-text>何时使用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BC%98%E7%BC%BA%E7%82%B9-22><span class=nav-number>2.3.7.4.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-22><span class=nav-number>2.3.7.5.</span> <span class=nav-text>使用场景</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B-21><span class=nav-number>2.3.7.6.</span> <span class=nav-text>应用实例</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%BA%90%E7%A0%81%E5%BA%94%E7%94%A8-5><span class=nav-number>2.3.7.7.</span> <span class=nav-text>源码应用</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-22><span class=nav-number>2.3.7.8.</span> <span class=nav-text>注意事项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B-22><span class=nav-number>2.3.7.9.</span> <span class=nav-text>代码实例</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#1-4%E3%80%81%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB><span class=nav-number>2.4.</span> <span class=nav-text>1.4、设计模式间的关系</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link href=#2%E3%80%81%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%8E%9F%E5%88%99><span class=nav-number>3.</span> <span class=nav-text>2、设计模式原则</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#2-1%E3%80%81%E5%BC%80%E9%97%AD%E5%8E%9F%E5%88%99%EF%BC%88OCP%EF%BC%89><span class=nav-number>3.1.</span> <span class=nav-text>2.1、开闭原则（OCP）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#2-1-1%E3%80%81%E7%AE%80%E4%BB%8B><span class=nav-number>3.1.1.</span> <span class=nav-text>2.1.1、简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#2-1-2%E3%80%81%E5%88%86%E7%B1%BB><span class=nav-number>3.1.2.</span> <span class=nav-text>2.1.2、分类</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#2-2%E3%80%81%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E5%8E%9F%E5%88%99%EF%BC%88SRP%EF%BC%89><span class=nav-number>3.2.</span> <span class=nav-text>2.2、单一职责原则（SRP）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#2-2-1%E3%80%81%E7%AE%80%E4%BB%8B><span class=nav-number>3.2.1.</span> <span class=nav-text>2.2.1、简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#2-2-2%E3%80%81%E9%97%AE%E9%A2%98%E7%94%B1%E6%9D%A5><span class=nav-number>3.2.2.</span> <span class=nav-text>2.2.2、问题由来</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#2-2-3%E3%80%81%E4%BA%A7%E7%94%9F%E5%8E%9F%E5%9B%A0><span class=nav-number>3.2.3.</span> <span class=nav-text>2.2.3、产生原因</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#2-2-4%E3%80%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95><span class=nav-number>3.2.4.</span> <span class=nav-text>2.2.4、解决方法</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#2-3%E3%80%81%E4%BE%9D%E8%B5%96%E5%80%92%E7%BD%AE%E5%8E%9F%E5%88%99%EF%BC%88DIP%EF%BC%89><span class=nav-number>3.3.</span> <span class=nav-text>2.3、依赖倒置原则（DIP）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#2-3-1%E3%80%81%E7%AE%80%E4%BB%8B><span class=nav-number>3.3.1.</span> <span class=nav-text>2.3.1、简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#2-3-2%E3%80%81%E6%84%8F%E5%9B%BE><span class=nav-number>3.3.2.</span> <span class=nav-text>2.3.2、意图</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#2-3-3%E3%80%81%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9><span class=nav-number>3.3.3.</span> <span class=nav-text>2.3.3、注意事项</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#2-4%E3%80%81%E6%8E%A5%E5%8F%A3%E9%9A%94%E7%A6%BB%E5%8E%9F%E5%88%99%EF%BC%88ISP%EF%BC%89><span class=nav-number>3.4.</span> <span class=nav-text>2.4、接口隔离原则（ISP）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#2-4-1%E3%80%81%E7%AE%80%E4%BB%8B><span class=nav-number>3.4.1.</span> <span class=nav-text>2.4.1、简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#2-4-2%E3%80%81%E4%BC%98%E7%82%B9><span class=nav-number>3.4.2.</span> <span class=nav-text>2.4.2、优点</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#2-5%E3%80%81%E9%87%8C%E6%B0%8F%E6%9B%BF%E6%8D%A2%E5%8E%9F%E5%88%99%EF%BC%88LSP%EF%BC%89><span class=nav-number>3.5.</span> <span class=nav-text>2.5、里氏替换原则（LSP）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#2-5-1%E3%80%81%E7%AE%80%E4%BB%8B><span class=nav-number>3.5.1.</span> <span class=nav-text>2.5.1、简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#2-5-2%E3%80%81%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9><span class=nav-number>3.5.2.</span> <span class=nav-text>2.5.2、注意事项</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#2-6%E3%80%81%E8%BF%AA%E7%B1%B3%E7%89%B9%E5%8E%9F%E5%88%99%EF%BC%88LOD%EF%BC%89><span class=nav-number>3.6.</span> <span class=nav-text>2.6、迪米特原则（LOD）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#2-6-1%E3%80%81%E7%AE%80%E4%BB%8B><span class=nav-number>3.6.1.</span> <span class=nav-text>2.6.1、简介</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#2-7%E3%80%81%E5%90%88%E6%88%90%E5%A4%8D%E7%94%A8%E5%8E%9F%E5%88%99%EF%BC%88CRP%EF%BC%89><span class=nav-number>3.7.</span> <span class=nav-text>2.7、合成复用原则（CRP）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#2-7-1%E3%80%81%E7%AE%80%E4%BB%8B><span class=nav-number>3.7.1.</span> <span class=nav-text>2.7.1、简介</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#2-7-2%E3%80%81%E4%BC%98%E7%82%B9><span class=nav-number>3.7.2.</span> <span class=nav-text>2.7.2、优点</span></a></ol></ol></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><img alt=豪哥 class=site-author-image itemprop=image src=/static/imgs/avatar.png><p class=site-author-name itemprop=name>豪哥<div class=site-description itemprop=description>豪哥博客</div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>116</span> <span class=site-state-item-name>日志</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>36</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/> <span class=site-state-item-count>129</span> <span class=site-state-item-name>标签</span></a></div></nav></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article lang=zh-CN><link href=https://hgprivate.github.io/2024/10/12/Java%E4%B9%8B%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%9F%A5%E8%AF%86%E7%AF%87/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/static/imgs/avatar.png itemprop=image> <meta content=豪哥 itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=豪哥博客 itemprop=name> <meta content=豪哥博客 itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="Java系列-设计模式 | 豪哥博客" itemprop=name> <meta itemprop=description> </span><header class=post-header><h1 itemprop="name headline" class=post-title>Java系列-设计模式</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2024-10-12 11:23:46" datetime=2024-10-12T11:23:46+08:00>2024-10-12</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2024-10-10 20:57:19" datetime=2024-10-10T20:57:19+08:00 itemprop=dateModified>2024-10-10</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/ itemprop=url rel=index><span itemprop=name>设计模式</span></a> </span> </span></div></div></header><div class=post-body itemprop=articleBody><h1 id=0、概述><a class=headerlink href=#0、概述 title=0、概述></a>0、概述</h1><h2 id=0-1、软件设计基本原则><a class=headerlink href=#0-1、软件设计基本原则 title=0.1、软件设计基本原则></a>0.1、软件设计基本原则</h2><ol><li>高内聚，低耦合；<li>面向抽象编程；<li>多用组合少用继承；<li>遵循开闭原则；</ol><h2 id=0-2、设计模式简介><a class=headerlink href=#0-2、设计模式简介 title=0.2、设计模式简介></a>0.2、设计模式简介</h2><p>设计模式是计算机软件领域较抽象的东西，设计模式的作用：使软件系统变得更加稳定、更易扩展、更易维护。<p><strong>设计模式不分语言，共23种，分3种类型：创建型、行为型、结构型</strong>。<h1 id=1、设计模式分类><a class=headerlink href=#1、设计模式分类 title=1、设计模式分类></a>1、设计模式分类</h1><h2 id=1-1、创建型（5种）><a class=headerlink href=#1-1、创建型（5种） title=1.1、创建型（5种）></a>1.1、创建型（5种）</h2><h3 id=1-1-1、Singleton（单例模式）><a class=headerlink href=#1-1-1、Singleton（单例模式） title=1.1.1、Singleton（单例模式）></a>1.1.1、Singleton（单例模式）</h3><h4 id=简介><a class=headerlink href=#简介 title=简介></a>简介</h4><p><strong>保证一个类仅有一个实例，并提供一个访问它的全局访问点。常见单例模式实现有：饿汉式、懒汉式、枚举式等</strong>。<h4 id=实现><a class=headerlink href=#实现 title=实现></a>实现</h4><ol><li>构造方法设为私有，禁止它人创建对象。</ol><h4 id=何时使用><a class=headerlink href=#何时使用 title=何时使用></a>何时使用</h4><p>当您想控制实例数目，节省系统资源的时候。<h4 id=优缺点><a class=headerlink href=#优缺点 title=优缺点></a>优缺点</h4><ul><li><p>优点：</p> <ol><li>在内存里只有一个实例，减少了内存的开销，尤其是频繁的创建和销毁实例（比如管理学院首页页面缓存）。<li>避免对资源的多重占用（比如写文件操作）。</ol><li><p>缺点：</p> <p>没有接口，不能继承，与单一职责原则冲突，一个类应该只关心内部逻辑，而不关心外面怎么样来实例化。</p></ul><h4 id=应用实例><a class=headerlink href=#应用实例 title=应用实例></a>应用实例</h4><ol><li>一个班级只有一个班主任。<li>Windows 是多进程多线程的，在操作一个文件的时候，就不可避免地出现多个进程或线程同时操作一个文件的现象，所以所有文件的处理必须通过唯一的实例来进行。<li>一些设备管理器常常设计为单例模式，比如一个电脑有两台打印机，在输出的时候就要处理不能两台打印机打印同一个文件。</ol><h4 id=使用场景><a class=headerlink href=#使用场景 title=使用场景></a>使用场景</h4><ol><li>要求生产唯一序列号。<li>WEB 中的计数器，不用每次刷新都在数据库里加一次，用单例先缓存起来。<li>创建一个对象消耗资源过多时可通过单例降低多次创建带来的消耗，比如 I/O 与数据库的连接等。</ol><h4 id=注意事项><a class=headerlink href=#注意事项 title=注意事项></a>注意事项</h4><ol><li><font color=red>注意序列化对单例的破坏；</font><li><font color=red>注意反射对单例的破坏；</font></ol><h4 id=代码实例><a class=headerlink href=#代码实例 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br></pre><td class=code><pre><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 实例一：基于双重校验锁方式实现单例</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * - 优点：懒加载，效率较好。</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * - 缺点：反序列化会对单例造成破坏</span></span><br><span class=line><span class=comment> *   应对方案：要想防止序列化对单例的破坏，只要添加readResolve方法就可避免。</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Singleton</span> <span class=keyword>implements</span> <span class="title class_">Serializable</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>volatile</span> <span class=keyword>static</span> Singleton singleton;</span><br><span class=line>    <span class=keyword>private</span> <span class="title function_">Singleton</span> <span class=params>()</span>{}</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> Singleton <span class="title function_">getSingleton</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>if</span> (singleton == <span class=literal>null</span>) {</span><br><span class=line>            <span class=keyword>synchronized</span> (Singleton.class) {</span><br><span class=line>                <span class=keyword>if</span> (singleton == <span class=literal>null</span>) {</span><br><span class=line>                    singleton = <span class=keyword>new</span> <span class="title class_">Singleton</span>();</span><br><span class=line>                }</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> singleton;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>private</span> Object <span class="title function_">readResolve</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> singleton;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 实例二：基于 CAS 实现单例</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * - 优点：</span></span><br><span class=line><span class=comment> *   - 不需要使用传统的锁机制来保证线程安全；</span></span><br><span class=line><span class=comment> *   - 相对于锁它没有线程切换和阻塞的额外消耗,可以支持较大的并行度；</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * - 缺点：</span></span><br><span class=line><span class=comment> *   - 如果等待一直执行不成功(一直在死循环中)，会对CPU造成较大的执行开销；</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">SingletonByCAS</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>static</span> <span class=keyword>final</span> AtomicReference&LTSingletonByCAS> INSTANCE = <span class=keyword>new</span> <span class="title class_">AtomicReference</span>&LTSingletonByCAS>();</span><br><span class=line>    <span class=keyword>private</span> <span class="title function_">SingletonByCAS</span><span class=params>()</span>{}</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> SingletonByCAS <span class="title function_">getInstance</span><span class=params>()</span>{</span><br><span class=line>        <span class=keyword>for</span> (;;){</span><br><span class=line>            <span class=type>SingletonByCAS</span> <span class=variable>single</span> <span class=operator>=</span> INSTANCE.get();</span><br><span class=line>            <span class=keyword>if</span> (<span class=literal>null</span> != single){</span><br><span class=line>                <span class=keyword>return</span> single;</span><br><span class=line>            }</span><br><span class=line>            single = <span class=keyword>new</span> <span class="title class_">SingletonByCAS</span>();</span><br><span class=line>            <span class=keyword>if</span> (INSTANCE.compareAndSet(<span class=literal>null</span>, single)){</span><br><span class=line>                <span class=keyword>return</span> single;</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 实例三：基于 枚举 实现单例</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>enum</span> <span class="title class_">SingletonByEnum</span> {</span><br><span class=line>    INSTANCE;</span><br><span class=line>    <span class=comment>// 其它方法</span></span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 实例四：基于双重校验锁方式实现单例（优化版）</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * - 优点：懒加载，利用局部变量提高效率；</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * - 缺点：反序列化会对单例造成破坏</span></span><br><span class=line><span class=comment> *   应对方案：要想防止序列化对单例的破坏，只要添加readResolve方法就可避免。</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">SingletonByLocalVariable</span> <span class=keyword>implements</span> <span class="title class_">Serializable</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>volatile</span> <span class=keyword>static</span> SingletonByLocalVariable singleton;</span><br><span class=line>    <span class=keyword>private</span> <span class="title function_">SingletonByLocalVariable</span><span class=params>()</span>{}</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> SingletonByLocalVariable <span class="title function_">getSingleton</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>SingletonByLocalVariable</span> <span class=variable>tmp</span> <span class=operator>=</span> singleton;</span><br><span class=line>        <span class=keyword>if</span> (tmp == <span class=literal>null</span>) {</span><br><span class=line>            <span class=keyword>synchronized</span> (SingletonByLocalVariable.class) {</span><br><span class=line>                tmp = singleton;</span><br><span class=line>                <span class=keyword>if</span> (tmp == <span class=literal>null</span>) {</span><br><span class=line>                    tmp = <span class=keyword>new</span> <span class="title class_">SingletonByLocalVariable</span>();</span><br><span class=line>                    singleton = tmp;</span><br><span class=line>                }</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> singleton;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>private</span> Object <span class="title function_">readResolve</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> singleton;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 实例五：基于静态内部类实现单例</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * - 原理：利用了classloder的机制来保证初始化instance时只有一个线程。</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * - 优点：这是一种懒加载，也即Singleton类被装载了，但instance不一定被初始化。</span></span><br><span class=line><span class=comment> *        因为SingletonHolder类没有被主动使用，只有显式调用getInstance方法时，</span></span><br><span class=line><span class=comment> *        才会装载SingletonHolder类，进而实例化instance。</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">SingletonByStaticInnerClass</span> {</span><br><span class=line>    <span class=comment>// 私有构造，禁止通过new创建对象。</span></span><br><span class=line>    <span class=keyword>private</span> <span class="title function_">SingletonByStaticInnerClass</span><span class=params>()</span>{</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>static</span> <span class=keyword>class</span> <span class="title class_">SingletonHholder</span>{</span><br><span class=line>        <span class=keyword>private</span> <span class=keyword>static</span> <span class=keyword>final</span> <span class=type>SingletonByStaticInnerClass</span> <span class=variable>INSTANCE</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">SingletonByStaticInnerClass</span>();</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>final</span> SingletonByStaticInnerClass <span class="title function_">getInstance</span><span class=params>()</span>{</span><br><span class=line>        <span class=keyword>return</span> SingletonHholder.INSTANCE;</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-1-2、FactoryMethod（工厂方法）><a class=headerlink href=#1-1-2、FactoryMethod（工厂方法） title=1.1.2、FactoryMethod（工厂方法）></a>1.1.2、FactoryMethod（工厂方法）</h3><h4 id=简介-1><a class=headerlink href=#简介-1 title=简介></a>简介</h4><p><strong>定义一个用于创建对象的接口，让子类决定实例化哪一个类。该模式将对象的创建延迟到了子类中</strong>。<h4 id=结构><a class=headerlink href=#结构 title=结构></a>结构</h4><ul><li>抽象工厂：声明了工厂方法，但没有实现。<li>具体工厂：实现工厂方法，返回一个具体产品。<li>抽象产品：产品接口。<li>具体产品：实现具体的产品。</ul><h4 id=何时使用-1><a class=headerlink href=#何时使用-1 title=何时使用></a>何时使用</h4><p>需要在不同的条件下创建不同实例，以满足不同的需求。<h4 id=优缺点-1><a class=headerlink href=#优缺点-1 title=优缺点></a>优缺点</h4><ul><li><p>优点</p> <ol><li>将具体产品和创建者解耦。<li>符合单一职责原则。<li>符合开闭原则。</ol><li><p>缺点</p> <p>每增加一个产品时，需要增加一个具体产品类和产品对应的工厂，使得系统中类的个数成倍增加，一定程度上增加了系统的复杂度，同时也增加了系统具体类的依赖。</p></ul><h4 id=使用场景-1><a class=headerlink href=#使用场景-1 title=使用场景></a>使用场景</h4><ol><li>日志记录器：记录可能记录到本地硬盘、系统事件、远程服务器等，用户可以选择记录日志到什么地方。<li>数据库访问，当用户不知道最后系统采用哪一类数据库，以及数据库可能有变化时。<li>设计一个连接服务器的框架，需要三个协议，”POP3”、”IMAP”、”HTTP”，可以把这三个作为产品类，共同实现一个接口。</ol><h4 id=应用实例-1><a class=headerlink href=#应用实例-1 title=应用实例></a>应用实例</h4><ol><li>您需要一辆汽车，可以直接从工厂里面提货，而不用去管这辆汽车是如何生产出来的。<li>Hibernate 换数据库只需换驱动就可以。</ol><h4 id=源码应用><a class=headerlink href=#源码应用 title=源码应用></a>源码应用</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line>Calendar.getInstance();</span><br><span class=line>java.text.NumberFormat.getInstance();</span><br><span class=line>java.util.ResourceBundle.getBundle();</span><br><span class=line></span><br><span class=line>java.net.URLStreamHandlerFactory</span><br><span class=line>java.xml.bind.JAXBContext.createMarshaller</span><br></pre></table></figure><h4 id=注意事项-1><a class=headerlink href=#注意事项-1 title=注意事项></a>注意事项</h4><p><font color=red>在任何需要生成复杂对象的地方，都可以使用工厂方法模式。有一点需要注意：复杂对象适合使用工厂模式，而简单对象不适合。</font><h4 id=代码实例-1><a class=headerlink href=#代码实例-1 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br></pre><td class=code><pre><span class=line><span class=comment>// 抽象产品类</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">Chair</span> {</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">sitOn</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体产品类 1</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">ModernChair</span> <span class=keyword>implements</span> <span class="title class_">Chair</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">sitOn</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Sitting on a modern chair."</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体产品类 2</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">VictorianChair</span> <span class=keyword>implements</span> <span class="title class_">Chair</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">sitOn</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Sitting on a victorian chair."</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 抽象工厂类</span></span><br><span class=line><span class=keyword>abstract</span> <span class=keyword>class</span> <span class="title class_">ChairFactory</span> {</span><br><span class=line>    <span class=comment>// 工厂方法</span></span><br><span class=line>    <span class=keyword>abstract</span> Chair <span class="title function_">createChair</span><span class=params>()</span>;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">sit</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>Chair</span> <span class=variable>chair</span> <span class=operator>=</span> createChair();</span><br><span class=line>        chair.sitOn();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体工厂类 1</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">ModernChairFactory</span> <span class=keyword>extends</span> <span class="title class_">ChairFactory</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Chair <span class="title function_">createChair</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModernChair</span>();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体工厂类 2</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">VictorianChairFactory</span> <span class=keyword>extends</span> <span class="title class_">ChairFactory</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Chair <span class="title function_">createChair</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">VictorianChair</span>();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Main</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=comment>// 创建现代风格椅子的工厂</span></span><br><span class=line>        <span class=type>ChairFactory</span> <span class=variable>modernFactory</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ModernChairFactory</span>();</span><br><span class=line>        modernFactory.sit();  <span class=comment>// 输出: Sitting on a modern chair.</span></span><br><span class=line></span><br><span class=line>        <span class=comment>// 创建维多利亚风格椅子的工厂</span></span><br><span class=line>        <span class=type>ChairFactory</span> <span class=variable>victorianFactory</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">VictorianChairFactory</span>();</span><br><span class=line>        victorianFactory.sit();  <span class=comment>// 输出: Sitting on a victorian chair.</span></span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-1-3、AbstractFactory（抽象工厂）><a class=headerlink href=#1-1-3、AbstractFactory（抽象工厂） title=1.1.3、AbstractFactory（抽象工厂）></a>1.1.3、AbstractFactory（抽象工厂）</h3><h4 id=定义><a class=headerlink href=#定义 title=定义></a>定义</h4><p>抽象工厂模式提供了一种创建一系列相关或相互依赖对象的接口，而不需要指定它们的具体类。换句话说，它就像是工厂的工厂，用于创建一系列产品（对象）。<h4 id=结构-1><a class=headerlink href=#结构-1 title=结构></a>结构</h4><ul><li>抽象工厂：声明用于创建一组对象的接口。<li>具体工厂：实现接口，返回一组相关的具体产品。<li>抽象产品：每个产品族中的产品都有一个抽象接口。<li>具体产品：实现具体的产品。</ul><h4 id=何时使用-2><a class=headerlink href=#何时使用-2 title=何时使用></a>何时使用</h4><p>系统产品有多于一个的产品族，而系统只消费其中某一族的产品。<h4 id=优缺点-2><a class=headerlink href=#优缺点-2 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>可以实现从工厂得到的产品彼此兼容。<li>可以避免具体产品和客户端代码之间的紧密耦合。<li>符合单一职责原则。<li>符合开闭原则。</ol><li>缺点<ol><li>产品族扩展非常困难，要增加一个系列的某一产品，既要在抽象的 Creator 里加代码，又要在具体实现中加代码。</ol></ul><h4 id=使用场景-2><a class=headerlink href=#使用场景-2 title=使用场景></a>使用场景</h4><ol><li>QQ 换皮肤，一整套一起换。<li>生成不同操作系统对应的程序。</ol><h4 id=注意事项-2><a class=headerlink href=#注意事项-2 title=注意事项></a>注意事项</h4><p>产品族难扩展，产品等级易扩展。<h4 id=QA><a class=headerlink href=#QA title=QA></a>QA</h4><ol><li><p>为何还需要工厂?</p> <ol><li>灵活控制生产过程。<li>权限、修饰、日志等。</ol></ol><h4 id=代码实例-2><a class=headerlink href=#代码实例-2 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br></pre><td class=code><pre><span class=line><span class=comment>// 抽象产品类 1</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">Chair</span> {</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">sitOn</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 抽象产品类 2</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">Table</span> {</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">use</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体产品类 1 - 现代风格的椅子</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">ModernChair</span> <span class=keyword>implements</span> <span class="title class_">Chair</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">sitOn</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Sitting on a modern chair."</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体产品类 2 - 现代风格的桌子</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">ModernTable</span> <span class=keyword>implements</span> <span class="title class_">Table</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">use</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Using a modern table."</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体产品类 3 - 维多利亚风格的椅子</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">VictorianChair</span> <span class=keyword>implements</span> <span class="title class_">Chair</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">sitOn</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Sitting on a victorian chair."</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体产品类 4 - 维多利亚风格的桌子</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">VictorianTable</span> <span class=keyword>implements</span> <span class="title class_">Table</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">use</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Using a victorian table."</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 抽象工厂类</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">FurnitureFactory</span> {</span><br><span class=line>    Chair <span class="title function_">createChair</span><span class=params>()</span>;</span><br><span class=line>    Table <span class="title function_">createTable</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体工厂类 1 - 现代风格家具工厂</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">ModernFurnitureFactory</span> <span class=keyword>implements</span> <span class="title class_">FurnitureFactory</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Chair <span class="title function_">createChair</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModernChair</span>();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Table <span class="title function_">createTable</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModernTable</span>();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体工厂类 2 - 维多利亚风格家具工厂</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">VictorianFurnitureFactory</span> <span class=keyword>implements</span> <span class="title class_">FurnitureFactory</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Chair <span class="title function_">createChair</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">VictorianChair</span>();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Table <span class="title function_">createTable</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">VictorianTable</span>();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Main</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=comment>// 创建现代风格的家具工厂</span></span><br><span class=line>        <span class=type>FurnitureFactory</span> <span class=variable>modernFactory</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ModernFurnitureFactory</span>();</span><br><span class=line>        <span class=type>Chair</span> <span class=variable>modernChair</span> <span class=operator>=</span> modernFactory.createChair();</span><br><span class=line>        <span class=type>Table</span> <span class=variable>modernTable</span> <span class=operator>=</span> modernFactory.createTable();</span><br><span class=line></span><br><span class=line>        modernChair.sitOn();  <span class=comment>// 输出: Sitting on a modern chair.</span></span><br><span class=line>        modernTable.use();    <span class=comment>// 输出: Using a modern table.</span></span><br><span class=line></span><br><span class=line>        <span class=comment>// 创建维多利亚风格的家具工厂</span></span><br><span class=line>        <span class=type>FurnitureFactory</span> <span class=variable>victorianFactory</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">VictorianFurnitureFactory</span>();</span><br><span class=line>        <span class=type>Chair</span> <span class=variable>victorianChair</span> <span class=operator>=</span> victorianFactory.createChair();</span><br><span class=line>        <span class=type>Table</span> <span class=variable>victorianTable</span> <span class=operator>=</span> victorianFactory.createTable();</span><br><span class=line></span><br><span class=line>        victorianChair.sitOn();  <span class=comment>// 输出: Sitting on a victorian chair.</span></span><br><span class=line>        victorianTable.use();    <span class=comment>// 输出: Using a victorian table.</span></span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-1-4、Builder（建造者模式）><a class=headerlink href=#1-1-4、Builder（建造者模式） title=1.1.4、Builder（建造者模式）></a>1.1.4、Builder（建造者模式）</h3><h4 id=简介-2><a class=headerlink href=#简介-2 title=简介></a>简介</h4><p>建造者模式是一种对象创建模式，主要用于构建复杂对象。该模式将复杂对象的创建过程分为多个步骤，并通过使用同一个构建过程，可以创建不同的表示。<h4 id=结构-2><a class=headerlink href=#结构-2 title=结构></a>结构</h4><ul><li>产品类<li>抽象建造者<li>具体建造者<li>指挥者<li>客户端</ul><h4 id=何时使用-3><a class=headerlink href=#何时使用-3 title=何时使用></a>何时使用</h4><p>一些基本部件不会变，而其组合经常变化的时候。<h4 id=优缺点-3><a class=headerlink href=#优缺点-3 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>清晰的创建过程。将复杂对象的创建过程进行分离，使得客户端需要关心具体的创建过程，只需通过接口来构建对象。<li>灵活的产品构建。可以通过不同的具体建造者，来实现相同的构建步骤可以有不同的产品表示。<li>遵循单一职责原则。产品构造和表示是分开的，不同的建造者可以建造不多的产品。<li>代码复用。可以复用建造的步骤，减少重复的代码。</ol><li>缺点<ol><li>产品必须有共同点，范围有限制。<li>内部变化复杂，有很多建造类。</ol></ul><h4 id=使用场景-3><a class=headerlink href=#使用场景-3 title=使用场景></a>使用场景</h4><ol><li>需要构建的对象十分复杂，有许多步骤或部件需要组装。<li>不同的构建方式可能产生不同的对象表示，但构建的步骤或顺序是固定的。<li>希望隐藏对象的构建过程，只暴漏简单的接口。</ol><h4 id=应用实例-2><a class=headerlink href=#应用实例-2 title=应用实例></a>应用实例</h4><ol><li>去肯德基，汉堡、可乐、薯条、炸鸡翅等是不变的，而其组合是经常变化的，生成出所谓的 “套餐”。<li>JAVA 中的 StringBuilder。</ol><h4 id=源码应用-1><a class=headerlink href=#源码应用-1 title=源码应用></a>源码应用</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>org.springframework.web.service.mvc.method.RequestMappingInfo</span><br><span class=line>org.springframework.benas.factory.support.BeanDefinitionBuilder</span><br></pre></table></figure><h4 id=注意事项-3><a class=headerlink href=#注意事项-3 title=注意事项></a>注意事项</h4><p><font color=red>与工厂模式的区别：建造者模式更加关注零件装配的顺序。</font><h4 id=代码实例-3><a class=headerlink href=#代码实例-3 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br></pre><td class=code><pre><span class=line><span class=comment>// 产品类：汽车</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">Car</span> {</span><br><span class=line>    <span class=keyword>private</span> String engine;</span><br><span class=line>    <span class=keyword>private</span> String seats;</span><br><span class=line>    <span class=keyword>private</span> String GPS;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setEngine</span><span class=params>(String engine)</span> {</span><br><span class=line>        <span class=built_in>this</span>.engine = engine;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setSeats</span><span class=params>(String seats)</span> {</span><br><span class=line>        <span class=built_in>this</span>.seats = seats;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setGPS</span><span class=params>(String GPS)</span> {</span><br><span class=line>        <span class=built_in>this</span>.GPS = GPS;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">show</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Car with engine: "</span> + engine + <span class=string>", seats: "</span> + seats + <span class=string>", GPS: "</span> + GPS);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 建造者接口，定义建造产品的步骤</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">CarBuilder</span> {</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">buildEngine</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">buildSeats</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">buildGPS</span><span class=params>()</span>;</span><br><span class=line>    Car <span class="title function_">getCar</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体建造者：负责建造一辆具体的汽车</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">SportsCarBuilder</span> <span class=keyword>implements</span> <span class="title class_">CarBuilder</span> {</span><br><span class=line>    <span class=keyword>private</span> Car car;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">SportsCarBuilder</span><span class=params>()</span> {</span><br><span class=line>        <span class=built_in>this</span>.car = <span class=keyword>new</span> <span class="title class_">Car</span>();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">buildEngine</span><span class=params>()</span> {</span><br><span class=line>        car.setEngine(<span class=string>"V8 Engine"</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">buildSeats</span><span class=params>()</span> {</span><br><span class=line>        car.setSeats(<span class=string>"Sports Seats"</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">buildGPS</span><span class=params>()</span> {</span><br><span class=line>        car.setGPS(<span class=string>"Advanced GPS"</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Car <span class="title function_">getCar</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=built_in>this</span>.car;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line><span class=keyword>class</span> <span class="title class_">FamilyCarBuilder</span> <span class=keyword>implements</span> <span class="title class_">CarBuilder</span> {</span><br><span class=line>    <span class=keyword>private</span> Car car;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">FamilyCarBuilder</span><span class=params>()</span> {</span><br><span class=line>        <span class=built_in>this</span>.car = <span class=keyword>new</span> <span class="title class_">Car</span>();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">buildEngine</span><span class=params>()</span> {</span><br><span class=line>        car.setEngine(<span class=string>"V6 Engine"</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">buildSeats</span><span class=params>()</span> {</span><br><span class=line>        car.setSeats(<span class=string>"Comfort Seats"</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">buildGPS</span><span class=params>()</span> {</span><br><span class=line>        car.setGPS(<span class=string>"Basic GPS"</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Car <span class="title function_">getCar</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=built_in>this</span>.car;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 指挥者类：负责安排建造的顺序</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">Director</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">constructSportsCar</span><span class=params>(CarBuilder builder)</span> {</span><br><span class=line>        builder.buildEngine();</span><br><span class=line>        builder.buildSeats();</span><br><span class=line>        builder.buildGPS();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">constructFamilyCar</span><span class=params>(CarBuilder builder)</span> {</span><br><span class=line>        builder.buildEngine();</span><br><span class=line>        builder.buildSeats();</span><br><span class=line>        builder.buildGPS();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Main</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>Director</span> <span class=variable>director</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Director</span>();</span><br><span class=line></span><br><span class=line>        <span class=comment>// 构建运动型汽车</span></span><br><span class=line>        <span class=type>CarBuilder</span> <span class=variable>sportsCarBuilder</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">SportsCarBuilder</span>();</span><br><span class=line>        director.constructSportsCar(sportsCarBuilder);</span><br><span class=line>        <span class=type>Car</span> <span class=variable>sportsCar</span> <span class=operator>=</span> sportsCarBuilder.getCar();</span><br><span class=line>        sportsCar.show();  <span class=comment>// 输出: Car with engine: V8 Engine, seats: Sports Seats, GPS: Advanced GPS</span></span><br><span class=line></span><br><span class=line>        <span class=comment>// 构建家庭型汽车</span></span><br><span class=line>        <span class=type>CarBuilder</span> <span class=variable>familyCarBuilder</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">FamilyCarBuilder</span>();</span><br><span class=line>        director.constructFamilyCar(familyCarBuilder);</span><br><span class=line>        <span class=type>Car</span> <span class=variable>familyCar</span> <span class=operator>=</span> familyCarBuilder.getCar();</span><br><span class=line>        familyCar.show();  <span class=comment>// 输出: Car with engine: V6 Engine, seats: Comfort Seats, GPS: Basic GPS</span></span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-1-5、Prototype（原型模式）><a class=headerlink href=#1-1-5、Prototype（原型模式） title=1.1.5、Prototype（原型模式）></a>1.1.5、Prototype（原型模式）</h3><h4 id=定义-1><a class=headerlink href=#定义-1 title=定义></a>定义</h4><p>原型模式通过克隆已有对象来获取新对象，而不是通过类的构造器创建对象。该模式提供了一种复制对象的机制，同时可以避免直接使用new关键字来创建实例。<p>相关知识点：Cloneable接口/Object.clone方法；浅拷贝/深拷贝；序列化实现深拷贝。<h4 id=结构-3><a class=headerlink href=#结构-3 title=结构></a>结构</h4><ul><li>Prototype（原型接口）：定义一个接口，用于实现对象的克隆。<li>ConcretePrototype（具体原型类）：实现原型接口的具体类，提供克隆自己的方法。</ul><h4 id=何时使用-4><a class=headerlink href=#何时使用-4 title=何时使用></a>何时使用</h4><ol><li>当一个系统应该独立于它的产品创建，构成和表示时。<li>当要实例化的类是在运行时刻指定时，例如，通过动态装载。<li>为了避免创建一个与产品类层次平行的工厂类层次时。<li>当一个类的实例只能由几个不同状态组合中的一种时。建立相应数目的原型并克隆它们可能比每次用合适的状态手工实例化该类更方便一些。</ol><h4 id=优缺点-4><a class=headerlink href=#优缺点-4 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>性能提高。<li>逃避构造函数的约束。<li>可以不耦合具体类的情况下克隆对象。<li>避免重复的初始化代码。<li>更方便的构建复杂对象。</ol><li>缺点<ol><li>设计克隆方法需要对类的功能进行通盘考虑，这对于全新的类不是很难，但对于已有的类不一定很容易，特别当一个类引用不支持串行化的间接对象，或者引用含有循环结构时。<li>必须实现 Cloneable 接口。</ol></ul><h4 id=使用场景-4><a class=headerlink href=#使用场景-4 title=使用场景></a>使用场景</h4><ol><li>资源优化场景；<li>类初始化需要消化非常多的资源；<li>性能和安全要求的场景；<li>通过 new 创建对象需要繁杂步骤时；<li>一个对象有多个修改；<li>当多个对象需要对同一对象执行操作时，可以将共享对象拷贝多个来应付每一个调用者对象；<li>实际开发中，原型模式一般和工厂方法一起使用。工厂方法可以将 原型模式拷贝生成的对象提供给调用者；</ol><h4 id=应用实例-3><a class=headerlink href=#应用实例-3 title=应用实例></a>应用实例</h4><ol><li>细胞分裂。<li>JAVA 中的 Object clone() 方法。</ol><h4 id=源码中的应用><a class=headerlink href=#源码中的应用 title=源码中的应用></a>源码中的应用</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>org.springframework.beans.factory.support.AbstracBeanDefinition</span><br><span class=line>java.util.Arrays</span><br></pre></table></figure><h4 id=注意事项-4><a class=headerlink href=#注意事项-4 title=注意事项></a>注意事项</h4><p><font color=red>原型模式是通过拷贝现有对象来生成新对象。浅拷贝实现 Cloneable，重写，深拷贝通过实现 Serializable 读取二进制流。</font><h4 id=代码实例-4><a class=headerlink href=#代码实例-4 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br></pre><td class=code><pre><span class=line><span class=comment>// 原型接口，Java内置的Cloneable接口用于表示对象可克隆</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">Prototype</span> <span class=keyword>extends</span> <span class="title class_">Cloneable</span> {</span><br><span class=line>    Prototype <span class="title function_">clone</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体的原型类，实现克隆方法</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">ConcretePrototype</span> <span class=keyword>implements</span> <span class="title class_">Prototype</span> {</span><br><span class=line>    <span class=keyword>private</span> String name;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">ConcretePrototype</span><span class=params>(String name)</span> {</span><br><span class=line>        <span class=built_in>this</span>.name = name;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>// 实现克隆方法</span></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Prototype <span class="title function_">clone</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>try</span> {</span><br><span class=line>            <span class=keyword>return</span> (Prototype) <span class=built_in>super</span>.clone();  <span class=comment>// 调用Object类的浅拷贝</span></span><br><span class=line>        } <span class=keyword>catch</span> (CloneNotSupportedException e) {</span><br><span class=line>            e.printStackTrace();</span><br><span class=line>            <span class=keyword>return</span> <span class=literal>null</span>;</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">getName</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> name;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setName</span><span class=params>(String name)</span> {</span><br><span class=line>        <span class=built_in>this</span>.name = name;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">toString</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=string>"ConcretePrototype{"</span> +</span><br><span class=line>                <span class=string>"name='"</span> + name + <span class=string>'\''</span> +</span><br><span class=line>                <span class=string>'}'</span>;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Main</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=comment>// 创建一个具体原型对象</span></span><br><span class=line>        <span class=type>ConcretePrototype</span> <span class=variable>prototype1</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ConcretePrototype</span>(<span class=string>"Original"</span>);</span><br><span class=line>        System.out.println(<span class=string>"Original: "</span> + prototype1);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 克隆该原型对象</span></span><br><span class=line>        <span class=type>ConcretePrototype</span> <span class=variable>clonedPrototype</span> <span class=operator>=</span> (ConcretePrototype) prototype1.clone();</span><br><span class=line>        clonedPrototype.setName(<span class=string>"Cloned"</span>);</span><br><span class=line>        System.out.println(<span class=string>"Cloned: "</span> + clonedPrototype);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 验证原型对象没有受到影响</span></span><br><span class=line>        System.out.println(<span class=string>"After cloning, Original: "</span> + prototype1);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h2 id=1-2、行为型（11种）><a class=headerlink href=#1-2、行为型（11种） title=1.2、行为型（11种）></a>1.2、行为型（11种）</h2><h3 id=1-2-1、Iterator（迭代器模式）><a class=headerlink href=#1-2-1、Iterator（迭代器模式） title=1.2.1、Iterator（迭代器模式）></a>1.2.1、Iterator（迭代器模式）</h3><h4 id=定义-2><a class=headerlink href=#定义-2 title=定义></a>定义</h4><p>迭代器模式用于提供一种顺序访问聚合对象（比如集合、列表、数组）内部元素的方法，而无需暴漏该对象的内部表示。通过迭代器模式，客户端可以遍历容器中的元素，而不需要了解容器的底层实现细节。<h4 id=结构-4><a class=headerlink href=#结构-4 title=结构></a>结构</h4><ul><li>迭代器接口<li>具体迭代器类<li>聚合接口<li>具体聚合类</ul><h4 id=何时使用-5><a class=headerlink href=#何时使用-5 title=何时使用></a>何时使用</h4><p>需要对容器/集合遍历时，可以使用迭代器模式。<h4 id=实现-1><a class=headerlink href=#实现-1 title=实现></a>实现</h4><ul><li>数组实现<li>链表实现</ul><h4 id=优缺点-5><a class=headerlink href=#优缺点-5 title=优缺点></a>优缺点</h4><ul><li><p>优点</p> <ol><li>它支持以不同方式遍历一个聚合对象；<li>迭代器简化了聚合类；<li>在同一聚合上可以有多个遍历；<li>迭代器模式中，增加新的聚合类和迭代器类都很方便，无须修改原有代码；</ol><li><p>缺点</p> <p>由于迭代器模式将存储数据和遍历数据的职责分离，增加新的聚合类需要对应增加新的迭代器类，类的个数成对增加，这在一定程度上增加了系统的复杂性。</p></ul><h4 id=使用场景-5><a class=headerlink href=#使用场景-5 title=使用场景></a>使用场景</h4><ol><li>访问一个聚合对象的内部元素而无须暴露其内部表示。<li>需要为聚合对象提供多种遍历方式。<li>为遍历不同的聚合结构提供一个统一的接口。</ol><h4 id=应用实例-4><a class=headerlink href=#应用实例-4 title=应用实例></a>应用实例</h4><p>JAVA 中的 iterator。<h4 id=注意事项-5><a class=headerlink href=#注意事项-5 title=注意事项></a>注意事项</h4><p><font color=red>迭代器模式分离了集合对象的遍历行为，抽象出一个迭代器类，可实现不爆露对象内部就可访问其内部元素；</font><h4 id=代码实例-5><a class=headerlink href=#代码实例-5 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br></pre><td class=code><pre><span class=line><span class=comment>// 迭代器接口</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">Iterator</span>&LTT> {</span><br><span class=line>    <span class=type>boolean</span> <span class="title function_">hasNext</span><span class=params>()</span>;</span><br><span class=line>    T <span class="title function_">next</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 聚合接口</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">Aggregate</span>&LTT> {</span><br><span class=line>    Iterator&LTT> <span class="title function_">createIterator</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体聚合类：自定义集合</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">MyCollection</span>&LTT> <span class=keyword>implements</span> <span class="title class_">Aggregate</span>&LTT> {</span><br><span class=line>    <span class=keyword>private</span> T[] items;</span><br><span class=line>    <span class=keyword>private</span> <span class=type>int</span> <span class=variable>size</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">MyCollection</span><span class=params>(<span class=type>int</span> capacity)</span> {</span><br><span class=line>        items = (T[]) <span class=keyword>new</span> <span class="title class_">Object</span>[capacity];</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">add</span><span class=params>(T item)</span> {</span><br><span class=line>        <span class=keyword>if</span> (size < items.length) {</span><br><span class=line>            items[size++] = item;</span><br><span class=line>        } <span class=keyword>else</span> {</span><br><span class=line>            System.out.println(<span class=string>"集合已满，无法添加更多元素"</span>);</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=type>int</span> <span class="title function_">size</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> size;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> T <span class="title function_">get</span><span class=params>(<span class=type>int</span> index)</span> {</span><br><span class=line>        <span class=keyword>if</span> (index >= <span class=number>0</span> && index < size) {</span><br><span class=line>            <span class=keyword>return</span> items[index];</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> <span class=literal>null</span>;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Iterator&LTT> <span class="title function_">createIterator</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">MyIterator</span>(<span class=built_in>this</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体迭代器类</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">MyIterator</span>&LTT> <span class=keyword>implements</span> <span class="title class_">Iterator</span>&LTT> {</span><br><span class=line>    <span class=keyword>private</span> MyCollection&LTT> collection;</span><br><span class=line>    <span class=keyword>private</span> <span class=type>int</span> <span class=variable>index</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">MyIterator</span><span class=params>(MyCollection&LTT> collection)</span> {</span><br><span class=line>        <span class=built_in>this</span>.collection = collection;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=type>boolean</span> <span class="title function_">hasNext</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> index < collection.size();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> T <span class="title function_">next</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>if</span> (hasNext()) {</span><br><span class=line>            <span class=keyword>return</span> collection.get(index++);</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> <span class=literal>null</span>;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 客户端代码</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">IteratorPatternDemo</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=comment>// 创建自定义集合并添加元素</span></span><br><span class=line>        MyCollection&LTString> myCollection = <span class=keyword>new</span> <span class="title class_">MyCollection</span><>(<span class=number>5</span>);</span><br><span class=line>        myCollection.add(<span class=string>"元素1"</span>);</span><br><span class=line>        myCollection.add(<span class=string>"元素2"</span>);</span><br><span class=line>        myCollection.add(<span class=string>"元素3"</span>);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 获取迭代器</span></span><br><span class=line>        Iterator&LTString> iterator = myCollection.createIterator();</span><br><span class=line></span><br><span class=line>        <span class=comment>// 使用迭代器遍历集合</span></span><br><span class=line>        <span class=keyword>while</span> (iterator.hasNext()) {</span><br><span class=line>            <span class=type>String</span> <span class=variable>item</span> <span class=operator>=</span> iterator.next();</span><br><span class=line>            System.out.println(<span class=string>"访问元素: "</span> + item);</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-2、Observer（观察者模式）><a class=headerlink href=#1-2-2、Observer（观察者模式） title=1.2.2、Observer（观察者模式）></a>1.2.2、Observer（观察者模式）</h3><h4 id=定义-3><a class=headerlink href=#定义-3 title=定义></a>定义</h4><p>观察者模式定义了对象间一对多的依赖关系，使得当一个对象的状态发生变化时，其所有依赖于它的对象都会收到通知并自动更新。<h4 id=结构-5><a class=headerlink href=#结构-5 title=结构></a>结构</h4><ul><li>Subject（抽象主题）<li>ConcreteSubject（具体主题）<li>Observer（抽象观察者）<li>ConcreteObserver（具体观察者）</ul><h4 id=何时使用-6><a class=headerlink href=#何时使用-6 title=何时使用></a>何时使用</h4><p>一个对象（目标对象）的状态发生改变，所有的依赖对象（观察者对象）都将得到通知。<h4 id=优缺点-6><a class=headerlink href=#优缺点-6 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>观察者和被观察者是抽象耦合的。<li>建立一套触发机制。</ol><li>缺点<ol><li>参与者太多 导致 参照者发送通知会消耗很多资源；<li>参与者和参照者中间发生 循坏依赖可能导致系统崩溃。<li>参与者只知道参照者发生了变化，而如何变化却不知道；</ol></ul><h4 id=使用场景-6><a class=headerlink href=#使用场景-6 title=使用场景></a>使用场景</h4><ol><li>一个抽象模型有两个方面，其中一个方面依赖于另一个方面。将这些方面封装在独立的对象中使它们可以各自独立地改变和复用。<li>一个对象的改变将导致其他一个或多个对象也发生改变，而不知道具体有多少对象将发生改变，可以降低对象之间的耦合度。<li>一个对象必须通知其他对象，而并不知道这些对象是谁。<li>需要在系统中创建一个触发链，A 对象的行为将影响 B 对象，B 对象的行为将影响 C 对象……，可以使用观察者模式创建一种链式触发机制。</ol><h4 id=应用实例-5><a class=headerlink href=#应用实例-5 title=应用实例></a>应用实例</h4><ol><li>拍卖的时候，拍卖师观察最高标价，然后通知给其他竞价者竞价。<li>西游记里面悟空请求菩萨降服红孩儿，菩萨洒了一地水招来一个老乌龟，这个乌龟就是观察者，他观察菩萨洒水这个动作。</ol><h4 id=源码应用-2><a class=headerlink href=#源码应用-2 title=源码应用></a>源码应用</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>java.util.Observable</span><br><span class=line>org.springframework.context.ApplicationListener</span><br></pre></table></figure><h4 id=注意事项-6><a class=headerlink href=#注意事项-6 title=注意事项></a>注意事项</h4><ol><li><font color=red>JAVA 中存在相关支持类；</font><li><font color=red>应该避免循环引用；</font><li><font color=red>顺序执行将导致某一观察者错误进而导致系统卡壳，故一般采用异步方式；</font></ol><h4 id=代码实例-6><a class=headerlink href=#代码实例-6 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br></pre><td class=code><pre><span class=line><span class=comment>// 抽象主题</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">Subject</span> {</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">registerObserver</span><span class=params>(Observer o)</span>;</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">removeObserver</span><span class=params>(Observer o)</span>;</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">notifyObservers</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体主题</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">WeatherData</span> <span class=keyword>implements</span> <span class="title class_">Subject</span> {</span><br><span class=line>    <span class=keyword>private</span> List&LTObserver> observers;</span><br><span class=line>    <span class=keyword>private</span> <span class=type>float</span> temperature;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">WeatherData</span><span class=params>()</span> {</span><br><span class=line>        observers = <span class=keyword>new</span> <span class="title class_">ArrayList</span><>();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">registerObserver</span><span class=params>(Observer o)</span> {</span><br><span class=line>        observers.add(o);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">removeObserver</span><span class=params>(Observer o)</span> {</span><br><span class=line>        observers.remove(o);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">notifyObservers</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>for</span> (Observer observer : observers) {</span><br><span class=line>            observer.update(temperature);</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setTemperature</span><span class=params>(<span class=type>float</span> temperature)</span> {</span><br><span class=line>        <span class=built_in>this</span>.temperature = temperature;</span><br><span class=line>        notifyObservers();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 抽象观察者</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">Observer</span> {</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">update</span><span class=params>(<span class=type>float</span> temperature)</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体观察者</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">CurrentConditionsDisplay</span> <span class=keyword>implements</span> <span class="title class_">Observer</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=type>float</span> temperature;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">update</span><span class=params>(<span class=type>float</span> temperature)</span> {</span><br><span class=line>        <span class=built_in>this</span>.temperature = temperature;</span><br><span class=line>        display();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">display</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Current temperature: "</span> + temperature);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 使用</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">WeatherStation</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>WeatherData</span> <span class=variable>weatherData</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">WeatherData</span>();</span><br><span class=line>        <span class=type>CurrentConditionsDisplay</span> <span class=variable>currentDisplay</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">CurrentConditionsDisplay</span>();</span><br><span class=line></span><br><span class=line>        weatherData.registerObserver(currentDisplay);</span><br><span class=line>        weatherData.setTemperature(<span class=number>25.3f</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-3、TemplateMethod（模板方法）><a class=headerlink href=#1-2-3、TemplateMethod（模板方法） title=1.2.3、TemplateMethod（模板方法）></a>1.2.3、TemplateMethod（模板方法）</h3><h4 id=定义-4><a class=headerlink href=#定义-4 title=定义></a>定义</h4><p>模板方法模式定义了一个算法的骨架，将算法中的某些步骤推迟到子类中去实现。通过模板方法模式，子类可以在不改变算法结构的前提下重新定义算法的某些特定步骤。<h4 id=结构-6><a class=headerlink href=#结构-6 title=结构></a>结构</h4><ul><li>抽象类<li>具体类</ul><h4 id=何时使用-7><a class=headerlink href=#何时使用-7 title=何时使用></a>何时使用</h4><p>系统中存在一部分通用方法。<h4 id=优缺点-7><a class=headerlink href=#优缺点-7 title=优缺点></a>优缺点</h4><ul><li><p>优点</p> <ol><li>封装不变部分，扩展可变部分。<li>提取公共代码，便于维护。<li>行为由父类控制，子类实现。</ol><li><p>缺点</p> <p>每一个不同的实现都需要一个子类来实现，类的数量增加导致系统愈加庞大。</p></ul><h4 id=使用场景-7><a class=headerlink href=#使用场景-7 title=使用场景></a>使用场景</h4><ol><li>有多个子类共有的方法，且逻辑相同。<li>重要的、复杂的方法，可以考虑作为模板方法。</ol><h4 id=应用实例-6><a class=headerlink href=#应用实例-6 title=应用实例></a>应用实例</h4><ol><li>在造房子的时候，地基、走线、水管都一样，只有后期加壁橱加栅栏等差异。<li>西游记中的 81 难，就是一个顶层逻辑骨架。<li>spring 对 Hibernate 的支持，将一些规定好的方法封装起来，编程人员直接使用即可。</ol><h4 id=注意事项-7><a class=headerlink href=#注意事项-7 title=注意事项></a>注意事项</h4><p><font color=red>为防止恶意操作，模板方法一般会使用 final 修饰。</font><h4 id=代码实例-7><a class=headerlink href=#代码实例-7 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br></pre><td class=code><pre><span class=line><span class=comment>// 抽象类，定义算法骨架</span></span><br><span class=line><span class=keyword>abstract</span> <span class=keyword>class</span> <span class="title class_">Game</span> {</span><br><span class=line>    <span class=comment>// 模板方法，定义了游戏的流程</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>final</span> <span class=keyword>void</span> <span class="title function_">play</span><span class=params>()</span> {</span><br><span class=line>        initialize();</span><br><span class=line>        startPlay();</span><br><span class=line>        endPlay();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>// 具体步骤，子类可能不需要重写</span></span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">initialize</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Game initialized."</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>// 抽象方法，子类必须实现</span></span><br><span class=line>    <span class=keyword>abstract</span> <span class=keyword>void</span> <span class="title function_">startPlay</span><span class=params>()</span>;</span><br><span class=line>    </span><br><span class=line>    <span class=comment>// 抽象方法，子类必须实现</span></span><br><span class=line>    <span class=keyword>abstract</span> <span class=keyword>void</span> <span class="title function_">endPlay</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体类，继承抽象类并实现抽象方法</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">Football</span> <span class=keyword>extends</span> <span class="title class_">Game</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">startPlay</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Football Game Started. Enjoy the game!"</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">endPlay</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Football Game Finished."</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>class</span> <span class="title class_">Basketball</span> <span class=keyword>extends</span> <span class="title class_">Game</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">startPlay</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Basketball Game Started. Enjoy the game!"</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">endPlay</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Basketball Game Finished."</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 客户端代码</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">TemplateMethodPatternDemo</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>Game</span> <span class=variable>game</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Football</span>();</span><br><span class=line>        game.play(); <span class=comment>// 执行的是模板方法</span></span><br><span class=line>        </span><br><span class=line>        System.out.println();</span><br><span class=line>        </span><br><span class=line>        game = <span class=keyword>new</span> <span class="title class_">Basketball</span>();</span><br><span class=line>        game.play();</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-4、Strategy（策略模式）><a class=headerlink href=#1-2-4、Strategy（策略模式） title=1.2.4、Strategy（策略模式）></a>1.2.4、Strategy（策略模式）</h3><h4 id=定义-5><a class=headerlink href=#定义-5 title=定义></a>定义</h4><p>策略模式定义了一系列算法，并将每个算法封装起来，使得它们可以互相替换。策略模式使得算法可以独立于使用它的客户端而变化。<h4 id=结构-7><a class=headerlink href=#结构-7 title=结构></a>结构</h4><ul><li>策略接口<li>具体策略类<li>上下文类</ul><h4 id=何时使用-8><a class=headerlink href=#何时使用-8 title=何时使用></a>何时使用</h4><p>一个系统有许多类，而区分它们的只是他们直接的行为。<h4 id=优缺点-8><a class=headerlink href=#优缺点-8 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>算法可以自由切换。<li>避免使用多重条件判断。<li>扩展性良好。</ol><li>缺点<ol><li>策略类会增多。<li>所有策略类都需要对外暴露。</ol></ul><h4 id=使用场景-8><a class=headerlink href=#使用场景-8 title=使用场景></a>使用场景</h4><ol><li>一个系统中的许多类只存在行为上的区别时，该模式可以动态让一个对象在许多行为中选择一种行为。<li>一个系统需要动态地在几种算法中选择一种。<li>如果一个对象有很多行为，如果不用恰当的模式，这些行为就只好使用多重的条件选择语句来实现。</ol><h4 id=应用实例-7><a class=headerlink href=#应用实例-7 title=应用实例></a>应用实例</h4><ol><li>诸葛亮的锦囊妙计，每一个锦囊就是一个策略。<li>旅行的交通方式可以选择骑自行车、开汽车等，每一种旅行方式都是一个策略。<li>JAVA AWT 中的 LayoutManager。</ol><h4 id=注意事项-8><a class=headerlink href=#注意事项-8 title=注意事项></a>注意事项</h4><p><font color=red>如果一个系统的策略多于四个，就需要考虑使用混合模式，解决策略类膨胀的问题。</font>、<h4 id=代码实例-8><a class=headerlink href=#代码实例-8 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br></pre><td class=code><pre><span class=line><span class=comment>// 策略接口，定义算法的公共方法</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">Strategy</span> {</span><br><span class=line>    <span class=type>int</span> <span class="title function_">doOperation</span><span class=params>(<span class=type>int</span> num1, <span class=type>int</span> num2)</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体策略类1：加法策略</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">OperationAdd</span> <span class=keyword>implements</span> <span class="title class_">Strategy</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=type>int</span> <span class="title function_">doOperation</span><span class=params>(<span class=type>int</span> num1, <span class=type>int</span> num2)</span> {</span><br><span class=line>        <span class=keyword>return</span> num1 + num2;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体策略类2：减法策略</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">OperationSubtract</span> <span class=keyword>implements</span> <span class="title class_">Strategy</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=type>int</span> <span class="title function_">doOperation</span><span class=params>(<span class=type>int</span> num1, <span class=type>int</span> num2)</span> {</span><br><span class=line>        <span class=keyword>return</span> num1 - num2;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体策略类3：乘法策略</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">OperationMultiply</span> <span class=keyword>implements</span> <span class="title class_">Strategy</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=type>int</span> <span class="title function_">doOperation</span><span class=params>(<span class=type>int</span> num1, <span class=type>int</span> num2)</span> {</span><br><span class=line>        <span class=keyword>return</span> num1 * num2;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 上下文类，持有策略的引用</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">Context</span> {</span><br><span class=line>    <span class=keyword>private</span> Strategy strategy;</span><br><span class=line></span><br><span class=line>    <span class=comment>// 可以通过构造函数或setter方法设置具体策略</span></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">Context</span><span class=params>(Strategy strategy)</span> {</span><br><span class=line>        <span class=built_in>this</span>.strategy = strategy;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setStrategy</span><span class=params>(Strategy strategy)</span> {</span><br><span class=line>        <span class=built_in>this</span>.strategy = strategy;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>// 调用策略的方法</span></span><br><span class=line>    <span class=keyword>public</span> <span class=type>int</span> <span class="title function_">executeStrategy</span><span class=params>(<span class=type>int</span> num1, <span class=type>int</span> num2)</span> {</span><br><span class=line>        <span class=keyword>return</span> strategy.doOperation(num1, num2);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 客户端代码</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">StrategyPatternDemo</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=comment>// 使用加法策略</span></span><br><span class=line>        <span class=type>Context</span> <span class=variable>context</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Context</span>(<span class=keyword>new</span> <span class="title class_">OperationAdd</span>());</span><br><span class=line>        System.out.println(<span class=string>"10 + 5 = "</span> + context.executeStrategy(<span class=number>10</span>, <span class=number>5</span>));</span><br><span class=line></span><br><span class=line>        <span class=comment>// 动态切换为减法策略</span></span><br><span class=line>        context.setStrategy(<span class=keyword>new</span> <span class="title class_">OperationSubtract</span>());</span><br><span class=line>        System.out.println(<span class=string>"10 - 5 = "</span> + context.executeStrategy(<span class=number>10</span>, <span class=number>5</span>));</span><br><span class=line></span><br><span class=line>        <span class=comment>// 动态切换为乘法策略</span></span><br><span class=line>        context.setStrategy(<span class=keyword>new</span> <span class="title class_">OperationMultiply</span>());</span><br><span class=line>        System.out.println(<span class=string>"10 * 5 = "</span> + context.executeStrategy(<span class=number>10</span>, <span class=number>5</span>));</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-5、ChainOfResponsibility（职责链模式）><a class=headerlink href=#1-2-5、ChainOfResponsibility（职责链模式） title=1.2.5、ChainOfResponsibility（职责链模式）></a>1.2.5、ChainOfResponsibility（职责链模式）</h3><h4 id=定义-6><a class=headerlink href=#定义-6 title=定义></a>定义</h4><p>职责链模式通过将请求沿着一个“职责链”传递，链上的每个对象都可以对请求进行处理或将其传递给下一个对象。职责链模式的目的是将请求的发送者与接收者解耦，让多个对象都有机会处理这个请求，而不是明确指定具体的处理对象。<h4 id=结构-8><a class=headerlink href=#结构-8 title=结构></a>结构</h4><ul><li>抽象处理者<li>具体处理者<li>客户端</ul><h4 id=何时使用-9><a class=headerlink href=#何时使用-9 title=何时使用></a>何时使用</h4><p>过滤消息中各种不雅内容；<h4 id=优缺点-9><a class=headerlink href=#优缺点-9 title=优缺点></a>优缺点</h4><ol><li>请求的发送者和接收者解耦。<li>可以执行控制顺序。<li>符合开闭原则和单一职责原则。</ol><h4 id=使用场景-9><a class=headerlink href=#使用场景-9 title=使用场景></a>使用场景</h4><ol><li>多个对象都能处理同一个请求，具体由哪个对象处理该请求则在运行时自动确定。<li>在不明确指定接收者的情况下，向多个对象中的某个对象发送一个请求。<li>动态指定一组对象处理请求的场景。</ol><h4 id=应用实例-8><a class=headerlink href=#应用实例-8 title=应用实例></a>应用实例</h4><ol><li>红楼梦中的 “击鼓传花”。<li>JS 中的事件冒泡。<li>JAVA WEB 中 Apache Tomcat 对 Encoding 的处理，Struts2 的拦截器，jsp servlet 的 Filter。</ol><h4 id=源码应用-3><a class=headerlink href=#源码应用-3 title=源码应用></a>源码应用</h4><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>javax.servlet.Filter</span><br><span class=line>javax.servlet.FilterChain</span><br></pre></table></figure><h4 id=注意事项-9><a class=headerlink href=#注意事项-9 title=注意事项></a>注意事项</h4><p><font color=red>JAVA WEB 中有很多应用。</font><h4 id=代码实例-9><a class=headerlink href=#代码实例-9 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br></pre><td class=code><pre><span class=line><span class=comment>// 抽象处理者，定义处理请求的接口</span></span><br><span class=line><span class=keyword>abstract</span> <span class=keyword>class</span> <span class="title class_">Handler</span> {</span><br><span class=line>    <span class=keyword>protected</span> Handler nextHandler; <span class=comment>// 下一个处理者</span></span><br><span class=line></span><br><span class=line>    <span class=comment>// 设置下一个处理者</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setNextHandler</span><span class=params>(Handler nextHandler)</span> {</span><br><span class=line>        <span class=built_in>this</span>.nextHandler = nextHandler;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>// 处理请求的抽象方法</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>void</span> <span class="title function_">handleRequest</span><span class=params>(<span class=type>int</span> request)</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体处理者1：处理小于10的请求</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">ConcreteHandler1</span> <span class=keyword>extends</span> <span class="title class_">Handler</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">handleRequest</span><span class=params>(<span class=type>int</span> request)</span> {</span><br><span class=line>        <span class=keyword>if</span> (request < <span class=number>10</span>) {</span><br><span class=line>            System.out.println(<span class=string>"Handler1处理请求："</span> + request);</span><br><span class=line>        } <span class=keyword>else</span> <span class=keyword>if</span> (nextHandler != <span class=literal>null</span>) {</span><br><span class=line>            nextHandler.handleRequest(request); <span class=comment>// 转交给下一个处理者</span></span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体处理者2：处理10到20之间的请求</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">ConcreteHandler2</span> <span class=keyword>extends</span> <span class="title class_">Handler</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">handleRequest</span><span class=params>(<span class=type>int</span> request)</span> {</span><br><span class=line>        <span class=keyword>if</span> (request >= <span class=number>10</span> && request < <span class=number>20</span>) {</span><br><span class=line>            System.out.println(<span class=string>"Handler2处理请求："</span> + request);</span><br><span class=line>        } <span class=keyword>else</span> <span class=keyword>if</span> (nextHandler != <span class=literal>null</span>) {</span><br><span class=line>            nextHandler.handleRequest(request); <span class=comment>// 转交给下一个处理者</span></span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体处理者3：处理大于等于20的请求</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">ConcreteHandler3</span> <span class=keyword>extends</span> <span class="title class_">Handler</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">handleRequest</span><span class=params>(<span class=type>int</span> request)</span> {</span><br><span class=line>        <span class=keyword>if</span> (request >= <span class=number>20</span>) {</span><br><span class=line>            System.out.println(<span class=string>"Handler3处理请求："</span> + request);</span><br><span class=line>        } <span class=keyword>else</span> <span class=keyword>if</span> (nextHandler != <span class=literal>null</span>) {</span><br><span class=line>            nextHandler.handleRequest(request); <span class=comment>// 转交给下一个处理者</span></span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 客户端代码</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ChainOfResponsibilityPatternDemo</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=comment>// 创建处理者</span></span><br><span class=line>        <span class=type>Handler</span> <span class=variable>handler1</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ConcreteHandler1</span>();</span><br><span class=line>        <span class=type>Handler</span> <span class=variable>handler2</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ConcreteHandler2</span>();</span><br><span class=line>        <span class=type>Handler</span> <span class=variable>handler3</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ConcreteHandler3</span>();</span><br><span class=line></span><br><span class=line>        <span class=comment>// 设置处理链</span></span><br><span class=line>        handler1.setNextHandler(handler2);</span><br><span class=line>        handler2.setNextHandler(handler3);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 向链中的第一个处理者发出请求</span></span><br><span class=line>        <span class=type>int</span>[] requests = {<span class=number>5</span>, <span class=number>12</span>, <span class=number>25</span>, <span class=number>18</span>};</span><br><span class=line>        <span class=keyword>for</span> (<span class=type>int</span> request : requests) {</span><br><span class=line>            handler1.handleRequest(request); <span class=comment>// 始终从第一个处理者开始</span></span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-6、Mediator（中介者模式）><a class=headerlink href=#1-2-6、Mediator（中介者模式） title=1.2.6、Mediator（中介者模式）></a>1.2.6、Mediator（中介者模式）</h3><h4 id=定义-7><a class=headerlink href=#定义-7 title=定义></a>定义</h4><p>中介者模式通过一个 中介者对象 来封装对象之间的交互，使得对象不再需要显式地相互引用，减少对象之间的耦合，便于系统的扩展和维护。中介者模式的核心是引入一个中介者来协调多个对象之间的通信，而不是让对象直接交互。<h4 id=结构-9><a class=headerlink href=#结构-9 title=结构></a>结构</h4><ul><li>抽象中介者<li>具体中介者<li>抽象同事类<li>具体同事类</ul><h4 id=何时使用-10><a class=headerlink href=#何时使用-10 title=何时使用></a>何时使用</h4><p>多个类相互耦合，形成了网状结构。<h4 id=优缺点-10><a class=headerlink href=#优缺点-10 title=优缺点></a>优缺点</h4><ul><li><p>优点</p> <ol><li>降低了类的复杂度，将一对多转化成了一对一。<li>实现了类之间的解耦。<li>符合迪米特原则。</ol><li><p>缺点</p> <p>中介者会庞大，变得复杂难以维护。</p></ul><h4 id=使用场景-10><a class=headerlink href=#使用场景-10 title=使用场景></a>使用场景</h4><ol><li>对象间存在复杂引用关系，内部结构复杂难以使用；<li>通过一个中间类来封装多个类中的行为，而又不想生成太多的子类；</ol><h4 id=应用实例-9><a class=headerlink href=#应用实例-9 title=应用实例></a>应用实例</h4><ol><li>中国加入 WTO 之前是各个国家相互贸易，结构复杂，现在是各个国家通过 WTO 来互相贸易。<li>机场调度系统。<li>MVC 框架中 C（控制器）就是 M（模型）和 V（视图）的中介者。</ol><h4 id=注意事项-10><a class=headerlink href=#注意事项-10 title=注意事项></a>注意事项</h4><p><font color=red>不应当在职责混乱时使用。</font><h4 id=代码实例-10><a class=headerlink href=#代码实例-10 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br></pre><td class=code><pre><span class=line><span class=comment>// 抽象中介者</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">Mediator</span> {</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">sendMessage</span><span class=params>(String message, Colleague colleague)</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 抽象同事类</span></span><br><span class=line><span class=keyword>abstract</span> <span class=keyword>class</span> <span class="title class_">Colleague</span> {</span><br><span class=line>    <span class=keyword>protected</span> Mediator mediator;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">Colleague</span><span class=params>(Mediator mediator)</span> {</span><br><span class=line>        <span class=built_in>this</span>.mediator = mediator;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>// 向中介者发送消息</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>void</span> <span class="title function_">send</span><span class=params>(String message)</span>;</span><br><span class=line></span><br><span class=line>    <span class=comment>// 接收消息</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>void</span> <span class="title function_">receive</span><span class=params>(String message)</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体同事类1</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">ConcreteColleague1</span> <span class=keyword>extends</span> <span class="title class_">Colleague</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">ConcreteColleague1</span><span class=params>(Mediator mediator)</span> {</span><br><span class=line>        <span class=built_in>super</span>(mediator);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">send</span><span class=params>(String message)</span> {</span><br><span class=line>        System.out.println(<span class=string>"同事1发送消息："</span> + message);</span><br><span class=line>        mediator.sendMessage(message, <span class=built_in>this</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">receive</span><span class=params>(String message)</span> {</span><br><span class=line>        System.out.println(<span class=string>"同事1接收到消息："</span> + message);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体同事类2</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">ConcreteColleague2</span> <span class=keyword>extends</span> <span class="title class_">Colleague</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">ConcreteColleague2</span><span class=params>(Mediator mediator)</span> {</span><br><span class=line>        <span class=built_in>super</span>(mediator);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">send</span><span class=params>(String message)</span> {</span><br><span class=line>        System.out.println(<span class=string>"同事2发送消息："</span> + message);</span><br><span class=line>        mediator.sendMessage(message, <span class=built_in>this</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">receive</span><span class=params>(String message)</span> {</span><br><span class=line>        System.out.println(<span class=string>"同事2接收到消息："</span> + message);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体中介者</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">ConcreteMediator</span> <span class=keyword>implements</span> <span class="title class_">Mediator</span> {</span><br><span class=line>    <span class=keyword>private</span> ConcreteColleague1 colleague1;</span><br><span class=line>    <span class=keyword>private</span> ConcreteColleague2 colleague2;</span><br><span class=line></span><br><span class=line>    <span class=comment>// 注册同事对象</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setColleague1</span><span class=params>(ConcreteColleague1 colleague1)</span> {</span><br><span class=line>        <span class=built_in>this</span>.colleague1 = colleague1;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setColleague2</span><span class=params>(ConcreteColleague2 colleague2)</span> {</span><br><span class=line>        <span class=built_in>this</span>.colleague2 = colleague2;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">sendMessage</span><span class=params>(String message, Colleague colleague)</span> {</span><br><span class=line>        <span class=keyword>if</span> (colleague == colleague1) {</span><br><span class=line>            colleague2.receive(message);</span><br><span class=line>        } <span class=keyword>else</span> {</span><br><span class=line>            colleague1.receive(message);</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 客户端代码</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">MediatorPatternDemo</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>ConcreteMediator</span> <span class=variable>mediator</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ConcreteMediator</span>();</span><br><span class=line></span><br><span class=line>        <span class=comment>// 创建同事对象并注册到中介者</span></span><br><span class=line>        <span class=type>ConcreteColleague1</span> <span class=variable>colleague1</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ConcreteColleague1</span>(mediator);</span><br><span class=line>        <span class=type>ConcreteColleague2</span> <span class=variable>colleague2</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ConcreteColleague2</span>(mediator);</span><br><span class=line></span><br><span class=line>        mediator.setColleague1(colleague1);</span><br><span class=line>        mediator.setColleague2(colleague2);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 同事1发送消息，通过中介者传递给同事2</span></span><br><span class=line>        colleague1.send(<span class=string>"你好，2号！"</span>);</span><br><span class=line>        <span class=comment>// 同事2发送消息，通过中介者传递给同事1</span></span><br><span class=line>        colleague2.send(<span class=string>"你好，1号！"</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-7、Interpreter（解释器模式）><a class=headerlink href=#1-2-7、Interpreter（解释器模式） title=1.2.7、Interpreter（解释器模式）></a>1.2.7、Interpreter（解释器模式）</h3><h4 id=定义-8><a class=headerlink href=#定义-8 title=定义></a>定义</h4><p>解释器模式提供了解析和执行语言的语法或表达式的方式。解释器模式用于定义一个语言的文法，并建立一个解释器来解释该语言中的句子或表达式。<h4 id=结构-10><a class=headerlink href=#结构-10 title=结构></a>结构</h4><ul><li>抽象表达式<li>终结符表达式<li>非终结符表达式<li>上下文<li>客户端</ul><h4 id=何时使用-11><a class=headerlink href=#何时使用-11 title=何时使用></a>何时使用</h4><p>某一个类型的问题发送频率特高，可以将该类型问题的各实例封装成一个简单描述，然后通过解释器来解释处理该描述。<h4 id=优缺点-11><a class=headerlink href=#优缺点-11 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>可扩展性比较好，灵活。<li>增加了新的解释表达式的方式。<li>易于实现简单文法。</ol><li>缺点<ol><li>可利用场景比较少。<li>对于复杂的文法比较难维护。<li>解释器模式会引起类膨胀。<li>解释器模式采用递归调用方法。</ol></ul><h4 id=使用场景-11><a class=headerlink href=#使用场景-11 title=使用场景></a>使用场景</h4><ol><li>将一个解释执行语言中的句子表示为一个抽象语法树。<li>重复出现的问题可以用一种简单的语言来进行表达。<li>简单语法需要解释的场景。</ol><h4 id=应用实例-10><a class=headerlink href=#应用实例-10 title=应用实例></a>应用实例</h4><p>编译器、运算表达式计算。<h4 id=注意事项-11><a class=headerlink href=#注意事项-11 title=注意事项></a>注意事项</h4><p><font color=red>可利用场景比较少，JAVA 中可以用 expression4J 代替。</font><h4 id=代码实例-11><a class=headerlink href=#代码实例-11 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br></pre><td class=code><pre><span class=line><span class=comment>// 抽象表达式接口</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">Expression</span> {</span><br><span class=line>    <span class=type>int</span> <span class="title function_">interpret</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 终结符表达式：常量表达式</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">NumberExpression</span> <span class=keyword>implements</span> <span class="title class_">Expression</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=type>int</span> number;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">NumberExpression</span><span class=params>(<span class=type>int</span> number)</span> {</span><br><span class=line>        <span class=built_in>this</span>.number = number;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=type>int</span> <span class="title function_">interpret</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=built_in>this</span>.number;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 非终结符表达式：加法表达式</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">AddExpression</span> <span class=keyword>implements</span> <span class="title class_">Expression</span> {</span><br><span class=line>    <span class=keyword>private</span> Expression leftExpression;</span><br><span class=line>    <span class=keyword>private</span> Expression rightExpression;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">AddExpression</span><span class=params>(Expression leftExpression, Expression rightExpression)</span> {</span><br><span class=line>        <span class=built_in>this</span>.leftExpression = leftExpression;</span><br><span class=line>        <span class=built_in>this</span>.rightExpression = rightExpression;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=type>int</span> <span class="title function_">interpret</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> leftExpression.interpret() + rightExpression.interpret();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 非终结符表达式：减法表达式</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">SubtractExpression</span> <span class=keyword>implements</span> <span class="title class_">Expression</span> {</span><br><span class=line>    <span class=keyword>private</span> Expression leftExpression;</span><br><span class=line>    <span class=keyword>private</span> Expression rightExpression;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">SubtractExpression</span><span class=params>(Expression leftExpression, Expression rightExpression)</span> {</span><br><span class=line>        <span class=built_in>this</span>.leftExpression = leftExpression;</span><br><span class=line>        <span class=built_in>this</span>.rightExpression = rightExpression;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=type>int</span> <span class="title function_">interpret</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> leftExpression.interpret() - rightExpression.interpret();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 客户端代码</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">InterpreterPatternDemo</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=comment>// 构造一个加法表达式： (10 + (5 - 2))</span></span><br><span class=line>        <span class=type>Expression</span> <span class=variable>expression</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">AddExpression</span>(</span><br><span class=line>            <span class=keyword>new</span> <span class="title class_">NumberExpression</span>(<span class=number>10</span>), </span><br><span class=line>            <span class=keyword>new</span> <span class="title class_">SubtractExpression</span>(<span class=keyword>new</span> <span class="title class_">NumberExpression</span>(<span class=number>5</span>), <span class=keyword>new</span> <span class="title class_">NumberExpression</span>(<span class=number>2</span>))</span><br><span class=line>        );</span><br><span class=line></span><br><span class=line>        <span class=comment>// 解释并求值</span></span><br><span class=line>        System.out.println(<span class=string>"结果："</span> + expression.interpret());</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-8、Command（命令模式）><a class=headerlink href=#1-2-8、Command（命令模式） title=1.2.8、Command（命令模式）></a>1.2.8、Command（命令模式）</h3><h4 id=定义-9><a class=headerlink href=#定义-9 title=定义></a>定义</h4><p>命令模式会将请求封装为一个对象，以实现可以用不同的请求对客户进行参数化、请求排队、记录日志以及支持可撤销操作。命令模式的核心思想是将请求和接收者进行解耦，形成一种调用者和执行者之间的松耦合结构。<h4 id=结构-11><a class=headerlink href=#结构-11 title=结构></a>结构</h4><ul><li>命令接口<li>具体命令类<li>接收者<li>调用者<li>客户端</ul><h4 id=何时使用-12><a class=headerlink href=#何时使用-12 title=何时使用></a>何时使用</h4><p>在某些场合，比如要对行为进行 “记录、撤销 / 重做、事务” 等处理，这种无法抵御变化的紧耦合是不合适的。在这种情况下，如何将 “行为请求者” 与 “行为实现者” 解耦？将一组行为抽象为对象，可以实现二者之间的松耦合。<h4 id=优缺点-12><a class=headerlink href=#优缺点-12 title=优缺点></a>优缺点</h4><ul><li><p>优点</p> <ol><li>降低了系统耦合度。<li>新命令可以很容易添加到系统中去。</ol><li><p>缺点</p> <p>可能会导致某些系统有过多的具体命令类。</p></ul><h4 id=使用场景-12><a class=headerlink href=#使用场景-12 title=使用场景></a>使用场景</h4><ol><li>GUI 中每一个按钮都是一条命令。<li>模拟 CMD。</ol><h4 id=应用实例-11><a class=headerlink href=#应用实例-11 title=应用实例></a>应用实例</h4><p>struts 1 中 action 的核心控制器 ActionServlet 只有一个，相当于 Invoker，而模型层也会有对应不同的模型类，相当于具体的 Command。<h4 id=注意事项-12><a class=headerlink href=#注意事项-12 title=注意事项></a>注意事项</h4><p><font color=red>需要支持命令的撤销 (Undo) 操作和恢复 (Redo) 操作。</font><h4 id=代码实例-12><a class=headerlink href=#代码实例-12 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br></pre><td class=code><pre><span class=line><span class=comment>// 命令接口</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">Command</span> {</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">execute</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 接收者：灯</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">Light</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">turnOn</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"灯打开了"</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">turnOff</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"灯关闭了"</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体命令：打开灯命令</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">TurnOnLightCommand</span> <span class=keyword>implements</span> <span class="title class_">Command</span> {</span><br><span class=line>    <span class=keyword>private</span> Light light;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">TurnOnLightCommand</span><span class=params>(Light light)</span> {</span><br><span class=line>        <span class=built_in>this</span>.light = light;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">execute</span><span class=params>()</span> {</span><br><span class=line>        light.turnOn();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体命令：关闭灯命令</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">TurnOffLightCommand</span> <span class=keyword>implements</span> <span class="title class_">Command</span> {</span><br><span class=line>    <span class=keyword>private</span> Light light;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">TurnOffLightCommand</span><span class=params>(Light light)</span> {</span><br><span class=line>        <span class=built_in>this</span>.light = light;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">execute</span><span class=params>()</span> {</span><br><span class=line>        light.turnOff();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 调用者：遥控器</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">RemoteControl</span> {</span><br><span class=line>    <span class=keyword>private</span> Command command;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setCommand</span><span class=params>(Command command)</span> {</span><br><span class=line>        <span class=built_in>this</span>.command = command;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">pressButton</span><span class=params>()</span> {</span><br><span class=line>        command.execute();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 客户端代码</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">CommandPatternDemo</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=comment>// 创建接收者对象</span></span><br><span class=line>        <span class=type>Light</span> <span class=variable>livingRoomLight</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Light</span>();</span><br><span class=line></span><br><span class=line>        <span class=comment>// 创建具体命令</span></span><br><span class=line>        <span class=type>Command</span> <span class=variable>turnOnCommand</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">TurnOnLightCommand</span>(livingRoomLight);</span><br><span class=line>        <span class=type>Command</span> <span class=variable>turnOffCommand</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">TurnOffLightCommand</span>(livingRoomLight);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 创建调用者（遥控器）</span></span><br><span class=line>        <span class=type>RemoteControl</span> <span class=variable>remote</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">RemoteControl</span>();</span><br><span class=line></span><br><span class=line>        <span class=comment>// 打开灯</span></span><br><span class=line>        remote.setCommand(turnOnCommand);</span><br><span class=line>        remote.pressButton();</span><br><span class=line></span><br><span class=line>        <span class=comment>// 关闭灯</span></span><br><span class=line>        remote.setCommand(turnOffCommand);</span><br><span class=line>        remote.pressButton();</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-9、State（状态模式）><a class=headerlink href=#1-2-9、State（状态模式） title=1.2.9、State（状态模式）></a>1.2.9、State（状态模式）</h3><h4 id=定义-10><a class=headerlink href=#定义-10 title=定义></a>定义</h4><p>状态模式允许一个对象在内部状态发生改变时，改变它的行为。通过将状态封装为独立的类，状态模式使得对象的行为和状态之间的依赖关系得到解耦，从而使得状态转换更为灵活和清晰。<h4 id=结构-12><a class=headerlink href=#结构-12 title=结构></a>结构</h4><ul><li>上下文<li>状态接口<li>具体状态类</ul><h4 id=何时使用-13><a class=headerlink href=#何时使用-13 title=何时使用></a>何时使用</h4><p>代码中包含大量与对象状态有关的条件语句。<h4 id=优缺点-13><a class=headerlink href=#优缺点-13 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>封装了转换规则。<li>枚举可能的状态，在枚举状态之前需要确定状态种类。<li>将所有与某个状态有关的行为放到一个类中，并且可以方便地增加新的状态，只需要改变对象状态即可改变对象的行为。<li>允许状态转换逻辑与状态对象合成一体，而不是某一个巨大的条件语句块。<li>可以让多个环境对象共享一个状态对象，从而减少系统中对象的个数。</ol><li>缺点<ol><li>状态模式的使用必然会增加系统类和对象的个数。<li>状态模式的结构与实现都较为复杂，如果使用不当将导致程序结构和代码的混乱。<li>状态模式对 “开闭原则” 的支持并不太好，对于可以切换状态的状态模式，增加新的状态类需要修改那些负责状态转换的源代码，否则无法切换到新增状态，而且修改某个状态类的行为也需修改对应类的源代码。</ol></ul><h4 id=使用场景-13><a class=headerlink href=#使用场景-13 title=使用场景></a>使用场景</h4><ol><li>行为随状态改变而改变的场景。<li>条件、分支语句的代替者。</ol><h4 id=应用实例-12><a class=headerlink href=#应用实例-12 title=应用实例></a>应用实例</h4><ol><li>打篮球的时候运动员可以有正常状态. 不正常状态和超常状态。<li>‘曾侯乙编钟’是具体环境(Context)，钟是抽象接口，钟 A是具体状态。</ol><h4 id=注意事项-13><a class=headerlink href=#注意事项-13 title=注意事项></a>注意事项</h4><p><font color=red>行为受状态约束时使用状态模式，而且状态不超过 5 个。</font><h4 id=代码实例-13><a class=headerlink href=#代码实例-13 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br><span class=line>120</span><br><span class=line>121</span><br><span class=line>122</span><br><span class=line>123</span><br><span class=line>124</span><br><span class=line>125</span><br><span class=line>126</span><br><span class=line>127</span><br><span class=line>128</span><br><span class=line>129</span><br><span class=line>130</span><br><span class=line>131</span><br><span class=line>132</span><br><span class=line>133</span><br><span class=line>134</span><br><span class=line>135</span><br><span class=line>136</span><br><span class=line>137</span><br><span class=line>138</span><br><span class=line>139</span><br><span class=line>140</span><br><span class=line>141</span><br><span class=line>142</span><br><span class=line>143</span><br><span class=line>144</span><br><span class=line>145</span><br><span class=line>146</span><br><span class=line>147</span><br><span class=line>148</span><br><span class=line>149</span><br><span class=line>150</span><br><span class=line>151</span><br><span class=line>152</span><br><span class=line>153</span><br><span class=line>154</span><br><span class=line>155</span><br><span class=line>156</span><br><span class=line>157</span><br><span class=line>158</span><br><span class=line>159</span><br><span class=line>160</span><br><span class=line>161</span><br></pre><td class=code><pre><span class=line><span class=comment>// 状态接口</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">State</span> {</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">pressOpenButton</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">pressCloseButton</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">pressMoveButton</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">pressStopButton</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体状态类：停止状态</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">StoppedState</span> <span class=keyword>implements</span> <span class="title class_">State</span> {</span><br><span class=line>    <span class=keyword>private</span> ElevatorContext context;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">StoppedState</span><span class=params>(ElevatorContext context)</span> {</span><br><span class=line>        <span class=built_in>this</span>.context = context;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">pressOpenButton</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"门打开了。"</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">pressCloseButton</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"门关闭了。"</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">pressMoveButton</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"电梯开始运行。"</span>);</span><br><span class=line>        context.setState(context.getMovingState());  <span class=comment>// 切换到运行状态</span></span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">pressStopButton</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"电梯已经停止。"</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体状态类：运行状态</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">MovingState</span> <span class=keyword>implements</span> <span class="title class_">State</span> {</span><br><span class=line>    <span class=keyword>private</span> ElevatorContext context;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">MovingState</span><span class=params>(ElevatorContext context)</span> {</span><br><span class=line>        <span class=built_in>this</span>.context = context;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">pressOpenButton</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"电梯运行中，不能开门！"</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">pressCloseButton</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"门已经是关闭状态。"</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">pressMoveButton</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"电梯已经在运行中。"</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">pressStopButton</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"电梯停止运行。"</span>);</span><br><span class=line>        context.setState(context.getStoppedState());  <span class=comment>// 切换到停止状态</span></span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体状态类：维护状态</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">MaintenanceState</span> <span class=keyword>implements</span> <span class="title class_">State</span> {</span><br><span class=line>    <span class=keyword>private</span> ElevatorContext context;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">MaintenanceState</span><span class=params>(ElevatorContext context)</span> {</span><br><span class=line>        <span class=built_in>this</span>.context = context;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">pressOpenButton</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"电梯维护中，不能开门！"</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">pressCloseButton</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"电梯维护中，门不能关闭！"</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">pressMoveButton</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"电梯维护中，不能运行！"</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">pressStopButton</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"电梯已经停止维护。"</span>);</span><br><span class=line>        context.setState(context.getStoppedState());  <span class=comment>// 切换到停止状态</span></span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 上下文类：电梯</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">ElevatorContext</span> {</span><br><span class=line>    <span class=keyword>private</span> State stoppedState;</span><br><span class=line>    <span class=keyword>private</span> State movingState;</span><br><span class=line>    <span class=keyword>private</span> State maintenanceState;</span><br><span class=line>    <span class=keyword>private</span> State currentState;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">ElevatorContext</span><span class=params>()</span> {</span><br><span class=line>        stoppedState = <span class=keyword>new</span> <span class="title class_">StoppedState</span>(<span class=built_in>this</span>);</span><br><span class=line>        movingState = <span class=keyword>new</span> <span class="title class_">MovingState</span>(<span class=built_in>this</span>);</span><br><span class=line>        maintenanceState = <span class=keyword>new</span> <span class="title class_">MaintenanceState</span>(<span class=built_in>this</span>);</span><br><span class=line>        currentState = stoppedState;  <span class=comment>// 初始状态为停止状态</span></span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setState</span><span class=params>(State state)</span> {</span><br><span class=line>        currentState = state;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">pressOpenButton</span><span class=params>()</span> {</span><br><span class=line>        currentState.pressOpenButton();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">pressCloseButton</span><span class=params>()</span> {</span><br><span class=line>        currentState.pressCloseButton();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">pressMoveButton</span><span class=params>()</span> {</span><br><span class=line>        currentState.pressMoveButton();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">pressStopButton</span><span class=params>()</span> {</span><br><span class=line>        currentState.pressStopButton();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>// 获取不同状态的对象</span></span><br><span class=line>    <span class=keyword>public</span> State <span class="title function_">getStoppedState</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> stoppedState;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> State <span class="title function_">getMovingState</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> movingState;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> State <span class="title function_">getMaintenanceState</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> maintenanceState;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 客户端代码</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">StatePatternDemo</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>ElevatorContext</span> <span class=variable>elevator</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ElevatorContext</span>();</span><br><span class=line></span><br><span class=line>        <span class=comment>// 电梯处于停止状态</span></span><br><span class=line>        elevator.pressOpenButton();   <span class=comment>// 门打开了</span></span><br><span class=line>        elevator.pressMoveButton();   <span class=comment>// 电梯开始运行</span></span><br><span class=line>        elevator.pressOpenButton();   <span class=comment>// 电梯运行中，不能开门！</span></span><br><span class=line></span><br><span class=line>        <span class=comment>// 切换到停止状态</span></span><br><span class=line>        elevator.pressStopButton();   <span class=comment>// 电梯停止运行</span></span><br><span class=line>        elevator.pressOpenButton();   <span class=comment>// 门打开了</span></span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-10、Visitor（访问者模式）><a class=headerlink href=#1-2-10、Visitor（访问者模式） title=1.2.10、Visitor（访问者模式）></a>1.2.10、Visitor（访问者模式）</h3><h4 id=定义-11><a class=headerlink href=#定义-11 title=定义></a>定义</h4><p>访问者模式允许你在不修改对象结构的前提下，增加新的操作。访问者模式将数据结构与作用于数据结构的操作进行分离，使得新的操作可以很容易地扩展而不需要修改现有类的代码，符合开闭原则。<h4 id=结构-13><a class=headerlink href=#结构-13 title=结构></a>结构</h4><ul><li>访问者接口<li>具体访问者<li>元素接口<li>具体元素类<li>对象结构</ul><h4 id=何时使用-14><a class=headerlink href=#何时使用-14 title=何时使用></a>何时使用</h4><p>对一个对象执行多种不同操作，且要避免这些操作影响对象关联的类，可以使用该模式将这些操作封装到类中。<h4 id=优缺点-14><a class=headerlink href=#优缺点-14 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>符合单一职责原则。<li>优秀的扩展性。<li>灵活性。</ol><li>缺点<ol><li>具体元素对访问者公布细节，违反了迪米特原则。<li>具体元素变更比较困难。<li>违反了依赖倒置原则，依赖具体类，没有依赖抽象。</ol></ul><h4 id=使用场景-14><a class=headerlink href=#使用场景-14 title=使用场景></a>使用场景</h4><ol><li>对象对应的类很少改变，但需要在对象上添加新操作。<li>需要对一个对象执行多种不同操作，且要避免这些操作影响对象对应的类，且在添加新操作时也不想修改该类的场景；</ol><h4 id=应用实例-13><a class=headerlink href=#应用实例-13 title=应用实例></a>应用实例</h4><p>你去朋友家做客，您是访问者，朋友接受您的访问，然后对朋友的描述做出一个判断，这就是访问者模式。<h4 id=注意事项-14><a class=headerlink href=#注意事项-14 title=注意事项></a>注意事项</h4><p><font color=red>访问者可以对功能进行统一，可以做报表、UI、拦截器与过滤器。</font><h4 id=代码实例-14><a class=headerlink href=#代码实例-14 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br><span class=line>120</span><br><span class=line>121</span><br><span class=line>122</span><br><span class=line>123</span><br><span class=line>124</span><br><span class=line>125</span><br><span class=line>126</span><br><span class=line>127</span><br></pre><td class=code><pre><span class=line><span class=comment>// 访问者接口</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">Visitor</span> {</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">visit</span><span class=params>(Employee employee)</span>;</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">visit</span><span class=params>(Manager manager)</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体访问者类：工资计算</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">SalaryVisitor</span> <span class=keyword>implements</span> <span class="title class_">Visitor</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">visit</span><span class=params>(Employee employee)</span> {</span><br><span class=line>        System.out.println(<span class=string>"普通员工 "</span> + employee.getName() + <span class=string>" 的工资为: "</span> + (employee.getSalary() * <span class=number>1.0</span>));</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">visit</span><span class=params>(Manager manager)</span> {</span><br><span class=line>        System.out.println(<span class=string>"经理 "</span> + manager.getName() + <span class=string>" 的工资为: "</span> + (manager.getSalary() * <span class=number>1.2</span>));</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体访问者类：打印信息</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">PrintInfoVisitor</span> <span class=keyword>implements</span> <span class="title class_">Visitor</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">visit</span><span class=params>(Employee employee)</span> {</span><br><span class=line>        System.out.println(<span class=string>"普通员工: "</span> + employee.getName());</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">visit</span><span class=params>(Manager manager)</span> {</span><br><span class=line>        System.out.println(<span class=string>"经理: "</span> + manager.getName());</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 元素接口</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">Element</span> {</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">accept</span><span class=params>(Visitor visitor)</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体元素类：普通员工</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">Employee</span> <span class=keyword>implements</span> <span class="title class_">Element</span> {</span><br><span class=line>    <span class=keyword>private</span> String name;</span><br><span class=line>    <span class=keyword>private</span> <span class=type>double</span> salary;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">Employee</span><span class=params>(String name, <span class=type>double</span> salary)</span> {</span><br><span class=line>        <span class=built_in>this</span>.name = name;</span><br><span class=line>        <span class=built_in>this</span>.salary = salary;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">getName</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> name;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=type>double</span> <span class="title function_">getSalary</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> salary;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">accept</span><span class=params>(Visitor visitor)</span> {</span><br><span class=line>        visitor.visit(<span class=built_in>this</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体元素类：经理</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">Manager</span> <span class=keyword>implements</span> <span class="title class_">Element</span> {</span><br><span class=line>    <span class=keyword>private</span> String name;</span><br><span class=line>    <span class=keyword>private</span> <span class=type>double</span> salary;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">Manager</span><span class=params>(String name, <span class=type>double</span> salary)</span> {</span><br><span class=line>        <span class=built_in>this</span>.name = name;</span><br><span class=line>        <span class=built_in>this</span>.salary = salary;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">getName</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> name;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=type>double</span> <span class="title function_">getSalary</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> salary;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">accept</span><span class=params>(Visitor visitor)</span> {</span><br><span class=line>        visitor.visit(<span class=built_in>this</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 对象结构：公司</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">Company</span> {</span><br><span class=line>    <span class=keyword>private</span> List&LTElement> employees = <span class=keyword>new</span> <span class="title class_">ArrayList</span><>();</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">addEmployee</span><span class=params>(Element employee)</span> {</span><br><span class=line>        employees.add(employee);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">accept</span><span class=params>(Visitor visitor)</span> {</span><br><span class=line>        <span class=keyword>for</span> (Element employee : employees) {</span><br><span class=line>            employee.accept(visitor);</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 客户端代码</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">VisitorPatternDemo</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=comment>// 创建员工</span></span><br><span class=line>        <span class=type>Employee</span> <span class=variable>emp1</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Employee</span>(<span class=string>"张三"</span>, <span class=number>5000</span>);</span><br><span class=line>        <span class=type>Employee</span> <span class=variable>emp2</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Employee</span>(<span class=string>"李四"</span>, <span class=number>4000</span>);</span><br><span class=line>        <span class=type>Manager</span> <span class=variable>mgr1</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Manager</span>(<span class=string>"王经理"</span>, <span class=number>8000</span>);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 创建公司</span></span><br><span class=line>        <span class=type>Company</span> <span class=variable>company</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Company</span>();</span><br><span class=line>        company.addEmployee(emp1);</span><br><span class=line>        company.addEmployee(emp2);</span><br><span class=line>        company.addEmployee(mgr1);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 创建访问者</span></span><br><span class=line>        <span class=type>SalaryVisitor</span> <span class=variable>salaryVisitor</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">SalaryVisitor</span>();</span><br><span class=line>        <span class=type>PrintInfoVisitor</span> <span class=variable>printInfoVisitor</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">PrintInfoVisitor</span>();</span><br><span class=line></span><br><span class=line>        <span class=comment>// 访问员工，计算工资</span></span><br><span class=line>        System.out.println(<span class=string>"工资计算："</span>);</span><br><span class=line>        company.accept(salaryVisitor);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 访问员工，打印信息</span></span><br><span class=line>        System.out.println(<span class=string>"\n打印信息："</span>);</span><br><span class=line>        company.accept(printInfoVisitor);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-2-11、Memento（备忘录模式）><a class=headerlink href=#1-2-11、Memento（备忘录模式） title=1.2.11、Memento（备忘录模式）></a>1.2.11、Memento（备忘录模式）</h3><h4 id=定义-12><a class=headerlink href=#定义-12 title=定义></a>定义</h4><p>备忘录模式用于在不破坏封装性的前提下，捕获和恢复对象的内部状态。备忘录模式允许对象保存其历史状态，以便在需要时恢复到之前的状态，常用于实现撤销、重做功能。<h4 id=结构-14><a class=headerlink href=#结构-14 title=结构></a>结构</h4><ul><li>发起人<li>备忘录<li>负责人</ul><h4 id=何时使用-15><a class=headerlink href=#何时使用-15 title=何时使用></a>何时使用</h4><p>用户需要取消不确定或者错误的操作时，能够恢复到他原先的状态，使得他有 “后悔药” 可吃。<h4 id=优缺点-15><a class=headerlink href=#优缺点-15 title=优缺点></a>优缺点</h4><ul><li><p>优点</p> <ol><li>给用户提供了一种可以恢复状态的机制，可以使用户能够比较方便地回到某个历史的状态。<li>实现了信息的封装，使得用户不需要关心状态的保存细节。</ol><li><p>缺点</p> <p>消耗资源。类成员数量多导致占用大量资源，且保存时会占用内存。</p></ul><h4 id=使用场景-15><a class=headerlink href=#使用场景-15 title=使用场景></a>使用场景</h4><ol><li>需要保存 / 恢复数据的相关状态场景。<li>提供一个可回滚的操作。</ol><h4 id=应用实例-14><a class=headerlink href=#应用实例-14 title=应用实例></a>应用实例</h4><ol><li>后悔药。<li>打游戏时的存档。<li>Windows 里的 ctri + z。<li>IE 中的后退。<li>数据库的事务管理。</ol><h4 id=注意事项-15><a class=headerlink href=#注意事项-15 title=注意事项></a>注意事项</h4><ol><li><font color=red>为了符合迪米特原则，还要增加一个管理备忘录的类。</font><li><font color=red>为了节约内存，可使用原型模式 + 备忘录模式。</font></ol><h4 id=代码实例-15><a class=headerlink href=#代码实例-15 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br></pre><td class=code><pre><span class=line><span class=comment>// 备忘录类：保存编辑器的状态</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">TextEditorMemento</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>final</span> String text;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">TextEditorMemento</span><span class=params>(String text)</span> {</span><br><span class=line>        <span class=built_in>this</span>.text = text;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">getText</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> text;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 发起人类：文本编辑器</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">TextEditor</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=type>StringBuilder</span> <span class=variable>text</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">StringBuilder</span>();</span><br><span class=line></span><br><span class=line>    <span class=comment>// 编辑文本</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">write</span><span class=params>(String newText)</span> {</span><br><span class=line>        text.append(newText);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>// 获取当前文本</span></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">getText</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> text.toString();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>// 创建备忘录，保存当前状态</span></span><br><span class=line>    <span class=keyword>public</span> TextEditorMemento <span class="title function_">save</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">TextEditorMemento</span>(text.toString());</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>// 恢复备忘录中的状态</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">restore</span><span class=params>(TextEditorMemento memento)</span> {</span><br><span class=line>        text = <span class=keyword>new</span> <span class="title class_">StringBuilder</span>(memento.getText());</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 负责人类：保存备忘录</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">Caretaker</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>final</span> List&LTTextEditorMemento> mementos = <span class=keyword>new</span> <span class="title class_">ArrayList</span><>();</span><br><span class=line></span><br><span class=line>    <span class=comment>// 保存备忘录</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">addMemento</span><span class=params>(TextEditorMemento memento)</span> {</span><br><span class=line>        mementos.add(memento);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>// 获取最后一个备忘录（撤销功能）</span></span><br><span class=line>    <span class=keyword>public</span> TextEditorMemento <span class="title function_">getLastMemento</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>if</span> (mementos.size() == <span class=number>0</span>) {</span><br><span class=line>            <span class=keyword>return</span> <span class=literal>null</span>;</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> mementos.remove(mementos.size() - <span class=number>1</span>);  <span class=comment>// 删除并返回最后一个备忘录</span></span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 客户端代码</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">MementoPatternDemo</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>TextEditor</span> <span class=variable>editor</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">TextEditor</span>();</span><br><span class=line>        <span class=type>Caretaker</span> <span class=variable>caretaker</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Caretaker</span>();</span><br><span class=line></span><br><span class=line>        <span class=comment>// 用户输入文本</span></span><br><span class=line>        editor.write(<span class=string>"Hello "</span>);</span><br><span class=line>        caretaker.addMemento(editor.save());  <span class=comment>// 保存当前状态</span></span><br><span class=line></span><br><span class=line>        editor.write(<span class=string>"World!"</span>);</span><br><span class=line>        caretaker.addMemento(editor.save());  <span class=comment>// 保存当前状态</span></span><br><span class=line></span><br><span class=line>        System.out.println(<span class=string>"当前文本: "</span> + editor.getText());  <span class=comment>// 当前文本: Hello World!</span></span><br><span class=line></span><br><span class=line>        <span class=comment>// 撤销操作</span></span><br><span class=line>        editor.restore(caretaker.getLastMemento());</span><br><span class=line>        System.out.println(<span class=string>"撤销一次: "</span> + editor.getText());  <span class=comment>// 撤销一次: Hello </span></span><br><span class=line></span><br><span class=line>        <span class=comment>// 再次撤销</span></span><br><span class=line>        editor.restore(caretaker.getLastMemento());</span><br><span class=line>        System.out.println(<span class=string>"再次撤销: "</span> + editor.getText());  <span class=comment>// 再次撤销: (空)</span></span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h2 id=1-3、结构型（7种）><a class=headerlink href=#1-3、结构型（7种） title=1.3、结构型（7种）></a>1.3、结构型（7种）</h2><h3 id=1-3-1、Composite（组合模式）><a class=headerlink href=#1-3-1、Composite（组合模式） title=1.3.1、Composite（组合模式）></a>1.3.1、Composite（组合模式）</h3><h4 id=定义-13><a class=headerlink href=#定义-13 title=定义></a>定义</h4><p>组合模式通过将对象组合成树形结构来表示部分、整体的层次结构，使得客户端可以以相同的方式处理单个对象和组合对象。它允许你通过递归方式来组合对象，从而以统一的方式来处理这些对象。<h4 id=结构-15><a class=headerlink href=#结构-15 title=结构></a>结构</h4><ul><li>Component（抽象组件）：定义所有组合对象的公共接口，它既可以是叶子节点，也可以是组合对象。<li>Leaf（叶子节点）：表示组合的叶子对象，不能包含子节点，是组合中的基本构件。<li>Composite（组合对象）：包含子对象的组合对象。它实现了Component接口，且可以包含其它Component对象（包括Leaf和Composite对象）。</ul><h4 id=何时使用-16><a class=headerlink href=#何时使用-16 title=何时使用></a>何时使用</h4><ol><li>想表示对象部分 - 整体的层次结构（树形结构）。<li>忽略组合对象与单个对象的不同，用户将统一地使用组合结构中的所有对象。</ol><h4 id=优缺点-16><a class=headerlink href=#优缺点-16 title=优缺点></a>优缺点</h4><ul><li><p>优点</p> <ol><li>高层模块调用简单。<li>节点自由增加。</ol><li><p>缺点</p> <p>在使用组合模式时，其叶子和树枝的声明都是实现类，而不是接口，违反了依赖倒置原则。</p></ul><h4 id=使用场景-16><a class=headerlink href=#使用场景-16 title=使用场景></a>使用场景</h4><ol><li>树形结构。组合模式非常适合处理文件系统、组织结构、UI组件树等树形结构的数据。<li>一致性操作。希望客户端以统一的方式处理单个对象和组合对象。</ol><h4 id=应用实例-15><a class=headerlink href=#应用实例-15 title=应用实例></a>应用实例</h4><ol><li>算术表达式包括操作数. 操作符和另一个操作数，其中，另一个操作符也可以是操作数. 操作符和另一个操作数。<li>在 JAVA AWT 和 SWING 中，对于 Button 和 Checkbox 是树叶，Container 是树枝。</ol><h4 id=注意事项-16><a class=headerlink href=#注意事项-16 title=注意事项></a>注意事项</h4><p><font color=red>定义时 为 具体类。</font><h4 id=代码实例-16><a class=headerlink href=#代码实例-16 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br></pre><td class=code><pre><span class=line><span class=comment>// 抽象组件类，定义叶子和组合对象的共同接口</span></span><br><span class=line><span class=keyword>abstract</span> <span class=keyword>class</span> <span class="title class_">FileSystemComponent</span> {</span><br><span class=line>    <span class=keyword>protected</span> String name;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">FileSystemComponent</span><span class=params>(String name)</span> {</span><br><span class=line>        <span class=built_in>this</span>.name = name;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>// 打印组件的名称</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>abstract</span> <span class=keyword>void</span> <span class="title function_">show</span><span class=params>()</span>;</span><br><span class=line></span><br><span class=line>    <span class=comment>// 叶子节点不支持添加和移除子节点，组合对象需要重写这些方法</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">add</span><span class=params>(FileSystemComponent component)</span> {</span><br><span class=line>        <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">UnsupportedOperationException</span>(<span class=string>"Operation not supported."</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">remove</span><span class=params>(FileSystemComponent component)</span> {</span><br><span class=line>        <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">UnsupportedOperationException</span>(<span class=string>"Operation not supported."</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 叶子节点：文件</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">File</span> <span class=keyword>extends</span> <span class="title class_">FileSystemComponent</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">File</span><span class=params>(String name)</span> {</span><br><span class=line>        <span class=built_in>super</span>(name);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">show</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"File: "</span> + name);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 组合对象：文件夹</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">Directory</span> <span class=keyword>extends</span> <span class="title class_">FileSystemComponent</span> {</span><br><span class=line>    <span class=keyword>private</span> List&LTFileSystemComponent> children = <span class=keyword>new</span> <span class="title class_">ArrayList</span><>();</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">Directory</span><span class=params>(String name)</span> {</span><br><span class=line>        <span class=built_in>super</span>(name);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">show</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Directory: "</span> + name);</span><br><span class=line>        <span class=keyword>for</span> (FileSystemComponent component : children) {</span><br><span class=line>            component.show();  <span class=comment>// 递归调用子节点的show方法</span></span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">add</span><span class=params>(FileSystemComponent component)</span> {</span><br><span class=line>        children.add(component);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">remove</span><span class=params>(FileSystemComponent component)</span> {</span><br><span class=line>        children.remove(component);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Main</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=comment>// 创建文件和文件夹</span></span><br><span class=line>        <span class=type>FileSystemComponent</span> <span class=variable>file1</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">File</span>(<span class=string>"File1.txt"</span>);</span><br><span class=line>        <span class=type>FileSystemComponent</span> <span class=variable>file2</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">File</span>(<span class=string>"File2.txt"</span>);</span><br><span class=line>        <span class=type>FileSystemComponent</span> <span class=variable>file3</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">File</span>(<span class=string>"File3.txt"</span>);</span><br><span class=line></span><br><span class=line>        <span class=type>Directory</span> <span class=variable>dir1</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Directory</span>(<span class=string>"Folder1"</span>);</span><br><span class=line>        <span class=type>Directory</span> <span class=variable>dir2</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Directory</span>(<span class=string>"Folder2"</span>);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 将文件添加到文件夹中</span></span><br><span class=line>        dir1.add(file1);</span><br><span class=line>        dir1.add(file2);</span><br><span class=line>        dir2.add(file3);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 创建根目录，并将文件夹添加到根目录中</span></span><br><span class=line>        <span class=type>Directory</span> <span class=variable>root</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Directory</span>(<span class=string>"Root"</span>);</span><br><span class=line>        root.add(dir1);</span><br><span class=line>        root.add(dir2);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 显示文件系统的结构</span></span><br><span class=line>        root.show();</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-3-2、Facade（外观模式）><a class=headerlink href=#1-3-2、Facade（外观模式） title=1.3.2、Facade（外观模式）></a>1.3.2、Facade（外观模式）</h3><h4 id=定义-14><a class=headerlink href=#定义-14 title=定义></a>定义</h4><p>外观模式的目的是为复杂的子系统提供一个简化接口，使客户端可以通过一个统一接口来访问子系统的功能，而无需了解子系统的内部细节。外观模式不会改变子系统本身，而是通过创建一个外观类来简化接口。<h4 id=结构-16><a class=headerlink href=#结构-16 title=结构></a>结构</h4><ul><li>facade（外观类）：提供简化的接口，调用子系统的功能。<li>Subsystem Classes（子系统类）：子系统中的各个模块，外观类负责与这些模块进行交互。子系统并不知道外观类的存在，它们只负责执行自己的功能。<li>客户端：通过外观类与子系统进行交互，而不需要直接接触子系统。</ul><h4 id=何时使用-17><a class=headerlink href=#何时使用-17 title=何时使用></a>何时使用</h4><ol><li>无需知道系统内部，只需提供一个系统 “接待员” 即可。<li>定义系统的入口。</ol><h4 id=优缺点-17><a class=headerlink href=#优缺点-17 title=优缺点></a>优缺点</h4><ul><li><p>优点</p> <ol><li>减少系统相互依赖。<li>提高灵活性。<li>提高了安全性。</ol><li><p>缺点</p> <p>不符合开闭原则，如果要改东西很麻烦，继承重写都不合适。</p></ul><h4 id=使用场景-17><a class=headerlink href=#使用场景-17 title=使用场景></a>使用场景</h4><ol><li>为复杂的模块或子系统提供外界访问的模块。<li>子系统相对独立。<li>预防低水平人员带来的风险。</ol><h4 id=应用实例-16><a class=headerlink href=#应用实例-16 title=应用实例></a>应用实例</h4><ol><li>去医院看病，可能要去挂号、门诊、划价、取药，让患者或患者家属觉得很复杂，如果有提供接待人员，只让接待人员来处理，就很方便。<li>JAVA 的三层开发模式。</ol><h4 id=注意事项-17><a class=headerlink href=#注意事项-17 title=注意事项></a>注意事项</h4><p><font color=red>在层次化结构中，可以使用外观模式定义系统每一层的入口。</font><h4 id=代码实例-17><a class=headerlink href=#代码实例-17 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br></pre><td class=code><pre><span class=line><span class=comment>// 子系统类1：DVD播放器</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">DVDPlayer</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">on</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"DVD Player is ON."</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">play</span><span class=params>(String movie)</span> {</span><br><span class=line>        System.out.println(<span class=string>"Playing movie: "</span> + movie);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">off</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"DVD Player is OFF."</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 子系统类2：投影仪</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">Projector</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">on</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Projector is ON."</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">off</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Projector is OFF."</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 子系统类3：音响系统</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">SoundSystem</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">on</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Sound System is ON."</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setVolume</span><span class=params>(<span class=type>int</span> level)</span> {</span><br><span class=line>        System.out.println(<span class=string>"Setting volume to: "</span> + level);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">off</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Sound System is OFF."</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 子系统类4：灯光控制</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">Lights</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">dim</span><span class=params>(<span class=type>int</span> level)</span> {</span><br><span class=line>        System.out.println(<span class=string>"Dimming lights to: "</span> + level + <span class=string>"%"</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">on</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Lights are ON."</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 外观类：家庭影院外观</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">HomeTheaterFacade</span> {</span><br><span class=line>    <span class=keyword>private</span> DVDPlayer dvdPlayer;</span><br><span class=line>    <span class=keyword>private</span> Projector projector;</span><br><span class=line>    <span class=keyword>private</span> SoundSystem soundSystem;</span><br><span class=line>    <span class=keyword>private</span> Lights lights;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">HomeTheaterFacade</span><span class=params>(DVDPlayer dvdPlayer, Projector projector, SoundSystem soundSystem, Lights lights)</span> {</span><br><span class=line>        <span class=built_in>this</span>.dvdPlayer = dvdPlayer;</span><br><span class=line>        <span class=built_in>this</span>.projector = projector;</span><br><span class=line>        <span class=built_in>this</span>.soundSystem = soundSystem;</span><br><span class=line>        <span class=built_in>this</span>.lights = lights;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>// 统一的接口：开启家庭影院观看电影</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">watchMovie</span><span class=params>(String movie)</span> {</span><br><span class=line>        System.out.println(<span class=string>"Setting up movie night..."</span>);</span><br><span class=line>        lights.dim(<span class=number>20</span>);  <span class=comment>// 调暗灯光</span></span><br><span class=line>        projector.on();  <span class=comment>// 开启投影仪</span></span><br><span class=line>        soundSystem.on();  <span class=comment>// 开启音响系统</span></span><br><span class=line>        soundSystem.setVolume(<span class=number>5</span>);  <span class=comment>// 设置音量</span></span><br><span class=line>        dvdPlayer.on();  <span class=comment>// 开启DVD播放器</span></span><br><span class=line>        dvdPlayer.play(movie);  <span class=comment>// 播放电影</span></span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>// 统一的接口：关闭家庭影院</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">endMovie</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Shutting down home theater..."</span>);</span><br><span class=line>        dvdPlayer.off();</span><br><span class=line>        soundSystem.off();</span><br><span class=line>        projector.off();</span><br><span class=line>        lights.on();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Main</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=comment>// 创建各个子系统对象</span></span><br><span class=line>        <span class=type>DVDPlayer</span> <span class=variable>dvdPlayer</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">DVDPlayer</span>();</span><br><span class=line>        <span class=type>Projector</span> <span class=variable>projector</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Projector</span>();</span><br><span class=line>        <span class=type>SoundSystem</span> <span class=variable>soundSystem</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">SoundSystem</span>();</span><br><span class=line>        <span class=type>Lights</span> <span class=variable>lights</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Lights</span>();</span><br><span class=line></span><br><span class=line>        <span class=comment>// 创建外观对象，提供简化接口</span></span><br><span class=line>        <span class=type>HomeTheaterFacade</span> <span class=variable>homeTheater</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">HomeTheaterFacade</span>(dvdPlayer, projector, soundSystem, lights);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 客户端通过外观类控制家庭影院</span></span><br><span class=line>        homeTheater.watchMovie(<span class=string>"Inception"</span>);</span><br><span class=line>        System.out.println();</span><br><span class=line>        homeTheater.endMovie();</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-3-3、Proxy（代理模式）><a class=headerlink href=#1-3-3、Proxy（代理模式） title=1.3.3、Proxy（代理模式）></a>1.3.3、Proxy（代理模式）</h3><h4 id=定义-15><a class=headerlink href=#定义-15 title=定义></a>定义</h4><p><strong>为某个动作生成一个代理，用来控制对目标对象的访问。</strong><h4 id=实现-2><a class=headerlink href=#实现-2 title=实现></a>实现</h4><ul><li>静态代理<li>动态代理</ul><h4 id=何时使用-18><a class=headerlink href=#何时使用-18 title=何时使用></a>何时使用</h4><p>想在访问一个类时做一些控制。<h4 id=优缺点-18><a class=headerlink href=#优缺点-18 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>职责清晰。<li>高扩展性。<li>智能化。</ol><li>缺点<ol><li>由于增加了代理对象，因此有些类型的代理模式可能会造成请求的处理速度变慢。<li>实现代理模式需要额外的工作，有些代理模式的实现非常复杂。</ol></ul><h4 id=使用场景-18><a class=headerlink href=#使用场景-18 title=使用场景></a>使用场景</h4><ol><li>远程代理。<li>虚拟代理。<li>Copy-on-Write 代理。<li>保护（Protect or Access）代理。<li>Cache 代理。<li>防火墙（Firewall）代理。<li>同步化（Synchronization）代理。<li>智能引用（Smart Reference）代理。</ol><h4 id=应用实例-17><a class=headerlink href=#应用实例-17 title=应用实例></a>应用实例</h4><ol><li>Windows 中的快捷方式。<li>猪八戒去找高翠兰结果是孙悟空变的，可以这样理解：把高翠兰的外貌抽象出来，高翠兰本人和孙悟空都实现了这个接口，猪八戒访问高翠兰的时候看不出来这个是孙悟空，所以说孙悟空是高翠兰代理类。<li>买火车票不一定在火车站买，也可以去代售点。<li>一张支票或银行存单是账户中资金的代理。支票在市场交易中用来代替现金，并提供对签发人账号上资金的控制。<li>spring aop。</ol><h4 id=注意事项-18><a class=headerlink href=#注意事项-18 title=注意事项></a>注意事项</h4><ol><li><font color=red>与适配器模式的区别：适配器模式主要改变所考虑对象的接口，而代理模式不能改变所代理类的接口。</font><li><font color=red>与装饰器模式的区别：装饰器模式为了增强功能，而代理模式是为了加以控制。</font></ol><h4 id=代码实例-18><a class=headerlink href=#代码实例-18 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br></pre><td class=code><pre><span class=line><span class=comment>// 抽象主题接口，定义图像的行为</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">Image</span> {</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">display</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 真实的图像类，实际处理图像的加载和显示</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">RealImage</span> <span class=keyword>implements</span> <span class="title class_">Image</span> {</span><br><span class=line>    <span class=keyword>private</span> String fileName;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">RealImage</span><span class=params>(String fileName)</span> {</span><br><span class=line>        <span class=built_in>this</span>.fileName = fileName;</span><br><span class=line>        loadFromDisk();  <span class=comment>// 加载图像，模拟耗时操作</span></span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>void</span> <span class="title function_">loadFromDisk</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Loading "</span> + fileName);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">display</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Displaying "</span> + fileName);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 代理类，控制对 RealImage 的访问，并实现延迟加载</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">ImageProxy</span> <span class=keyword>implements</span> <span class="title class_">Image</span> {</span><br><span class=line>    <span class=keyword>private</span> RealImage realImage;</span><br><span class=line>    <span class=keyword>private</span> String fileName;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">ImageProxy</span><span class=params>(String fileName)</span> {</span><br><span class=line>        <span class=built_in>this</span>.fileName = fileName;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">display</span><span class=params>()</span> {</span><br><span class=line>        <span class=comment>// 只有在需要显示图像时，才去创建和加载真实的图像</span></span><br><span class=line>        <span class=keyword>if</span> (realImage == <span class=literal>null</span>) {</span><br><span class=line>            realImage = <span class=keyword>new</span> <span class="title class_">RealImage</span>(fileName);</span><br><span class=line>        }</span><br><span class=line>        realImage.display();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Main</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>Image</span> <span class=variable>image1</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ImageProxy</span>(<span class=string>"image1.jpg"</span>);</span><br><span class=line>        <span class=type>Image</span> <span class=variable>image2</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ImageProxy</span>(<span class=string>"image2.jpg"</span>);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 图像尚未加载，只有在调用 display 时才会加载</span></span><br><span class=line>        System.out.println(<span class=string>"Before calling display..."</span>);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 图像被加载并显示</span></span><br><span class=line>        image1.display();</span><br><span class=line>        image2.display();</span><br><span class=line></span><br><span class=line>        <span class=comment>// 再次调用 display，图像已经加载，不需要再次加载</span></span><br><span class=line>        System.out.println(<span class=string>"After calling display..."</span>);</span><br><span class=line>        image1.display();</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-3-4、Adpter（适配器模式）><a class=headerlink href=#1-3-4、Adpter（适配器模式） title=1.3.4、Adpter（适配器模式）></a>1.3.4、Adpter（适配器模式）</h3><h4 id=定义-16><a class=headerlink href=#定义-16 title=定义></a>定义</h4><p>适配器模式用于解决 接口不兼容 的问题，让原本不兼容的类能通过适配器来协同工作。它提供了一种包装器，将一个接口转化为另一个接口，使得不兼容的对象之间可以协作。<h4 id=结构-17><a class=headerlink href=#结构-17 title=结构></a>结构</h4><ul><li>target（目标接口）<li>adaptee（适配者）<li>adapter（适配器）<li>client（客户端）</ul><h4 id=实现-3><a class=headerlink href=#实现-3 title=实现></a>实现</h4><ul><li>Object Adapter<li>Class Adapter</ul><h4 id=何时使用-19><a class=headerlink href=#何时使用-19 title=何时使用></a>何时使用</h4><ol><li>系统需要使用现有的类，而此类的接口不符合系统需要。<li>想要建立一个可以重复使用的类，可以使得不兼容的类变得兼容起来。<li>通过接口转换，将一个类插入另一个类系中。（比如老虎和飞禽，现在多了一个飞虎，在不增加实体的需求下，增加一个适配器，在里面包容一个虎对象，实现飞的接口。）</ol><h4 id=优缺点-19><a class=headerlink href=#优缺点-19 title=优缺点></a>优缺点</h4><ul><li>优点<ol><li>可以让任何两个没有关联的类一起运行。<li>提高了类的复用。<li>增加了类的透明度。<li>灵活性好。</ol><li>缺点<ol><li>过多地使用适配器，会让系统非常零乱，不易整体进行把握。比如，明明看到调用的是 A 接口，其实内部被适配成了 B 接口的实现，一个系统如果太多出现这种情况，无异于一场灾难。因此如果不是很有必要，可以不使用适配器，而是直接对系统进行重构。<li>由于 JAVA 至多继承一个类，所以至多只能适配一个适配者类，而且目标类必须是抽象类。</ol></ul><h4 id=使用场景-19><a class=headerlink href=#使用场景-19 title=使用场景></a>使用场景</h4><ol><li>希望使用某些现有类，但接口与代码不兼容时，可以使用适配器模式。<li>希望重用几个现有子类，这些子类缺少一些不能添加到超类中的公共功能时，可以使用适配器模式。</ol><h4 id=应用实例-18><a class=headerlink href=#应用实例-18 title=应用实例></a>应用实例</h4><ol><li>美国电器 110V，中国 220V，就要有一个适配器将 110V 转化为 220V。<li>JAVA JDK 1.1 提供了 Enumeration 接口，而在 1.2 中提供了 Iterator 接口，想要使用 1.2 的 JDK，则要将以前系统的 Enumeration 接口转化为 Iterator 接口，这时就需要适配器模式。<li>在 LINUX 上运行 WINDOWS 程序。 4. JAVA 中的 jdbc。</ol><h4 id=源码应用-4><a class=headerlink href=#源码应用-4 title=源码应用></a>源码应用</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line>java.util.Arrays#asList();</span><br><span class=line>java.util.Collections#list();</span><br><span class=line>org.springframework.context.event.GenericApplicationListenerAdapter</span><br></pre></table></figure><h4 id=注意事项-19><a class=headerlink href=#注意事项-19 title=注意事项></a>注意事项</h4><p><font color=red>适配器不是在详细设计时添加的，而是解决正在服役的项目问题。</font><h4 id=代码实例-19><a class=headerlink href=#代码实例-19 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br></pre><td class=code><pre><span class=line><span class=comment>// 定义目标接口，要求能播放MP4文件</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">MediaPlayer</span> {</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">play</span><span class=params>(String audioType, String fileName)</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 老的音频播放器，只支持MP3格式</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">MP3Player</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">playMP3</span><span class=params>(String fileName)</span> {</span><br><span class=line>        System.out.println(<span class=string>"Playing MP3 file. Name: "</span> + fileName);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 适配器类，适配MP3Player来支持MP4播放功能</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">MediaAdapter</span> <span class=keyword>implements</span> <span class="title class_">MediaPlayer</span> {</span><br><span class=line>    <span class=keyword>private</span> MP3Player mp3Player;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">MediaAdapter</span><span class=params>(String audioType)</span> {</span><br><span class=line>        <span class=keyword>if</span> (audioType.equalsIgnoreCase(<span class=string>"mp3"</span>)) {</span><br><span class=line>            mp3Player = <span class=keyword>new</span> <span class="title class_">MP3Player</span>();  <span class=comment>// 使用适配者对象</span></span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">play</span><span class=params>(String audioType, String fileName)</span> {</span><br><span class=line>        <span class=keyword>if</span> (audioType.equalsIgnoreCase(<span class=string>"mp3"</span>)) {</span><br><span class=line>            mp3Player.playMP3(fileName);  <span class=comment>// 调用适配者的功能</span></span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 高层客户端类，可以播放多种格式，包括MP3和MP4</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">AudioPlayer</span> <span class=keyword>implements</span> <span class="title class_">MediaPlayer</span> {</span><br><span class=line>    MediaAdapter mediaAdapter;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">play</span><span class=params>(String audioType, String fileName)</span> {</span><br><span class=line>        <span class=comment>// 支持播放MP3文件的直接播放</span></span><br><span class=line>        <span class=keyword>if</span> (audioType.equalsIgnoreCase(<span class=string>"mp3"</span>)) {</span><br><span class=line>            System.out.println(<span class=string>"Playing MP3 file. Name: "</span> + fileName);</span><br><span class=line>        }</span><br><span class=line>        <span class=comment>// 使用适配器播放其他格式，如MP4</span></span><br><span class=line>        <span class=keyword>else</span> <span class=keyword>if</span> (audioType.equalsIgnoreCase(<span class=string>"mp4"</span>)) {</span><br><span class=line>            mediaAdapter = <span class=keyword>new</span> <span class="title class_">MediaAdapter</span>(<span class=string>"mp3"</span>);</span><br><span class=line>            System.out.println(<span class=string>"Using adapter to play MP4 file as MP3."</span>);</span><br><span class=line>            mediaAdapter.play(<span class=string>"mp3"</span>, fileName);  <span class=comment>// 转换格式播放</span></span><br><span class=line>        } <span class=keyword>else</span> {</span><br><span class=line>            System.out.println(<span class=string>"Invalid media format: "</span> + audioType);</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Main</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>AudioPlayer</span> <span class=variable>audioPlayer</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">AudioPlayer</span>();</span><br><span class=line></span><br><span class=line>        audioPlayer.play(<span class=string>"mp3"</span>, <span class=string>"song.mp3"</span>);</span><br><span class=line>        audioPlayer.play(<span class=string>"mp4"</span>, <span class=string>"movie.mp4"</span>);</span><br><span class=line>        audioPlayer.play(<span class=string>"avi"</span>, <span class=string>"example.avi"</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-3-5、Decorator（装饰模式）><a class=headerlink href=#1-3-5、Decorator（装饰模式） title=1.3.5、Decorator（装饰模式）></a>1.3.5、Decorator（装饰模式）</h3><h4 id=定义-17><a class=headerlink href=#定义-17 title=定义></a>定义</h4><p>装饰器模式通过创建一个装饰器对象来包裹原始对象，以增加新的功能。这个模式的核心思想：不改变原始类的基础上，通过装饰器类给原始对象增加行为，装饰器类和原始类实现相同的接口，因此装饰器可以在运行时灵活的组合对象行为。<h4 id=结构-18><a class=headerlink href=#结构-18 title=结构></a>结构</h4><ul><li>组件<li>目标组件<li>装饰器<li>具体装饰器</ul><h4 id=何时使用-20><a class=headerlink href=#何时使用-20 title=何时使用></a>何时使用</h4><p>既想扩展类，又不想通过子类的方式实现。<h4 id=优缺点-20><a class=headerlink href=#优缺点-20 title=优缺点></a>优缺点</h4><ul><li><p>优点</p> <ol><li>不改变原有对象的情况下给一个对象扩展功能。<li>使用不同的组合可以实现不同的效果。<li>符合开闭原则。</ol><li><p>缺点</p> <p>多层装饰比较复杂。</p></ul><h4 id=使用场景-20><a class=headerlink href=#使用场景-20 title=使用场景></a>使用场景</h4><ol><li>扩展一个类的功能。<li>动态增加功能，动态撤销。</ol><h4 id=应用实例-19><a class=headerlink href=#应用实例-19 title=应用实例></a>应用实例</h4><ol><li>孙悟空有 72 变，当他变成 “庙宇” 后，他的根本还是一只猴子，但是他又有了庙宇的功能。<li>不论一幅画有没有画框都可以挂在墙上，但是通常都是有画框的，并且实际上是画框被挂在墙上。在挂在墙上之前，画可以被蒙上玻璃，装到框子里；这时画、玻璃和画框形成了一个物体。</ol><h4 id=源码中的应用-1><a class=headerlink href=#源码中的应用-1 title=源码中的应用></a>源码中的应用</h4><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line>Servlet API</span><br><span class=line>javax.servlet.http.HttpServletRequestWrapper</span><br><span class=line>javax.servlet.http.HttpServletResponseWrapper</span><br></pre></table></figure><h4 id=注意事项-20><a class=headerlink href=#注意事项-20 title=注意事项></a>注意事项</h4><p><font color=red>可代替继承。</font><h4 id=代码实例-20><a class=headerlink href=#代码实例-20 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br></pre><td class=code><pre><span class=line><span class=comment>// 组件接口，定义基础功能</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">Coffee</span> {</span><br><span class=line>    String <span class="title function_">getDescription</span><span class=params>()</span>;</span><br><span class=line>    <span class=type>double</span> <span class="title function_">getCost</span><span class=params>()</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体组件类，实现基本的咖啡功能</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">BasicCoffee</span> <span class=keyword>implements</span> <span class="title class_">Coffee</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">getDescription</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=string>"Basic Coffee"</span>;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=type>double</span> <span class="title function_">getCost</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=number>2.0</span>;  <span class=comment>// 基本咖啡价格</span></span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 装饰器类，持有一个Coffee对象</span></span><br><span class=line><span class=keyword>abstract</span> <span class=keyword>class</span> <span class="title class_">CoffeeDecorator</span> <span class=keyword>implements</span> <span class="title class_">Coffee</span> {</span><br><span class=line>    <span class=keyword>protected</span> Coffee decoratedCoffee;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">CoffeeDecorator</span><span class=params>(Coffee coffee)</span> {</span><br><span class=line>        <span class=built_in>this</span>.decoratedCoffee = coffee;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">getDescription</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> decoratedCoffee.getDescription();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=type>double</span> <span class="title function_">getCost</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> decoratedCoffee.getCost();</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体装饰器类，添加牛奶</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">MilkDecorator</span> <span class=keyword>extends</span> <span class="title class_">CoffeeDecorator</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">MilkDecorator</span><span class=params>(Coffee coffee)</span> {</span><br><span class=line>        <span class=built_in>super</span>(coffee);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">getDescription</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> decoratedCoffee.getDescription() + <span class=string>", Milk"</span>;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=type>double</span> <span class="title function_">getCost</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> decoratedCoffee.getCost() + <span class=number>0.5</span>;  <span class=comment>// 牛奶的额外费用</span></span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体装饰器类，添加糖</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">SugarDecorator</span> <span class=keyword>extends</span> <span class="title class_">CoffeeDecorator</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">SugarDecorator</span><span class=params>(Coffee coffee)</span> {</span><br><span class=line>        <span class=built_in>super</span>(coffee);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">getDescription</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> decoratedCoffee.getDescription() + <span class=string>", Sugar"</span>;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=type>double</span> <span class="title function_">getCost</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> decoratedCoffee.getCost() + <span class=number>0.2</span>;  <span class=comment>// 糖的额外费用</span></span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Main</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=comment>// 基本咖啡</span></span><br><span class=line>        <span class=type>Coffee</span> <span class=variable>coffee</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">BasicCoffee</span>();</span><br><span class=line>        System.out.println(coffee.getDescription() + <span class=string>" $"</span> + coffee.getCost());</span><br><span class=line></span><br><span class=line>        <span class=comment>// 添加牛奶的咖啡</span></span><br><span class=line>        coffee = <span class=keyword>new</span> <span class="title class_">MilkDecorator</span>(coffee);</span><br><span class=line>        System.out.println(coffee.getDescription() + <span class=string>" $"</span> + coffee.getCost());</span><br><span class=line></span><br><span class=line>        <span class=comment>// 添加糖和牛奶的咖啡</span></span><br><span class=line>        coffee = <span class=keyword>new</span> <span class="title class_">SugarDecorator</span>(coffee);</span><br><span class=line>        System.out.println(coffee.getDescription() + <span class=string>" $"</span> + coffee.getCost());</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-3-6、Bridge（桥接模式）><a class=headerlink href=#1-3-6、Bridge（桥接模式） title=1.3.6、Bridge（桥接模式）></a>1.3.6、Bridge（桥接模式）</h3><h4 id=定义-18><a class=headerlink href=#定义-18 title=定义></a>定义</h4><p>桥接模式核心思想是将抽象与实现解耦，使它们可以独立扩展。它通过引入一个中间的“桥”（桥接接口），将不同的抽象部分与不同的实现部分连接起来，避免直接耦合，抽象部分与实现部分可以独立变化，互不影响。<h4 id=结构-19><a class=headerlink href=#结构-19 title=结构></a>结构</h4><ul><li>抽象部分<li>扩展抽象部分<li>实现部分<li>具体实现部分</ul><h4 id=何时使用-21><a class=headerlink href=#何时使用-21 title=何时使用></a>何时使用</h4><p>系统的实现有多个方案，每一种都可能变化。<h4 id=优缺点-21><a class=headerlink href=#优缺点-21 title=优缺点></a>优缺点</h4><ul><li><p>优点</p> <ol><li>抽象和实现的分离。<li>优秀的扩展能力。<li>实现细节对客户透明。</ol><li><p>缺点</p> <p>桥接模式的引入会增加系统的理解与设计难度，由于聚合关联关系建立在抽象层，要求开发者针对抽象进行设计与编程。</p></ul><h4 id=使用场景-21><a class=headerlink href=#使用场景-21 title=使用场景></a>使用场景</h4><ol><li>不希望在抽象类和它的实现之间有一个固定的绑定关系；<li>类的抽象和实现都应该可以通过生成子类的方法加以扩充；<li>对一个抽象的实现部分的修改应对客户不产生影响，即客户代码无需重新编译；</ol><h4 id=应用实例-20><a class=headerlink href=#应用实例-20 title=应用实例></a>应用实例</h4><ol><li>猪八戒从天蓬元帅转世投胎到猪，转世投胎的机制将尘世划分为两个等级，即：灵魂和肉体，前者相当于抽象化，后者相当于实现化。生灵通过功能的委派，调用肉体对象的功能，使得生灵可以动态地选择。<li>墙上的开关，可以看到的开关是抽象的，不用管里面具体怎么实现的。</ol><h4 id=注意事项-21><a class=headerlink href=#注意事项-21 title=注意事项></a>注意事项</h4><p><font color=red>对于两个独立变化的维度，使用桥接模式非常合适。</font><h4 id=代码实例-21><a class=headerlink href=#代码实例-21 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br></pre><td class=code><pre><span class=line><span class=comment>// 实现部分的接口，定义设备的操作</span></span><br><span class=line><span class=keyword>interface</span> <span class="title class_">Device</span> {</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">turnOn</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">turnOff</span><span class=params>()</span>;</span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">setVolume</span><span class=params>(<span class=type>int</span> volume)</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体实现类，电视设备</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">TV</span> <span class=keyword>implements</span> <span class="title class_">Device</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=type>int</span> volume;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">turnOn</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"TV is turned on."</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">turnOff</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"TV is turned off."</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setVolume</span><span class=params>(<span class=type>int</span> volume)</span> {</span><br><span class=line>        <span class=built_in>this</span>.volume = volume;</span><br><span class=line>        System.out.println(<span class=string>"TV volume set to "</span> + <span class=built_in>this</span>.volume);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 具体实现类，收音机设备</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">Radio</span> <span class=keyword>implements</span> <span class="title class_">Device</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=type>int</span> volume;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">turnOn</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Radio is turned on."</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">turnOff</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Radio is turned off."</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setVolume</span><span class=params>(<span class=type>int</span> volume)</span> {</span><br><span class=line>        <span class=built_in>this</span>.volume = volume;</span><br><span class=line>        System.out.println(<span class=string>"Radio volume set to "</span> + <span class=built_in>this</span>.volume);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 抽象类，定义远程控制器</span></span><br><span class=line><span class=keyword>abstract</span> <span class=keyword>class</span> <span class="title class_">RemoteControl</span> {</span><br><span class=line>    <span class=keyword>protected</span> Device device;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">RemoteControl</span><span class=params>(Device device)</span> {</span><br><span class=line>        <span class=built_in>this</span>.device = device;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">turnOn</span><span class=params>()</span> {</span><br><span class=line>        device.turnOn();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">turnOff</span><span class=params>()</span> {</span><br><span class=line>        device.turnOff();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">setVolume</span><span class=params>(<span class=type>int</span> volume)</span> {</span><br><span class=line>        device.setVolume(volume);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 扩展的抽象类，增加更多控制功能</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">AdvancedRemoteControl</span> <span class=keyword>extends</span> <span class="title class_">RemoteControl</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">AdvancedRemoteControl</span><span class=params>(Device device)</span> {</span><br><span class=line>        <span class=built_in>super</span>(device);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">mute</span><span class=params>()</span> {</span><br><span class=line>        System.out.println(<span class=string>"Muting the device."</span>);</span><br><span class=line>        device.setVolume(<span class=number>0</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Main</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        <span class=type>Device</span> <span class=variable>tv</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">TV</span>();</span><br><span class=line>        <span class=type>RemoteControl</span> <span class=variable>tvRemote</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">RemoteControl</span>(tv);</span><br><span class=line></span><br><span class=line>        tvRemote.turnOn();</span><br><span class=line>        tvRemote.setVolume(<span class=number>10</span>);</span><br><span class=line>        tvRemote.turnOff();</span><br><span class=line></span><br><span class=line>        System.out.println(<span class=string>"---"</span>);</span><br><span class=line></span><br><span class=line>        <span class=type>Device</span> <span class=variable>radio</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Radio</span>();</span><br><span class=line>        <span class=type>AdvancedRemoteControl</span> <span class=variable>radioRemote</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">AdvancedRemoteControl</span>(radio);</span><br><span class=line></span><br><span class=line>        radioRemote.turnOn();</span><br><span class=line>        radioRemote.setVolume(<span class=number>5</span>);</span><br><span class=line>        radioRemote.mute();</span><br><span class=line>        radioRemote.turnOff();</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-3-7、Flyweight（享元模式）><a class=headerlink href=#1-3-7、Flyweight（享元模式） title=1.3.7、Flyweight（享元模式）></a>1.3.7、Flyweight（享元模式）</h3><h4 id=定义-19><a class=headerlink href=#定义-19 title=定义></a>定义</h4><p>享元模式的核心思想是 共享相似对象，通过共享相同的对象来减少对象的创建。当多个对象本质上相同时，可以使用一个对象来共享，而并非每次都创建一个新对象。<h4 id=结构-20><a class=headerlink href=#结构-20 title=结构></a>结构</h4><ul><li>享元接口<li>具体享元类<li>非共享享元类<li>享元工厂</ul><h4 id=何时使用-22><a class=headerlink href=#何时使用-22 title=何时使用></a>何时使用</h4><ol><li>系统中有大量对象。<li>这些对象消耗大量内存。<li>这些对象的状态大部分可以外部化。<li>这些对象可以按照内蕴状态分为很多组，当把外蕴对象从对象中拿出来时，每组对象都可用一个对象来代替。<li>系统不依赖于对象身份，因对象不可分辨。</ol><h4 id=优缺点-22><a class=headerlink href=#优缺点-22 title=优缺点></a>优缺点</h4><ul><li>优点：减少对象创建，降低内存消耗，效率提高。<li>缺点：提高了系统复杂度，需要分离出外部状态和内部状态，而且外部状态具有固有化的性质，不应该随着内部状态的变化而变化，否则会造成系统混乱。</ul><h4 id=使用场景-22><a class=headerlink href=#使用场景-22 title=使用场景></a>使用场景</h4><ol><li>系统有大量相似对象。<li>需要缓冲池的场景。</ol><h4 id=应用实例-21><a class=headerlink href=#应用实例-21 title=应用实例></a>应用实例</h4><ol><li>JAVA 中的 String，如果有则返回，如果没有则创建一个字符串保存在字符串缓存池里面。<li>数据库的数据池。</ol><h4 id=源码应用-5><a class=headerlink href=#源码应用-5 title=源码应用></a>源码应用</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>String / Integer / Long....</span><br><span class=line>com.sun.org.apache.bcel.internal.generic.InstructionConstants</span><br></pre></table></figure><h4 id=注意事项-22><a class=headerlink href=#注意事项-22 title=注意事项></a>注意事项</h4><ol><li><font color=red>注意划分外部状态和内部状态，否则可能会引起线程安全问题。</font><li><font color=red>这些类必须有一个工厂对象加以控制。</font></ol><h4 id=代码实例-22><a class=headerlink href=#代码实例-22 title=代码实例></a>代码实例</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br></pre><td class=code><pre><span class=line><span class=comment>// 享元类，表示树的共享部分（类型和颜色）</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">TreeType</span> {</span><br><span class=line>    <span class=keyword>private</span> String name;</span><br><span class=line>    <span class=keyword>private</span> String color;</span><br><span class=line>    <span class=keyword>private</span> String texture;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">TreeType</span><span class=params>(String name, String color, String texture)</span> {</span><br><span class=line>        <span class=built_in>this</span>.name = name;</span><br><span class=line>        <span class=built_in>this</span>.color = color;</span><br><span class=line>        <span class=built_in>this</span>.texture = texture;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">draw</span><span class=params>(<span class=type>int</span> x, <span class=type>int</span> y)</span> {</span><br><span class=line>        System.out.println(<span class=string>"Drawing tree of type: "</span> + name + <span class=string>" at ("</span> + x + <span class=string>", "</span> + y + <span class=string>")"</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 享元工厂类，负责管理和创建享元类对象</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">TreeFactory</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>static</span> Map&LTString, TreeType> treeTypes = <span class=keyword>new</span> <span class="title class_">HashMap</span><>();</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> TreeType <span class="title function_">getTreeType</span><span class=params>(String name, String color, String texture)</span> {</span><br><span class=line>        <span class=type>TreeType</span> <span class=variable>result</span> <span class=operator>=</span> treeTypes.get(name);</span><br><span class=line>        <span class=keyword>if</span> (result == <span class=literal>null</span>) {</span><br><span class=line>            result = <span class=keyword>new</span> <span class="title class_">TreeType</span>(name, color, texture);</span><br><span class=line>            treeTypes.put(name, result);</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> result;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=comment>// 非共享的树类，包含位置等外部状态</span></span><br><span class=line><span class=keyword>class</span> <span class="title class_">Tree</span> {</span><br><span class=line>    <span class=keyword>private</span> <span class=type>int</span> x;</span><br><span class=line>    <span class=keyword>private</span> <span class=type>int</span> y;</span><br><span class=line>    <span class=keyword>private</span> TreeType type;  <span class=comment>// 共享的内部状态</span></span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">Tree</span><span class=params>(<span class=type>int</span> x, <span class=type>int</span> y, TreeType type)</span> {</span><br><span class=line>        <span class=built_in>this</span>.x = x;</span><br><span class=line>        <span class=built_in>this</span>.y = y;</span><br><span class=line>        <span class=built_in>this</span>.type = type;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">draw</span><span class=params>()</span> {</span><br><span class=line>        type.draw(x, y);  <span class=comment>// 使用共享的TreeType对象来绘制树</span></span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Main</span> {</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        List&LTTree> forest = <span class=keyword>new</span> <span class="title class_">ArrayList</span><>();</span><br><span class=line></span><br><span class=line>        <span class=comment>// 创建大量的树，并共享相同的TreeType对象</span></span><br><span class=line>        <span class=type>TreeType</span> <span class=variable>oakType</span> <span class=operator>=</span> TreeFactory.getTreeType(<span class=string>"Oak"</span>, <span class=string>"Green"</span>, <span class=string>"Rough"</span>);</span><br><span class=line>        <span class=type>TreeType</span> <span class=variable>pineType</span> <span class=operator>=</span> TreeFactory.getTreeType(<span class=string>"Pine"</span>, <span class=string>"Dark Green"</span>, <span class=string>"Smooth"</span>);</span><br><span class=line></span><br><span class=line>        forest.add(<span class=keyword>new</span> <span class="title class_">Tree</span>(<span class=number>10</span>, <span class=number>20</span>, oakType));</span><br><span class=line>        forest.add(<span class=keyword>new</span> <span class="title class_">Tree</span>(<span class=number>30</span>, <span class=number>40</span>, oakType));</span><br><span class=line>        forest.add(<span class=keyword>new</span> <span class="title class_">Tree</span>(<span class=number>50</span>, <span class=number>60</span>, pineType));</span><br><span class=line>        forest.add(<span class=keyword>new</span> <span class="title class_">Tree</span>(<span class=number>70</span>, <span class=number>80</span>, pineType));</span><br><span class=line></span><br><span class=line>        <span class=comment>// 绘制森林中的树</span></span><br><span class=line>        <span class=keyword>for</span> (Tree tree : forest) {</span><br><span class=line>            tree.draw();</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h2 id=1-4、设计模式间的关系><a class=headerlink href=#1-4、设计模式间的关系 title=1.4、设计模式间的关系></a>1.4、设计模式间的关系</h2><p><img alt=设计模式间的关系 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/06/image-20210420203056818.png?token=AIGEF3L6P4ZSWPM3RWVOD3LEZZZVE><h1 id=2、设计模式原则><a class=headerlink href=#2、设计模式原则 title=2、设计模式原则></a>2、设计模式原则</h1><h2 id=2-1、开闭原则（OCP）><a class=headerlink href=#2-1、开闭原则（OCP） title=2.1、开闭原则（OCP）></a>2.1、开闭原则（OCP）</h2><h3 id=2-1-1、简介><a class=headerlink href=#2-1-1、简介 title=2.1.1、简介></a>2.1.1、简介</h3><p><strong>开闭原则规定：软件中的对象（类，模块，函数等）对于扩展应该开放，对于修改应该封闭。</strong>也就是说，应该在不修改类源代码前提下来更改类的行为。<h3 id=2-1-2、分类><a class=headerlink href=#2-1-2、分类 title=2.1.2、分类></a>2.1.2、分类</h3><ul><li><p><strong>梅耶开闭原则</strong>：梅耶原则 提倡继承实现。具体实现可以通过继承来重用，但是接口规格不必如此。已存在的实现对于修改是封闭的，但是新的实现不必实现原有接口。</p><li><p><strong>多态开闭原则</strong>：多态开闭原则 倡导继承抽象类。接口规约可以通过继承来重用，但是实现不必如此。已存在的接口对于修改是封闭的，并且新的实现必须至少实现那个接口。</p></ul><h2 id=2-2、单一职责原则（SRP）><a class=headerlink href=#2-2、单一职责原则（SRP） title=2.2、单一职责原则（SRP）></a>2.2、单一职责原则（SRP）</h2><h3 id=2-2-1、简介><a class=headerlink href=#2-2-1、简介 title=2.2.1、简介></a>2.2.1、简介</h3><p>面向对象五个基本原则（SOLID）之一。<p><strong>单一职责原则（SRP：Single responsibility principle）又称单一功能原则。该原则规定：一个类或者模块只负责完成一个职责。</strong><p>单一职责原则由罗伯特·C·马丁（Robert C. Martin）于《敏捷软件开发：原则、模式和实践》一书中给出。马丁表示此原则是基于汤姆·狄马克(Tom DeMarco)和Meilir Page-Jones的=著作中的 内聚性原则 来实现。<h3 id=2-2-2、问题由来><a class=headerlink href=#2-2-2、问题由来 title=2.2.2、问题由来></a>2.2.2、问题由来</h3><p>之所以会出现单一职责原则就是因为在软件设计时会出现以下类似场景：<p>T负责两个不同的职责：职责P1，职责P2。当由于职责P1需求发生改变而需要修改类T时，有可能会导致原本运行正常的职责P2功能发生故障。也就是说职责P1和P2耦合在了一起。<h3 id=2-2-3、产生原因><a class=headerlink href=#2-2-3、产生原因 title=2.2.3、产生原因></a>2.2.3、产生原因</h3><p>很多耦合常常发生在不经意之间，原因就是 职责扩散：因为某种原因，某一职责被分化为颗粒度更细多个职责。<h3 id=2-2-4、解决方法><a class=headerlink href=#2-2-4、解决方法 title=2.2.4、解决方法></a>2.2.4、解决方法</h3><p>遵守单一职责原则，将不同的职责封装到不同的类或模块中。<h2 id=2-3、依赖倒置原则（DIP）><a class=headerlink href=#2-3、依赖倒置原则（DIP） title=2.3、依赖倒置原则（DIP）></a>2.3、依赖倒置原则（DIP）</h2><h3 id=2-3-1、简介><a class=headerlink href=#2-3-1、简介 title=2.3.1、简介></a>2.3.1、简介</h3><p><strong>开闭原则的基础。依赖倒置原则（Dependence Inversion Principle）是指：程序要依赖于抽象接口，不要依赖于具体实现。</strong>简单说就是一定要面向抽象编程，而不要面向实现编程，这样就降低了客户与实现模块间的耦合。<h3 id=2-3-2、意图><a class=headerlink href=#2-3-2、意图 title=2.3.2、意图></a>2.3.2、意图</h3><p><strong>面向过程开发，上层调用下层，上层依赖于下层，当下层剧烈变动时上层也要跟着变动，这就会降低模块的复用性且大大提高了开发成本</strong><p>面向对象开发解决了这个问题，一般情况下抽象的变化概率很小，让用户程序依赖于抽象，实现的细节也依赖于抽象。即使实现细节不断变动，只要抽象不变，客户程序就不需要变化。这大大降低了客户程序与实现细节的耦合度。<h3 id=2-3-3、注意事项><a class=headerlink href=#2-3-3、注意事项 title=2.3.3、注意事项></a>2.3.3、注意事项</h3><ol><li>高层次的模块不应该依赖于低层次的模块，他们都应该依赖于抽象。<li>抽象不应该依赖于具体，而是具体应该依赖于抽象。</ol><h2 id=2-4、接口隔离原则（ISP）><a class=headerlink href=#2-4、接口隔离原则（ISP） title=2.4、接口隔离原则（ISP）></a>2.4、接口隔离原则（ISP）</h2><h3 id=2-4-1、简介><a class=headerlink href=#2-4-1、简介 title=2.4.1、简介></a>2.4.1、简介</h3><p>接口隔离原则（Interface Segregation Principle，ISP）是面向对象设计中的一个原则，它强调的是 <strong>客户端不应该依赖它不需要的接口，将臃肿的接口拆分为更小、更具体的接口，避免接口的冗余</strong>。<p>接口隔离原则的核心思想是 <strong>定义接口时要精简、单一，不应该包含不需要的方法，这样可以减少类与接口之间的耦合，提高代码可读性、可维护性、可扩展性</strong>。<p>接口隔离原则可以参考如下几点来实现：<ul><li>将庞大的接口拆分为多个小接口。<li>根据需要只使用特定的接口。<li>接口的职责要单一。</ul><h3 id=2-4-2、优点><a class=headerlink href=#2-4-2、优点 title=2.4.2、优点></a>2.4.2、优点</h3><p>接口隔离原则可以使得系统的接口设计更加灵活、可扩展和易于维护。能降低类与接口之间的耦合度，减少不必要的依赖关系，使得系统的各个模块能够独立地发展与演化。<h2 id=2-5、里氏替换原则（LSP）><a class=headerlink href=#2-5、里氏替换原则（LSP） title=2.5、里氏替换原则（LSP）></a>2.5、里氏替换原则（LSP）</h2><h3 id=2-5-1、简介><a class=headerlink href=#2-5-1、简介 title=2.5.1、简介></a>2.5.1、简介</h3><p>里氏代换原则（Liskov Substitution Principle LSP）是指：<strong>基类可以出现的地方，子类也可以出现</strong>。<p>LSP是继承复用的基石，只有当衍生类可以替换掉基类，软件的功能不受到影响时，基类才能真正被复用，而衍生类也能够在基类的基础上增加新的行为。<em><strong>里氏代换原则是对“开闭”原则的补充。实现“开闭”原则的关键步骤就是抽象化</strong></em>。而基类与子类的继承关系就是抽象化的具体实现，所以里氏代换原则是对实现抽象化的具体步骤的规范。<h3 id=2-5-2、注意事项><a class=headerlink href=#2-5-2、注意事项 title=2.5.2、注意事项></a>2.5.2、注意事项</h3><p><strong>设计时，尽量继承抽象类，而不要继承具体类。</strong>如果从继承等级树来看，所有叶子节点应当是具体类，而所有的树枝节点应当是抽象类或者接口。当然这只是一般性的指导原则，使用时还需具体情况具体分析。<p>简单的理解为一个软件实体如果使用的是一个父类，那么一定适用于其子类，而且它察觉不出父类对象和子类对象的区别。也就是说，软件里面，把父类都替换成它的子类，程序的行为没有变化。<h2 id=2-6、迪米特原则（LOD）><a class=headerlink href=#2-6、迪米特原则（LOD） title=2.6、迪米特原则（LOD）></a>2.6、迪米特原则（LOD）</h2><h3 id=2-6-1、简介><a class=headerlink href=#2-6-1、简介 title=2.6.1、简介></a>2.6.1、简介</h3><p>迪米特原则（Law Of Demeter）也被称为最少知道原则，是面向对象设计中的一个原则。迪米特原则的核心思想是 <strong>降低对象之间的耦合，使得对象之间的通信变得简单和直接</strong>。<p><strong>迪米特原则的目标是实现高内聚、低耦合</strong>。具体包括如下几点：<ul><li>减少对象之间的耦合<li>保护对象的隐私<li>提高代码可维护性</ul><p>迪米特原则可以参考如下几个方面来实现：<ul><li>在类中尽量减少对其它类的引用，不应该直接引用与本类关系较远的类。<li>通过封装和信息隐藏，将对象的内部细节隐藏起来，只暴漏必要的接口。<li>使用中介者模式或外观模式来降低对象之间的直接依赖关系。</ul><h2 id=2-7、合成复用原则（CRP）><a class=headerlink href=#2-7、合成复用原则（CRP） title=2.7、合成复用原则（CRP）></a>2.7、合成复用原则（CRP）</h2><h3 id=2-7-1、简介><a class=headerlink href=#2-7-1、简介 title=2.7.1、简介></a>2.7.1、简介</h3><p>合成复用原则是设计模式中的一个原则，也称之为CRP原则。它指的是在软件设计中，<strong>优先使用对象组合而不是继承来实现代码的复用</strong>。<p>合成复用原则的核心思想是：<strong>通过将现有的对象组合成新的对象，实现代码复用和灵活性</strong>。相对于通过继承实现复用，使用对象组合可以更好的控制类之间的关系，且可以动态改变对象的行为。<h3 id=2-7-2、优点><a class=headerlink href=#2-7-2、优点 title=2.7.2、优点></a>2.7.2、优点</h3><p>合成复用有如下几个优点：<ul><li>减少类之间的耦合：继承会导致子类和父类之间的紧耦合，而对象组合可以在对象之间建立松散的关系，减少类之间的依赖。<li>提高系统灵活性：对象组合可以动态改变对象的行为，通过替换组合中的对象，可以灵活扩展和修改系统的功能。<li>更好地复用代码：组合现有对象，可以构建出具有不同功能的新对象，实现代码复用。<li>更好的维护：对象组合关系松散，需要修改系统行为时，可以更容易的定位和修改相关的对象。</ul></div><footer class=post-footer><div class=post-tags><a href=/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/ rel=tag># 设计模式</a></div><div class=post-nav><div class=post-nav-item><a href=/2024/10/12/Java%E4%B9%8B%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%AF%87/ rel=prev title=Java系列-Java基础> <i class="fa fa-angle-left"></i> Java系列-Java基础 </a></div><div class=post-nav-item><a href=/2024/10/12/Java%E4%B9%8B%E7%BA%BF%E7%A8%8B%E5%B9%B6%E5%8F%91%E7%AF%87/ rel=next title=Java系列-多线程与高并发> Java系列-多线程与高并发 <i class="fa fa-angle-right"></i> </a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>© <span itemprop=copyrightYear>2024</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>豪哥</span></div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label=返回顶部 class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script crossorigin=anonymous integrity=sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY= src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js></script><script src=/js/comments.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/sidebar.js></script><script src=/js/next-boot.js></script><script crossorigin=anonymous integrity=sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc= src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js></script><script src=/js/third-party/search/local-search.js></script>