<!doctypehtml><html lang=zh-CN><meta charset=UTF-8><meta content=width=device-width name=viewport><meta media="(prefers-color-scheme: light)" content=#222 name=theme-color><meta media="(prefers-color-scheme: dark)" content=#222 name=theme-color><meta content="Hexo 7.3.0" name=generator><link href=/images/apple-touch-icon-next.png rel=apple-touch-icon sizes=180x180><link href=/images/favicon-32x32-next.png rel=icon sizes=32x32 type=image/png><link href=/images/favicon-16x16-next.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><link href=/css/main.css rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css integrity=sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA= rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css integrity=sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE= rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"hshz21.gitee.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src=/js/config.js></script><meta content=豪哥博客 name=description><meta content=website property=og:type><meta content=豪哥博客 property=og:title><meta content=https://hshz21.gitee.io/index.html property=og:url><meta content=豪哥博客 property=og:site_name><meta content=豪哥博客 property=og:description><meta content=zh_CN property=og:locale><meta content=豪哥 property=article:author><meta content=HG property=article:tag><meta content=summary name=twitter:card><link href=https://hshz21.gitee.io/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"index.html","title":""}</script><script class=next-config data-name=calendar type=application/json>""</script><title>豪哥博客</title><noscript><link href=/css/noscript.css rel=stylesheet></noscript><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label=切换导航栏 class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <h1 class=site-title>豪哥博客</h1> <i class=logo-line></i> </a><p class=site-subtitle itemprop=description>豪哥博客</div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=搜索 role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>分类</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>搜索 </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=搜索... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-overview-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><img alt=豪哥 class=site-author-image itemprop=image src=/static/imgs/avatar.png><p class=site-author-name itemprop=name>豪哥<div class=site-description itemprop=description>豪哥博客</div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>109</span> <span class=site-state-item-name>日志</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>33</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/> <span class=site-state-item-count>126</span> <span class=site-state-item-name>标签</span></a></div></nav></div></div></div></div></aside></div><div class="main-inner index posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://hshz21.gitee.io/2024/08/21/04-%E4%B8%80%E8%87%B4%E6%80%A7%E5%8D%8F%E8%AE%AE/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/static/imgs/avatar.png itemprop=image> <meta content=豪哥 itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=豪哥博客 itemprop=name> <meta content=豪哥博客 itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="undefined | 豪哥博客" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/2024/08/21/04-%E4%B8%80%E8%87%B4%E6%80%A7%E5%8D%8F%E8%AE%AE/ itemprop=url>微服务问题系列-一致性问题</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2024-08-21 21:39:15" datetime=2024-08-21T21:39:15+08:00>2024-08-21</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-08-07 16:08:17" datetime=2023-08-07T16:08:17+08:00 itemprop=dateModified>2023-08-07</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/ itemprop=url rel=index><span itemprop=name>微服务</span></a> </span> </span></div></div></header><div class=post-body itemprop=articleBody><h1 id=1、Raft协议><a class=headerlink href=#1、Raft协议 title=1、Raft协议></a>1、Raft协议</h1><h2 id=1-1、简介><a class=headerlink href=#1-1、简介 title=1.1、简介></a>1.1、简介</h2><p>分布式系统，3个节点 n1、n2、n3，每个节点有三种状态：跟随者、候选者、leader。<ol><li>最开始，三个节点都是fllower状态。<li>其中一个节点先将自己变为 候选者，然后向其他节点发送拉票请求，让其他节点投票给他，让他做leader。<li>若有超过一半的节点同意该请求，则当前候选者正式升级为leader。<li>leader节点收到 赋值请求X=5，会在leader节点日志中记录X=5，要注意的是仅仅是在日志中记录一下，并没有提交。<li>leader节点记录日志后，会将该赋值命令 发送給其它节点，其它节点同样先记录在日志中，记录成功后会发送响应给leader节点。<li>leader节点收到所有节点响应后，提交 本地日志中的赋值命令，提交成功后 会通知其它节点也提交。</ol><h2 id=1-2、领导选举逻辑><a class=headerlink href=#1-2、领导选举逻辑 title=1.2、领导选举逻辑></a>1.2、领导选举逻辑</h2><p>注意：raft协议有两个超时时间（选举时间、自旋时间）来控制选举过程。<p>选举超时：随从变为候选者的时间（自旋时间），一般150ms-300ms。<ol><li>所有节点都有自旋时间，谁的自旋时间先结束，谁先称为候选者。<li>该候选者先向其它节点发送投票请求，其他节点可以选择是否投票给它，若有超过一半的节点都同意，则该候选者将成功升级为leader。<li>其它节点投完票后会重置自旋时间，也就是从0开始自旋。<li>leader节点会发送心跳检测，其它跟随者收到心跳检测后会重置自旋时间，一收到就重置，一收到就重置。<li>此时，若leader因为某种原因，停止了心跳检测请求的发送，那么其他跟随者的自旋时间到期后，会在所有跟随者中挑选一个做为新的leader（选拔逻辑与之前相同），期间若选举失败，会重新选举，直到成功。</ol></div><footer class=post-footer><div class=post-eof></div></footer></article></div><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://hshz21.gitee.io/2024/08/21/03-%E6%8E%A5%E5%8F%A3%E5%B9%82%E7%AD%89%E6%80%A7/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/static/imgs/avatar.png itemprop=image> <meta content=豪哥 itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=豪哥博客 itemprop=name> <meta content=豪哥博客 itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="undefined | 豪哥博客" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/2024/08/21/03-%E6%8E%A5%E5%8F%A3%E5%B9%82%E7%AD%89%E6%80%A7/ itemprop=url>微服务问题系列-接口幂等问题</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2024-08-21 21:39:15" datetime=2024-08-21T21:39:15+08:00>2024-08-21</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-08-07 16:08:27" datetime=2023-08-07T16:08:27+08:00 itemprop=dateModified>2023-08-07</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/ itemprop=url rel=index><span itemprop=name>微服务</span></a> </span> </span></div></div></header><div class=post-body itemprop=articleBody><h1 id=1、幂等性简介><a class=headerlink href=#1、幂等性简介 title=1、幂等性简介></a>1、幂等性简介</h1><h2 id=1-1、幂等性定义><a class=headerlink href=#1-1、幂等性定义 title=1.1、幂等性定义></a>1.1、幂等性定义</h2><p><strong>针对同一个接口，调用多次与调用一次，其效果完全等同。这种情况被称为符合幂等性。</strong><h2 id=1-2、幂等性场景><a class=headerlink href=#1-2、幂等性场景 title=1.2、幂等性场景></a>1.2、幂等性场景</h2><ol><li>订单付款。<li>充值。</ol><h1 id=2、幂等性方案><a class=headerlink href=#2、幂等性方案 title=2、幂等性方案></a>2、幂等性方案</h1><h2 id=2-1、token机制><a class=headerlink href=#2-1、token机制 title=2.1、token机制></a>2.1、token机制</h2><h2 id=2-2、锁机制><a class=headerlink href=#2-2、锁机制 title=2.2、锁机制></a>2.2、锁机制</h2><ul><li>数据库悲观锁<li>数据库乐观锁<li>业务层分布式锁</ul><h2 id=2-3、唯一约束><a class=headerlink href=#2-3、唯一约束 title=2.3、唯一约束></a>2.3、唯一约束</h2><ul><li>数据库唯一约束<li>redis set 防重</ul><h2 id=2-4、防重表><a class=headerlink href=#2-4、防重表 title=2.4、防重表></a>2.4、防重表</h2><h2 id=2-5、请求唯一ID><a class=headerlink href=#2-5、请求唯一ID title=2.5、请求唯一ID></a>2.5、请求唯一ID</h2></div><footer class=post-footer><div class=post-eof></div></footer></article></div><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://hshz21.gitee.io/2024/08/21/03-%E6%97%A5%E5%BF%97%E5%A4%84%E7%90%86/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/static/imgs/avatar.png itemprop=image> <meta content=豪哥 itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=豪哥博客 itemprop=name> <meta content=豪哥博客 itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="undefined | 豪哥博客" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/2024/08/21/03-%E6%97%A5%E5%BF%97%E5%A4%84%E7%90%86/ itemprop=url>微服务业务功能系列-日志处理</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2024-08-21 21:39:15" datetime=2024-08-21T21:39:15+08:00>2024-08-21</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-08-07 15:30:19" datetime=2023-08-07T15:30:19+08:00 itemprop=dateModified>2023-08-07</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/ itemprop=url rel=index><span itemprop=name>微服务</span></a> </span> </span></div></div></header><div class=post-body itemprop=articleBody><h1 id=1、日志简介><a class=headerlink href=#1、日志简介 title=1、日志简介></a>1、日志简介</h1><h2 id=1-1、日志级别><a class=headerlink href=#1-1、日志级别 title=1.1、日志级别></a>1.1、日志级别</h2><p><strong>日志级别从高到底依次为：ALL、DEBUG、INFO、WARN、ERROR、FATAL、OFF。</strong><h2 id=1-2、默认日志><a class=headerlink href=#1-2、默认日志 title=1.2、默认日志></a>1.2、默认日志</h2><p>SpringBoot中默认使用logback日志系统。<h1 id=2、配置><a class=headerlink href=#2、配置 title=2、配置></a>2、配置</h1><p>在项目resources目录下创建<code>logback-spring.xml</code>文件，在文件中添加如下内容，并根据个人实际情况做不同的设置与修改。<figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br><span class=line>120</span><br><span class=line>121</span><br><span class=line>122</span><br><span class=line>123</span><br><span class=line>124</span><br><span class=line>125</span><br><span class=line>126</span><br><span class=line>127</span><br><span class=line>128</span><br><span class=line>129</span><br><span class=line>130</span><br><span class=line>131</span><br><span class=line>132</span><br><span class=line>133</span><br><span class=line>134</span><br><span class=line>135</span><br><span class=line>136</span><br><span class=line>137</span><br><span class=line>138</span><br><span class=line>139</span><br><span class=line>140</span><br><span class=line>141</span><br><span class=line>142</span><br><span class=line>143</span><br><span class=line>144</span><br><span class=line>145</span><br><span class=line>146</span><br><span class=line>147</span><br><span class=line>148</span><br><span class=line>149</span><br><span class=line>150</span><br><span class=line>151</span><br><span class=line>152</span><br><span class=line>153</span><br><span class=line>154</span><br><span class=line>155</span><br><span class=line>156</span><br></pre><td class=code><pre><span class=line><span class=meta>&LT?xml version=<span class=string>"1.0"</span> encoding=<span class=string>"UTF-8"</span>?></span></span><br><span class=line><span class=tag><<span class=name>configuration</span>  <span class=attr>scan</span>=<span class=string>"true"</span> <span class=attr>scanPeriod</span>=<span class=string>"10 seconds"</span>></span></span><br><span class=line>    <span class=comment>&LT!-- 日志级别从低到高分为TRACE < DEBUG < INFO < WARN < ERROR < FATAL，如果设置为WARN，则低于WARN的信息都不会输出 --></span></span><br><span class=line>    <span class=comment>&LT!-- scan:当此属性设置为true时，配置文件如果发生改变，将会被重新加载，默认值为true --></span></span><br><span class=line>    <span class=comment>&LT!-- scanPeriod:设置监测配置文件是否有修改的时间间隔，如果没有给出时间单位，默认单位是毫秒。当scan为true时，此属性生效。默认的时间间隔为1分钟。 --></span></span><br><span class=line>    <span class=comment>&LT!-- de<span class=doctag>bug:</span>当此属性设置为true时，将打印出logback内部日志信息，实时查看logback运行状态。默认值为false。 --></span></span><br><span class=line></span><br><span class=line>    <span class=tag><<span class=name>contextName</span>></span>logback<span class=tag>&LT/<span class=name>contextName</span>></span></span><br><span class=line>    <span class=comment>&LT!-- name的值是变量的名称，value的值时变量定义的值。通过定义的值会被插入到logger上下文中。定义变量后，可以使“${}”来使用变量。 --></span></span><br><span class=line>    <span class=tag><<span class=name>property</span> <span class=attr>name</span>=<span class=string>"log.path"</span> <span class=attr>value</span>=<span class=string>"D:/tmp/guliedu/edu"</span> /></span></span><br><span class=line></span><br><span class=line>    <span class=comment>&LT!-- 彩色日志 --></span></span><br><span class=line>    <span class=comment>&LT!-- 配置格式变量：CONSOLE_LOG_PATTERN 彩色日志格式 --></span></span><br><span class=line>    <span class=comment>&LT!-- magenta:洋红 --></span></span><br><span class=line>    <span class=comment>&LT!-- boldMagenta:粗红--></span></span><br><span class=line>    <span class=comment>&LT!-- cyan:青色 --></span></span><br><span class=line>    <span class=comment>&LT!-- white:白色 --></span></span><br><span class=line>    <span class=comment>&LT!-- magenta:洋红 --></span></span><br><span class=line>    <span class=tag><<span class=name>property</span> <span class=attr>name</span>=<span class=string>"CONSOLE_LOG_PATTERN"</span></span></span><br><span class=line><span class=tag>              <span class=attr>value</span>=<span class=string>"%yellow(%date{yyyy-MM-dd HH:mm:ss}) %highlight(%-5level) %blue(%thread) %blue(%file:%line) %green(%logger) %cyan(%msg%n)"</span>/></span></span><br><span class=line></span><br><span class=line>    <span class=comment>&LT!--输出到控制台--></span></span><br><span class=line>    <span class=tag><<span class=name>appender</span> <span class=attr>name</span>=<span class=string>"CONSOLE"</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.core.ConsoleAppender"</span>></span></span><br><span class=line>        <span class=comment>&LT!--此日志appender是为开发使用，只配置最底级别，控制台输出的日志级别是大于或等于此级别的日志信息--></span></span><br><span class=line>        <span class=comment>&LT!-- 例如：如果此处配置了INFO级别，则后面其他位置即使配置了DEBUG级别的日志，也不会被输出 --></span></span><br><span class=line>        <span class=tag><<span class=name>filter</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.classic.filter.ThresholdFilter"</span>></span></span><br><span class=line>            <span class=tag><<span class=name>level</span>></span>INFO<span class=tag>&LT/<span class=name>level</span>></span></span><br><span class=line>        <span class=tag>&LT/<span class=name>filter</span>></span></span><br><span class=line>        <span class=tag><<span class=name>encoder</span>></span></span><br><span class=line>            <span class=tag><<span class=name>Pattern</span>></span>${CONSOLE_LOG_PATTERN}<span class=tag>&LT/<span class=name>Pattern</span>></span></span><br><span class=line>            <span class=comment>&LT!-- 设置字符集 --></span></span><br><span class=line>            <span class=tag><<span class=name>charset</span>></span>UTF-8<span class=tag>&LT/<span class=name>charset</span>></span></span><br><span class=line>        <span class=tag>&LT/<span class=name>encoder</span>></span></span><br><span class=line>    <span class=tag>&LT/<span class=name>appender</span>></span></span><br><span class=line></span><br><span class=line>    <span class=comment>&LT!--输出到文件--></span></span><br><span class=line>    <span class=comment>&LT!-- 时间滚动输出 level为 INFO 日志 --></span></span><br><span class=line>    <span class=tag><<span class=name>appender</span> <span class=attr>name</span>=<span class=string>"INFO_FILE"</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.core.rolling.RollingFileAppender"</span>></span></span><br><span class=line>        <span class=comment>&LT!-- 正在记录的日志文件的路径及文件名 --></span></span><br><span class=line>        <span class=tag><<span class=name>file</span>></span>${log.path}/log_info.log<span class=tag>&LT/<span class=name>file</span>></span></span><br><span class=line>        <span class=comment>&LT!--日志文件输出格式--></span></span><br><span class=line>        <span class=tag><<span class=name>encoder</span>></span></span><br><span class=line>            <span class=tag><<span class=name>pattern</span>></span>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n<span class=tag>&LT/<span class=name>pattern</span>></span></span><br><span class=line>            <span class=tag><<span class=name>charset</span>></span>UTF-8<span class=tag>&LT/<span class=name>charset</span>></span></span><br><span class=line>        <span class=tag>&LT/<span class=name>encoder</span>></span></span><br><span class=line>        <span class=comment>&LT!-- 日志记录器的滚动策略，按日期，按大小记录 --></span></span><br><span class=line>        <span class=tag><<span class=name>rollingPolicy</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span>></span></span><br><span class=line>            <span class=comment>&LT!-- 每天日志归档路径以及格式 --></span></span><br><span class=line>            <span class=tag><<span class=name>fileNamePattern</span>></span>${log.path}/info/log-info-%d{yyyy-MM-dd}.%i.log<span class=tag>&LT/<span class=name>fileNamePattern</span>></span></span><br><span class=line>            <span class=tag><<span class=name>timeBasedFileNamingAndTriggeringPolicy</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"</span>></span></span><br><span class=line>                <span class=tag><<span class=name>maxFileSize</span>></span>100MB<span class=tag>&LT/<span class=name>maxFileSize</span>></span></span><br><span class=line>            <span class=tag>&LT/<span class=name>timeBasedFileNamingAndTriggeringPolicy</span>></span></span><br><span class=line>            <span class=comment>&LT!--日志文件保留天数--></span></span><br><span class=line>            <span class=tag><<span class=name>maxHistory</span>></span>15<span class=tag>&LT/<span class=name>maxHistory</span>></span></span><br><span class=line>        <span class=tag>&LT/<span class=name>rollingPolicy</span>></span></span><br><span class=line>        <span class=comment>&LT!-- 此日志文件只记录info级别的 --></span></span><br><span class=line>        <span class=tag><<span class=name>filter</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.classic.filter.LevelFilter"</span>></span></span><br><span class=line>            <span class=tag><<span class=name>level</span>></span>INFO<span class=tag>&LT/<span class=name>level</span>></span></span><br><span class=line>            <span class=tag><<span class=name>onMatch</span>></span>ACCEPT<span class=tag>&LT/<span class=name>onMatch</span>></span></span><br><span class=line>            <span class=tag><<span class=name>onMismatch</span>></span>DENY<span class=tag>&LT/<span class=name>onMismatch</span>></span></span><br><span class=line>        <span class=tag>&LT/<span class=name>filter</span>></span></span><br><span class=line>    <span class=tag>&LT/<span class=name>appender</span>></span></span><br><span class=line></span><br><span class=line>    <span class=comment>&LT!-- 时间滚动输出 WARN级别 的日志 --></span></span><br><span class=line>    <span class=tag><<span class=name>appender</span> <span class=attr>name</span>=<span class=string>"WARN_FILE"</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.core.rolling.RollingFileAppender"</span>></span></span><br><span class=line>        <span class=comment>&LT!-- 正在记录的日志文件的路径及文件名 --></span></span><br><span class=line>        <span class=tag><<span class=name>file</span>></span>${log.path}/log_warn.log<span class=tag>&LT/<span class=name>file</span>></span></span><br><span class=line>        <span class=comment>&LT!--日志文件输出格式--></span></span><br><span class=line>        <span class=tag><<span class=name>encoder</span>></span></span><br><span class=line>            <span class=tag><<span class=name>pattern</span>></span>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n<span class=tag>&LT/<span class=name>pattern</span>></span></span><br><span class=line>            <span class=tag><<span class=name>charset</span>></span>UTF-8<span class=tag>&LT/<span class=name>charset</span>></span> <span class=comment>&LT!-- 此处设置字符集 --></span></span><br><span class=line>        <span class=tag>&LT/<span class=name>encoder</span>></span></span><br><span class=line>        <span class=comment>&LT!-- 日志记录器的滚动策略，按日期，按大小记录 --></span></span><br><span class=line>        <span class=tag><<span class=name>rollingPolicy</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span>></span></span><br><span class=line>            <span class=tag><<span class=name>fileNamePattern</span>></span>${log.path}/warn/log-warn-%d{yyyy-MM-dd}.%i.log<span class=tag>&LT/<span class=name>fileNamePattern</span>></span></span><br><span class=line>            <span class=tag><<span class=name>timeBasedFileNamingAndTriggeringPolicy</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"</span>></span></span><br><span class=line>                <span class=tag><<span class=name>maxFileSize</span>></span>100MB<span class=tag>&LT/<span class=name>maxFileSize</span>></span></span><br><span class=line>            <span class=tag>&LT/<span class=name>timeBasedFileNamingAndTriggeringPolicy</span>></span></span><br><span class=line>            <span class=comment>&LT!--日志文件保留天数--></span></span><br><span class=line>            <span class=tag><<span class=name>maxHistory</span>></span>15<span class=tag>&LT/<span class=name>maxHistory</span>></span></span><br><span class=line>        <span class=tag>&LT/<span class=name>rollingPolicy</span>></span></span><br><span class=line>        <span class=comment>&LT!-- 此日志文件只记录warn级别的 --></span></span><br><span class=line>        <span class=tag><<span class=name>filter</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.classic.filter.LevelFilter"</span>></span></span><br><span class=line>            <span class=tag><<span class=name>level</span>></span>warn<span class=tag>&LT/<span class=name>level</span>></span></span><br><span class=line>            <span class=tag><<span class=name>onMatch</span>></span>ACCEPT<span class=tag>&LT/<span class=name>onMatch</span>></span></span><br><span class=line>            <span class=tag><<span class=name>onMismatch</span>></span>DENY<span class=tag>&LT/<span class=name>onMismatch</span>></span></span><br><span class=line>        <span class=tag>&LT/<span class=name>filter</span>></span></span><br><span class=line>    <span class=tag>&LT/<span class=name>appender</span>></span></span><br><span class=line></span><br><span class=line>    <span class=comment>&LT!-- 时间滚动输出 ERROR级别 的日志 --></span></span><br><span class=line>    <span class=tag><<span class=name>appender</span> <span class=attr>name</span>=<span class=string>"ERROR_FILE"</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.core.rolling.RollingFileAppender"</span>></span></span><br><span class=line>        <span class=comment>&LT!-- 正在记录的日志文件的路径及文件名 --></span></span><br><span class=line>        <span class=tag><<span class=name>file</span>></span>${log.path}/log_error.log<span class=tag>&LT/<span class=name>file</span>></span></span><br><span class=line>        <span class=comment>&LT!--日志文件输出格式--></span></span><br><span class=line>        <span class=tag><<span class=name>encoder</span>></span></span><br><span class=line>            <span class=tag><<span class=name>pattern</span>></span>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n<span class=tag>&LT/<span class=name>pattern</span>></span></span><br><span class=line>            <span class=tag><<span class=name>charset</span>></span>UTF-8<span class=tag>&LT/<span class=name>charset</span>></span> <span class=comment>&LT!-- 此处设置字符集 --></span></span><br><span class=line>        <span class=tag>&LT/<span class=name>encoder</span>></span></span><br><span class=line>        <span class=comment>&LT!-- 日志记录器的滚动策略，按日期，按大小记录 --></span></span><br><span class=line>        <span class=tag><<span class=name>rollingPolicy</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span>></span></span><br><span class=line>            <span class=tag><<span class=name>fileNamePattern</span>></span>${log.path}/error/log-error-%d{yyyy-MM-dd}.%i.log<span class=tag>&LT/<span class=name>fileNamePattern</span>></span></span><br><span class=line>            <span class=tag><<span class=name>timeBasedFileNamingAndTriggeringPolicy</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"</span>></span></span><br><span class=line>                <span class=tag><<span class=name>maxFileSize</span>></span>100MB<span class=tag>&LT/<span class=name>maxFileSize</span>></span></span><br><span class=line>            <span class=tag>&LT/<span class=name>timeBasedFileNamingAndTriggeringPolicy</span>></span></span><br><span class=line>            <span class=comment>&LT!--日志文件保留天数--></span></span><br><span class=line>            <span class=tag><<span class=name>maxHistory</span>></span>15<span class=tag>&LT/<span class=name>maxHistory</span>></span></span><br><span class=line>        <span class=tag>&LT/<span class=name>rollingPolicy</span>></span></span><br><span class=line>        <span class=comment>&LT!-- 此日志文件只记录ERROR级别的 --></span></span><br><span class=line>        <span class=tag><<span class=name>filter</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.classic.filter.LevelFilter"</span>></span></span><br><span class=line>            <span class=tag><<span class=name>level</span>></span>ERROR<span class=tag>&LT/<span class=name>level</span>></span></span><br><span class=line>            <span class=tag><<span class=name>onMatch</span>></span>ACCEPT<span class=tag>&LT/<span class=name>onMatch</span>></span></span><br><span class=line>            <span class=tag><<span class=name>onMismatch</span>></span>DENY<span class=tag>&LT/<span class=name>onMismatch</span>></span></span><br><span class=line>        <span class=tag>&LT/<span class=name>filter</span>></span></span><br><span class=line>    <span class=tag>&LT/<span class=name>appender</span>></span></span><br><span class=line></span><br><span class=line>    <span class=comment>&LT!--</span></span><br><span class=line><span class=comment>        &LTlogger>用来设置某一个包或者具体的某一个类的日志打印级别、以及指定&LTappender>。</span></span><br><span class=line><span class=comment>        &LTlogger>仅有一个name属性，</span></span><br><span class=line><span class=comment>        一个可选的level和一个可选的addtivity属性。</span></span><br><span class=line><span class=comment>        name:用来指定受此logger约束的某一个包或者具体的某一个类。</span></span><br><span class=line><span class=comment>        level:用来设置打印级别，大小写无关：TRACE, DEBUG, INFO, WARN, ERROR, ALL 和 OFF，</span></span><br><span class=line><span class=comment>              如果未设置此属性，那么当前logger将会继承上级的级别。</span></span><br><span class=line><span class=comment>    --></span></span><br><span class=line>    <span class=comment>&LT!--</span></span><br><span class=line><span class=comment>        使用mybatis的时候，sql语句是debug下才会打印，而这里我们只配置了info，所以想要查看sql语句的话，有以下两种操作：</span></span><br><span class=line><span class=comment>        第一种把&LTroot level="INFO">改成&LTroot level="DEBUG">这样就会打印sql，不过这样日志那边会出现很多其他消息</span></span><br><span class=line><span class=comment>        第二种就是单独给mapper下目录配置DEBUG模式，代码如下，这样配置sql语句会打印，其他还是正常DEBUG级别：</span></span><br><span class=line><span class=comment>     --></span></span><br><span class=line>    <span class=comment>&LT!--开发环境:打印控制台--></span></span><br><span class=line>    <span class=tag><<span class=name>springProfile</span> <span class=attr>name</span>=<span class=string>"dev"</span>></span></span><br><span class=line>        <span class=comment>&LT!--可以输出项目中的debug日志，包括mybatis的sql日志--></span></span><br><span class=line>        <span class=tag><<span class=name>logger</span> <span class=attr>name</span>=<span class=string>"cn.shh.project.guliedu"</span> <span class=attr>level</span>=<span class=string>"INFO"</span> /></span></span><br><span class=line>        <span class=comment>&LT!--</span></span><br><span class=line><span class=comment>            root节点是必选节点，用来指定最基础的日志输出级别，只有一个level属性</span></span><br><span class=line><span class=comment>            level:用来设置打印级别，大小写无关：TRACE, DEBUG, INFO, WARN, ERROR, ALL 和 OFF，默认是DEBUG</span></span><br><span class=line><span class=comment>            可以包含零个或多个appender元素。</span></span><br><span class=line><span class=comment>        --></span></span><br><span class=line>        <span class=tag><<span class=name>root</span> <span class=attr>level</span>=<span class=string>"INFO"</span>></span></span><br><span class=line>            <span class=tag><<span class=name>appender-ref</span> <span class=attr>ref</span>=<span class=string>"CONSOLE"</span> /></span></span><br><span class=line>            <span class=tag><<span class=name>appender-ref</span> <span class=attr>ref</span>=<span class=string>"INFO_FILE"</span> /></span></span><br><span class=line>            <span class=tag><<span class=name>appender-ref</span> <span class=attr>ref</span>=<span class=string>"WARN_FILE"</span> /></span></span><br><span class=line>            <span class=tag><<span class=name>appender-ref</span> <span class=attr>ref</span>=<span class=string>"ERROR_FILE"</span> /></span></span><br><span class=line>        <span class=tag>&LT/<span class=name>root</span>></span></span><br><span class=line>    <span class=tag>&LT/<span class=name>springProfile</span>></span></span><br><span class=line></span><br><span class=line>    <span class=comment>&LT!--生产环境:输出到文件--></span></span><br><span class=line>    <span class=tag><<span class=name>springProfile</span> <span class=attr>name</span>=<span class=string>"pro"</span>></span></span><br><span class=line>        <span class=tag><<span class=name>root</span> <span class=attr>level</span>=<span class=string>"INFO"</span>></span></span><br><span class=line>            <span class=tag><<span class=name>appender-ref</span> <span class=attr>ref</span>=<span class=string>"CONSOLE"</span> /></span></span><br><span class=line>            <span class=tag><<span class=name>appender-ref</span> <span class=attr>ref</span>=<span class=string>"DEBUG_FILE"</span> /></span></span><br><span class=line>            <span class=tag><<span class=name>appender-ref</span> <span class=attr>ref</span>=<span class=string>"INFO_FILE"</span> /></span></span><br><span class=line>            <span class=tag><<span class=name>appender-ref</span> <span class=attr>ref</span>=<span class=string>"ERROR_FILE"</span> /></span></span><br><span class=line>            <span class=tag><<span class=name>appender-ref</span> <span class=attr>ref</span>=<span class=string>"WARN_FILE"</span> /></span></span><br><span class=line>        <span class=tag>&LT/<span class=name>root</span>></span></span><br><span class=line>    <span class=tag>&LT/<span class=name>springProfile</span>></span></span><br><span class=line><span class=tag>&LT/<span class=name>configuration</span>></span></span><br></pre></table></figure></div><footer class=post-footer><div class=post-eof></div></footer></article></div><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://hshz21.gitee.io/2024/08/21/02-%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/static/imgs/avatar.png itemprop=image> <meta content=豪哥 itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=豪哥博客 itemprop=name> <meta content=豪哥博客 itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="undefined | 豪哥博客" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/2024/08/21/02-%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/ itemprop=url>微服务业务功能系列-全局异常</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2024-08-21 21:39:15" datetime=2024-08-21T21:39:15+08:00>2024-08-21</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-08-07 15:30:00" datetime=2023-08-07T15:30:00+08:00 itemprop=dateModified>2023-08-07</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/ itemprop=url rel=index><span itemprop=name>微服务</span></a> </span> </span></div></div></header><div class=post-body itemprop=articleBody><h1 id=1、自定义异常><a class=headerlink href=#1、自定义异常 title=1、自定义异常></a>1、自定义异常</h1><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br></pre><td class=code><pre><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">SYTException</span> <span class=keyword>extends</span> <span class="title class_">RuntimeException</span>{</span><br><span class=line>    <span class=keyword>private</span> Integer code;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">SYTException</span><span class=params>(String msg, Integer code)</span>{</span><br><span class=line>        <span class=built_in>super</span>(msg);</span><br><span class=line>        <span class=built_in>this</span>.code = code;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">SYTException</span><span class=params>(RCodeEnum rCodeEnum)</span>{</span><br><span class=line>        <span class=built_in>super</span>(rCodeEnum.getMsg());</span><br><span class=line>        <span class=built_in>this</span>.code = rCodeEnum.getCode();</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h1 id=2、全局统一异常处理><a class=headerlink href=#2、全局统一异常处理 title=2、全局统一异常处理></a>2、全局统一异常处理</h1><p>在全局统一异常处理类中可以添加自定义异常类，当在项目中抛出该设置的自定义异常时，会得到统一处理。<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br></pre><td class=code><pre><span class=line><span class=meta>@ControllerAdvice</span></span><br><span class=line><span class=meta>@ResponseBody</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">GlobalExceptionHandler</span> {</span><br><span class=line>    <span class=meta>@ExceptionHandler(Exception.class)</span></span><br><span class=line>    <span class=keyword>public</span> R <span class="title function_">error</span><span class=params>(Exception e)</span>{</span><br><span class=line>        e.printStackTrace();</span><br><span class=line>        <span class=keyword>return</span> R.fail();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@ExceptionHandler(SYTException.class)</span></span><br><span class=line>    <span class=keyword>public</span> R <span class="title function_">error</span><span class=params>(SYTException e)</span>{</span><br><span class=line>        e.printStackTrace();</span><br><span class=line>        <span class=keyword>return</span> R.fail();</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure></div><footer class=post-footer><div class=post-eof></div></footer></article></div><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://hshz21.gitee.io/2024/08/21/02-Session%E5%85%B1%E4%BA%AB%E9%97%AE%E9%A2%98/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/static/imgs/avatar.png itemprop=image> <meta content=豪哥 itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=豪哥博客 itemprop=name> <meta content=豪哥博客 itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="undefined | 豪哥博客" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/2024/08/21/02-Session%E5%85%B1%E4%BA%AB%E9%97%AE%E9%A2%98/ itemprop=url>微服务问题系列-Session共享问题</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2024-08-21 21:39:15" datetime=2024-08-21T21:39:15+08:00>2024-08-21</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-08-07 16:09:12" datetime=2023-08-07T16:09:12+08:00 itemprop=dateModified>2023-08-07</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/ itemprop=url rel=index><span itemprop=name>微服务</span></a> </span> </span></div></div></header><div class=post-body itemprop=articleBody><h1 id=1、Session共享方案特点><a class=headerlink href=#1、Session共享方案特点 title=1、Session共享方案特点></a>1、Session共享方案特点</h1><p>session替代方案需满足：<ul><li>数据共享<li>内存存储<li>key/value结构</ul><h1 id=2、Session共享方案><a class=headerlink href=#2、Session共享方案 title=2、Session共享方案></a>2、Session共享方案</h1><h2 id=2-1、Tomcat><a class=headerlink href=#2-1、Tomcat title=2.1、Tomcat></a>2.1、Tomcat</h2><ul><li>tomcat通过配置实现session互相拷贝<ul><li>浪费内存空间，成本高。<li>同步时间较长，效率低。</ul></ul><h2 id=2-2、Redis（推荐）><a class=headerlink href=#2-2、Redis（推荐） title=2.2、Redis（推荐）></a>2.2、Redis（推荐）</h2><ul><li>验证码<ul><li>String类型。<li>key使用手机号。</ul><li>用户数据<ul><li>hash类型。<li>key使用随机token，且让浏览器保存，后期交互时都要带上。<li>30分钟有效期。<li>拦截器更新有效期，只有在用户超过30没有一次交流时才销毁。</ul></ul><h1 id=3、代码示例><a class=headerlink href=#3、代码示例 title=3、代码示例></a>3、代码示例</h1><h2 id=3-1、SpringSession整合Redis><a class=headerlink href=#3-1、SpringSession整合Redis title=3.1、SpringSession整合Redis></a>3.1、SpringSession整合Redis</h2><h3 id=3-1-1、引入依赖><a class=headerlink href=#3-1-1、引入依赖 title=3.1.1、引入依赖></a>3.1.1、引入依赖</h3><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line><span class=tag><<span class=name>dependency</span>></span></span><br><span class=line>    <span class=tag><<span class=name>groupId</span>></span>org.springframework.session<span class=tag>&LT/<span class=name>groupId</span>></span></span><br><span class=line>    <span class=tag><<span class=name>artifactId</span>></span>spring-session-data-redis<span class=tag>&LT/<span class=name>artifactId</span>></span></span><br><span class=line><span class=tag>&LT/<span class=name>dependency</span>></span></span><br></pre></table></figure><h3 id=3-1-2、配置><a class=headerlink href=#3-1-2、配置 title=3.1.2、配置></a>3.1.2、配置</h3><h4 id=3-1-2-1、application-yml><a class=headerlink href=#3-1-2-1、application-yml title=3.1.2.1、application.yml></a>3.1.2.1、application.yml</h4><figure class="highlight yml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br></pre><td class=code><pre><span class=line><span class=attr>server:</span></span><br><span class=line>  <span class=attr>servlet:</span> </span><br><span class=line>    <span class=attr>session:</span></span><br><span class=line>      <span class=attr>timeout:</span> <span class=string>30m</span>	<span class=comment># 30分钟</span></span><br><span class=line><span class=attr>spring:</span></span><br><span class=line>  <span class=attr>session:</span></span><br><span class=line>    <span class=attr>store-type:</span> <span class=string>redis</span></span><br><span class=line>  <span class=attr>redis:</span></span><br><span class=line>    <span class=attr>host:</span> <span class=number>192.168</span><span class=number>.2</span><span class=number>.4</span></span><br><span class=line>    <span class=attr>port:</span> <span class=number>6379</span></span><br></pre></table></figure><h4 id=3-1-2-2、配置类><a class=headerlink href=#3-1-2-2、配置类 title=3.1.2.2、配置类></a>3.1.2.2、配置类</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br></pre><td class=code><pre><span class=line><span class=meta>@Configuration</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">GuLiMallSessionConfig</span> {</span><br><span class=line>    <span class=meta>@Bean</span></span><br><span class=line>    <span class=keyword>public</span> CookieSerializer <span class="title function_">cookieSerializer</span><span class=params>()</span>{</span><br><span class=line>        <span class=type>DefaultCookieSerializer</span> <span class=variable>cookieSerializer</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">DefaultCookieSerializer</span>();</span><br><span class=line>        <span class=comment>// 明确的指定Cookie的作用域</span></span><br><span class=line>        cookieSerializer.setDomainName(<span class=string>"gulimall.com"</span>);</span><br><span class=line>        cookieSerializer.setCookieName(<span class=string>"GLMSESSION"</span>);</span><br><span class=line>        <span class=keyword>return</span> cookieSerializer;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 自定义序列化机制</span></span><br><span class=line><span class=comment>     * 这里方法名必须是：springSessionDefaultRedisSerializer</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=meta>@Bean</span></span><br><span class=line>    <span class=keyword>public</span> RedisSerializer&LTObject> <span class="title function_">springSessionDefaultRedisSerializer</span><span class=params>()</span>{</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">GenericJackson2JsonRedisSerializer</span>();</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h4 id=3-1-2-3、启动类上加注解><a class=headerlink href=#3-1-2-3、启动类上加注解 title=3.1.2.3、启动类上加注解></a>3.1.2.3、启动类上加注解</h4><p>启动类上需要加主机<code>@EnableRedisHttpSession</code>。<h3 id=3-1-3、使用示例><a class=headerlink href=#3-1-3、使用示例 title=3.1.3、使用示例></a>3.1.3、使用示例</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br></pre><td class=code><pre><span class=line><span class=meta>@PostMapping("/login")</span></span><br><span class=line><span class=keyword>public</span> String <span class="title function_">login</span><span class=params>(UserLoginVo userLoginVo, RedirectAttributes redirectAttributes, HttpSession session)</span>{</span><br><span class=line>    log.info(<span class=string>"--------------------登录 S--------------------"</span>);</span><br><span class=line>    <span class=type>R</span> <span class=variable>r</span> <span class=operator>=</span> memberFeignService.login(userLoginVo);</span><br><span class=line>    <span class=keyword>if</span>(r.getCode() == <span class=number>0</span>){</span><br><span class=line>        <span class=type>MemberRsepVo</span> <span class=variable>rsepVo</span> <span class=operator>=</span> r.getData(<span class=string>"data"</span>, <span class=keyword>new</span> <span class="title class_">TypeReference</span>&LTMemberRsepVo>() {});</span><br><span class=line>        session.setAttribute(AuthServerConstant.LOGIN_USER, rsepVo);</span><br><span class=line>        log.info(<span class=string>"MemberRsepVo - rsepVo："</span> + rsepVo.toString());</span><br><span class=line>        log.info(<span class=string>"--------------------登录 E--------------------"</span>);</span><br><span class=line>        <span class=keyword>return</span> <span class=string>"redirect:http://gulimall.com"</span>;</span><br><span class=line>    }<span class=keyword>else</span> {</span><br><span class=line>        HashMap&LTString, String> error = <span class=keyword>new</span> <span class="title class_">HashMap</span><>();</span><br><span class=line>        <span class=comment>// 获取错误信息</span></span><br><span class=line>        error.put(<span class=string>"msg"</span>, r.getData(<span class=string>"msg"</span>,<span class=keyword>new</span> <span class="title class_">TypeReference</span>&LTString>(){}));</span><br><span class=line>        redirectAttributes.addFlashAttribute(<span class=string>"errors"</span>, error);</span><br><span class=line>        log.info(<span class=string>"--------------------登录 E（error）--------------------"</span>);</span><br><span class=line>        <span class=keyword>return</span> <span class=string>"redirect:http://auth.gulimall.com/login.html"</span>;</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure></div><footer class=post-footer><div class=post-eof></div></footer></article></div><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://hshz21.gitee.io/2024/08/21/01-%E5%85%A8%E5%B1%80%E7%BB%9F%E4%B8%80%E8%BF%94%E5%9B%9E%E5%80%BC/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/static/imgs/avatar.png itemprop=image> <meta content=豪哥 itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=豪哥博客 itemprop=name> <meta content=豪哥博客 itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="undefined | 豪哥博客" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/2024/08/21/01-%E5%85%A8%E5%B1%80%E7%BB%9F%E4%B8%80%E8%BF%94%E5%9B%9E%E5%80%BC/ itemprop=url>微服务业务功能系列-全局统一返回值</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2024-08-21 21:39:15" datetime=2024-08-21T21:39:15+08:00>2024-08-21</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-08-07 15:29:11" datetime=2023-08-07T15:29:11+08:00 itemprop=dateModified>2023-08-07</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/ itemprop=url rel=index><span itemprop=name>微服务</span></a> </span> </span></div></div></header><div class=post-body itemprop=articleBody><h1 id=1、返回结果枚举类><a class=headerlink href=#1、返回结果枚举类 title=1、返回结果枚举类></a>1、返回结果枚举类</h1><p>RCodeEnum.java<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br></pre><td class=code><pre><span class=line><span class=meta>@Getter</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>enum</span> <span class="title class_">RCodeEnum</span> {</span><br><span class=line>    SUCCESS(<span class=number>200</span>,<span class=string>"成功"</span>),</span><br><span class=line>    FAIL(<span class=number>201</span>, <span class=string>"失败"</span>),</span><br><span class=line>    PARAM_ERROR( <span class=number>202</span>, <span class=string>"参数不正确"</span>),</span><br><span class=line>    SERVICE_ERROR(<span class=number>203</span>, <span class=string>"服务异常"</span>),</span><br><span class=line>    DATA_ERROR(<span class=number>204</span>, <span class=string>"数据异常"</span>),</span><br><span class=line>    DATA_UPDATE_ERROR(<span class=number>205</span>, <span class=string>"数据版本异常"</span>),</span><br><span class=line></span><br><span class=line>    LOGIN_AUTH(<span class=number>208</span>, <span class=string>"未登陆"</span>),</span><br><span class=line>    PERMISSION(<span class=number>209</span>, <span class=string>"没有权限"</span>),</span><br><span class=line></span><br><span class=line>    CODE_ERROR(<span class=number>210</span>, <span class=string>"验证码错误"</span>),</span><br><span class=line><span class=comment>//    LOGIN_MOBLE_ERROR(211, "账号不正确"),</span></span><br><span class=line>    LOGIN_DISABLED_ERROR(<span class=number>212</span>, <span class=string>"改用户已被禁用"</span>),</span><br><span class=line>    REGISTER_MOBLE_ERROR(<span class=number>213</span>, <span class=string>"手机号已被使用"</span>),</span><br><span class=line>    LOGIN_AURH(<span class=number>214</span>, <span class=string>"需要登录"</span>),</span><br><span class=line>    LOGIN_ACL(<span class=number>215</span>, <span class=string>"没有权限"</span>),</span><br><span class=line></span><br><span class=line>    URL_ENCODE_ERROR( <span class=number>216</span>, <span class=string>"URL编码失败"</span>),</span><br><span class=line>    ILLEGAL_CALLBACK_REQUEST_ERROR( <span class=number>217</span>, <span class=string>"非法回调请求"</span>),</span><br><span class=line>    FETCH_ACCESSTOKEN_FAILD( <span class=number>218</span>, <span class=string>"获取accessToken失败"</span>),</span><br><span class=line>    FETCH_USERINFO_ERROR( <span class=number>219</span>, <span class=string>"获取用户信息失败"</span>),</span><br><span class=line>    <span class=comment>//LOGIN_ERROR( 23005, "登录失败"),</span></span><br><span class=line></span><br><span class=line>    PAY_RUN(<span class=number>220</span>, <span class=string>"支付中"</span>),</span><br><span class=line>    CANCEL_ORDER_FAIL(<span class=number>225</span>, <span class=string>"取消订单失败"</span>),</span><br><span class=line>    CANCEL_ORDER_NO(<span class=number>225</span>, <span class=string>"不能取消预约"</span>),</span><br><span class=line></span><br><span class=line>    HOSCODE_EXIST(<span class=number>230</span>, <span class=string>"医院编号已经存在"</span>),</span><br><span class=line>    NUMBER_NO(<span class=number>240</span>, <span class=string>"可预约号不足"</span>),</span><br><span class=line>    TIME_NO(<span class=number>250</span>, <span class=string>"当前时间不可以预约"</span>),</span><br><span class=line></span><br><span class=line>    SIGN_ERROR(<span class=number>300</span>, <span class=string>"签名错误"</span>),</span><br><span class=line>    HOSPITAL_OPEN(<span class=number>310</span>, <span class=string>"医院未开通，暂时不能访问"</span>),</span><br><span class=line>    HOSPITAL_LOCK(<span class=number>320</span>, <span class=string>"医院被锁定，暂时不能访问"</span>);</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> Integer code;</span><br><span class=line>    <span class=keyword>private</span> String msg;</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> <span class="title function_">RCodeEnum</span><span class=params>(Integer code, String msg)</span> {</span><br><span class=line>        <span class=built_in>this</span>.code = code;</span><br><span class=line>        <span class=built_in>this</span>.msg = msg;</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h1 id=2、返回结果类><a class=headerlink href=#2、返回结果类 title=2、返回结果类></a>2、返回结果类</h1><p>返回结果类 依赖于 返回结果枚举类（可选），返回结果类代码如下：<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br></pre><td class=code><pre><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=meta>@ApiModel(value = "全局统一返回结果")</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">R</span>&LTT> {</span><br><span class=line>    <span class=meta>@ApiModelProperty(value = "返回码")</span></span><br><span class=line>    <span class=keyword>private</span> Integer code;</span><br><span class=line>    <span class=meta>@ApiModelProperty(value = "返回消息")</span></span><br><span class=line>    <span class=keyword>private</span> String msg;</span><br><span class=line>    <span class=meta>@ApiModelProperty(value = "返回数据")</span></span><br><span class=line>    <span class=keyword>private</span> T data;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">R</span><span class=params>()</span>{}</span><br><span class=line></span><br><span class=line>    <span class=keyword>protected</span> <span class=keyword>static</span> &LTT> R&LTT> <span class="title function_">build</span><span class=params>(T data)</span> {</span><br><span class=line>        R&LTT> r = <span class=keyword>new</span> <span class="title class_">R</span>&LTT>();</span><br><span class=line>        <span class=keyword>if</span> (data != <span class=literal>null</span>)</span><br><span class=line>            r.setData(data);</span><br><span class=line>        <span class=keyword>return</span> r;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> &LTT> R&LTT> <span class="title function_">build</span><span class=params>(T body, RCodeEnum rCodeEnum)</span> {</span><br><span class=line>        R&LTT> r = build(body);</span><br><span class=line>        r.setCode(rCodeEnum.getCode());</span><br><span class=line>        r.setMsg(rCodeEnum.getMsg());</span><br><span class=line>        <span class=keyword>return</span> r;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> &LTT> R&LTT> <span class="title function_">build</span><span class=params>(Integer code, String message)</span> {</span><br><span class=line>        R&LTT> r = build(<span class=literal>null</span>);</span><br><span class=line>        r.setCode(code);</span><br><span class=line>        r.setMsg(message);</span><br><span class=line>        <span class=keyword>return</span> r;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span>&LTT> R&LTT> <span class="title function_">ok</span><span class=params>()</span>{</span><br><span class=line>        <span class=keyword>return</span> R.ok(<span class=literal>null</span>);</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span>&LTT> R&LTT> <span class="title function_">ok</span><span class=params>(T data)</span>{</span><br><span class=line>        R&LTT> r = build(data);</span><br><span class=line>        <span class=keyword>return</span> build(data, RCodeEnum.SUCCESS);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span>&LTT> R&LTT> <span class="title function_">fail</span><span class=params>()</span>{</span><br><span class=line>        <span class=keyword>return</span> R.fail(<span class=literal>null</span>);</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span>&LTT> R&LTT> <span class="title function_">fail</span><span class=params>(T data)</span>{</span><br><span class=line>        R&LTT> r = build(data);</span><br><span class=line>        <span class=keyword>return</span> build(data, RCodeEnum.FAIL);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> R&LTT> <span class="title function_">msg</span><span class=params>(String msg)</span>{</span><br><span class=line>        <span class=built_in>this</span>.setMsg(msg);</span><br><span class=line>        <span class=keyword>return</span> <span class=built_in>this</span>;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> R&LTT> <span class="title function_">code</span><span class=params>(Integer code)</span>{</span><br><span class=line>        <span class=built_in>this</span>.setCode(code);</span><br><span class=line>        <span class=keyword>return</span> <span class=built_in>this</span>;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>public</span> <span class=type>boolean</span> <span class="title function_">isOk</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>if</span>(<span class=built_in>this</span>.getCode().intValue() == RCodeEnum.SUCCESS.getCode().intValue()) {</span><br><span class=line>            <span class=keyword>return</span> <span class=literal>true</span>;</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> <span class=literal>false</span>;</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure></div><footer class=post-footer><div class=post-eof></div></footer></article></div><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://hshz21.gitee.io/2024/08/21/01-%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/static/imgs/avatar.png itemprop=image> <meta content=豪哥 itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=豪哥博客 itemprop=name> <meta content=豪哥博客 itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="undefined | 豪哥博客" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/2024/08/21/01-%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/ itemprop=url>微服务问题系列-处理跨域</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2024-08-21 21:39:15" datetime=2024-08-21T21:39:15+08:00>2024-08-21</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-08-07 16:09:01" datetime=2023-08-07T16:09:01+08:00 itemprop=dateModified>2023-08-07</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/ itemprop=url rel=index><span itemprop=name>微服务</span></a> </span> </span></div></div></header><div class=post-body itemprop=articleBody><h1 id=1、跨域问题><a class=headerlink href=#1、跨域问题 title=1、跨域问题></a>1、跨域问题</h1><p><strong>只要 访问协议、访问地址、端口号 三个地方有一个不一样就会出现跨域问题。</strong><h1 id=2、跨域解决方案><a class=headerlink href=#2、跨域解决方案 title=2、跨域解决方案></a>2、跨域解决方案</h1><h2 id=2-1、注解><a class=headerlink href=#2-1、注解 title=2.1、注解></a>2.1、注解</h2><p>可以在Controller控制器上加上注解<code>@CrossOrigin</code>即可，不过这种方案生产中不推荐，仅在开发测试阶段来使用。<h2 id=2-2、网关><a class=headerlink href=#2-2、网关 title=2.2、网关></a>2.2、网关</h2><p><strong>可以通过网关<code>SpringGateway</code>来解决跨域，生产中建议使用该解决方案。</strong><h3 id=2-2-1、配置文件方案><a class=headerlink href=#2-2-1、配置文件方案 title=2.2.1、配置文件方案></a>2.2.1、配置文件方案</h3><p>在配置文件中加入如下内容即可：<figure class="highlight yml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br></pre><td class=code><pre><span class=line><span class=attr>spring:</span></span><br><span class=line>  <span class=attr>cloud:</span></span><br><span class=line>    <span class=attr>gateway:</span></span><br><span class=line>      <span class=attr>globalcors:</span> <span class=comment># 全局的跨域处理</span></span><br><span class=line>        <span class=attr>add-to-simple-url-handler-mapping:</span> <span class=literal>true</span> <span class=comment># 设置为true来解决options请求被拦截问题</span></span><br><span class=line>        <span class=attr>corsConfigurations:</span></span><br><span class=line>          <span class=string>'[/**]'</span><span class=string>:</span></span><br><span class=line>            <span class=attr>allowedOrigins:</span> <span class=comment># 允许哪些网站的跨域请求 </span></span><br><span class=line>              <span class=bullet>-</span> <span class=string>"http://localhost:8090"</span></span><br><span class=line>            <span class=attr>allowedMethods:</span> <span class=comment># 允许的跨域ajax的请求方式</span></span><br><span class=line>              <span class=bullet>-</span> <span class=string>"GET"</span></span><br><span class=line>              <span class=bullet>-</span> <span class=string>"POST"</span></span><br><span class=line>              <span class=bullet>-</span> <span class=string>"DELETE"</span></span><br><span class=line>              <span class=bullet>-</span> <span class=string>"PUT"</span></span><br><span class=line>              <span class=bullet>-</span> <span class=string>"OPTIONS"</span></span><br><span class=line>            <span class=attr>allowedHeaders:</span> <span class=string>"*"</span> <span class=comment># 允许在请求中携带的头信息</span></span><br><span class=line>            <span class=attr>allowCredentials:</span> <span class=literal>true</span> <span class=comment># 是否允许携带cookie</span></span><br><span class=line>            <span class=attr>maxAge:</span> <span class=number>360000</span> <span class=comment># 跨域检测有效期</span></span><br></pre></table></figure><p>路由转发配置内容示例如下：<figure class="highlight yml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br></pre><td class=code><pre><span class=line><span class=attr>spring:</span></span><br><span class=line>  <span class=attr>cloud:</span></span><br><span class=line>    <span class=attr>nacos:</span> <span class=comment># nacos配置，可以选择nacos作为配置中心，维护更方便。</span></span><br><span class=line>      <span class=attr>discovery:</span></span><br><span class=line>        <span class=attr>server-addr:</span> <span class=number>127.0</span><span class=number>.0</span><span class=number>.1</span><span class=string>:8848</span></span><br><span class=line>        <span class=attr>namespace:</span> <span class=string>f2466630-4cfd-4f5c-975d-47b6a3d81a0a</span></span><br><span class=line>        <span class=attr>group:</span> <span class=string>syt-service</span></span><br><span class=line>    <span class=attr>gateway:</span></span><br><span class=line>      <span class=attr>routes:</span></span><br><span class=line>        <span class=bullet>-</span> <span class=attr>id:</span> <span class=string>syt-user-router</span></span><br><span class=line>          <span class=attr>uri:</span> <span class=string>lb://service-user</span></span><br><span class=line>          <span class=attr>predicates:</span></span><br><span class=line>            <span class=bullet>-</span> <span class=string>Path=/api/user/**</span></span><br><span class=line>          <span class=attr>filters:</span></span><br><span class=line>            <span class=bullet>-</span> <span class=string>RewritePath=/api/?(?&LTsegment>.*),</span> <span class=string>/$\{segment}</span></span><br><span class=line>        <span class=bullet>-</span> <span class=attr>id:</span> <span class=string>syt-hosp-router</span></span><br><span class=line>          <span class=attr>uri:</span> <span class=string>lb://service-hosp</span></span><br><span class=line>          <span class=attr>predicates:</span></span><br><span class=line>            <span class=bullet>-</span> <span class=string>Path=/api/hosp/**</span></span><br><span class=line>          <span class=attr>filters:</span></span><br><span class=line>            <span class=bullet>-</span> <span class=string>RewritePath=/api/?(?&LTsegment>.*),</span> <span class=string>/$\{segment}</span></span><br><span class=line>        <span class=bullet>-</span> <span class=attr>id:</span> <span class=string>syt-cmn-router</span></span><br><span class=line>          <span class=attr>uri:</span> <span class=string>lb://service-cmn</span></span><br><span class=line>          <span class=attr>predicates:</span></span><br><span class=line>            <span class=bullet>-</span> <span class=string>Path=/api/cmn/**</span></span><br><span class=line>          <span class=attr>filters:</span></span><br><span class=line>            <span class=bullet>-</span> <span class=string>RewritePath=/api/?(?&LTsegment>.*),</span> <span class=string>/$\{segment}</span></span><br></pre></table></figure><h3 id=2-2-2、配置类方案><a class=headerlink href=#2-2-2、配置类方案 title=2.2.2、配置类方案></a>2.2.2、配置类方案</h3><p>这里注意，配置类方案与配置文件方案 二选一即可。<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br></pre><td class=code><pre><span class=line><span class=keyword>import</span> org.springframework.context.annotation.Bean;</span><br><span class=line><span class=keyword>import</span> org.springframework.context.annotation.Configuration;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.cors.CorsConfiguration;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.cors.reactive.CorsWebFilter;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.cors.reactive.UrlBasedCorsConfigurationSource;</span><br><span class=line></span><br><span class=line><span class=meta>@Configuration</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">SYTCorsConfig</span> {</span><br><span class=line>    <span class=meta>@Bean</span></span><br><span class=line>    <span class=keyword>public</span> CorsWebFilter <span class="title function_">corsWebFilter</span><span class=params>()</span>{</span><br><span class=line>        <span class=type>CorsConfiguration</span> <span class=variable>corsConfiguration</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">CorsConfiguration</span>();</span><br><span class=line>        corsConfiguration.addAllowedHeader(<span class=string>"*"</span>);</span><br><span class=line>        corsConfiguration.addAllowedMethod(<span class=string>"*"</span>);</span><br><span class=line>        corsConfiguration.addAllowedOrigin(<span class=string>"*"</span>);</span><br><span class=line>        <span class=comment>//corsConfiguration.setAllowCredentials(true);</span></span><br><span class=line>        <span class=type>UrlBasedCorsConfigurationSource</span> <span class=variable>configurationSource</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">UrlBasedCorsConfigurationSource</span>();</span><br><span class=line>        configurationSource.registerCorsConfiguration(<span class=string>"/**"</span>, corsConfiguration);</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">CorsWebFilter</span>(configurationSource);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure></div><footer class=post-footer><div class=post-eof></div></footer></article></div><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://hshz21.gitee.io/2024/08/21/%E6%80%BB%E7%BA%BF%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/static/imgs/avatar.png itemprop=image> <meta content=豪哥 itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=豪哥博客 itemprop=name> <meta content=豪哥博客 itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="undefined | 豪哥博客" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/2024/08/21/%E6%80%BB%E7%BA%BF%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/ itemprop=url>计算机系列-系统总线</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2024-08-21 21:39:15" datetime=2024-08-21T21:39:15+08:00>2024-08-21</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-10-06 11:13:37" datetime=2023-10-06T11:13:37+08:00 itemprop=dateModified>2023-10-06</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/ itemprop=url rel=index><span itemprop=name>计算机</span></a> </span> </span></div></div></header><div class=post-body itemprop=articleBody><h1 id=1、认识总线><a class=headerlink href=#1、认识总线 title=1、认识总线></a>1、认识总线</h1><h2 id=1-1、总线简介><a class=headerlink href=#1-1、总线简介 title=1.1、总线简介></a>1.1、总线简介</h2><p><strong>随着处理器和存储器速度越来越快，单总线（当然还有IBM PC总线）很难处理总线交通流量，故新一代总线出现了</strong>。<p>Pentium系统结构图如下所示：<p><img alt=大型Pentium系统结构图01 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/%E5%A4%A7%E5%9E%8BPentium%E7%B3%BB%E7%BB%9F%E7%BB%93%E6%9E%84%E5%9B%BE01.png?token=AIGEF3JXIXM7SQPAGRBS33DEZZVW4><p><strong>图中系统有8个总线（高速缓存、局部、内存、PCI、SCSI、USB、IDE和ISA），每个总线传输速度和功能都不同</strong>。操作系统必须了解所有总线的配置和管理。有两个主要总线，即早期的IBM PC ISA（Industry Standard Architecture）总线和它的后继者PCI（Peripheral Component Interconnect）总线。<h2 id=1-2、ISA-PCI总线><a class=headerlink href=#1-2、ISA-PCI总线 title=1.2、ISA/PCI总线></a>1.2、ISA/PCI总线</h2><h3 id=1-2-1、ISA总线><a class=headerlink href=#1-2-1、ISA总线 title=1.2.1、ISA总线></a>1.2.1、ISA总线</h3><p><strong>ISA总线就是原先的IBM PC/AT总线，以8.33MHz频率运行，可并行传送2字节，最大速率为16.67MB/s。它还可与老式的慢速I/O卡向后兼容。</strong><h3 id=1-2-2、PCI总线><a class=headerlink href=#1-2-2、PCI总线 title=1.2.2、PCI总线></a>1.2.2、PCI总线</h3><p><strong>PCI总线作为ISA总线后继者由Intel公司发布。它可在66MHz频率运行，可并行传送8字节，数据速率为528MB/s。</strong><blockquote><p>目前多数高速I/O设备采用PCI总线。由于有大量I/O卡采用PCI总线，甚至许多非Intel计算机也使用PCI总线。现在，使用称为PCI Express的PCI总线升级版的新计算机已经出现。</blockquote><p>在这种配置中，CPU通过局部总线与PCI桥芯片对话，而PCI桥芯片通过专门的存储总线与存储器对话，一般速率为100MHz。<p>Pentium系统在芯片上有1级高速缓存，在芯片外有一个非常大的2级高速缓存，它通过高速缓存总线与CPU连接。<h2 id=1-3、IDE-USB-SCSI总线><a class=headerlink href=#1-3、IDE-USB-SCSI总线 title=1.3、IDE/USB/SCSI总线></a>1.3、IDE/USB/SCSI总线</h2><p>系统中有三个专门的总线：IDE、USB和SCSI。<h3 id=1-3-1、IDE总线><a class=headerlink href=#1-3-1、IDE总线 title=1.3.1、IDE总线></a>1.3.1、IDE总线</h3><p><strong>IDE总线 将诸如 磁盘 和 CD-ROM 类的外部设备与系统相连接。IDE总线 是PC/AT的 磁盘控制器接口的副产品，现在几乎成了所有基于Pentium系统的硬盘标准，对于CD-ROM也经常是这样。</strong><h3 id=1-3-2、USB总线><a class=headerlink href=#1-3-2、USB总线 title=1.3.2、USB总线></a>1.3.2、USB总线</h3><h4 id=1-3-2-1、USB总线简介><a class=headerlink href=#1-3-2-1、USB总线简介 title=1.3.2.1、USB总线简介></a>1.3.2.1、USB总线简介</h4><p><strong>通用串行总线（Universal Serial Bus，USB）是用来将所有慢速I/O设备，诸如键盘和鼠标，与计算机连接。</strong><p>USB总线采用一种小型四针连接器，其中两针为USB设备提供电源。<h4 id=1-3-2-2、USB总线特点><a class=headerlink href=#1-3-2-2、USB总线特点 title=1.3.2.2、USB总线特点></a>1.3.2.2、USB总线特点</h4><p><strong>USB是一种集中式总线，其根设备每1ms轮询一次I/O设备，看是否有信息收发。</strong><blockquote><p>USB1.0可以处理总计为1.5MB/s的负载，而较新的USB2.0总线可以有60MB/s的速率。<p>所有USB设备共享一个USB设备驱动器，所以无须重新启动就可以给计算机添加USB设备。</blockquote><h3 id=1-3-3、SCSI总线><a class=headerlink href=#1-3-3、SCSI总线 title=1.3.3、SCSI总线></a>1.3.3、SCSI总线</h3><p><strong>SCSI（Small Computer System Interface）总线是一种高速总线，用在高速硬盘、扫描仪和其他需要较大带宽的设备上。它最高可达320MB/s。</strong><p>自从其发布以来，SCSI总线一直用在Macintosh系统上，在UNIX和一些基于Intel的系统中也很流行。<h3 id=1-3-4、IEEE-1394总线><a title="1.3.4、IEEE 1394总线" class=headerlink href=#1-3-4、IEEE-1394总线></a>1.3.4、IEEE 1394总线</h3><p><strong>EEE1394称为火线（FireWire），严格来说，火线是苹果公司具体实现1394的名称。</strong><p><strong>与USB一样，IEEE1394是串行总线，设计用于最快可达100MB/s的包传送中，它适合于将数码相机和类似的多媒体设备连接到计算机上。</strong><p>IEEE 1394与USB不同，不需要集中式控制器。<h3 id=1-3-5、总结><a class=headerlink href=#1-3-5、总结 title=1.3.5、总结></a>1.3.5、总结</h3><p><strong>要想使总线工作起来，需要让操作系统知道连接到计算机的外部设备有哪些，并对它们进行配置。</strong><p>这个特点 导致 Intel 和 微软 设计了一种名为 即插即用 的I/O系统。<blockquote><p>在即插即用之前，每块I/O卡有一个固定的中断请求级别和用于其I/O寄存器的固定地址，例如，键盘的中断级别是1，并使用0x60至0x64的I/O地址，软盘控制器是中断6级并使用0x3F0至0x3F7的I/O地址，而打印机是中断7级并使用0x378至0x37A的I/O地址等。<p>比如，用户买了一块声卡和调制解调卡，并且它们都是可以使用中断4的，但此时，问题发生了，两块卡互相冲突，结果不能在一起工作。解决方案是在每块I/O卡上提供DIP开关或跳接器，并指导用户对其进行设置以选择中断级别和I/O地址，使其不会与用户系统的任何其他部件冲突。</blockquote><p><strong>即插即用所做的工作是，系统自动地收集有关I/O设备的信息，集中赋予中断级别和I/O地址，然后通知每块卡所使用的数值。</strong>这项工作与计算机的启动密切相关。<h2 id=1-4、启动计算机><a class=headerlink href=#1-4、启动计算机 title=1.4、启动计算机></a>1.4、启动计算机</h2><p><strong>环境描述如下</strong>：<p>在每个Pentium上有一块双亲板（在政治上的纠正影响到计算机产业之前，它们曾称为“母板”）。在双亲板上有一个称为基本输入输出系统（Basic Input Output System，BIOS）的程序。在BIOS内有底层I/O软件，包括读键盘、写屏幕、进行磁盘I/O以及其他过程。现在这个程序存放在一块闪速RAM中，它是非可易失性的，但是在发现BIOS中有错时可以通过操作系统对它进行更新。<p><strong>Pentium启动过程可简单描述如下</strong>：<ol><li><p>计算机启动，BIOS开始运行。</p> <ol><li>首先检查安装的RAM数量，键盘和其他基本设备是否已安装并正常响应。<li>扫描ISA和PCI总线并找出连在上面的所有设备。其中有些是遗留设备，且有固定的中断级别和I/O地址。即插即用设备也被记录下来。如果现有设备 与 系统上一次启动时的设备不同，则配置新设备。</ol><li><p>BIOS尝试在CMOS存储器中的设备清单中来决定启动设备。</p> <p>用户可以在系统刚启动之后进入一个BIOS配置程序，对设备清单进行修改。典型地，如果存在软盘，则系统试图从软盘启动。如果失败则试用CD-ROM，看看是否有可启动CD-ROM存在。如果软盘和CD-ROM都没有，系统从硬盘启动。启动设备上的第一个扇区被读入内存并执行。这个扇面中包含一个对保存在启动扇面末尾的分区表检查的程序，以确定哪个分区是活动的。然后，从该分区读入第二个启动装载模块。来自活动分区的这个装载模块被读入操作系统，并启动之。</p><li><p>操作系统询问BIOS获得配置信息。</p> <p>对于每种设备，系统检查对应的设备驱动程序是否存在。如果没有，系统要求用户插入含有该设备驱动程序的CD-ROM（由设备供应商提供）。一旦有了全部的设备驱动程序，操作系统就将它们调入内核。然后初始化有关表格，创建需要的任何背景进程，并在每个终端上启动登录程序或GUI。</p></ol></div><footer class=post-footer><div class=post-eof></div></footer></article></div><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://hshz21.gitee.io/2024/08/21/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AF%B9%E6%AF%94%E6%80%BB%E7%BB%93/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/static/imgs/avatar.png itemprop=image> <meta content=豪哥 itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=豪哥博客 itemprop=name> <meta content=豪哥博客 itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="undefined | 豪哥博客" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/2024/08/21/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AF%B9%E6%AF%94%E6%80%BB%E7%BB%93/ itemprop=url>消息队列系列-消息队列框架对比</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2024-08-21 21:39:15" datetime=2024-08-21T21:39:15+08:00>2024-08-21</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-08-07 10:07:54" datetime=2023-08-07T10:07:54+08:00 itemprop=dateModified>2023-08-07</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/ itemprop=url rel=index><span itemprop=name>消息队列</span></a> </span> </span></div></div></header><div class=post-body itemprop=articleBody><h1 id=消息中间件使用场景><a class=headerlink href=#消息中间件使用场景 title=消息中间件使用场景></a>消息中间件使用场景</h1><h2 id=削峰填谷><a class=headerlink href=#削峰填谷 title=削峰填谷></a>削峰填谷</h2><h2 id=解耦><a class=headerlink href=#解耦 title=解耦></a>解耦</h2><h2 id=广播><a class=headerlink href=#广播 title=广播></a>广播</h2><h2 id=最终一致性><a class=headerlink href=#最终一致性 title=最终一致性></a>最终一致性</h2><h1 id=消息中间件优劣总结><a class=headerlink href=#消息中间件优劣总结 title=消息中间件优劣总结></a>消息中间件优劣总结</h1><h2 id=RabbitMQ><a class=headerlink href=#RabbitMQ title=RabbitMQ></a>RabbitMQ</h2><p><strong>RabbitMQ 发布于 2007年，基于AMQP（高级消息队列协议）设计而成的可复用企业消息系统。</strong><p>优点：<ol><li>由于erlang语言的特性，mq 性能较好，支持高并发；<li>吞吐量到万级，MQ功能比较完备；<li>健壮、稳定、易用、跨平台、支持多种语言、文档齐全；<li>开源提供的管理界面非常棒，用起来很好用；<li>社区活跃度高；</ol><p>缺点：<ol><li>通过erlang语言开发，源码难以理解，不利于做二次开发和维护，只能依赖于开源社区。<li>RabbitMQ吞吐量较低，因为它的实现机制较重。<li>需要学习比较复杂的接口和协议，学习和维护成本较高。</ol><h2 id=RocketMQ><a class=headerlink href=#RocketMQ title=RocketMQ></a>RocketMQ</h2><p><strong>RocketMQ 是 阿里参考kafka后基于 Java 语言开发的一个消息中间件。</strong><p>RocketMQ是一个分布式开源消息中间件，前身是MetaQ，是阿里参考Kafka后研发的一个消息中间件，后开源给apache基金会成为了apache顶级开源项目，具有高性能、高可靠、高实时、分布式等特点。<p>优点：<ol><li>单机吞吐量：十万级；<li>可用性：非常高，分布式架构；<li>消息可靠性：经过参数优化配置，消息可以做到0丢失；<li>功能支持：MQ功能较完善，属于分布式结构，扩展性好；<li>消息堆积：支持10亿级别的消息堆积，不会因为堆积导致性能下降；<li>底层源码：通过Java语言开发设计而成，便于理解和二次开发；</ol><p>缺点：<ol><li>社区活跃度一般；<li>客户端语言支持度不大，主要支持 Java 和 C++；<li>MQ核心中没有实现 JMS 接口，个别系统迁移需要修改大量代码；</ol><h2 id=KafKa><a class=headerlink href=#KafKa title=KafKa></a>KafKa</h2><p>可达百万级TPS，为大数据而生。在数据采集、传输、存储等过程中发挥着重要作用。<p><strong>Apache Kafka 是 LinkedIn公司开发的一个分布式日志提交系统，后成为Apache项目的一部分。</strong><p>优点：<ol><li>TPS：单机可达百万TPS，吞吐量高；<li>时效性：ms（毫秒）级；<li>可用性：分布式架构，可用性较高；<li>获取消息：消费者采用Pull方式获取消息，可保证消息有序，同时可保证所有消息都被消费且仅被消费一次；<li>管理界面：有第三方优秀的界面管理工具Kafka-Manager；<li>客户量：日志领域较成熟，已被多家公司和多个开源项目使用；<li>功能支持：功能较简单，主要支持MQ功能，在大数据实时计算以及日志采集等方面已有大量应用；</ol><p>缺点：<ol><li>Kafka单机超过64个队列/分区时会导致Load发生明显飙高现象，队列越多，load越高，发送消息响应时间越长；<li>使用短轮询方式，实时性取决于轮询间隔时间；<li>消费失败后不支持重试；<li>支持消息顺序，但是一台代理宕机后，就会产生消息乱序；<li>社区更新较慢；</ol><h2 id=ActiveMQ><a class=headerlink href=#ActiveMQ title=ActiveMQ></a>ActiveMQ</h2><p>优点：<ul><li>单机吞吐量：万级；<li>topic数量都吞吐量的影响；<li>时效性：ms级（毫秒级）；<li>可用性：高，基于主从架构实现高可用性；<li>消息可靠性：有较低的概率丢失数据；<li>功能支持：MQ领域的功能极其完备；</ul><p>缺点：<p>官方社区现在对 ActiveMQ 5.x 维护越来越少，客户量较少。<h1 id=KafKa和RabbitMQ的区别><a class=headerlink href=#KafKa和RabbitMQ的区别 title=KafKa和RabbitMQ的区别></a>KafKa和RabbitMQ的区别</h1><h2 id=语言不同><a class=headerlink href=#语言不同 title=语言不同></a>语言不同</h2><ul><li>RabbitMQ：由高并发语言 erlanng 开发而成，适用于 可靠性要求较高 的场景。<li>KafKa：由 Scala 语言开发而成，适用于 处理大量活跃流式数据的场景。</ul><h2 id=架构不同><a class=headerlink href=#架构不同 title=架构不同></a>架构不同</h2><p>producer、broker、consumer<ul><li><p>RabbitMQ：以 broker 为中心，有消息确认机制。</p><li><p>KafKa：以 consumer 为中心，无消息确认机制。</p></ul><h2 id=Brokerr与Consume交互方式不同><a class=headerlink href=#Brokerr与Consume交互方式不同 title=Brokerr与Consume交互方式不同></a>Brokerr与Consume交互方式不同</h2><ul><li>RabbitMQ 采用 push（推）方式。<li>KafKa 采用 pull（拉）方式。</ul><h2 id=集群负载><a class=headerlink href=#集群负载 title=集群负载></a>集群负载</h2><ul><li><p>RabbitMQ：不支持负载均衡，需要 loadbalancer 支持。</p> <p>loadbalancer：是一个 请求转发、负载均衡工具。</p><li><p>KafKa：采用 Zookeeper 对集群中的 broker、consumer 进行管理。</p></ul><h2 id=适用场景><a class=headerlink href=#适用场景 title=适用场景></a>适用场景</h2><ul><li><p>RabbitMQ</p> <p>RabbitMQ支持 可靠传递消息、事务，但不支持批量操作；</p> <p>存储可采用内存或者硬盘。金融场景中经常使用。</p><li><p>KafKa</p> <p>KafKa支持 批量处理消息、zero-copy机制，且拥有高吞吐量；</p> <p>数据的存储和获取是 本地磁盘顺序批量操作，具有O(1)的复杂度（与分区上的存储大小无关），消息处理效率很高；</p></ul><h1 id=常见消息中间件对比><a class=headerlink href=#常见消息中间件对比 title=常见消息中间件对比></a>常见消息中间件对比</h1><table><thead><tr><th align=center><th align=center>ActiveMQ<th align=center>RabbitMQ<th align=center>RocketMQ<th align=center>KafKa<tbody><tr><td align=center>实现语言<td align=center>Java<td align=center>Erlang<td align=center>Java<td align=center>Scala<tr><td align=center>吞吐量<td align=center>万级<td align=center>万级<td align=center>十万级<td align=center>十万级<tr><td align=center>时效<td align=center>毫秒<td align=center>微秒<td align=center>毫秒<td align=center>毫秒<tr><td align=center>可用性<td align=center>高（主从）<td align=center>高（主从）<td align=center>非常高（分布式）<td align=center>非常高（分布式）<tr><td align=center>可靠性<td align=center>低概率丢失<td align=center>几乎0丢失<td align=center>几乎0丢失<td align=center>几乎0丢失<tr><td align=center>数据存储<td align=center>每个节点存储所有数据<td align=center>每个节点存储所有数据<td align=center>每个节点存储部分数据，且每个节点都有数据备份<td align=center>每个节点存储部分数据，且每个节点都有数据备份</table></div><footer class=post-footer><div class=post-eof></div></footer></article></div><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=https://hshz21.gitee.io/2024/08/21/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/static/imgs/avatar.png itemprop=image> <meta content=豪哥 itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=豪哥博客 itemprop=name> <meta content=豪哥博客 itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="undefined | 豪哥博客" itemprop=name> <meta itemprop=description> </span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/2024/08/21/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/ itemprop=url>数据与算法系列-数据结构与算法</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2024-08-21 21:39:15" datetime=2024-08-21T21:39:15+08:00>2024-08-21</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-10-06 10:25:57" datetime=2023-10-06T10:25:57+08:00 itemprop=dateModified>2023-10-06</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/%E6%95%B0%E6%8D%AE%E4%B8%8E%E7%AE%97%E6%B3%95/ itemprop=url rel=index><span itemprop=name>数据与算法</span></a> </span> </span></div></div></header><div class=post-body itemprop=articleBody><h1 id=1、算法><a class=headerlink href=#1、算法 title=1、算法></a>1、算法</h1><p>算法指同一问题的不同解决方法。算法通常针对特定数据结构。<h2 id=1-1、排序算法><a class=headerlink href=#1-1、排序算法 title=1.1、排序算法></a>1.1、排序算法</h2><h3 id=1-1-1、内部排序（使用内存）><a class=headerlink href=#1-1-1、内部排序（使用内存） title=1.1.1、内部排序（使用内存）></a>1.1.1、内部排序（使用内存）</h3><h4 id=1-1-1-1、插入排序><a class=headerlink href=#1-1-1-1、插入排序 title=1.1.1.1、插入排序></a>1.1.1.1、插入排序</h4><ul><li>直接插入排序：将n个待排序元素看成一个有序表和一个无序表，第一次排序时，有序表中只有一个元素，无序表中有n-1个元素，接下来每次从无序表中拿出第一个元素，将它放入有序表的适当位置，使之依然序表。然后继续，直到排序完毕；<li>折半插入排序：是对直接插入排序算法的一种改进。与直接插入排序的区别是：在有序表中寻找待排序数据的正确位置时，使用了折半查找/二分查找。<li>希尔排序：希尔排序是将记录按下标的一定增量分组，对每组使用直接插入排序算法排序；随着增量逐渐减少，每组包含的关键词越来越多，当增量减至1时，整个文件恰被分成一组，算法便终止。</ul><h4 id=1-1-1-2、选择排序><a class=headerlink href=#1-1-1-2、选择排序 title=1.1.1.2、选择排序></a>1.1.1.2、选择排序</h4><p><strong>（1）简单选择排序</strong><p>每一轮只找最小值且放在最前面，下一轮在剩下的元素中再次寻找最小值并放于上一次找到的最小值右边，以此类推，直到全部比较完毕。<p><strong>（2）堆排序</strong><p>堆排序是一种选择排序，最坏，最好的平均时间复杂度均为O(nlogn)，它是不稳定排序。<p>堆是一个完全二叉树，特点是<strong>每个节点的值都大于或等于其左右孩子节点的值，称为大顶堆；或者每个节点的值都小于或等于其左右孩子节点的值，称为小顶堆</strong>。<p>堆排序逻辑如下：<ol><li>将无序序列构建成一个堆，根据 升序/降序 需求 选择 小顶堆或大顶堆；<li>将堆顶元素与末尾元素交换，将最大元素”沉”到数组末端；<li>重新调整结构，使其满足堆定义，然后继续交换堆顶元素与当前末尾元素，反复执行调整+交换步骤，直到整个序列有序；</ol><p>堆排序时间复杂度：<ul><li>平均时间复杂度：O(nlogn)<li>最好情况：O(nlogn)<li>最坏情况：O(nlogn)<li>空间复杂度：O(1)<li>稳定性：不稳定</ul><h4 id=1-1-1-3、交换排序><a class=headerlink href=#1-1-1-3、交换排序 title=1.1.1.3、交换排序></a>1.1.1.3、交换排序</h4><p><strong>（1）冒泡排序</strong><p>其逻辑是比较相邻的元素。如果第一个比第二个大，就交换他们两个。<p><strong>（2）快速排序</strong><p>快速排序是一种 排序执行效率很高的 排序算法，它利用分治法来对待排序序列进行分治排序。<p>它的思想是：以最后一位数字为关键字，拿待排序数组中的每个元素对比关键字进行一趟排序将待排记录分隔成独立的两部分，其中的一部分比关键字小，后面一部分比关键字大，然后再对这前后的两部分分别采用这种方式进行排序，通过递归的运算最终达到整个序列有序。<blockquote><p>快排之所以被称为“快”排，是因为它的平均时间是最短的，主要原因是硬件方面的，每趟快排需要指定一个“支点”（也就是作为分界点的值），一趟中涉及的所有比较都是与这个“支点”来进行比较的，那么我们可以把这个“支点”放在寄存器里，如此这般，效率自然大大提高。除此之外，快排的高效率与分治思想也是分不开的。</blockquote><h4 id=1-1-1-4、归并排序><a class=headerlink href=#1-1-1-4、归并排序 title=1.1.1.4、归并排序></a>1.1.1.4、归并排序</h4><p><strong>归并排序基于分治法</strong>，其思想是将待排序的元素序列分成两个相等的子序列，然后将子序列再次分割为两个子序列，一直分割到一个序列只有一个元素为止。然后比较相邻两个子序列中数据大小，将小的放左边，大的放右边，并将之合并为一个序列，以此类推，直到合并完成为止。<p><img alt=image-20200921145201640 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20200921145201640.png?token=AIGEF3L2CI465XXEYEKL7IDEZZWVM><h4 id=1-1-1-5、基数排序><a class=headerlink href=#1-1-1-5、基数排序 title=1.1.1.5、基数排序></a>1.1.1.5、基数排序</h4><p>基数排序（radix sort）属于“分配式排序”（distribution sort），又称“桶子法”（bucket sort）或bin sort，顾名思义，它是通过键值的各个位的值，将要排序的元素分配至某些“桶”中，从而达到排序的作用，基数排序法是属于稳定性的排序。<h3 id=1-1-2、外部排序><a class=headerlink href=#1-1-2、外部排序 title=1.1.2、外部排序></a>1.1.2、外部排序</h3><h2 id=1-2、查找算法><a class=headerlink href=#1-2、查找算法 title=1.2、查找算法></a>1.2、查找算法</h2><p>Java中常用的查找算法有四种。<h3 id=1-2-1、顺序（线性）查找><a class=headerlink href=#1-2-1、顺序（线性）查找 title=1.2.1、顺序（线性）查找></a>1.2.1、顺序（线性）查找</h3><h3 id=1-2-2、二分查找><a class=headerlink href=#1-2-2、二分查找 title=1.2.2、二分查找></a>1.2.2、二分查找</h3><p>每次拿到待查找元素数组的中间元素值且将数组分成两半（左半和右半），然后拿查找值与中间元素值比较，大了就以右半数组为基础做相同操作，小了就以左半数组为基础做相同操作，以此类推，直到找到为止。<h3 id=1-2-3、插值查找><a class=headerlink href=#1-2-3、插值查找 title=1.2.3、插值查找></a>1.2.3、插值查找</h3><p>二分查找的升级版，升级地方为求中间元素值的公式。<ul><li><p>二分查找 获取中间元素值的公式为：int mid = (left + right) / 2;</p><li><p>插值查找 获取中间元素值的公式为：int mid = left + (right - left)*(findVal - arr[left]) / (arr[right] - arr[left]);</p></ul><h3 id=1-2-4、斐波那契查找（黄金分割点查找）><a class=headerlink href=#1-2-4、斐波那契查找（黄金分割点查找） title=1.2.4、斐波那契查找（黄金分割点查找）></a>1.2.4、斐波那契查找（黄金分割点查找）</h3><p>其原理与前两种类似，仅仅<strong>改变了中间元素（mid）的位置</strong>，mid不再是中间或插值得到，而是位于黄金分割点附近，即：mid = low + F(k - 1) - 1; F代表斐波那契数列。<blockquote><p>斐波那契数列：{1,1,2,3,5,8,13,21,34,55}，发现数列的两个相邻数的比例无限接近0.618。</blockquote><h2 id=1-3、常用算法><a class=headerlink href=#1-3、常用算法 title=1.3、常用算法></a>1.3、常用算法</h2><h3 id=1-3-1、二分查找算法（非递归，关键字匹配）><a class=headerlink href=#1-3-1、二分查找算法（非递归，关键字匹配） title=1.3.1、二分查找算法（非递归，关键字匹配）></a>1.3.1、二分查找算法（非递归，关键字匹配）</h3><h4 id=1-3-1-1、简介><a class=headerlink href=#1-3-1-1、简介 title=1.3.1.1、简介></a>1.3.1.1、简介</h4><p><strong>二分查找也称 折半查找（Binary Search），是一种效率较高的查找方法</strong>。折半查找要求线性表必须采用顺序存储结构，而且表中元素按关键字有序排列。该算法时间复杂度可以表示O(h)=O(log2n)。<p>首先，假设表中元素是按升序排列，将表中间位置记录的<a href=https://baike.baidu.com/item/%E5%85%B3%E9%94%AE%E5%AD%97 rel=noopener target=_blank>关键字</a>与查找关键字比较，如果两者相等，则查找成功；否则利用中间位置记录将表分成前、后两个子表，如果中间位置记录的关键字大于查找关键字，则进一步查找前一子表，否则进一步查找后一子表。重复以上过程，直到找到满足条件的<a href=https://baike.baidu.com/item/%E8%AE%B0%E5%BD%95/1837758 rel=noopener target=_blank>记录</a>，使查找成功，或直到子表不存在为止，此时查找不成功。<h4 id=1-3-1-2、代码实现><a class=headerlink href=#1-3-1-2、代码实现 title=1.3.1.2、代码实现></a>1.3.1.2、代码实现</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=keyword>static</span> <span class=type>int</span> <span class="title function_">binarySearch</span><span class=params>(Integer[] srcArray, <span class=type>int</span> des)</span> {</span><br><span class=line>    <span class=comment>//定义初始最小、最大索引</span></span><br><span class=line>    <span class=type>int</span> <span class=variable>start</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>    <span class=type>int</span> <span class=variable>end</span> <span class=operator>=</span> srcArray.length - <span class=number>1</span>;</span><br><span class=line>    <span class=comment>//确保不会出现重复查找，越界</span></span><br><span class=line>    <span class=keyword>while</span> (start <= end) {</span><br><span class=line>        <span class=comment>//计算出中间索引值</span></span><br><span class=line>        <span class=type>int</span> <span class=variable>middle</span> <span class=operator>=</span> (end + start)>>><span class=number>1</span> ;<span class=comment>//防止溢出</span></span><br><span class=line>        <span class=keyword>if</span> (des == srcArray[middle]) {</span><br><span class=line>            <span class=keyword>return</span> middle;</span><br><span class=line>        <span class=comment>//判断下限</span></span><br><span class=line>        } <span class=keyword>else</span> <span class=keyword>if</span> (des < srcArray[middle]) {</span><br><span class=line>            end = middle - <span class=number>1</span>;</span><br><span class=line>        <span class=comment>//判断上限</span></span><br><span class=line>        } <span class=keyword>else</span> {</span><br><span class=line>            start = middle + <span class=number>1</span>;</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>    <span class=comment>//若没有，则返回-1</span></span><br><span class=line>    <span class=keyword>return</span> -<span class=number>1</span>;</span><br><span class=line>}</span><br></pre></table></figure><h3 id=1-3-2、分治算法><a class=headerlink href=#1-3-2、分治算法 title=1.3.2、分治算法></a>1.3.2、分治算法</h3><h4 id=1-3-2-1、简介><a class=headerlink href=#1-3-2-1、简介 title=1.3.2.1、简介></a>1.3.2.1、简介</h4><p>分治算法的基本思想是将一个规模为N的问题分解为K个规模较小的子问题，这些子问题相互独立且与原问题性质相同。求出子问题的解就可得到原问题的解。即一种分割目标完成计算的算法，简单问题可用二分法完成。<h4 id=1-3-2-2、解题步骤><a class=headerlink href=#1-3-2-2、解题步骤 title=1.3.2.2、解题步骤></a>1.3.2.2、解题步骤</h4><p>分治法解题的一般步骤：<ol><li>分解，将要解决的问题划分成若干规模较小的同类问题；<li>求解，当子问题划分得足够小时，用较简单的方法解决；<li>合并，按原问题的要求，将子问题的解逐层合并构成原问题的解。</ol><h4 id=1-3-2-3、应用场景><a class=headerlink href=#1-3-2-3、应用场景 title=1.3.2.3、应用场景></a>1.3.2.3、应用场景</h4><p>运用分治策略解决的问题一般来说具有以下特点：<ol><li><p>原问题可以分解为多个子问题：</p> <p>这些子问题与原问题相比，只是问题的规模有所降低，其结构和求解方法与原问题相同或相似。</p><li><p>原问题在分解过程中，递归地求解子问题：</p> <p>由于递归都必须有一个终止条件，因此，当分解后的子问题规模足够小时，应能够直接求解。</p><li><p>在求解并得到各个子问题的解后：</p> <p>应能够采用某种方式、方法合并或构造出原问题的解。</p></ol><p>在分治策略中，由于子问题与原问题在结构和解法上的相似性，用分治方法解决的问题，大都采用了递归的形式。在各种排序方法中，如归并排序、堆排序、快速排序等，都存在有分治的思想。<h3 id=1-3-3、动态规划算法（求最优决策）><a class=headerlink href=#1-3-3、动态规划算法（求最优决策） title=1.3.3、动态规划算法（求最优决策）></a>1.3.3、动态规划算法（求最优决策）</h3><h4 id=13-3-1、简介><a class=headerlink href=#13-3-1、简介 title=13.3.1、简介></a>13.3.1、简介</h4><p>动态规划（Dynamic Programming，DP）是<a href=https://baike.baidu.com/item/%E8%BF%90%E7%AD%B9%E5%AD%A6/1559 rel=noopener target=_blank>运筹学</a>的一个分支，是求解<a href=https://baike.baidu.com/item/%E5%86%B3%E7%AD%96%E8%BF%87%E7%A8%8B/6714639 rel=noopener target=_blank>决策过程</a>最优化的过程。20世纪50年代初，美国数学家<a href=https://baike.baidu.com/item/%E8%B4%9D%E5%B0%94%E6%9B%BC/9239579 rel=noopener target=_blank>贝尔曼</a>（R.Bellman）等人在研究多阶段决策过程的优化问题时，提出了著名的 最优化原理，从而创立了动态规划。动态规划的应用极其广泛，包括工程技术、经济、工业生产、军事以及自动化控制等领域，并在背包问题、生产经营问题、资金管理问题、资源分配问题、最短路径问题和复杂系统可靠性问题等中取得了显著的效果。<p><strong>动态规划算法通常用于求解具有某种最优性质的问题</strong>。动态规划算法与<a href=https://baike.baidu.com/item/%E5%88%86%E6%B2%BB%E6%B3%95 rel=noopener target=_blank>分治法</a>类似，基本思想是 将待求解问题分解成若干个子问题，先求解子问题，然后根据 子问题的解 得到 原问题的解。与分治法不同的是，适合于用动态规划求解的问题，经分解得到子问题往往不是互相独立的。<h4 id=1-3-3-2、局限性><a class=headerlink href=#1-3-3-2、局限性 title=1.3.3.2、局限性></a>1.3.3.2、局限性</h4><p>动态规划对于解决多阶段决策问题的效果很明显，但是动态规划也有一定的局限性。首先，它没有统一的处理方法，必须根据问题的各种性质并结合一定的技巧来处理；另外当变量的维数增大时，总的计算量及存贮量急剧增大。因而，受计算机的存贮量及计算速度的限制，当今的计算机仍不能用动态规划方法来解决较大规模的问题，这就是“维数障碍”。<h3 id=1-3-4、暴力匹配算法（字符串匹配）><a class=headerlink href=#1-3-4、暴力匹配算法（字符串匹配） title=1.3.4、暴力匹配算法（字符串匹配）></a>1.3.4、暴力匹配算法（字符串匹配）</h3><h4 id=1-3-4-1、简介><a class=headerlink href=#1-3-4-1、简介 title=1.3.4.1、简介></a>1.3.4.1、简介</h4><p>暴力匹配的思想：假设下标<code>i</code>指向字符串<code>str1</code>，下标<code>j</code>指向字符串<code>str2</code>，则有如下规律：<ol><li>如果str1[i] = str2[j]，则i++，j++。<li>如果str1[i] != str2[j]，则令i = i - (j - 1)，j = 0。</ol><h4 id=1-3-4-2、缺点><a class=headerlink href=#1-3-4-2、缺点 title=1.3.4.2、缺点></a>1.3.4.2、缺点</h4><p><strong>暴力破解会有大量的回溯</strong>，每次只移动一位，若不匹配则移动到下一位接着判断，浪费了大量时间。为了优化就诞生了KMP算法。<h3 id=1-3-5、KMP算法（字符串匹配）><a class=headerlink href=#1-3-5、KMP算法（字符串匹配） title=1.3.5、KMP算法（字符串匹配）></a>1.3.5、KMP算法（字符串匹配）</h3><h4 id=1-3-5-1、简介><a class=headerlink href=#1-3-5-1、简介 title=1.3.5.1、简介></a>1.3.5.1、简介</h4><p><strong>KMP算法是一种改进的字符串匹配算法</strong>，由D.E.Knuth，J.H.Morris和V.R.Pratt提出的，因此人们称它为克努特—莫里斯—普拉特操作（简称KMP算法）。KMP算法的核心是利用匹配失败后的信息，尽量减少模式串与主串的匹配次数以达到快速匹配的目的。具体实现就是通过一个next()函数实现，函数本身包含了模式串的局部匹配信息。KMP算法的 时间复杂度为 <code>O(m+n) [1]</code> 。<h4 id=1-3-5-2、模式匹配类型><a class=headerlink href=#1-3-5-2、模式匹配类型 title=1.3.5.2、模式匹配类型></a>1.3.5.2、模式匹配类型</h4><ol><li>精确匹配<li>近似匹配</ol><h4 id=1-3-5-3、部分匹配表><a class=headerlink href=#1-3-5-3、部分匹配表 title=1.3.5.3、部分匹配表></a>1.3.5.3、部分匹配表</h4><p><img alt=image-20200919141327620 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20200919141327620.png?token=AIGEF3JMQBUJFREE6ZNIL5DEZZWXE><p>由表可得：移动位数 = 已匹配的字符数 + 对应的部分匹配值。<h3 id=1-3-6、贪心算法（局部最优解）><a class=headerlink href=#1-3-6、贪心算法（局部最优解） title=1.3.6、贪心算法（局部最优解）></a>1.3.6、贪心算法（局部最优解）</h3><h4 id=1-3-6-1、简介><a class=headerlink href=#1-3-6-1、简介 title=1.3.6.1、简介></a>1.3.6.1、简介</h4><p><strong>贪心算法（又称贪婪算法）是指，在对问题求解时，总是做出在当前看来是最好的选择。也就是说，不从整体最优上加以考虑，算法得到的是在某种意义上的局部最优解</strong>。<p>贪心算法不是对所有问题都能得到整体最优解，关键是贪心策略的选择。也就是说，不从整体最优上加以考虑，做出的只是在某种意义上的局部最优解。<h3 id=1-3-7、普利姆算法（Prim，稠密图最小生成树）><a class=headerlink href=#1-3-7、普利姆算法（Prim，稠密图最小生成树） title=1.3.7、普利姆算法（Prim，稠密图最小生成树）></a>1.3.7、普利姆算法（Prim，稠密图最小生成树）</h3><h4 id=1-3-7-1、简介><a class=headerlink href=#1-3-7-1、简介 title=1.3.7.1、简介></a>1.3.7.1、简介</h4><p>普利姆(Prim)算法求最小生成树，也就是在包含n个顶点的连通图中，找出只有(n-1)条边包含所有n个顶点的连通子图，也就是所谓的极小连通子图。<p>例如，通过普里姆算法查找下图的最小生成树的步骤为：<ol><li><p>假如从顶点A出发，顶点 B、C、D 到顶点 A 的权值分别为 2、4、2，所以，对于顶点 A 来说，顶点 B 和顶点 D 到 A 的权值最小，假设先找到的顶点 B：</p> <p><img alt=image-20200920084320304 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20200920084320304.png?token=AIGEF3IZHFXIYNI4L5HLUBLEZZWYU></p><li><p>继续分析顶点 C 和 D，顶点 C 到 B 的权值为 3，到 A 的权值为 4；顶点 D 到 A 的权值为 2，到 B 的权值为无穷大（如果之间没有直接通路，设定权值为无穷大）。所以顶点 D 到 A 的权值最小：</p> <p><img alt=image-20200920084352501 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20200920084352501.png?token=AIGEF3LLQKIYVMKSWL5RUP3EZZWZY></p><li><p>最后，只剩下顶点 C，到 A 的权值为 4，到 B 的权值和到 D 的权值一样大，为 3。所以该连通图有两个最小生成树：</p> <p><img alt=image-20200920084435924 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/image-20200920084435924.png?token=AIGEF3OD2D3UJQXOLJPN4MDEZZW3O></p></ol><h4 id=1-3-7-2、总结><a class=headerlink href=#1-3-7-2、总结 title=1.3.7.2、总结></a>1.3.7.2、总结</h4><p>普利姆算法求最小生成树，是从顶点方面考虑，存在两重遍历(已访问顶点集和未访问顶点集)，对应的还有一个克鲁斯卡尔算法求最小生成树，是从边的角度出发考虑的。根据各自算法特性，可以粗略的判断出，把稠密图看作边集相对于点集数量级比较大，稀疏图看作点集相对于边集较大，则普利姆算法适合于计算稠密图，克鲁斯卡尔算法适合于计算稀疏图。<h3 id=1-3-8、克鲁斯卡尔算法（Kruskal，稀疏图最小生成树）><a class=headerlink href=#1-3-8、克鲁斯卡尔算法（Kruskal，稀疏图最小生成树） title=1.3.8、克鲁斯卡尔算法（Kruskal，稀疏图最小生成树）></a>1.3.8、克鲁斯卡尔算法（Kruskal，稀疏图最小生成树）</h3><h4 id=1-3-8-1、简介><a class=headerlink href=#1-3-8-1、简介 title=1.3.8.1、简介></a>1.3.8.1、简介</h4><p><strong>克鲁斯卡尔算法是求连通网的最小生成树的另一种方法</strong>。与普里姆算法不同，它的时间复杂度为O（e loge）（e为网中的边数），所以，适合于求边稀疏的网的最小生成树 [1] 。<h4 id=1-3-8-2、基本思想><a class=headerlink href=#1-3-8-2、基本思想 title=1.3.8.2、基本思想></a>1.3.8.2、基本思想</h4><p>克鲁斯卡尔（Kruskal）算法从另一途径求网的最小生成树。其基本思想是：假设连通网G=（V，E），令最小生成树的初始状态为只有n个顶点而无边的非连通图T=（V，{}），图中每个顶点自成一个连通分量。在E中选择代价最小的边，若该边依附的顶点分别在T中不同的连通分量上，则将此边加入到T中；否则，舍去此边而选择下一条代价最小的边。依此类推，直至T中所有顶点构成一个连通分量为止 [2] 。<h3 id=1-3-9、迪杰斯特拉算法（Dijkstra，最短路径）><a class=headerlink href=#1-3-9、迪杰斯特拉算法（Dijkstra，最短路径） title=1.3.9、迪杰斯特拉算法（Dijkstra，最短路径）></a>1.3.9、迪杰斯特拉算法（Dijkstra，最短路径）</h3><h4 id=1-3-9-1、简介><a class=headerlink href=#1-3-9-1、简介 title=1.3.9.1、简介></a>1.3.9.1、简介</h4><p>迪杰斯特拉算法(Dijkstra)是由荷兰计算机科学家<a href=https://baike.baidu.com/item/%E7%8B%84%E5%85%8B%E6%96%AF%E7%89%B9%E6%8B%89/2828872 rel=noopener target=_blank>狄克斯特拉</a>于1959 年提出，因此又叫<a href=https://baike.baidu.com/item/%E7%8B%84%E5%85%8B%E6%96%AF%E7%89%B9%E6%8B%89%E7%AE%97%E6%B3%95/6764865 rel=noopener target=_blank>狄克斯特拉算法</a>。是从一个顶点到其余各顶点的<a href=https://baike.baidu.com/item/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84 rel=noopener target=_blank>最短路径</a>算法，解决的是有权图中最短路径问题。迪杰斯特拉算法主要特点是从起始点开始，采用<a href=https://baike.baidu.com/item/%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/5411800 rel=noopener target=_blank>贪心算法</a>的策略，每次遍历到始点距离最近且未访问过的顶点的邻接节点，直到扩展到终点为止。<p>Dijkstra算法通常有两种方式，一种用永久和临时标号方式，一种是用OPEN、CLOSE表的方式，这里均采用永久和临时标号方式。注意该算法要求图中不存在负权边。<h3 id=1-3-10、弗洛伊德算法（Floyd，最短路径）><a class=headerlink href=#1-3-10、弗洛伊德算法（Floyd，最短路径） title=1.3.10、弗洛伊德算法（Floyd，最短路径）></a>1.3.10、弗洛伊德算法（Floyd，最短路径）</h3><h4 id=1-3-10-1、简介><a class=headerlink href=#1-3-10-1、简介 title=1.3.10.1、简介></a>1.3.10.1、简介</h4><p><strong>Floyd算法又称为插点法</strong>，是一种利用<a href=https://baike.baidu.com/item/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/529408 rel=noopener target=_blank>动态规划</a>思想寻找给定<a href=https://baike.baidu.com/item/%E5%8A%A0%E6%9D%83%E5%9B%BE/10579361 rel=noopener target=_blank>加权图</a>中多源点之间<a href=https://baike.baidu.com/item/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/6334920 rel=noopener target=_blank>最短路径</a>的算法，与Dijkstra算法类似。该算法名称以创始人之一、1978年<a href=https://baike.baidu.com/item/%E5%9B%BE%E7%81%B5%E5%A5%96/324645 rel=noopener target=_blank>图灵奖</a>获得者、斯坦福大学计算机科学系教授<a href=https://baike.baidu.com/item/%E7%BD%97%E4%BC%AF%E7%89%B9%C2%B7%E5%BC%97%E6%B4%9B%E4%BC%8A%E5%BE%B7/4903135 rel=noopener target=_blank>罗伯特·弗洛伊德</a>命名。<p>该算法也称为Floyd算法，Roy-Warshall算法，Roy-Floyd算法或WFI算法。<h4 id=1-3-10-2、算法过程><a class=headerlink href=#1-3-10-2、算法过程 title=1.3.10.2、算法过程></a>1.3.10.2、算法过程</h4><ol><li>从任意一条单边路径开始。所有两点之间的距离是边的权，如果两点之间没有边相连，则权为无穷大。<li>对于每一对顶点 u 和 v，看看是否存在一个顶点 w 使得从 u 到 w 再到 v 比已知的路径更短。如果是更新它。</ol><h4 id=1-3-10-3、时间-空间复杂度><a class=headerlink href=#1-3-10-3、时间-空间复杂度 title=1.3.10.3、时间/空间复杂度></a>1.3.10.3、时间/空间复杂度</h4><ul><li>时间复杂度：O(n^3)；<li>空间复杂度：O(n^2)；</ul><h4 id=1-3-10-4、优缺点><a class=headerlink href=#1-3-10-4、优缺点 title=1.3.10.4、优缺点></a>1.3.10.4、优缺点</h4><p>Floyd算法适用于APSP(All Pairs Shortest Paths，多源最短路径)，是一种动态规划算法，稠密图效果最佳，边权可正可负。此算法简单有效，由于三重循环结构紧凑，对于稠密图，效率要高于执行|V|次<a href=https://baike.baidu.com/item/Dijkstra%E7%AE%97%E6%B3%95 rel=noopener target=_blank>Dijkstra算法</a>，也要高于执行|V|次<a href=https://baike.baidu.com/item/SPFA%E7%AE%97%E6%B3%95 rel=noopener target=_blank>SPFA算法</a>。<ul><li>优点：容易理解，可以算出任意两个节点之间的最短距离，代码编写简单。<li>缺点：时间复杂度比较高，不适合计算大量数据。</ul><h3 id=1-3-11、骑士周游回溯算法><a class=headerlink href=#1-3-11、骑士周游回溯算法 title=1.3.11、骑士周游回溯算法></a>1.3.11、骑士周游回溯算法</h3><h4 id=1-3-11-1、简介><a class=headerlink href=#1-3-11-1、简介 title=1.3.11.1、简介></a>1.3.11.1、简介</h4><p>深度优先遍历+回溯+贪心。从初始位置startPoint开始，获取下一步能到达的所有位置，将它们添加到集合ArrayList< Point >中，根据它们下一步所能到达的位置的个数k对ArrayList< Point >中所有位置进行非递减排序，优先对k较小的位置进行遍历，若此路不通，则回溯。<h2 id=1-4、算法复杂度><a class=headerlink href=#1-4、算法复杂度 title=1.4、算法复杂度></a>1.4、算法复杂度</h2><h3 id=1-4-1、时间复杂度><a class=headerlink href=#1-4-1、时间复杂度 title=1.4.1、时间复杂度></a>1.4.1、时间复杂度</h3><p>度量一个程序执行时间的方法有两种：<ol><li>事前估算法<li>事后统计法</ol><h4 id=1-4-1-1、时间频度><a class=headerlink href=#1-4-1-1、时间频度 title=1.4.1.1、时间频度></a>1.4.1.1、时间频度</h4><p>**一个算法中语句执行次数称为 语句频度 或 时间频度，记为T(n)**。<h4 id=1-4-1-2、时间复杂度表示><a class=headerlink href=#1-4-1-2、时间复杂度表示 title=1.4.1.2、时间复杂度表示></a>1.4.1.2、时间复杂度表示</h4><ol><li>O(1)：常数时间，不论输入的数据规模有多大，算法都具有恒定的执行时间。<li>O(log n)：对数阶，二分搜索是一个该复杂度的一个经典例子。<li>O(n)：线性阶：数据的输入与算法的执行时间成正比。<li>O(n*log n)：线性对数阶，常见排序算法（归并、快排）都在该复杂度内。<li>O(n^2)：平方阶，嵌套循环通常会导致该复杂度。<li>O(n^3)：立方阶。<li>O(n^k)：k次方阶。<li>O(2^n)：指数时间。<li>O(n!)：阶乘时间。</ol><p><img alt=算法时间复杂度01 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/%E7%AE%97%E6%B3%95%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A601.jpg?token=AIGEF3PJUNGHWIOJSSI2YZ3EZZW5K><h3 id=1-4-2、空间复杂度><a class=headerlink href=#1-4-2、空间复杂度 title=1.4.2、空间复杂度></a>1.4.2、空间复杂度</h3><h4 id=1-4-2-1、简介><a class=headerlink href=#1-4-2-1、简介 title=1.4.2.1、简介></a>1.4.2.1、简介</h4><p>空间复杂度描述了算法在执行过程中额外使用的内存空间与输入数据量之间的关系。<p>1.4.2.2、空间复杂度类型<ul><li>O(1)：常量空间。算法使用固定规模的额外空间。<li>O(log n)：递归二分搜索中，堆栈调用深度是log n。<li>O(n)：线性空间。</ul><h3 id=1-4-3、Big-O><a title="1.4.3、Big O" class=headerlink href=#1-4-3、Big-O></a>1.4.3、Big O</h3><p><strong>Big O是描述算法复杂度的标号，通常使用Big O描述最坏情况下的运行时间或所需空间</strong>。<p><strong>Big O表示法的核心思想是关注主要部分，忽略常数、低次项等</strong>。比如，如果一个算法执行时间为 3n^2+4n+15，我们通常会说它的运行时间为O(n^2)，因为当n足够大时，低此项和常数的影响将变得微不足道。<p>Big O表示法为我们提供了一种评估算法效率的高级视角，使得我们能够快速比较不同算法在处理大数据量时的性能。<h3 id=1-4-4、总结><a class=headerlink href=#1-4-4、总结 title=1.4.4、总结></a>1.4.4、总结</h3><h4 id=排序算法-时间-空间复杂度-对比><a title="排序算法 时间/空间复杂度 对比" class=headerlink href=#排序算法-时间-空间复杂度-对比></a>排序算法 时间/空间复杂度 对比</h4><p><img alt=排序算法时间空间复杂度01 src=https://raw.githubusercontent.com/lucky2shh/blog-haogeblogs-image/master/2023/08/05/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E6%97%B6%E9%97%B4%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A601.jpg?token=AIGEF3PCPFPUYKDIWGS3GKLEZZW7E><h1 id=2、数据结构><a class=headerlink href=#2、数据结构 title=2、数据结构></a>2、数据结构</h1><h2 id=2-1、简介><a class=headerlink href=#2-1、简介 title=2.1、简介></a>2.1、简介</h2><p>其英文称为：Data Structure，其表示存储数据的不同方式。<h2 id=2-2、分类><a class=headerlink href=#2-2、分类 title=2.2、分类></a>2.2、分类</h2><p>数据结构分为 <strong>线性结构 和 非线性结构</strong> 两大类。<h3 id=2-2-1、线性结构><a class=headerlink href=#2-2-1、线性结构 title=2.2.1、线性结构></a>2.2.1、线性结构</h3><p><strong>线性结构的特点是数据元素之间存在一对一的线性关系</strong>。即除了第一个和最后一个元素外，每个元素都有一个前驱和后继。<p>线性结构有两种存储结构：<ol><li><p>顺序存储结构：顺序存储的线性表称为顺序表，其中的元素是连续的：</p><li><p>链式存储结构：链式存储的线性表称为链表，其中的元素不一定是连续的，元素节点存放数据及相邻节点的地址信息：</p></ol><p>线性结构常见实现有：<ul><li><p><font color=orange>数组</font></p><li><p><font color=orange>队列</font>：队列是一个有序列表，遵循FIFO规则，可以用数组或链表来实现。</p> <p>队列是一种特殊操作受限的线性表，它只允许在表的前端（front，队头）执行删除操作，而在表的后端（rear，队尾）执行插入操作。</p> <p>队列中没有元素时，称为空队列。</p> <p>创建顺序队列结构必须为其静态分配或动态申请一片连续的存储空间，并设置两个指针进行管理。一个是队头指针front，它指向队头元素；另一个是队尾指针rear，它指向下一个入队元素的存储位置。</p> <p>队列采用FIFO(first in first out——先进先出)，数据插入到链表尾部，从头部开始读取数据。每次读取一个元素，释放一个元素。所谓的动态创建，动态释放。因而也不存在溢出等问题。由于链表由结构体间接而成，遍历也方便。（先进先出）。</p><li><p><font color=orange>链表</font></p><li><p><font color=orange>栈</font></p></ul><h3 id=2-2-2、非线性结构><a class=headerlink href=#2-2-2、非线性结构 title=2.2.2、非线性结构></a>2.2.2、非线性结构</h3><p><strong>非线性结构的特点是每个元素可能与多个其它元素连接，不仅仅是线性结构中的前驱和后继</strong>。<p>非线性结构通常使用指针或链接来表示元素之间的关系。<p>非线性结构常见实现有：<ol><li><p><font color=orange>树结构</font></p> <ol><li><p>二叉树</p> <ol><li><p>满二叉树：所有叶子节点都在同一层的二叉树称为：满二叉树。</p><li><p>完全二叉树：所有叶子节点在最后一层或者倒数第二层，且最后一层的叶子节点在左边连续，倒数第二层的叶子节点在右边连续，则我们称这样的二叉树为：完全二叉树。</p></ol><li><p>AVL树</p></ol><li><p><font color=orange>图结构</font></p></ol><h1 id=3、常见问题及应对><a class=headerlink href=#3、常见问题及应对 title=3、常见问题及应对></a>3、常见问题及应对</h1><h2 id=3-1、修路问题><a class=headerlink href=#3-1、修路问题 title=3.1、修路问题></a>3.1、修路问题</h2><p>最小生成树 + 普利姆算法<h2 id=3-2、最短路径问题><a class=headerlink href=#3-2、最短路径问题 title=3.2、最短路径问题></a>3.2、最短路径问题</h2><p>图 + 弗洛伊德算法<h2 id=3-3、汉诺塔问题><a class=headerlink href=#3-3、汉诺塔问题 title=3.3、汉诺塔问题></a>3.3、汉诺塔问题</h2><p>使用<strong>递归法</strong>可解决该问题。<p>汉诺塔问题是一个益智游戏，通常由3个柱子和一系列递减大小的盘子组成。初始时，所有盘子都在一个柱子上，目标是将它们移动到另一个柱子上，移动过程需要遵循两个规则：<ol><li>每次只能移动一个盘子。<li>大盘子不能放在小盘子上面。</ol><h2 id=3-4、八皇后问题><a class=headerlink href=#3-4、八皇后问题 title=3.4、八皇后问题></a>3.4、八皇后问题</h2><p>使用<strong>回溯法</strong>可解决该问题。<p>八皇后问题是一个经典问题，要求在8x8的棋盘上放置8个皇后，规则就是任何两个皇后都不能存在于同一行、同一列、同一对角线上。可以使用回溯法来解决这种问题。</div><footer class=post-footer><div class=post-eof></div></footer></article></div><nav class=pagination><span class="page-number current">1</span><a class=page-number href=/page/2/>2</a><span class=space>…</span><a class=page-number href=/page/11/>11</a><a class="extend next" aria-label=下一页 href=/page/2/ rel=next title=下一页><i class="fa fa-angle-right"></i></a></nav></div></main><footer class=footer><div class=footer-inner><div class=copyright>© <span itemprop=copyrightYear>2024</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>豪哥</span></div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label=返回顶部 class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script crossorigin=anonymous integrity=sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY= src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js></script><script src=/js/comments.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/sidebar.js></script><script src=/js/next-boot.js></script><script crossorigin=anonymous integrity=sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc= src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js></script><script src=/js/third-party/search/local-search.js></script>